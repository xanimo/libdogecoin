<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libdogecoin: src/bip39.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libdogecoin
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">bip39.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;<a class="el" href="index_8h_source.html">bip39/index.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="bip39_8h_source.html">dogecoin/bip39.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="utils_8h_source.html">dogecoin/utils.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="random_8h_source.html">dogecoin/random.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="sha2_8h_source.html">dogecoin/sha2.h</a>&gt;</code><br />
<code>#include &lt;uninorm.h&gt;</code><br />
</div>
<p><a href="bip39_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4a04654a0c21ca8f944129b45bc431e2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bip39_8c.html#a4a04654a0c21ca8f944129b45bc431e2">get_mnemonic</a> (const int entropysize, const char *entropy, const char *wordlist[], const char *space, char *entropy_out, char *mnemonic, size_t *mnemonic_size)</td></tr>
<tr class="separator:a4a04654a0c21ca8f944129b45bc431e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36b5d8096db0b0af682e5ad2a057a799"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bip39_8c.html#a36b5d8096db0b0af682e5ad2a057a799">get_root_seed</a> (const char *pass, const char *passphrase, <a class="el" href="winunistd_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> seed[64])</td></tr>
<tr class="separator:a36b5d8096db0b0af682e5ad2a057a799"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b8ebac5b6dd903e28d22fe1e8cdba6b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bip39_8c.html#a5b8ebac5b6dd903e28d22fe1e8cdba6b">get_custom_words</a> (const char *filepath, char *wordlist[])</td></tr>
<tr class="separator:a5b8ebac5b6dd903e28d22fe1e8cdba6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f89936585417beb5a425e5a66d32573"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bip39_8c.html#a7f89936585417beb5a425e5a66d32573">get_words</a> (const char *lang, char *wordlist[])</td></tr>
<tr class="separator:a7f89936585417beb5a425e5a66d32573"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16e1f39933538c74bc28b88ed8ae457d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bip39_8c.html#a16e1f39933538c74bc28b88ed8ae457d">produce_mnemonic_sentence</a> (const int segSize, const int checksumBits, const char *firstByte, const char *entropy, const char *wordlist[], const char *space, char *mnemonic, size_t *mnemonic_size)</td></tr>
<tr class="separator:a16e1f39933538c74bc28b88ed8ae457d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d658d3d4d40ee947004e68cca2ca67a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bip39_8c.html#a0d658d3d4d40ee947004e68cca2ca67a">dogecoin_generate_mnemonic</a> (const <a class="el" href="libdogecoin_8h.html#ac7bfd46fef5f139d2236baa3204c2ae2">ENTROPY_SIZE</a> entropy_size, const char *language, const char *space, const char *entropy, const char *filepath, char *entropy_out, size_t *size, char *words)</td></tr>
<tr class="memdesc:a0d658d3d4d40ee947004e68cca2ca67a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function generates a mnemonic for a given entropy size and language.  <a href="bip39_8c.html#a0d658d3d4d40ee947004e68cca2ca67a">More...</a><br /></td></tr>
<tr class="separator:a0d658d3d4d40ee947004e68cca2ca67a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89d04a12f306dad39828669665792f58"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bip39_8c.html#a89d04a12f306dad39828669665792f58">dogecoin_seed_from_mnemonic</a> (const char *mnemonic, const char *passphrase, <a class="el" href="libdogecoin_8h.html#aabc51db9648102bf9bc5009d5514921e">SEED</a> seed)</td></tr>
<tr class="memdesc:a89d04a12f306dad39828669665792f58"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function derives the seed from the mnemonic.  <a href="bip39_8c.html#a89d04a12f306dad39828669665792f58">More...</a><br /></td></tr>
<tr class="separator:a89d04a12f306dad39828669665792f58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d5c2d48bdf3dfb93ee813d51b643e92"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bip39_8c.html#a1d5c2d48bdf3dfb93ee813d51b643e92">generateRandomEnglishMnemonic</a> (const <a class="el" href="libdogecoin_8h.html#ac7bfd46fef5f139d2236baa3204c2ae2">ENTROPY_SIZE</a> size, <a class="el" href="libdogecoin_8h.html#aedbfa425a18f8fbd06416483601d2bc8">MNEMONIC</a> mnemonic)</td></tr>
<tr class="memdesc:a1d5c2d48bdf3dfb93ee813d51b643e92"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function generates a random English mnemonic phrase.  <a href="bip39_8c.html#a1d5c2d48bdf3dfb93ee813d51b643e92">More...</a><br /></td></tr>
<tr class="separator:a1d5c2d48bdf3dfb93ee813d51b643e92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6e0b6695d8c505b86970aa0bd189319"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bip39_8c.html#ab6e0b6695d8c505b86970aa0bd189319">generateEnglishMnemonic</a> (const <a class="el" href="libdogecoin_8h.html#a54c512bde686652b7e38e5e7f4287c5d">HEX_ENTROPY</a> entropy, const <a class="el" href="libdogecoin_8h.html#ac7bfd46fef5f139d2236baa3204c2ae2">ENTROPY_SIZE</a> size, <a class="el" href="libdogecoin_8h.html#aedbfa425a18f8fbd06416483601d2bc8">MNEMONIC</a> mnemonic)</td></tr>
<tr class="memdesc:ab6e0b6695d8c505b86970aa0bd189319"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function gnerates an English mnemonic phrase of given size or from hex entropy.  <a href="bip39_8c.html#ab6e0b6695d8c505b86970aa0bd189319">More...</a><br /></td></tr>
<tr class="separator:ab6e0b6695d8c505b86970aa0bd189319"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0d658d3d4d40ee947004e68cca2ca67a" name="a0d658d3d4d40ee947004e68cca2ca67a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d658d3d4d40ee947004e68cca2ca67a">&#9670;&nbsp;</a></span>dogecoin_generate_mnemonic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dogecoin_generate_mnemonic </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="libdogecoin_8h.html#ac7bfd46fef5f139d2236baa3204c2ae2">ENTROPY_SIZE</a>&#160;</td>
          <td class="paramname"><em>entropy_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>language</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>space</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>entropy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filepath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>entropy_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>words</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function generates a mnemonic for a given entropy size and language. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">entropy_size</td><td>The "128", "160", "192", "224", or "256" bits of entropy. </td></tr>
    <tr><td class="paramname">language</td><td>The ISO 639-2 code for the mnemonic language. </td></tr>
    <tr><td class="paramname">space</td><td>The character to seperate mnemonic words. </td></tr>
    <tr><td class="paramname">entropy</td><td>The entropy to generate the mnemonic (optional). </td></tr>
    <tr><td class="paramname">filepath</td><td>The path to a custom word file (optional). </td></tr>
    <tr><td class="paramname">entropy_out</td><td>The entropy of a given size as a hex string. </td></tr>
    <tr><td class="paramname">size</td><td>The size of the generated mnemonic in bytes (including '\0'). </td></tr>
    <tr><td class="paramname">words</td><td>The generated mnemonic code words.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 (success), -1 (fail) </dd></dl>

<p class="definition">Definition at line <a class="el" href="bip39_8c_source.html#l00691">691</a> of file <a class="el" href="bip39_8c_source.html">bip39.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  692</span>{</div>
<div class="line"><span class="lineno">  693</span>    <span class="keywordtype">char</span> *wordlist[<a class="code hl_define" href="bip39_8h.html#a0939c53ce21cbf0184f17730ddf7295c">LANG_WORD_CNT</a>] = {0};</div>
<div class="line"><span class="lineno">  694</span> </div>
<div class="line"><span class="lineno">  695</span>    <span class="comment">/* validate input, optional entropy checked below */</span></div>
<div class="line"><span class="lineno">  696</span>    <span class="keywordflow">if</span> (entropy_size != NULL) {</div>
<div class="line"><span class="lineno">  697</span> </div>
<div class="line"><span class="lineno">  698</span>        <span class="comment">/* load custom word file into memory if path is valid */</span></div>
<div class="line"><span class="lineno">  699</span>    <span class="keywordflow">if</span> (filepath != NULL) {</div>
<div class="line"><span class="lineno">  700</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="bip39_8c.html#a5b8ebac5b6dd903e28d22fe1e8cdba6b">get_custom_words</a> (filepath, (<span class="keywordtype">char</span> **) wordlist) == -1) {</div>
<div class="line"><span class="lineno">  701</span> </div>
<div class="line"><span class="lineno">  702</span>                <span class="comment">/* Free memory for custom words */</span></div>
<div class="line"><span class="lineno">  703</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="bip39_8h.html#a0939c53ce21cbf0184f17730ddf7295c">LANG_WORD_CNT</a>; i++) {</div>
<div class="line"><span class="lineno">  704</span>                    <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(wordlist[i]);</div>
<div class="line"><span class="lineno">  705</span>                }</div>
<div class="line"><span class="lineno">  706</span>                <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  707</span>            }</div>
<div class="line"><span class="lineno">  708</span>        }</div>
<div class="line"><span class="lineno">  709</span>        <span class="comment">/* otherwise, load language word list into memory */</span></div>
<div class="line"><span class="lineno">  710</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (language != NULL) {</div>
<div class="line"><span class="lineno">  711</span>           <span class="keywordflow">if</span> (<a class="code hl_function" href="bip39_8c.html#a7f89936585417beb5a425e5a66d32573">get_words</a>(language, wordlist) == -1) {</div>
<div class="line"><span class="lineno">  712</span>               <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  713</span>           }</div>
<div class="line"><span class="lineno">  714</span>        }</div>
<div class="line"><span class="lineno">  715</span>        <span class="comment">/* handle input validation errors */</span></div>
<div class="line"><span class="lineno">  716</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  717</span>            fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to get language or custom words file\n&quot;</span>);</div>
<div class="line"><span class="lineno">  718</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  719</span>        }</div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span>        <span class="comment">/* Validate optional entropy */</span></div>
<div class="line"><span class="lineno">  722</span>        <span class="keywordflow">if</span> (entropy != NULL) {</div>
<div class="line"><span class="lineno">  723</span> </div>
<div class="line"><span class="lineno">  724</span>            <span class="comment">/* Calculate expected size of entropy hex string */</span></div>
<div class="line"><span class="lineno">  725</span>            <span class="keywordtype">size_t</span> expected_entropy_size = strtol(entropy_size, NULL, 10) / 8 * <a class="code hl_define" href="bip39_8h.html#a92e3d70651e9e8631bb168dce87d6558">HEX_CHARS_PER_BYTE</a>;</div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>            <span class="comment">/* Verify size of the string equals the entropy_size specified */</span></div>
<div class="line"><span class="lineno">  728</span>            <span class="keywordflow">if</span> (strlen(entropy) != expected_entropy_size) {</div>
<div class="line"><span class="lineno">  729</span>                fprintf(stderr, <span class="stringliteral">&quot;ERROR: invalid entropy string, expected %ld bytes\n&quot;</span>, expected_entropy_size);</div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span>                <span class="comment">/* Free memory for custom words */</span></div>
<div class="line"><span class="lineno">  732</span>                <span class="keywordflow">if</span> (filepath != NULL) {</div>
<div class="line"><span class="lineno">  733</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="bip39_8h.html#a0939c53ce21cbf0184f17730ddf7295c">LANG_WORD_CNT</a>; i++) {</div>
<div class="line"><span class="lineno">  734</span>                        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(wordlist[i]);</div>
<div class="line"><span class="lineno">  735</span>                    }</div>
<div class="line"><span class="lineno">  736</span>                }</div>
<div class="line"><span class="lineno">  737</span>                <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  738</span>            }</div>
<div class="line"><span class="lineno">  739</span>        }</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>        <span class="comment">/* convert string value for entropy size to base 10 and get mnemonic */</span></div>
<div class="line"><span class="lineno">  742</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="bip39_8c.html#a4a04654a0c21ca8f944129b45bc431e2">get_mnemonic</a>(strtol(entropy_size, NULL, 10), entropy, (<span class="keyword">const</span> <span class="keywordtype">char</span> **) wordlist, space, entropy_out, words, size) == -1) {</div>
<div class="line"><span class="lineno">  743</span>            fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to get mnemonic\n&quot;</span>);</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>            <span class="comment">/* Free memory for custom words */</span></div>
<div class="line"><span class="lineno">  746</span>            <span class="keywordflow">if</span> (filepath != NULL) {</div>
<div class="line"><span class="lineno">  747</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="bip39_8h.html#a0939c53ce21cbf0184f17730ddf7295c">LANG_WORD_CNT</a>; i++) {</div>
<div class="line"><span class="lineno">  748</span>                    <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(wordlist[i]);</div>
<div class="line"><span class="lineno">  749</span>                }</div>
<div class="line"><span class="lineno">  750</span>            }</div>
<div class="line"><span class="lineno">  751</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  752</span>        }</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>        <span class="comment">/* Free memory for custom words */</span></div>
<div class="line"><span class="lineno">  755</span>        <span class="keywordflow">if</span> (filepath != NULL) {</div>
<div class="line"><span class="lineno">  756</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="bip39_8h.html#a0939c53ce21cbf0184f17730ddf7295c">LANG_WORD_CNT</a>; i++) {</div>
<div class="line"><span class="lineno">  757</span>                <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(wordlist[i]);</div>
<div class="line"><span class="lineno">  758</span>            }</div>
<div class="line"><span class="lineno">  759</span>        }</div>
<div class="line"><span class="lineno">  760</span>    }</div>
<div class="line"><span class="lineno">  761</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  762</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to get entropy size\n&quot;</span>);</div>
<div class="line"><span class="lineno">  763</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  764</span>    }</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  767</span>}</div>
<div class="ttc" id="abip39_8c_html_a4a04654a0c21ca8f944129b45bc431e2"><div class="ttname"><a href="bip39_8c.html#a4a04654a0c21ca8f944129b45bc431e2">get_mnemonic</a></div><div class="ttdeci">int get_mnemonic(const int entropysize, const char *entropy, const char *wordlist[], const char *space, char *entropy_out, char *mnemonic, size_t *mnemonic_size)</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8c_source.html#l00068">bip39.c:68</a></div></div>
<div class="ttc" id="abip39_8c_html_a5b8ebac5b6dd903e28d22fe1e8cdba6b"><div class="ttname"><a href="bip39_8c.html#a5b8ebac5b6dd903e28d22fe1e8cdba6b">get_custom_words</a></div><div class="ttdeci">int get_custom_words(const char *filepath, char *wordlist[])</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8c_source.html#l00442">bip39.c:442</a></div></div>
<div class="ttc" id="abip39_8c_html_a7f89936585417beb5a425e5a66d32573"><div class="ttname"><a href="bip39_8c.html#a7f89936585417beb5a425e5a66d32573">get_words</a></div><div class="ttdeci">int get_words(const char *lang, char *wordlist[])</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8c_source.html#l00488">bip39.c:488</a></div></div>
<div class="ttc" id="abip39_8h_html_a0939c53ce21cbf0184f17730ddf7295c"><div class="ttname"><a href="bip39_8h.html#a0939c53ce21cbf0184f17730ddf7295c">LANG_WORD_CNT</a></div><div class="ttdeci">#define LANG_WORD_CNT</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8h_source.html#l00025">bip39.h:25</a></div></div>
<div class="ttc" id="abip39_8h_html_a92e3d70651e9e8631bb168dce87d6558"><div class="ttname"><a href="bip39_8h.html#a92e3d70651e9e8631bb168dce87d6558">HEX_CHARS_PER_BYTE</a></div><div class="ttdeci">#define HEX_CHARS_PER_BYTE</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8h_source.html#l00031">bip39.h:31</a></div></div>
<div class="ttc" id="amem_8c_html_ad02c72991a2ff7d7a89d69c0234c4315"><div class="ttname"><a href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a></div><div class="ttdeci">void dogecoin_free(void *ptr)</div><div class="ttdoc">This function calls dogecoin_free_internal() using the current memory mapper.</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00121">mem.c:121</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mem_8c_source.html#l00121">dogecoin_free()</a>, <a class="el" href="bip39_8c_source.html#l00442">get_custom_words()</a>, <a class="el" href="bip39_8c_source.html#l00068">get_mnemonic()</a>, <a class="el" href="bip39_8c_source.html#l00488">get_words()</a>, <a class="el" href="bip39_8h_source.html#l00031">HEX_CHARS_PER_BYTE</a>, and <a class="el" href="bip39_8h_source.html#l00025">LANG_WORD_CNT</a>.</p>

<p class="reference">Referenced by <a class="el" href="bip39_8c_source.html#l00823">generateEnglishMnemonic()</a>.</p>

</div>
</div>
<a id="a89d04a12f306dad39828669665792f58" name="a89d04a12f306dad39828669665792f58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89d04a12f306dad39828669665792f58">&#9670;&nbsp;</a></span>dogecoin_seed_from_mnemonic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dogecoin_seed_from_mnemonic </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>mnemonic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>passphrase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libdogecoin_8h.html#aabc51db9648102bf9bc5009d5514921e">SEED</a>&#160;</td>
          <td class="paramname"><em>seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function derives the seed from the mnemonic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mnemonic</td><td>The mnemonic code words. </td></tr>
    <tr><td class="paramname">passphrase</td><td>The passphrase (optional). </td></tr>
    <tr><td class="paramname">seed</td><td>The 512-bit seed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 (success), -1 (fail) </dd></dl>

<p class="definition">Definition at line <a class="el" href="bip39_8c_source.html#l00778">778</a> of file <a class="el" href="bip39_8c_source.html">bip39.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  779</span>{</div>
<div class="line"><span class="lineno">  780</span>    <span class="comment">/* Check if the input arguments are valid */</span></div>
<div class="line"><span class="lineno">  781</span>    <span class="keywordflow">if</span> (!mnemonic || !seed) {</div>
<div class="line"><span class="lineno">  782</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: invalid input arguments\n&quot;</span>);</div>
<div class="line"><span class="lineno">  783</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  784</span>    }</div>
<div class="line"><span class="lineno">  785</span> </div>
<div class="line"><span class="lineno">  786</span>    <span class="comment">/* set passphrase to empty string if null */</span></div>
<div class="line"><span class="lineno">  787</span>    <span class="keywordflow">if</span> (passphrase == NULL) {</div>
<div class="line"><span class="lineno">  788</span>        passphrase = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  789</span>    }</div>
<div class="line"><span class="lineno">  790</span> </div>
<div class="line"><span class="lineno">  791</span>    <span class="comment">/* get random binary seed */</span></div>
<div class="line"><span class="lineno">  792</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="bip39_8c.html#a36b5d8096db0b0af682e5ad2a057a799">get_root_seed</a>(mnemonic, passphrase, seed) == -1) {</div>
<div class="line"><span class="lineno">  793</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to get root seed\n&quot;</span>);</div>
<div class="line"><span class="lineno">  794</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  795</span>    }</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  798</span>}</div>
<div class="ttc" id="abip39_8c_html_a36b5d8096db0b0af682e5ad2a057a799"><div class="ttname"><a href="bip39_8c.html#a36b5d8096db0b0af682e5ad2a057a799">get_root_seed</a></div><div class="ttdeci">int get_root_seed(const char *pass, const char *passphrase, uint8_t seed[64])</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8c_source.html#l00194">bip39.c:194</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="bip39_8c_source.html#l00194">get_root_seed()</a>.</p>

<p class="reference">Referenced by <a class="el" href="address_8c_source.html#l00458">generateHDMasterPubKeypairFromMnemonic()</a>, <a class="el" href="address_8c_source.html#l00406">getDerivedHDAddressFromMnemonic()</a>, and <a class="el" href="address_8c_source.html#l00500">verifyHDMasterPubKeypairFromMnemonic()</a>.</p>

</div>
</div>
<a id="ab6e0b6695d8c505b86970aa0bd189319" name="ab6e0b6695d8c505b86970aa0bd189319"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6e0b6695d8c505b86970aa0bd189319">&#9670;&nbsp;</a></span>generateEnglishMnemonic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int generateEnglishMnemonic </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="libdogecoin_8h.html#a54c512bde686652b7e38e5e7f4287c5d">HEX_ENTROPY</a>&#160;</td>
          <td class="paramname"><em>entropy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="libdogecoin_8h.html#ac7bfd46fef5f139d2236baa3204c2ae2">ENTROPY_SIZE</a>&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libdogecoin_8h.html#aedbfa425a18f8fbd06416483601d2bc8">MNEMONIC</a>&#160;</td>
          <td class="paramname"><em>mnemonic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function gnerates an English mnemonic phrase of given size or from hex entropy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">entropy</td><td>The hex string of entropy. </td></tr>
    <tr><td class="paramname">size</td><td>The size of entropy in bits. </td></tr>
    <tr><td class="paramname">mnemonic</td><td>The mnemonic code words.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 (success), -1 (fail) </dd></dl>

<p class="definition">Definition at line <a class="el" href="bip39_8c_source.html#l00823">823</a> of file <a class="el" href="bip39_8c_source.html">bip39.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  823</span>                                                                                                    {</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>    <span class="comment">/* Initialize variables */</span></div>
<div class="line"><span class="lineno">  826</span>    <span class="keyword">const</span> <span class="keywordtype">char</span>* lang = <span class="stringliteral">&quot;eng&quot;</span>;     <span class="comment">/* default english (eng) */</span></div>
<div class="line"><span class="lineno">  827</span>    <span class="keyword">const</span> <span class="keywordtype">char</span>* space = <span class="stringliteral">&quot; &quot;</span>;      <span class="comment">/* default utf8 ( ) */</span></div>
<div class="line"><span class="lineno">  828</span>    <span class="keyword">const</span> <span class="keywordtype">char</span>* words = 0;        <span class="comment">/* default no custom words (NULL) */</span></div>
<div class="line"><span class="lineno">  829</span>    <span class="keywordtype">char</span>* entropy_out = 0;</div>
<div class="line"><span class="lineno">  830</span>    <span class="keywordtype">size_t</span> mnemonic_size = 0;</div>
<div class="line"><span class="lineno">  831</span> </div>
<div class="line"><span class="lineno">  832</span>    <span class="comment">/* allocate space for entropy if valid */</span></div>
<div class="line"><span class="lineno">  833</span>    <span class="keywordflow">if</span> (entropy) {</div>
<div class="line"><span class="lineno">  834</span>        entropy_out = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * <a class="code hl_define" href="bip39_8h.html#abebe63a3b00480fe58619f9cc95ddad4">MAX_ENTROPY_STRING_SIZE</a>);</div>
<div class="line"><span class="lineno">  835</span>        <span class="keywordflow">if</span> (entropy_out == NULL) {</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>            fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to allocate memory for mnemonic\n&quot;</span>);</div>
<div class="line"><span class="lineno">  838</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  839</span>        }</div>
<div class="line"><span class="lineno">  840</span>        memset(entropy_out, <span class="charliteral">&#39;\0&#39;</span>, <a class="code hl_define" href="bip39_8h.html#abebe63a3b00480fe58619f9cc95ddad4">MAX_ENTROPY_STRING_SIZE</a>);</div>
<div class="line"><span class="lineno">  841</span>    }</div>
<div class="line"><span class="lineno">  842</span> </div>
<div class="line"><span class="lineno">  843</span>    <span class="comment">/* first determine size of mnemonic */</span></div>
<div class="line"><span class="lineno">  844</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="bip39_8c.html#a0d658d3d4d40ee947004e68cca2ca67a">dogecoin_generate_mnemonic</a> (size, lang, space, entropy, words, entropy_out, &amp;mnemonic_size, NULL) == -1) {</div>
<div class="line"><span class="lineno">  845</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a> (entropy_out);</div>
<div class="line"><span class="lineno">  846</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  847</span>    }</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>    <span class="comment">/* generate mnemonic with entropy out */</span></div>
<div class="line"><span class="lineno">  850</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="bip39_8c.html#a0d658d3d4d40ee947004e68cca2ca67a">dogecoin_generate_mnemonic</a> (size, lang, space, entropy_out, words, NULL, &amp;mnemonic_size, mnemonic) == -1) {</div>
<div class="line"><span class="lineno">  851</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a> (entropy_out);</div>
<div class="line"><span class="lineno">  852</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  853</span>    }</div>
<div class="line"><span class="lineno">  854</span> </div>
<div class="line"><span class="lineno">  855</span>    <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a> (entropy_out);</div>
<div class="line"><span class="lineno">  856</span> </div>
<div class="line"><span class="lineno">  857</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  858</span>}</div>
<div class="ttc" id="abip39_8c_html_a0d658d3d4d40ee947004e68cca2ca67a"><div class="ttname"><a href="bip39_8c.html#a0d658d3d4d40ee947004e68cca2ca67a">dogecoin_generate_mnemonic</a></div><div class="ttdeci">int dogecoin_generate_mnemonic(const ENTROPY_SIZE entropy_size, const char *language, const char *space, const char *entropy, const char *filepath, char *entropy_out, size_t *size, char *words)</div><div class="ttdoc">This function generates a mnemonic for a given entropy size and language.</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8c_source.html#l00691">bip39.c:691</a></div></div>
<div class="ttc" id="abip39_8h_html_abebe63a3b00480fe58619f9cc95ddad4"><div class="ttname"><a href="bip39_8h.html#abebe63a3b00480fe58619f9cc95ddad4">MAX_ENTROPY_STRING_SIZE</a></div><div class="ttdeci">#define MAX_ENTROPY_STRING_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8h_source.html#l00034">bip39.h:34</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mem_8c_source.html#l00121">dogecoin_free()</a>, <a class="el" href="bip39_8c_source.html#l00691">dogecoin_generate_mnemonic()</a>, and <a class="el" href="bip39_8h_source.html#l00034">MAX_ENTROPY_STRING_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="bip39_8c_source.html#l00808">generateRandomEnglishMnemonic()</a>, and <a class="el" href="such_8c_source.html#l00668">main()</a>.</p>

</div>
</div>
<a id="a1d5c2d48bdf3dfb93ee813d51b643e92" name="a1d5c2d48bdf3dfb93ee813d51b643e92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d5c2d48bdf3dfb93ee813d51b643e92">&#9670;&nbsp;</a></span>generateRandomEnglishMnemonic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int generateRandomEnglishMnemonic </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="libdogecoin_8h.html#ac7bfd46fef5f139d2236baa3204c2ae2">ENTROPY_SIZE</a>&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libdogecoin_8h.html#aedbfa425a18f8fbd06416483601d2bc8">MNEMONIC</a>&#160;</td>
          <td class="paramname"><em>mnemonic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function generates a random English mnemonic phrase. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>The size of entropy in bits. </td></tr>
    <tr><td class="paramname">mnemonic</td><td>The mnemonic code words.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 (success), -1 (fail) </dd></dl>

<p class="definition">Definition at line <a class="el" href="bip39_8c_source.html#l00808">808</a> of file <a class="el" href="bip39_8c_source.html">bip39.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  808</span>                                                                               {</div>
<div class="line"><span class="lineno">  809</span> </div>
<div class="line"><span class="lineno">  810</span>    <span class="comment">/* generate an English mnemonic without random entropy */</span></div>
<div class="line"><span class="lineno">  811</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="bip39_8c.html#ab6e0b6695d8c505b86970aa0bd189319">generateEnglishMnemonic</a> (NULL, size, mnemonic);</div>
<div class="line"><span class="lineno">  812</span>}</div>
<div class="ttc" id="abip39_8c_html_ab6e0b6695d8c505b86970aa0bd189319"><div class="ttname"><a href="bip39_8c.html#ab6e0b6695d8c505b86970aa0bd189319">generateEnglishMnemonic</a></div><div class="ttdeci">int generateEnglishMnemonic(const HEX_ENTROPY entropy, const ENTROPY_SIZE size, MNEMONIC mnemonic)</div><div class="ttdoc">This function gnerates an English mnemonic phrase of given size or from hex entropy.</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8c_source.html#l00823">bip39.c:823</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="bip39_8c_source.html#l00823">generateEnglishMnemonic()</a>.</p>

</div>
</div>
<a id="a5b8ebac5b6dd903e28d22fe1e8cdba6b" name="a5b8ebac5b6dd903e28d22fe1e8cdba6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b8ebac5b6dd903e28d22fe1e8cdba6b">&#9670;&nbsp;</a></span>get_custom_words()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_custom_words </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filepath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>wordlist</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bip39_8c_source.html#l00442">442</a> of file <a class="el" href="bip39_8c_source.html">bip39.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  442</span>                                                             {</div>
<div class="line"><span class="lineno">  443</span>    <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><span class="lineno">  444</span>    FILE * fp;</div>
<div class="line"><span class="lineno">  445</span>    <span class="keywordtype">char</span> word[1024];</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>    <span class="comment">/* Check that file path is valid */</span></div>
<div class="line"><span class="lineno">  448</span>    <span class="keywordflow">if</span> (filepath == NULL) {</div>
<div class="line"><span class="lineno">  449</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: file path error\n&quot;</span>);</div>
<div class="line"><span class="lineno">  450</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  451</span>    }</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>    fp = fopen(filepath, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno">  454</span>    <span class="keywordflow">if</span> (fp == NULL) {</div>
<div class="line"><span class="lineno">  455</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: file read error\n&quot;</span>);</div>
<div class="line"><span class="lineno">  456</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  457</span>    }</div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span>    <span class="keywordflow">while</span> (fscanf(fp, <span class="stringliteral">&quot;%s&quot;</span>, word) == 1) {</div>
<div class="line"><span class="lineno">  460</span>        <span class="keywordflow">if</span> (i &gt;= <a class="code hl_define" href="bip39_8h.html#a0939c53ce21cbf0184f17730ddf7295c">LANG_WORD_CNT</a>) {</div>
<div class="line"><span class="lineno">  461</span>            fprintf(stderr, <span class="stringliteral">&quot;ERROR: too many words in file\n&quot;</span>);</div>
<div class="line"><span class="lineno">  462</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  463</span>        }</div>
<div class="line"><span class="lineno">  464</span>        wordlist[i] = malloc(strlen(word) + 1);</div>
<div class="line"><span class="lineno">  465</span>        <span class="keywordflow">if</span> (wordlist[i] == NULL) {</div>
<div class="line"><span class="lineno">  466</span>            fprintf(stderr, <span class="stringliteral">&quot;ERROR: cannot allocate memory\n&quot;</span>);</div>
<div class="line"><span class="lineno">  467</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  468</span>        }</div>
<div class="line"><span class="lineno">  469</span>        strcpy(wordlist[i], word);</div>
<div class="line"><span class="lineno">  470</span>        i++;</div>
<div class="line"><span class="lineno">  471</span>    }</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>    fclose(fp);</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordflow">if</span> (i != <a class="code hl_define" href="bip39_8h.html#a0939c53ce21cbf0184f17730ddf7295c">LANG_WORD_CNT</a>) {</div>
<div class="line"><span class="lineno">  476</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: not 2048 words\n&quot;</span>);</div>
<div class="line"><span class="lineno">  477</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  478</span>    }</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  481</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="bip39_8h_source.html#l00025">LANG_WORD_CNT</a>.</p>

<p class="reference">Referenced by <a class="el" href="bip39_8c_source.html#l00691">dogecoin_generate_mnemonic()</a>.</p>

</div>
</div>
<a id="a4a04654a0c21ca8f944129b45bc431e2" name="a4a04654a0c21ca8f944129b45bc431e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a04654a0c21ca8f944129b45bc431e2">&#9670;&nbsp;</a></span>get_mnemonic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_mnemonic </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>entropysize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>entropy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>wordlist</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>space</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>entropy_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>mnemonic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>mnemonic_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Copyright (c) 2013-2014 Tomas Dzetkulic Copyright (c) 2013-2014 Pavol Rusnak Copyright (c) 2022 edtubbs Copyright (c) 2022 bluezr Copyright (c) 2022 michilumin Copyright (c) 2023 The Dogecoin Foundation</p>
<p >Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p >The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p >THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. </p>

<p class="definition">Definition at line <a class="el" href="bip39_8c_source.html#l00068">68</a> of file <a class="el" href="bip39_8c_source.html">bip39.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   68</span>                                                                                                                                                                  {</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>    <span class="comment">/* Check entropy size per BIP-39 */</span></div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordflow">if</span> (!(entropysize &gt;= 128 &amp;&amp; entropysize &lt;= 256 &amp;&amp; entropysize % 32 == 0)) {</div>
<div class="line"><span class="lineno">   72</span>        fprintf(stderr,</div>
<div class="line"><span class="lineno">   73</span>                <span class="stringliteral">&quot;ERROR: Only the following values for entropy bit sizes may be used: 128, 160, 192, 224, and 256\n&quot;</span>);</div>
<div class="line"><span class="lineno">   74</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">   75</span>    }</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>    <span class="keywordtype">int</span> entBytes = entropysize / 8; <span class="comment">// bytes instead of bits</span></div>
<div class="line"><span class="lineno">   79</span>    <span class="keywordtype">int</span> csAdd = entropysize / 32; <span class="comment">// portion in bits of a single byte</span></div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">   82</span><span class="comment">     * ENT (Entropy)</span></div>
<div class="line"><span class="lineno">   83</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordtype">char</span>* entropyBits = <a class="code hl_function" href="mem_8c.html#ada424f6ce66841962ef344f21c8d783f">dogecoin_char_vla</a>(entropysize + 1);</div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">if</span> (entropyBits == NULL) {</div>
<div class="line"><span class="lineno">   86</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to allocate memory for entropyBits\n&quot;</span>);</div>
<div class="line"><span class="lineno">   87</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">   88</span>    }</div>
<div class="line"><span class="lineno">   89</span>    entropyBits[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">   90</span>    <a class="code hl_function" href="mem_8c.html#afa74e6ef7b27aef8c742cd073ad849b9">dogecoin_mem_zero</a>(entropyBits, entropysize + 1);  <span class="comment">// Initialize entropyBits to all zeros</span></div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordtype">char</span> binaryByte[9] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>    <span class="comment">/* Allocate memory for local entropy */</span></div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* local_entropy = <a class="code hl_function" href="mem_8c.html#af03697d0d13640f65f51b79119346abc">dogecoin_uchar_vla</a>(entBytes);</div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordflow">if</span> (local_entropy == NULL) {</div>
<div class="line"><span class="lineno">   98</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to allocate memory for local entropy\n&quot;</span>);</div>
<div class="line"><span class="lineno">   99</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(entropyBits);</div>
<div class="line"><span class="lineno">  100</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  101</span>    }</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>    <span class="comment">/* Gather entropy bytes locally unless optionally provided */</span></div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordflow">if</span> (entropy == NULL) {</div>
<div class="line"><span class="lineno">  105</span>        <span class="keywordtype">int</span> rc = (int) <a class="code hl_function" href="random_8c.html#a40bb9e50e6aaf4f4adc85472bf9d2553">dogecoin_random_bytes</a>(local_entropy, entBytes, 0);</div>
<div class="line"><span class="lineno">  106</span>        <span class="keywordflow">if</span> (rc != 1) {</div>
<div class="line"><span class="lineno">  107</span>            fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to generate random entropy\n&quot;</span>);</div>
<div class="line"><span class="lineno">  108</span>            <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(entropyBits);</div>
<div class="line"><span class="lineno">  109</span>            <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(local_entropy);</div>
<div class="line"><span class="lineno">  110</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  111</span>        }</div>
<div class="line"><span class="lineno">  112</span>    }</div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  114</span>        <span class="comment">/* Convert optional entropy string to bytes */</span></div>
<div class="line"><span class="lineno">  115</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* entropy_bytes = <a class="code hl_function" href="utils_8c.html#aec1a2d99d5cfbcb4ccfc73b86ad410be">utils_hex_to_uint8</a>(entropy);</div>
<div class="line"><span class="lineno">  116</span>        <span class="keywordflow">if</span> (entropy_bytes == NULL) {</div>
<div class="line"><span class="lineno">  117</span>            fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to convert entropy string to bytes\n&quot;</span>);</div>
<div class="line"><span class="lineno">  118</span>            <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(entropyBits);</div>
<div class="line"><span class="lineno">  119</span>            <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(local_entropy);</div>
<div class="line"><span class="lineno">  120</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  121</span>        }</div>
<div class="line"><span class="lineno">  122</span>        <a class="code hl_function" href="mem_8c.html#ab5b323a3ddeb02bdcb2b5a8a46e2a4b7">memcpy_safe</a>(local_entropy, entropy_bytes, entBytes);</div>
<div class="line"><span class="lineno">  123</span>    }</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>    <span class="comment">/* Convert local entropy and copy to entropy parameter if allocated */</span></div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordflow">if</span> (entropy_out != NULL) {</div>
<div class="line"><span class="lineno">  127</span>        strcpy(entropy_out, <a class="code hl_function" href="utils_8c.html#aa5f628447b9a129900c20fbe36a0975a">utils_uint8_to_hex</a>(local_entropy, entBytes));</div>
<div class="line"><span class="lineno">  128</span>    }</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>    <span class="comment">/* Concatenate string of bits from entropy bytes */</span></div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; entBytes; i++) {</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>        <span class="comment">/* Convert valid byte to string of bits */</span></div>
<div class="line"><span class="lineno">  134</span>        sprintf(binaryByte, <a class="code hl_define" href="bip39_8h.html#ae8b243fdac3715a3da7c98b9a380eaa5">BYTE_TO_BINARY_PATTERN</a>, <a class="code hl_define" href="bip39_8h.html#aa28480bfa03957b4f284c13e800ca8b0">BYTE_TO_BINARY</a>(local_entropy[i]));</div>
<div class="line"><span class="lineno">  135</span>        binaryByte[8] = <span class="charliteral">&#39;\0&#39;</span>;  <span class="comment">// null-terminate the binary byte</span></div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>        <span class="comment">/* Concatentate the bits */</span></div>
<div class="line"><span class="lineno">  138</span>        <span class="keywordflow">if</span> (strcat(entropyBits, binaryByte) == NULL) {</div>
<div class="line"><span class="lineno">  139</span>            fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to concatenate entropy\n&quot;</span>);</div>
<div class="line"><span class="lineno">  140</span>            <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(entropyBits);</div>
<div class="line"><span class="lineno">  141</span>            <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(local_entropy);</div>
<div class="line"><span class="lineno">  142</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  143</span>        }</div>
<div class="line"><span class="lineno">  144</span>    }</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  147</span><span class="comment">     * ENT SHA256 checksum</span></div>
<div class="line"><span class="lineno">  148</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  149</span>    <span class="keyword">static</span> <span class="keywordtype">char</span> checksum[<a class="code hl_define" href="sha2_8h.html#a0c71de183b257bb9ef09a865ad1ddc29">SHA256_DIGEST_STRING_LENGTH</a>];</div>
<div class="line"><span class="lineno">  150</span>    <a class="code hl_function" href="mem_8c.html#afa74e6ef7b27aef8c742cd073ad849b9">dogecoin_mem_zero</a>(checksum, <span class="keyword">sizeof</span>(checksum));</div>
<div class="line"><span class="lineno">  151</span>    checksum[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>    <span class="comment">/* SHA256 of entropy bytes */</span></div>
<div class="line"><span class="lineno">  154</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> hash[<a class="code hl_define" href="sha2_8h.html#aa9cf0abf87b30c4c63e9c7e89c590579">SHA256_DIGEST_LENGTH</a>];</div>
<div class="line"><span class="lineno">  155</span>    <a class="code hl_function" href="sha2_8c.html#ab42d6510b992f106b2de5136f11d5f45">sha256_raw</a>(local_entropy, entBytes, hash);</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    <span class="comment">/* done with local_entropy */</span></div>
<div class="line"><span class="lineno">  158</span>    <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(local_entropy);</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    <span class="comment">/* Checksum from SHA256 */</span></div>
<div class="line"><span class="lineno">  161</span>    <a class="code hl_function" href="mem_8c.html#afa74e6ef7b27aef8c742cd073ad849b9">dogecoin_mem_zero</a>(checksum, <span class="keyword">sizeof</span>(checksum));  <span class="comment">// Initialize checksum to all zeros</span></div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="sha2_8h.html#aa9cf0abf87b30c4c63e9c7e89c590579">SHA256_DIGEST_LENGTH</a>; i++) {</div>
<div class="line"><span class="lineno">  163</span>        sprintf(&amp;checksum[i * 2], <span class="stringliteral">&quot;%02x&quot;</span>, hash[i]);</div>
<div class="line"><span class="lineno">  164</span>    }</div>
<div class="line"><span class="lineno">  165</span>    checksum[<a class="code hl_define" href="sha2_8h.html#a0c71de183b257bb9ef09a865ad1ddc29">SHA256_DIGEST_STRING_LENGTH</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;  <span class="comment">// null-terminate the checksum string</span></div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <span class="comment">/* Copy the checksum */</span></div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordtype">char</span> hexStr[3];</div>
<div class="line"><span class="lineno">  169</span>    memset(hexStr, 0, <span class="keyword">sizeof</span>(hexStr));</div>
<div class="line"><span class="lineno">  170</span>    <a class="code hl_function" href="mem_8c.html#ab5b323a3ddeb02bdcb2b5a8a46e2a4b7">memcpy_safe</a>(hexStr, &amp;checksum[0], 2);</div>
<div class="line"><span class="lineno">  171</span>    hexStr[2] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  174</span><span class="comment">     * CS (Checksum portion) to add to entropy</span></div>
<div class="line"><span class="lineno">  175</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordtype">int</span> ret = <a class="code hl_function" href="bip39_8c.html#a16e1f39933538c74bc28b88ed8ae457d">produce_mnemonic_sentence</a>(csAdd * 33 + 1, csAdd + 1, hexStr, entropyBits, wordlist, space, mnemonic, mnemonic_size);</div>
<div class="line"><span class="lineno">  178</span>    <span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line"><span class="lineno">  179</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to generate mnemonic sentence\n&quot;</span>);</div>
<div class="line"><span class="lineno">  180</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(entropyBits);</div>
<div class="line"><span class="lineno">  181</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  182</span>    }</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>    <span class="comment">/* done with entropyBits */</span></div>
<div class="line"><span class="lineno">  185</span>    <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(entropyBits);</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  188</span>}</div>
<div class="ttc" id="abip39_8c_html_a16e1f39933538c74bc28b88ed8ae457d"><div class="ttname"><a href="bip39_8c.html#a16e1f39933538c74bc28b88ed8ae457d">produce_mnemonic_sentence</a></div><div class="ttdeci">int produce_mnemonic_sentence(const int segSize, const int checksumBits, const char *firstByte, const char *entropy, const char *wordlist[], const char *space, char *mnemonic, size_t *mnemonic_size)</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8c_source.html#l00537">bip39.c:537</a></div></div>
<div class="ttc" id="abip39_8h_html_aa28480bfa03957b4f284c13e800ca8b0"><div class="ttname"><a href="bip39_8h.html#aa28480bfa03957b4f284c13e800ca8b0">BYTE_TO_BINARY</a></div><div class="ttdeci">#define BYTE_TO_BINARY(byte)</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8h_source.html#l00064">bip39.h:64</a></div></div>
<div class="ttc" id="abip39_8h_html_ae8b243fdac3715a3da7c98b9a380eaa5"><div class="ttname"><a href="bip39_8h.html#ae8b243fdac3715a3da7c98b9a380eaa5">BYTE_TO_BINARY_PATTERN</a></div><div class="ttdeci">#define BYTE_TO_BINARY_PATTERN</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8h_source.html#l00061">bip39.h:61</a></div></div>
<div class="ttc" id="amem_8c_html_ab5b323a3ddeb02bdcb2b5a8a46e2a4b7"><div class="ttname"><a href="mem_8c.html#ab5b323a3ddeb02bdcb2b5a8a46e2a4b7">memcpy_safe</a></div><div class="ttdeci">void * memcpy_safe(void *destination, const void *source, size_t count)</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00209">mem.c:209</a></div></div>
<div class="ttc" id="amem_8c_html_ada424f6ce66841962ef344f21c8d783f"><div class="ttname"><a href="mem_8c.html#ada424f6ce66841962ef344f21c8d783f">dogecoin_char_vla</a></div><div class="ttdeci">char * dogecoin_char_vla(size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00263">mem.c:263</a></div></div>
<div class="ttc" id="amem_8c_html_af03697d0d13640f65f51b79119346abc"><div class="ttname"><a href="mem_8c.html#af03697d0d13640f65f51b79119346abc">dogecoin_uchar_vla</a></div><div class="ttdeci">unsigned char * dogecoin_uchar_vla(size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00278">mem.c:278</a></div></div>
<div class="ttc" id="amem_8c_html_afa74e6ef7b27aef8c742cd073ad849b9"><div class="ttname"><a href="mem_8c.html#afa74e6ef7b27aef8c742cd073ad849b9">dogecoin_mem_zero</a></div><div class="ttdeci">volatile void * dogecoin_mem_zero(volatile void *dst, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00243">mem.c:243</a></div></div>
<div class="ttc" id="arandom_8c_html_a40bb9e50e6aaf4f4adc85472bf9d2553"><div class="ttname"><a href="random_8c.html#a40bb9e50e6aaf4f4adc85472bf9d2553">dogecoin_random_bytes</a></div><div class="ttdeci">dogecoin_bool dogecoin_random_bytes(uint8_t *buf, uint32_t len, const uint8_t update_seed)</div><div class="ttdef"><b>Definition:</b> <a href="random_8c_source.html#l00131">random.c:131</a></div></div>
<div class="ttc" id="asha2_8c_html_ab42d6510b992f106b2de5136f11d5f45"><div class="ttname"><a href="sha2_8c.html#ab42d6510b992f106b2de5136f11d5f45">sha256_raw</a></div><div class="ttdeci">void sha256_raw(const sha2_byte *data, size_t len, uint8_t digest[SHA256_DIGEST_LENGTH])</div><div class="ttdef"><b>Definition:</b> <a href="sha2_8c_source.html#l00635">sha2.c:635</a></div></div>
<div class="ttc" id="asha2_8h_html_a0c71de183b257bb9ef09a865ad1ddc29"><div class="ttname"><a href="sha2_8h.html#a0c71de183b257bb9ef09a865ad1ddc29">SHA256_DIGEST_STRING_LENGTH</a></div><div class="ttdeci">#define SHA256_DIGEST_STRING_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="sha2_8h_source.html#l00046">sha2.h:46</a></div></div>
<div class="ttc" id="asha2_8h_html_aa9cf0abf87b30c4c63e9c7e89c590579"><div class="ttname"><a href="sha2_8h.html#aa9cf0abf87b30c4c63e9c7e89c590579">SHA256_DIGEST_LENGTH</a></div><div class="ttdeci">#define SHA256_DIGEST_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="sha2_8h_source.html#l00045">sha2.h:45</a></div></div>
<div class="ttc" id="autils_8c_html_aa5f628447b9a129900c20fbe36a0975a"><div class="ttname"><a href="utils_8c.html#aa5f628447b9a129900c20fbe36a0975a">utils_uint8_to_hex</a></div><div class="ttdeci">char * utils_uint8_to_hex(const uint8_t *bin, size_t l)</div><div class="ttdoc">This function takes an array of raw bytes and converts them to a hex-encoded string.</div><div class="ttdef"><b>Definition:</b> <a href="utils_8c_source.html#l00212">utils.c:212</a></div></div>
<div class="ttc" id="autils_8c_html_aec1a2d99d5cfbcb4ccfc73b86ad410be"><div class="ttname"><a href="utils_8c.html#aec1a2d99d5cfbcb4ccfc73b86ad410be">utils_hex_to_uint8</a></div><div class="ttdeci">uint8_t * utils_hex_to_uint8(const char *str)</div><div class="ttdoc">This function takes a hex-encoded string and returns the binary representation as a uint8_t array.</div><div class="ttdef"><b>Definition:</b> <a href="utils_8c_source.html#l00147">utils.c:147</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="bip39_8h_source.html#l00064">BYTE_TO_BINARY</a>, <a class="el" href="bip39_8h_source.html#l00061">BYTE_TO_BINARY_PATTERN</a>, <a class="el" href="mem_8c_source.html#l00263">dogecoin_char_vla()</a>, <a class="el" href="mem_8c_source.html#l00121">dogecoin_free()</a>, <a class="el" href="mem_8c_source.html#l00243">dogecoin_mem_zero()</a>, <a class="el" href="random_8c_source.html#l00131">dogecoin_random_bytes()</a>, <a class="el" href="mem_8c_source.html#l00278">dogecoin_uchar_vla()</a>, <a class="el" href="mem_8c_source.html#l00209">memcpy_safe()</a>, <a class="el" href="bip39_8c_source.html#l00537">produce_mnemonic_sentence()</a>, <a class="el" href="sha2_8h_source.html#l00045">SHA256_DIGEST_LENGTH</a>, <a class="el" href="sha2_8h_source.html#l00046">SHA256_DIGEST_STRING_LENGTH</a>, <a class="el" href="sha2_8c_source.html#l00635">sha256_raw()</a>, <a class="el" href="utils_8c_source.html#l00147">utils_hex_to_uint8()</a>, and <a class="el" href="utils_8c_source.html#l00212">utils_uint8_to_hex()</a>.</p>

<p class="reference">Referenced by <a class="el" href="bip39_8c_source.html#l00691">dogecoin_generate_mnemonic()</a>.</p>

</div>
</div>
<a id="a36b5d8096db0b0af682e5ad2a057a799" name="a36b5d8096db0b0af682e5ad2a057a799"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36b5d8096db0b0af682e5ad2a057a799">&#9670;&nbsp;</a></span>get_root_seed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_root_seed </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>passphrase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="winunistd_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a>&#160;</td>
          <td class="paramname"><em>seed</em>[64]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bip39_8c_source.html#l00194">194</a> of file <a class="el" href="bip39_8c_source.html">bip39.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  194</span>                                                                              {</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>    <span class="comment">/* initialize variables */</span></div>
<div class="line"><span class="lineno">  197</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> digest[64];</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>    <span class="comment">/* create salt, passphrase could be empty string */</span></div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordtype">char</span> *salt = malloc(strlen(passphrase) + 9);</div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">if</span> (salt == NULL) {</div>
<div class="line"><span class="lineno">  202</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to allocate memory for salt\n&quot;</span>);</div>
<div class="line"><span class="lineno">  203</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  204</span>    }</div>
<div class="line"><span class="lineno">  205</span>    *salt = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordflow">if</span> (strcat(salt, <span class="stringliteral">&quot;mnemonic&quot;</span>) == NULL || strcat(salt, passphrase) == NULL) {</div>
<div class="line"><span class="lineno">  208</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to concatenate salt\n&quot;</span>);</div>
<div class="line"><span class="lineno">  209</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  210</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  211</span>    }</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>    <span class="comment">/* normalize the passphrase and salt */</span></div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordtype">size_t</span> norm_pass_len, norm_salt_len;</div>
<div class="line"><span class="lineno">  215</span><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="lineno">  216</span>    <span class="keywordtype">int</span> pass_len = strlen(pass);</div>
<div class="line"><span class="lineno">  217</span>    <span class="keywordtype">int</span> salt_len = strlen(salt);</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>    <span class="comment">/* Convert passphrase and salt to wide characters */</span></div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordtype">int</span> pass_wlen = MultiByteToWideChar(CP_UTF8, 0, pass, pass_len, NULL, 0);</div>
<div class="line"><span class="lineno">  221</span>    <span class="keywordtype">int</span> salt_wlen = MultiByteToWideChar(CP_UTF8, 0, salt, salt_len, NULL, 0);</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>    <span class="keywordflow">if</span> (pass_wlen == 0) {</div>
<div class="line"><span class="lineno">  224</span>        fprintf(stderr, <span class="stringliteral">&quot;Error converting passphrase to wide characters\n&quot;</span>);</div>
<div class="line"><span class="lineno">  225</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  226</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  227</span>    }</div>
<div class="line"><span class="lineno">  228</span>    <span class="keywordflow">if</span> (salt_wlen == 0) {</div>
<div class="line"><span class="lineno">  229</span>        fprintf(stderr, <span class="stringliteral">&quot;Error converting salt to wide characters\n&quot;</span>);</div>
<div class="line"><span class="lineno">  230</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  231</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  232</span>    }</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>    LPWSTR pass_w = malloc((pass_wlen) * <span class="keyword">sizeof</span>(WCHAR));</div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordflow">if</span> (pass_w == NULL) {</div>
<div class="line"><span class="lineno">  236</span>        fprintf(stderr, <span class="stringliteral">&quot;Error allocating memory for passphrase wide characters\n&quot;</span>);</div>
<div class="line"><span class="lineno">  237</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  238</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  239</span>    }</div>
<div class="line"><span class="lineno">  240</span>    LPWSTR salt_w = malloc((salt_wlen) * <span class="keyword">sizeof</span>(WCHAR));</div>
<div class="line"><span class="lineno">  241</span>    <span class="keywordflow">if</span> (salt_w == NULL) {</div>
<div class="line"><span class="lineno">  242</span>        fprintf(stderr, <span class="stringliteral">&quot;Error allocating memory for salt wide characters\n&quot;</span>);</div>
<div class="line"><span class="lineno">  243</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  244</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  245</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  246</span>    }</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>    <span class="keywordflow">if</span> (MultiByteToWideChar(CP_UTF8, 0, pass, pass_len, pass_w, pass_wlen) == 0) {</div>
<div class="line"><span class="lineno">  249</span>        fprintf(stderr, <span class="stringliteral">&quot;Error converting passphrase to wide characters\n&quot;</span>);</div>
<div class="line"><span class="lineno">  250</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  251</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  252</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt_w);</div>
<div class="line"><span class="lineno">  253</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  254</span>    }</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordflow">if</span> (MultiByteToWideChar(CP_UTF8, 0, salt, salt_len, salt_w, salt_wlen) == 0) {</div>
<div class="line"><span class="lineno">  257</span>        fprintf(stderr, <span class="stringliteral">&quot;Error converting salt to wide characters\n&quot;</span>);</div>
<div class="line"><span class="lineno">  258</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  259</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  260</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt_w);</div>
<div class="line"><span class="lineno">  261</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  262</span>    }</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>    norm_pass_len = NormalizeString(NormalizationKD, pass_w, pass_wlen, NULL, 0);</div>
<div class="line"><span class="lineno">  265</span>    norm_salt_len = NormalizeString(NormalizationKD, salt_w, salt_wlen, NULL, 0);</div>
<div class="line"><span class="lineno">  266</span>    <span class="keywordflow">if</span> (norm_pass_len &lt;= 0) {</div>
<div class="line"><span class="lineno">  267</span>        LPVOID message;</div>
<div class="line"><span class="lineno">  268</span>        DWORD error = GetLastError();</div>
<div class="line"><span class="lineno">  269</span>        FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,</div>
<div class="line"><span class="lineno">  270</span>        NULL, error, MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), (LPTSTR)&amp;message, 0, NULL);</div>
<div class="line"><span class="lineno">  271</span>        fprintf(stderr, <span class="stringliteral">&quot;Error getting length of normalized passphrase: %s\n&quot;</span>, message);</div>
<div class="line"><span class="lineno">  272</span>        LocalFree(message);</div>
<div class="line"><span class="lineno">  273</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  274</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  275</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt_w);</div>
<div class="line"><span class="lineno">  276</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  277</span>    }</div>
<div class="line"><span class="lineno">  278</span>    <span class="keywordflow">if</span> (norm_salt_len &lt;= 0) {</div>
<div class="line"><span class="lineno">  279</span>        fprintf(stderr, <span class="stringliteral">&quot;Error getting length of normalized salt\n&quot;</span>);</div>
<div class="line"><span class="lineno">  280</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  281</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  282</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt_w);</div>
<div class="line"><span class="lineno">  283</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  284</span>    }</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>    LPWSTR norm_pass = malloc((norm_pass_len) * <span class="keyword">sizeof</span>(WCHAR));</div>
<div class="line"><span class="lineno">  287</span>    <span class="keywordflow">if</span> (norm_pass == NULL) {</div>
<div class="line"><span class="lineno">  288</span>        fprintf(stderr, <span class="stringliteral">&quot;Error allocating memory for normalized passphrase\n&quot;</span>);</div>
<div class="line"><span class="lineno">  289</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  290</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  291</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt_w);</div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  293</span>    }</div>
<div class="line"><span class="lineno">  294</span>    LPWSTR norm_salt = malloc((norm_salt_len) * <span class="keyword">sizeof</span>(WCHAR));</div>
<div class="line"><span class="lineno">  295</span>    <span class="keywordflow">if</span> (norm_salt == NULL) {</div>
<div class="line"><span class="lineno">  296</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  297</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  298</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt_w);</div>
<div class="line"><span class="lineno">  299</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_pass);</div>
<div class="line"><span class="lineno">  300</span>        fprintf(stderr, <span class="stringliteral">&quot;Error allocating memory for normalized salt\n&quot;</span>);</div>
<div class="line"><span class="lineno">  301</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  302</span>    }</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>    norm_pass_len = NormalizeString(NormalizationKD, pass_w, pass_wlen, norm_pass, norm_pass_len);</div>
<div class="line"><span class="lineno">  305</span>    norm_salt_len = NormalizeString(NormalizationKD, salt_w, salt_wlen, norm_salt, norm_salt_len);</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>    <span class="keywordflow">if</span> (norm_pass_len &lt;= 0) {</div>
<div class="line"><span class="lineno">  308</span>        fprintf(stderr, <span class="stringliteral">&quot;Error getting normalized passphrase\n&quot;</span>);</div>
<div class="line"><span class="lineno">  309</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  310</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  311</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt_w);</div>
<div class="line"><span class="lineno">  312</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_pass);</div>
<div class="line"><span class="lineno">  313</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_salt);</div>
<div class="line"><span class="lineno">  314</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  315</span>    }</div>
<div class="line"><span class="lineno">  316</span>    <span class="keywordflow">if</span> (norm_salt_len &lt;= 0) {</div>
<div class="line"><span class="lineno">  317</span>        fprintf(stderr, <span class="stringliteral">&quot;Error getting normalized salt\n&quot;</span>);</div>
<div class="line"><span class="lineno">  318</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  319</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  320</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt_w);</div>
<div class="line"><span class="lineno">  321</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_pass);</div>
<div class="line"><span class="lineno">  322</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_salt);</div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  324</span>    }</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>    <span class="comment">/* Convert normalized passphrase and salt to multi-byte characters */</span></div>
<div class="line"><span class="lineno">  327</span>    <span class="keywordtype">int</span> norm_pass_mb_len = WideCharToMultiByte(CP_UTF8, 0, norm_pass, norm_pass_len, NULL, 0, NULL, NULL);</div>
<div class="line"><span class="lineno">  328</span>    <span class="keywordtype">int</span> norm_salt_mb_len = WideCharToMultiByte(CP_UTF8, 0, norm_salt, norm_salt_len, NULL, 0, NULL, NULL);</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>    <span class="keywordflow">if</span> (norm_pass_len == 0) {</div>
<div class="line"><span class="lineno">  331</span>        fprintf(stderr, <span class="stringliteral">&quot;Error converting normalized passphrase to multi-byte characters\n&quot;</span>);</div>
<div class="line"><span class="lineno">  332</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  333</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  334</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt_w);</div>
<div class="line"><span class="lineno">  335</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_pass);</div>
<div class="line"><span class="lineno">  336</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_salt);</div>
<div class="line"><span class="lineno">  337</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  338</span>    }</div>
<div class="line"><span class="lineno">  339</span>    <span class="keywordflow">if</span> (norm_salt_len == 0) {</div>
<div class="line"><span class="lineno">  340</span>        fprintf(stderr, <span class="stringliteral">&quot;Error converting normalized seed to multi-byte characters\n&quot;</span>);</div>
<div class="line"><span class="lineno">  341</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  342</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  343</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt_w);</div>
<div class="line"><span class="lineno">  344</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_pass);</div>
<div class="line"><span class="lineno">  345</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_salt);</div>
<div class="line"><span class="lineno">  346</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  347</span>    }</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>    <span class="keywordtype">char</span>* norm_pass_mb = malloc(norm_pass_mb_len * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line"><span class="lineno">  350</span>    <span class="keywordflow">if</span> (norm_pass_mb == NULL) {</div>
<div class="line"><span class="lineno">  351</span>        fprintf(stderr, <span class="stringliteral">&quot;Error allocating memory for normalized passphrase multi-byte characters\n&quot;</span>);</div>
<div class="line"><span class="lineno">  352</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  353</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  354</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt_w);</div>
<div class="line"><span class="lineno">  355</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_pass);</div>
<div class="line"><span class="lineno">  356</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_salt);</div>
<div class="line"><span class="lineno">  357</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  358</span>    }</div>
<div class="line"><span class="lineno">  359</span>    <span class="keywordtype">char</span>* norm_salt_mb = malloc(norm_salt_mb_len * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line"><span class="lineno">  360</span>    <span class="keywordflow">if</span> (norm_salt_mb == NULL) {</div>
<div class="line"><span class="lineno">  361</span>        fprintf(stderr, <span class="stringliteral">&quot;Error allocating memory for normalized salt multi-byte characters\n&quot;</span>);</div>
<div class="line"><span class="lineno">  362</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  363</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  364</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt_w);</div>
<div class="line"><span class="lineno">  365</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_pass);</div>
<div class="line"><span class="lineno">  366</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_salt);</div>
<div class="line"><span class="lineno">  367</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_pass_mb);</div>
<div class="line"><span class="lineno">  368</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  369</span>    }</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>    <span class="keywordflow">if</span> (WideCharToMultiByte(CP_UTF8, 0, norm_pass, norm_pass_len, norm_pass_mb, norm_pass_mb_len, NULL, NULL) == 0) {</div>
<div class="line"><span class="lineno">  372</span>        fprintf(stderr, <span class="stringliteral">&quot;Error converting normalized passphrase to multi-byte characters\n&quot;</span>);</div>
<div class="line"><span class="lineno">  373</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  374</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  375</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt_w);</div>
<div class="line"><span class="lineno">  376</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_pass);</div>
<div class="line"><span class="lineno">  377</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_salt);</div>
<div class="line"><span class="lineno">  378</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_pass_mb);</div>
<div class="line"><span class="lineno">  379</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_salt_mb);</div>
<div class="line"><span class="lineno">  380</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  381</span>    }</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>    <span class="keywordflow">if</span> (WideCharToMultiByte(CP_UTF8, 0, norm_salt, norm_salt_len, norm_salt_mb, norm_salt_mb_len, NULL, NULL) == 0) {</div>
<div class="line"><span class="lineno">  384</span>        fprintf(stderr, <span class="stringliteral">&quot;Error converting normalized passphrase to multi-byte characters\n&quot;</span>);</div>
<div class="line"><span class="lineno">  385</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  386</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  387</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt_w);</div>
<div class="line"><span class="lineno">  388</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_pass);</div>
<div class="line"><span class="lineno">  389</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_salt);</div>
<div class="line"><span class="lineno">  390</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_pass_mb);</div>
<div class="line"><span class="lineno">  391</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_salt_mb);</div>
<div class="line"><span class="lineno">  392</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  393</span>    }</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>    <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(pass_w);</div>
<div class="line"><span class="lineno">  396</span>    <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt_w);</div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span>    <span class="comment">/* pbkdf2 hmac sha512 */</span></div>
<div class="line"><span class="lineno">  399</span>    <a class="code hl_function" href="sha2_8c.html#a5b5cb73a44e5e7d2de4ba48097dc2582">pbkdf2_hmac_sha512</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) norm_pass_mb, norm_pass_mb_len, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) norm_salt_mb, norm_salt_mb_len, <a class="code hl_define" href="bip39_8h.html#a0939c53ce21cbf0184f17730ddf7295c">LANG_WORD_CNT</a>, digest);</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>    <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_pass_mb);</div>
<div class="line"><span class="lineno">  402</span>    <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_salt_mb);</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  405</span>    <a class="code hl_typedef" href="winunistd_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> *norm_pass;</div>
<div class="line"><span class="lineno">  406</span>    <a class="code hl_typedef" href="winunistd_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> *norm_salt;</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>    norm_pass = u8_normalize(UNINORM_NFKD, (<span class="keyword">const</span> <a class="code hl_typedef" href="winunistd_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> *) pass, strlen(pass), NULL, &amp;norm_pass_len);</div>
<div class="line"><span class="lineno">  409</span>    <span class="keywordflow">if</span> (norm_pass == NULL) {</div>
<div class="line"><span class="lineno">  410</span>        fprintf(stderr, <span class="stringliteral">&quot;Error normalizing passphrase\n&quot;</span>);</div>
<div class="line"><span class="lineno">  411</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  412</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  413</span>    }</div>
<div class="line"><span class="lineno">  414</span>    norm_salt = u8_normalize(UNINORM_NFKD, (<span class="keyword">const</span> <a class="code hl_typedef" href="winunistd_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> *) salt, strlen(salt), NULL, &amp;norm_salt_len);</div>
<div class="line"><span class="lineno">  415</span>    <span class="keywordflow">if</span> (norm_salt == NULL) {</div>
<div class="line"><span class="lineno">  416</span>        fprintf(stderr, <span class="stringliteral">&quot;Error normalizing salt\n&quot;</span>);</div>
<div class="line"><span class="lineno">  417</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  418</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_pass);</div>
<div class="line"><span class="lineno">  419</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  420</span>    }</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span>    <span class="comment">/* pbkdf2 hmac sha512 */</span></div>
<div class="line"><span class="lineno">  423</span>    <a class="code hl_function" href="sha2_8c.html#a5b5cb73a44e5e7d2de4ba48097dc2582">pbkdf2_hmac_sha512</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) norm_pass, norm_pass_len, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) norm_salt, norm_salt_len, <a class="code hl_define" href="bip39_8h.html#a0939c53ce21cbf0184f17730ddf7295c">LANG_WORD_CNT</a>, digest);</div>
<div class="line"><span class="lineno">  424</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>    <span class="comment">/* we&#39;re done with salt */</span></div>
<div class="line"><span class="lineno">  427</span>    <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(salt);</div>
<div class="line"><span class="lineno">  428</span>    <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_pass);</div>
<div class="line"><span class="lineno">  429</span>    <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(norm_salt);</div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span>    <span class="comment">/* copy the digest into seed*/</span></div>
<div class="line"><span class="lineno">  432</span>    <a class="code hl_function" href="mem_8c.html#ab5b323a3ddeb02bdcb2b5a8a46e2a4b7">memcpy_safe</a>(seed, digest, <a class="code hl_define" href="sha2_8h.html#a5a8416d0f8e1af6d7525114ef09be118">SHA512_DIGEST_LENGTH</a>);</div>
<div class="line"><span class="lineno">  433</span> </div>
<div class="line"><span class="lineno">  434</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  435</span>}</div>
<div class="ttc" id="asha2_8c_html_a5b5cb73a44e5e7d2de4ba48097dc2582"><div class="ttname"><a href="sha2_8c.html#a5b5cb73a44e5e7d2de4ba48097dc2582">pbkdf2_hmac_sha512</a></div><div class="ttdeci">void pbkdf2_hmac_sha512(const uint8_t *pass, int passlen, const uint8_t *salt, int saltlen, uint32_t iterations, uint8_t *key)</div><div class="ttdef"><b>Definition:</b> <a href="sha2_8c_source.html#l01126">sha2.c:1126</a></div></div>
<div class="ttc" id="asha2_8h_html_a5a8416d0f8e1af6d7525114ef09be118"><div class="ttname"><a href="sha2_8h.html#a5a8416d0f8e1af6d7525114ef09be118">SHA512_DIGEST_LENGTH</a></div><div class="ttdeci">#define SHA512_DIGEST_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="sha2_8h_source.html#l00048">sha2.h:48</a></div></div>
<div class="ttc" id="awinunistd_8h_html_a9a941819355e6f658991890ff66b4b0e"><div class="ttname"><a href="winunistd_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a></div><div class="ttdeci">unsigned __int8 uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="winunistd_8h_source.html#l00056">winunistd.h:56</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mem_8c_source.html#l00121">dogecoin_free()</a>, <a class="el" href="bip39_8h_source.html#l00025">LANG_WORD_CNT</a>, <a class="el" href="mem_8c_source.html#l00209">memcpy_safe()</a>, <a class="el" href="sha2_8c_source.html#l01126">pbkdf2_hmac_sha512()</a>, and <a class="el" href="sha2_8h_source.html#l00048">SHA512_DIGEST_LENGTH</a>.</p>

<p class="reference">Referenced by <a class="el" href="bip39_8c_source.html#l00778">dogecoin_seed_from_mnemonic()</a>.</p>

</div>
</div>
<a id="a7f89936585417beb5a425e5a66d32573" name="a7f89936585417beb5a425e5a66d32573"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f89936585417beb5a425e5a66d32573">&#9670;&nbsp;</a></span>get_words()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_words </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>lang</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>wordlist</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bip39_8c_source.html#l00488">488</a> of file <a class="el" href="bip39_8c_source.html">bip39.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  488</span>                                                  {</div>
<div class="line"><span class="lineno">  489</span>    <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>    <span class="comment">/* Check that language is valid */</span></div>
<div class="line"><span class="lineno">  492</span>    <span class="keywordflow">if</span> (lang == NULL) {</div>
<div class="line"><span class="lineno">  493</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: invalid language\n&quot;</span>);</div>
<div class="line"><span class="lineno">  494</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  495</span>    }</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>    <span class="comment">/* Check that wordlist is valid */</span></div>
<div class="line"><span class="lineno">  498</span>    <span class="keywordflow">if</span> (wordlist == NULL) {</div>
<div class="line"><span class="lineno">  499</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: invalid value of wordlist\n&quot;</span>);</div>
<div class="line"><span class="lineno">  500</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  501</span>    }</div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>    <span class="keywordflow">for</span> (; i &lt; 2048; i++) {</div>
<div class="line"><span class="lineno">  504</span>      <span class="keywordflow">if</span> (strcmp(lang,<span class="stringliteral">&quot;spa&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno">  505</span>          wordlist[i]=(<span class="keywordtype">char</span>*)<a class="code hl_variable" href="spanish_8h.html#ac123085805ac61c7a3c97f769e5475f4">wordlist_spa</a>[i];</div>
<div class="line"><span class="lineno">  506</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lang,<span class="stringliteral">&quot;eng&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno">  507</span>          wordlist[i]=(<span class="keywordtype">char</span>*)<a class="code hl_variable" href="english_8h.html#a5e3ec16de7adcf9626455b6544dabd52">wordlist_eng</a>[i];</div>
<div class="line"><span class="lineno">  508</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lang,<span class="stringliteral">&quot;jpn&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno">  509</span>          wordlist[i]=(<span class="keywordtype">char</span>*)<a class="code hl_variable" href="japanese_8h.html#aea3b83657abd4a914e5951fa103aadb6">wordlist_jpn</a>[i];</div>
<div class="line"><span class="lineno">  510</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lang,<span class="stringliteral">&quot;ita&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno">  511</span>          wordlist[i]=(<span class="keywordtype">char</span>*)<a class="code hl_variable" href="italian_8h.html#acd2b8c56146988a891a049fb50a8e4cf">wordlist_ita</a>[i];</div>
<div class="line"><span class="lineno">  512</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lang,<span class="stringliteral">&quot;fra&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno">  513</span>          wordlist[i]=(<span class="keywordtype">char</span>*)<a class="code hl_variable" href="french_8h.html#abe1891e316ce8711678d0369620246c3">wordlist_fra</a>[i];</div>
<div class="line"><span class="lineno">  514</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lang,<span class="stringliteral">&quot;kor&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno">  515</span>          wordlist[i]=(<span class="keywordtype">char</span>*)<a class="code hl_variable" href="korean_8h.html#abb04123512cc225ae13c573c999dd938">wordlist_kor</a>[i];</div>
<div class="line"><span class="lineno">  516</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lang,<span class="stringliteral">&quot;sc&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno">  517</span>          wordlist[i]=(<span class="keywordtype">char</span>*)<a class="code hl_variable" href="chinese__simplified_8h.html#adea2a5e13947d5bf0944417e0450a3c5">wordlist_sc</a>[i];</div>
<div class="line"><span class="lineno">  518</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lang,<span class="stringliteral">&quot;tc&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno">  519</span>          wordlist[i]=(<span class="keywordtype">char</span>*)<a class="code hl_variable" href="chinese__traditional_8h.html#ad4dfe334e4d9745803f6c1def08fa20a">wordlist_tc</a>[i];</div>
<div class="line"><span class="lineno">  520</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lang,<span class="stringliteral">&quot;cze&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno">  521</span>          wordlist[i]=(<span class="keywordtype">char</span>*)<a class="code hl_variable" href="czech_8h.html#a7642ebf28224056e023a5ad077f6fea3">wordlist_cze</a>[i];</div>
<div class="line"><span class="lineno">  522</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(lang,<span class="stringliteral">&quot;por&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno">  523</span>          wordlist[i]=(<span class="keywordtype">char</span>*)<a class="code hl_variable" href="portuguese_8h.html#a9bffdd796d6fd6946edcee3804e1ea10">wordlist_por</a>[i];</div>
<div class="line"><span class="lineno">  524</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  525</span>          fprintf(stderr, <span class="stringliteral">&quot;ERROR: invalid language\n&quot;</span>);</div>
<div class="line"><span class="lineno">  526</span>          <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  527</span>      }</div>
<div class="line"><span class="lineno">  528</span>    }</div>
<div class="line"><span class="lineno">  529</span>   <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  530</span>}</div>
<div class="ttc" id="achinese__simplified_8h_html_adea2a5e13947d5bf0944417e0450a3c5"><div class="ttname"><a href="chinese__simplified_8h.html#adea2a5e13947d5bf0944417e0450a3c5">wordlist_sc</a></div><div class="ttdeci">const char *const wordlist_sc[]</div><div class="ttdef"><b>Definition:</b> <a href="chinese__simplified_8h_source.html#l00001">chinese_simplified.h:1</a></div></div>
<div class="ttc" id="achinese__traditional_8h_html_ad4dfe334e4d9745803f6c1def08fa20a"><div class="ttname"><a href="chinese__traditional_8h.html#ad4dfe334e4d9745803f6c1def08fa20a">wordlist_tc</a></div><div class="ttdeci">const char *const wordlist_tc[]</div><div class="ttdef"><b>Definition:</b> <a href="chinese__traditional_8h_source.html#l00001">chinese_traditional.h:1</a></div></div>
<div class="ttc" id="aczech_8h_html_a7642ebf28224056e023a5ad077f6fea3"><div class="ttname"><a href="czech_8h.html#a7642ebf28224056e023a5ad077f6fea3">wordlist_cze</a></div><div class="ttdeci">const char *const wordlist_cze[]</div><div class="ttdef"><b>Definition:</b> <a href="czech_8h_source.html#l00001">czech.h:1</a></div></div>
<div class="ttc" id="aenglish_8h_html_a5e3ec16de7adcf9626455b6544dabd52"><div class="ttname"><a href="english_8h.html#a5e3ec16de7adcf9626455b6544dabd52">wordlist_eng</a></div><div class="ttdeci">const char *const wordlist_eng[]</div><div class="ttdef"><b>Definition:</b> <a href="english_8h_source.html#l00024">english.h:24</a></div></div>
<div class="ttc" id="afrench_8h_html_abe1891e316ce8711678d0369620246c3"><div class="ttname"><a href="french_8h.html#abe1891e316ce8711678d0369620246c3">wordlist_fra</a></div><div class="ttdeci">const char *const wordlist_fra[]</div><div class="ttdef"><b>Definition:</b> <a href="french_8h_source.html#l00001">french.h:1</a></div></div>
<div class="ttc" id="aitalian_8h_html_acd2b8c56146988a891a049fb50a8e4cf"><div class="ttname"><a href="italian_8h.html#acd2b8c56146988a891a049fb50a8e4cf">wordlist_ita</a></div><div class="ttdeci">const char *const wordlist_ita[]</div><div class="ttdef"><b>Definition:</b> <a href="italian_8h_source.html#l00001">italian.h:1</a></div></div>
<div class="ttc" id="ajapanese_8h_html_aea3b83657abd4a914e5951fa103aadb6"><div class="ttname"><a href="japanese_8h.html#aea3b83657abd4a914e5951fa103aadb6">wordlist_jpn</a></div><div class="ttdeci">const char *const wordlist_jpn[]</div><div class="ttdef"><b>Definition:</b> <a href="japanese_8h_source.html#l00001">japanese.h:1</a></div></div>
<div class="ttc" id="akorean_8h_html_abb04123512cc225ae13c573c999dd938"><div class="ttname"><a href="korean_8h.html#abb04123512cc225ae13c573c999dd938">wordlist_kor</a></div><div class="ttdeci">const char *const wordlist_kor[]</div><div class="ttdef"><b>Definition:</b> <a href="korean_8h_source.html#l00001">korean.h:1</a></div></div>
<div class="ttc" id="aportuguese_8h_html_a9bffdd796d6fd6946edcee3804e1ea10"><div class="ttname"><a href="portuguese_8h.html#a9bffdd796d6fd6946edcee3804e1ea10">wordlist_por</a></div><div class="ttdeci">const char *const wordlist_por[]</div><div class="ttdef"><b>Definition:</b> <a href="portuguese_8h_source.html#l00001">portuguese.h:1</a></div></div>
<div class="ttc" id="aspanish_8h_html_ac123085805ac61c7a3c97f769e5475f4"><div class="ttname"><a href="spanish_8h.html#ac123085805ac61c7a3c97f769e5475f4">wordlist_spa</a></div><div class="ttdeci">const char *const wordlist_spa[]</div><div class="ttdef"><b>Definition:</b> <a href="spanish_8h_source.html#l00001">spanish.h:1</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="czech_8h_source.html#l00001">wordlist_cze</a>, <a class="el" href="english_8h_source.html#l00024">wordlist_eng</a>, <a class="el" href="french_8h_source.html#l00001">wordlist_fra</a>, <a class="el" href="italian_8h_source.html#l00001">wordlist_ita</a>, <a class="el" href="japanese_8h_source.html#l00001">wordlist_jpn</a>, <a class="el" href="korean_8h_source.html#l00001">wordlist_kor</a>, <a class="el" href="portuguese_8h_source.html#l00001">wordlist_por</a>, <a class="el" href="chinese__simplified_8h_source.html#l00001">wordlist_sc</a>, <a class="el" href="spanish_8h_source.html#l00001">wordlist_spa</a>, and <a class="el" href="chinese__traditional_8h_source.html#l00001">wordlist_tc</a>.</p>

<p class="reference">Referenced by <a class="el" href="bip39_8c_source.html#l00691">dogecoin_generate_mnemonic()</a>.</p>

</div>
</div>
<a id="a16e1f39933538c74bc28b88ed8ae457d" name="a16e1f39933538c74bc28b88ed8ae457d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16e1f39933538c74bc28b88ed8ae457d">&#9670;&nbsp;</a></span>produce_mnemonic_sentence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int produce_mnemonic_sentence </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>segSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>checksumBits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>firstByte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>entropy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>wordlist</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>space</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>mnemonic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>mnemonic_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bip39_8c_source.html#l00537">537</a> of file <a class="el" href="bip39_8c_source.html">bip39.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  537</span>                                                                                                                                                                                                       {</div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span>    <span class="comment">/* Check if the input arguments are valid, mnemonic may be NULL */</span></div>
<div class="line"><span class="lineno">  540</span>    <span class="keywordflow">if</span> (segSize &lt;= 0 || checksumBits &lt;= 0 || !firstByte || !entropy || !wordlist || !space || !mnemonic_size) {</div>
<div class="line"><span class="lineno">  541</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: invalid input arguments\n&quot;</span>);</div>
<div class="line"><span class="lineno">  542</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  543</span>    }</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>    <span class="comment">/* Check that wordlist is valid */</span></div>
<div class="line"><span class="lineno">  546</span>    <span class="keywordflow">if</span> (*wordlist == NULL) {</div>
<div class="line"><span class="lineno">  547</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: invalid value of wordlist\n&quot;</span>);</div>
<div class="line"><span class="lineno">  548</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  549</span>    }</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>    <span class="comment">/* Define and initialize segment and csBits */</span></div>
<div class="line"><span class="lineno">  552</span>    <span class="keywordtype">char</span> *segment = <a class="code hl_function" href="mem_8c.html#a1812544443a8e512c4ff15fad2b6479a">dogecoin_string_vla</a> (segSize);</div>
<div class="line"><span class="lineno">  553</span>    <span class="keywordflow">if</span> (segment == NULL) {</div>
<div class="line"><span class="lineno">  554</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to allocate memory for segment\n&quot;</span>);</div>
<div class="line"><span class="lineno">  555</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  556</span>    }</div>
<div class="line"><span class="lineno">  557</span>    strcpy(segment, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>    <span class="keywordtype">char</span> *csBits = <a class="code hl_function" href="mem_8c.html#a1812544443a8e512c4ff15fad2b6479a">dogecoin_string_vla</a> (checksumBits);</div>
<div class="line"><span class="lineno">  560</span>    <span class="keywordflow">if</span> (csBits == NULL) {</div>
<div class="line"><span class="lineno">  561</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to allocate memory for csBits\n&quot;</span>);</div>
<div class="line"><span class="lineno">  562</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a> (segment);</div>
<div class="line"><span class="lineno">  563</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  564</span>    }</div>
<div class="line"><span class="lineno">  565</span>    strcpy(csBits, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>    <span class="comment">/* Convert the checksum string to a byte */</span></div>
<div class="line"><span class="lineno">  568</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *bytes = <a class="code hl_function" href="utils_8c.html#aec1a2d99d5cfbcb4ccfc73b86ad410be">utils_hex_to_uint8</a>(firstByte);</div>
<div class="line"><span class="lineno">  569</span>    <span class="keywordflow">if</span> (bytes == NULL) {</div>
<div class="line"><span class="lineno">  570</span>        <span class="comment">/* Invalid byte, return from the function */</span></div>
<div class="line"><span class="lineno">  571</span>        fprintf(stderr, <span class="stringliteral">&quot;ERROR: Failed to convert first byte\n&quot;</span>);</div>
<div class="line"><span class="lineno">  572</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a> (segment);</div>
<div class="line"><span class="lineno">  573</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a> (csBits);</div>
<div class="line"><span class="lineno">  574</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  575</span>    }</div>
<div class="line"><span class="lineno">  576</span> </div>
<div class="line"><span class="lineno">  577</span>    <span class="comment">/* Convert the byte to bits */</span></div>
<div class="line"><span class="lineno">  578</span>    <span class="keywordflow">switch</span>(checksumBits) {</div>
<div class="line"><span class="lineno">  579</span>        <span class="keywordflow">case</span> 5:</div>
<div class="line"><span class="lineno">  580</span>            sprintf(csBits, <a class="code hl_define" href="bip39_8h.html#a25b543eabb908452e8303f48528a9121">BYTE_TO_FIRST_FOUR_BINARY_PATTERN</a>, <a class="code hl_define" href="bip39_8h.html#a62c1b10d7565771eaaedaf4c1f9bdd46">BYTE_TO_FIRST_FOUR_BINARY</a>(bytes[0]));</div>
<div class="line"><span class="lineno">  581</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  582</span>        <span class="keywordflow">case</span> 6:</div>
<div class="line"><span class="lineno">  583</span>            sprintf(csBits, <a class="code hl_define" href="bip39_8h.html#ad51cdf2da6e2bb3804f087c10e5a28fa">BYTE_TO_FIRST_FIVE_BINARY_PATTERN</a>, <a class="code hl_define" href="bip39_8h.html#af686cf090918e228f6d40c22f709bf9c">BYTE_TO_FIRST_FIVE_BINARY</a>(bytes[0]));</div>
<div class="line"><span class="lineno">  584</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  585</span>        <span class="keywordflow">case</span> 7:</div>
<div class="line"><span class="lineno">  586</span>            sprintf(csBits, <a class="code hl_define" href="bip39_8h.html#a1b659f82ef1423f5d2354c4011f1c684">BYTE_TO_FIRST_SIX_BINARY_PATTERN</a>, <a class="code hl_define" href="bip39_8h.html#ad745a1da132e39697085aef6b6796c43">BYTE_TO_FIRST_SIX_BINARY</a>(bytes[0]));</div>
<div class="line"><span class="lineno">  587</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  588</span>        <span class="keywordflow">case</span> 8:</div>
<div class="line"><span class="lineno">  589</span>            sprintf(csBits, <a class="code hl_define" href="bip39_8h.html#ac1b2c690eabb549a0c9b50c8c9794190">BYTE_TO_FIRST_SEVEN_BINARY_PATTERN</a>, <a class="code hl_define" href="bip39_8h.html#ae423626703dd46b22f3728e5159a8771">BYTE_TO_FIRST_SEVEN_BINARY</a>(bytes[0]));</div>
<div class="line"><span class="lineno">  590</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  591</span>        <span class="keywordflow">case</span> 9:</div>
<div class="line"><span class="lineno">  592</span>            sprintf(csBits, <a class="code hl_define" href="bip39_8h.html#ae8b243fdac3715a3da7c98b9a380eaa5">BYTE_TO_BINARY_PATTERN</a>, <a class="code hl_define" href="bip39_8h.html#aa28480bfa03957b4f284c13e800ca8b0">BYTE_TO_BINARY</a>(bytes[0]));</div>
<div class="line"><span class="lineno">  593</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  594</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  595</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  596</span>            <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a> (segment);</div>
<div class="line"><span class="lineno">  597</span>            <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a> (csBits);</div>
<div class="line"><span class="lineno">  598</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  599</span>    }</div>
<div class="line"><span class="lineno">  600</span>    csBits[checksumBits - 1] = <span class="charliteral">&#39;\0&#39;</span>;   <span class="comment">// null-terminate the checksum string</span></div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>    <span class="comment">/* Concatenate the entropy and checksum bits onto the segment array,</span></div>
<div class="line"><span class="lineno">  603</span><span class="comment">     * ensuring that the segment array does not overflow.</span></div>
<div class="line"><span class="lineno">  604</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>    strncat(segment, entropy, segSize - strlen(segment) - 1);</div>
<div class="line"><span class="lineno">  607</span>    strncat(segment, csBits, segSize - strlen(segment) - 1);</div>
<div class="line"><span class="lineno">  608</span> </div>
<div class="line"><span class="lineno">  609</span>    <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a> (csBits);</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>    <span class="comment">/* Initialize the mnemonic array with a null terminator */</span></div>
<div class="line"><span class="lineno">  612</span>    <span class="keywordflow">if</span> (mnemonic != NULL) {</div>
<div class="line"><span class="lineno">  613</span>        mnemonic[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  614</span>    }</div>
<div class="line"><span class="lineno">  615</span>    *mnemonic_size = 0;</div>
<div class="line"><span class="lineno">  616</span> </div>
<div class="line"><span class="lineno">  617</span>    <span class="keywordtype">char</span> elevenBits[12] = {<span class="stringliteral">&quot;&quot;</span>};</div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>    <span class="keywordtype">int</span> elevenBitIndex = 0;</div>
<div class="line"><span class="lineno">  620</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; segSize; i++) {</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>        <span class="keywordflow">if</span> (elevenBitIndex == 11) {</div>
<div class="line"><span class="lineno">  623</span>            elevenBits[11] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  624</span>            <span class="comment">/* Compute the decimal value of the 11-bit binary chunk */</span></div>
<div class="line"><span class="lineno">  625</span>            <span class="keywordtype">long</span> real = 0;</div>
<div class="line"><span class="lineno">  626</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 11; j++) {</div>
<div class="line"><span class="lineno">  627</span>                real = (real &lt;&lt; 1) | (elevenBits[j] - <span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line"><span class="lineno">  628</span>            }</div>
<div class="line"><span class="lineno">  629</span>            <span class="comment">/* Check that real is a valid index into the wordlist array */</span></div>
<div class="line"><span class="lineno">  630</span>            <span class="keywordflow">if</span> (real &lt; 0 || real &gt;= <a class="code hl_define" href="bip39_8h.html#a0939c53ce21cbf0184f17730ddf7295c">LANG_WORD_CNT</a>) {</div>
<div class="line"><span class="lineno">  631</span>                fprintf(stderr, <span class="stringliteral">&quot;ERROR: invalid 11-bit binary chunk\n&quot;</span>);</div>
<div class="line"><span class="lineno">  632</span>                <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a> (segment);</div>
<div class="line"><span class="lineno">  633</span>                <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  634</span>            }</div>
<div class="line"><span class="lineno">  635</span> </div>
<div class="line"><span class="lineno">  636</span>            <span class="keyword">const</span> <span class="keywordtype">char</span> *word = wordlist[real];</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>            <span class="comment">/* Check for allocation */</span></div>
<div class="line"><span class="lineno">  639</span>            <span class="keywordflow">if</span> (mnemonic == NULL) {</div>
<div class="line"><span class="lineno">  640</span>                <span class="comment">/* update mnemonic_size with the length of what the mnemonic should be */</span></div>
<div class="line"><span class="lineno">  641</span>                *mnemonic_size += strlen(word);</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>                <span class="comment">/* Only count the space if it&#39;s not the last word */</span></div>
<div class="line"><span class="lineno">  644</span>                <span class="keywordflow">if</span> (i &lt; segSize - 1) {</div>
<div class="line"><span class="lineno">  645</span>                    *mnemonic_size += strlen(space);</div>
<div class="line"><span class="lineno">  646</span>                }</div>
<div class="line"><span class="lineno">  647</span>            }</div>
<div class="line"><span class="lineno">  648</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  649</span>                <span class="comment">/* Concatenate the word from the wordlist to the mnemonic */</span></div>
<div class="line"><span class="lineno">  650</span>                strcat(mnemonic, word);</div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span>                <span class="comment">/* update mnemonic_size with the length of the mnemonic */</span></div>
<div class="line"><span class="lineno">  653</span>                *mnemonic_size += strlen(word);</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>                <span class="comment">/* Concatenate a space to the mnemonic only if it&#39;s not the last word */</span></div>
<div class="line"><span class="lineno">  656</span>                <span class="keywordflow">if</span> (i &lt; segSize - 1) {</div>
<div class="line"><span class="lineno">  657</span>                    strcat(mnemonic, space);</div>
<div class="line"><span class="lineno">  658</span>                    *mnemonic_size += strlen(space);</div>
<div class="line"><span class="lineno">  659</span>                }</div>
<div class="line"><span class="lineno">  660</span>            }</div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span>            elevenBitIndex = 0;</div>
<div class="line"><span class="lineno">  663</span>        }</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>        elevenBits[elevenBitIndex] = segment[i];</div>
<div class="line"><span class="lineno">  666</span>        elevenBitIndex++;</div>
<div class="line"><span class="lineno">  667</span>    }</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>    <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a> (segment);</div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>   <span class="comment">/* Increment mnemonic_size to account for the null terminator */</span></div>
<div class="line"><span class="lineno">  672</span>   *mnemonic_size = *mnemonic_size + 1;</div>
<div class="line"><span class="lineno">  673</span> </div>
<div class="line"><span class="lineno">  674</span>   <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  675</span>}</div>
<div class="ttc" id="abip39_8h_html_a1b659f82ef1423f5d2354c4011f1c684"><div class="ttname"><a href="bip39_8h.html#a1b659f82ef1423f5d2354c4011f1c684">BYTE_TO_FIRST_SIX_BINARY_PATTERN</a></div><div class="ttdeci">#define BYTE_TO_FIRST_SIX_BINARY_PATTERN</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8h_source.html#l00096">bip39.h:96</a></div></div>
<div class="ttc" id="abip39_8h_html_a25b543eabb908452e8303f48528a9121"><div class="ttname"><a href="bip39_8h.html#a25b543eabb908452e8303f48528a9121">BYTE_TO_FIRST_FOUR_BINARY_PATTERN</a></div><div class="ttdeci">#define BYTE_TO_FIRST_FOUR_BINARY_PATTERN</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8h_source.html#l00075">bip39.h:75</a></div></div>
<div class="ttc" id="abip39_8h_html_a62c1b10d7565771eaaedaf4c1f9bdd46"><div class="ttname"><a href="bip39_8h.html#a62c1b10d7565771eaaedaf4c1f9bdd46">BYTE_TO_FIRST_FOUR_BINARY</a></div><div class="ttdeci">#define BYTE_TO_FIRST_FOUR_BINARY(byte)</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8h_source.html#l00078">bip39.h:78</a></div></div>
<div class="ttc" id="abip39_8h_html_ac1b2c690eabb549a0c9b50c8c9794190"><div class="ttname"><a href="bip39_8h.html#ac1b2c690eabb549a0c9b50c8c9794190">BYTE_TO_FIRST_SEVEN_BINARY_PATTERN</a></div><div class="ttdeci">#define BYTE_TO_FIRST_SEVEN_BINARY_PATTERN</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8h_source.html#l00108">bip39.h:108</a></div></div>
<div class="ttc" id="abip39_8h_html_ad51cdf2da6e2bb3804f087c10e5a28fa"><div class="ttname"><a href="bip39_8h.html#ad51cdf2da6e2bb3804f087c10e5a28fa">BYTE_TO_FIRST_FIVE_BINARY_PATTERN</a></div><div class="ttdeci">#define BYTE_TO_FIRST_FIVE_BINARY_PATTERN</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8h_source.html#l00085">bip39.h:85</a></div></div>
<div class="ttc" id="abip39_8h_html_ad745a1da132e39697085aef6b6796c43"><div class="ttname"><a href="bip39_8h.html#ad745a1da132e39697085aef6b6796c43">BYTE_TO_FIRST_SIX_BINARY</a></div><div class="ttdeci">#define BYTE_TO_FIRST_SIX_BINARY(byte)</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8h_source.html#l00099">bip39.h:99</a></div></div>
<div class="ttc" id="abip39_8h_html_ae423626703dd46b22f3728e5159a8771"><div class="ttname"><a href="bip39_8h.html#ae423626703dd46b22f3728e5159a8771">BYTE_TO_FIRST_SEVEN_BINARY</a></div><div class="ttdeci">#define BYTE_TO_FIRST_SEVEN_BINARY(byte)</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8h_source.html#l00111">bip39.h:111</a></div></div>
<div class="ttc" id="abip39_8h_html_af686cf090918e228f6d40c22f709bf9c"><div class="ttname"><a href="bip39_8h.html#af686cf090918e228f6d40c22f709bf9c">BYTE_TO_FIRST_FIVE_BINARY</a></div><div class="ttdeci">#define BYTE_TO_FIRST_FIVE_BINARY(byte)</div><div class="ttdef"><b>Definition:</b> <a href="bip39_8h_source.html#l00088">bip39.h:88</a></div></div>
<div class="ttc" id="amem_8c_html_a1812544443a8e512c4ff15fad2b6479a"><div class="ttname"><a href="mem_8c.html#a1812544443a8e512c4ff15fad2b6479a">dogecoin_string_vla</a></div><div class="ttdeci">char * dogecoin_string_vla(size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00270">mem.c:270</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="bip39_8h_source.html#l00064">BYTE_TO_BINARY</a>, <a class="el" href="bip39_8h_source.html#l00061">BYTE_TO_BINARY_PATTERN</a>, <a class="el" href="bip39_8h_source.html#l00088">BYTE_TO_FIRST_FIVE_BINARY</a>, <a class="el" href="bip39_8h_source.html#l00085">BYTE_TO_FIRST_FIVE_BINARY_PATTERN</a>, <a class="el" href="bip39_8h_source.html#l00078">BYTE_TO_FIRST_FOUR_BINARY</a>, <a class="el" href="bip39_8h_source.html#l00075">BYTE_TO_FIRST_FOUR_BINARY_PATTERN</a>, <a class="el" href="bip39_8h_source.html#l00111">BYTE_TO_FIRST_SEVEN_BINARY</a>, <a class="el" href="bip39_8h_source.html#l00108">BYTE_TO_FIRST_SEVEN_BINARY_PATTERN</a>, <a class="el" href="bip39_8h_source.html#l00099">BYTE_TO_FIRST_SIX_BINARY</a>, <a class="el" href="bip39_8h_source.html#l00096">BYTE_TO_FIRST_SIX_BINARY_PATTERN</a>, <a class="el" href="mem_8c_source.html#l00121">dogecoin_free()</a>, <a class="el" href="mem_8c_source.html#l00270">dogecoin_string_vla()</a>, <a class="el" href="bip39_8h_source.html#l00025">LANG_WORD_CNT</a>, and <a class="el" href="utils_8c_source.html#l00147">utils_hex_to_uint8()</a>.</p>

<p class="reference">Referenced by <a class="el" href="bip39_8c_source.html#l00068">get_mnemonic()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
