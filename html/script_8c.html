<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libdogecoin: src/script.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libdogecoin
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">script.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;<a class="el" href="buffer_8h_source.html">dogecoin/buffer.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="include_2dogecoin_2hash_8h_source.html">dogecoin/hash.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="rmd160_8h_source.html">dogecoin/rmd160.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="script_8h_source.html">dogecoin/script.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="serialize_8h_source.html">dogecoin/serialize.h</a>&gt;</code><br />
</div>
<p><a href="script_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a89f6522a0ff3e1b5b9ea0135e74985bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a89f6522a0ff3e1b5b9ea0135e74985bb">dogecoin_script_copy_without_op_codeseperator</a> (const <a class="el" href="structcstring.html">cstring</a> *script_in, <a class="el" href="structcstring.html">cstring</a> *script_out)</td></tr>
<tr class="memdesc:a89f6522a0ff3e1b5b9ea0135e74985bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function copies a script without the OP_CODESEPARATOR opcode.  <a href="script_8c.html#a89f6522a0ff3e1b5b9ea0135e74985bb">More...</a><br /></td></tr>
<tr class="separator:a89f6522a0ff3e1b5b9ea0135e74985bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bebfe2ef20079d39e0dc13c88c631ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="script_8h.html#a3728d27af357a79523869821d2eb1df4">dogecoin_script_op</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a9bebfe2ef20079d39e0dc13c88c631ec">dogecoin_script_op_new</a> ()</td></tr>
<tr class="memdesc:a9bebfe2ef20079d39e0dc13c88c631ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allocates the memory for a new dogecoin_script_op object.  <a href="script_8c.html#a9bebfe2ef20079d39e0dc13c88c631ec">More...</a><br /></td></tr>
<tr class="separator:a9bebfe2ef20079d39e0dc13c88c631ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8029e1959d97bdd2558af0d0e52870dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a8029e1959d97bdd2558af0d0e52870dd">dogecoin_script_op_free</a> (<a class="el" href="script_8h.html#a3728d27af357a79523869821d2eb1df4">dogecoin_script_op</a> *script_op)</td></tr>
<tr class="memdesc:a8029e1959d97bdd2558af0d0e52870dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function frees the pointer to a dogecoin_script_op object and sets the pointer to NULL.  <a href="script_8c.html#a8029e1959d97bdd2558af0d0e52870dd">More...</a><br /></td></tr>
<tr class="separator:a8029e1959d97bdd2558af0d0e52870dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbb7e12c33b946ecd164a4d1fceba82a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#acbb7e12c33b946ecd164a4d1fceba82a">dogecoin_script_op_free_cb</a> (void *data)</td></tr>
<tr class="memdesc:acbb7e12c33b946ecd164a4d1fceba82a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function casts data from a channel buffer to a dogecoin_script_op object and then frees it by calling <a class="el" href="script_8c.html#a8029e1959d97bdd2558af0d0e52870dd" title="This function frees the pointer to a dogecoin_script_op object and sets the pointer to NULL.">dogecoin_script_op_free()</a>.  <a href="script_8c.html#acbb7e12c33b946ecd164a4d1fceba82a">More...</a><br /></td></tr>
<tr class="separator:acbb7e12c33b946ecd164a4d1fceba82a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a835fa79c6c664fbc646dd02cffb43e0a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a835fa79c6c664fbc646dd02cffb43e0a">dogecoin_script_get_ops</a> (const <a class="el" href="structcstring.html">cstring</a> *script_in, <a class="el" href="structvector.html">vector</a> *ops_out)</td></tr>
<tr class="memdesc:a835fa79c6c664fbc646dd02cffb43e0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function converts a cstring script into a vector of dogecoin_script_op objects.  <a href="script_8c.html#a835fa79c6c664fbc646dd02cffb43e0a">More...</a><br /></td></tr>
<tr class="separator:a835fa79c6c664fbc646dd02cffb43e0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a821f282735ff2d7e5f07e934364096ee"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a821f282735ff2d7e5f07e934364096ee">dogecoin_script_is_pushdata</a> (const enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a> op)</td></tr>
<tr class="memdesc:a821f282735ff2d7e5f07e934364096ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks whether an opcode is a pushdata opcode.  <a href="script_8c.html#a821f282735ff2d7e5f07e934364096ee">More...</a><br /></td></tr>
<tr class="separator:a821f282735ff2d7e5f07e934364096ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab99cb7bc6b3bd9434399580da4d43ff3"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#ab99cb7bc6b3bd9434399580da4d43ff3">dogecoin_script_is_op</a> (const <a class="el" href="script_8h.html#a3728d27af357a79523869821d2eb1df4">dogecoin_script_op</a> *op, enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a> opcode)</td></tr>
<tr class="memdesc:ab99cb7bc6b3bd9434399580da4d43ff3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks whether the opcode of a given script operation matches the specified opcode.  <a href="script_8c.html#ab99cb7bc6b3bd9434399580da4d43ff3">More...</a><br /></td></tr>
<tr class="separator:ab99cb7bc6b3bd9434399580da4d43ff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b67694af4f04a0bc6690ac40a72d58f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a8b67694af4f04a0bc6690ac40a72d58f">dogecoin_script_is_op_pubkey</a> (const <a class="el" href="script_8h.html#a3728d27af357a79523869821d2eb1df4">dogecoin_script_op</a> *op)</td></tr>
<tr class="memdesc:a8b67694af4f04a0bc6690ac40a72d58f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks whether a given script operation pushes a pubkey to the stack. This is true if the script operation has a pushdata opcode and that its data is the same length as a compressed or uncompressed EC key.  <a href="script_8c.html#a8b67694af4f04a0bc6690ac40a72d58f">More...</a><br /></td></tr>
<tr class="separator:a8b67694af4f04a0bc6690ac40a72d58f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6f452f07b063e1a6b820bfeb068bcc0"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#ac6f452f07b063e1a6b820bfeb068bcc0">dogecoin_script_is_op_pubkeyhash</a> (const <a class="el" href="script_8h.html#a3728d27af357a79523869821d2eb1df4">dogecoin_script_op</a> *op)</td></tr>
<tr class="memdesc:ac6f452f07b063e1a6b820bfeb068bcc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks whether the given script operation pushes a pubkey hash to the stack. This is true if the script operation has a pushdata opcode and that its data is 20 bytes in size.  <a href="script_8c.html#ac6f452f07b063e1a6b820bfeb068bcc0">More...</a><br /></td></tr>
<tr class="separator:ac6f452f07b063e1a6b820bfeb068bcc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7650d6ca38c4502fb27b6c872da9ef6b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a7650d6ca38c4502fb27b6c872da9ef6b">dogecoin_script_is_pubkey</a> (const <a class="el" href="structvector.html">vector</a> *ops, <a class="el" href="structvector.html">vector</a> *data_out)</td></tr>
<tr class="memdesc:a7650d6ca38c4502fb27b6c872da9ef6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks whether the script matches the template for a pubkey script, which is composed of a push pubkey operation followed by an OP_CHECKSIG. The pubkey is then loaded into data_out.  <a href="script_8c.html#a7650d6ca38c4502fb27b6c872da9ef6b">More...</a><br /></td></tr>
<tr class="separator:a7650d6ca38c4502fb27b6c872da9ef6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4d9698dde44c7c7b1698840b497a8bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#aa4d9698dde44c7c7b1698840b497a8bb">dogecoin_script_is_pubkeyhash</a> (const <a class="el" href="structvector.html">vector</a> *ops, <a class="el" href="structvector.html">vector</a> *data_out)</td></tr>
<tr class="memdesc:aa4d9698dde44c7c7b1698840b497a8bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks whether the script matches the template for a pubkey hash script, which is composed of an OP_DUP, an OP_HASH160, a push pubkey hash operation, an OP_EQUALVERIFY, and an OP_CHECKSIG, in that order. The pubkey hash is then loaded into data_out.  <a href="script_8c.html#aa4d9698dde44c7c7b1698840b497a8bb">More...</a><br /></td></tr>
<tr class="separator:aa4d9698dde44c7c7b1698840b497a8bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56862b180a334357cf320d863ce9519c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a56862b180a334357cf320d863ce9519c">dogecoin_script_is_scripthash</a> (const <a class="el" href="structvector.html">vector</a> *ops, <a class="el" href="structvector.html">vector</a> *data_out)</td></tr>
<tr class="memdesc:a56862b180a334357cf320d863ce9519c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks whether the script matches the template for a script hash, which is composed of an OP_HASH160, a push pubkey hash operation, and an OP_EQUAL, in that order. The script hash is then loaded into data_out.  <a href="script_8c.html#a56862b180a334357cf320d863ce9519c">More...</a><br /></td></tr>
<tr class="separator:a56862b180a334357cf320d863ce9519c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1202671b6692b3d8e5a5f51d377ffe9c"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a1202671b6692b3d8e5a5f51d377ffe9c">dogecoin_script_is_op_smallint</a> (const <a class="el" href="script_8h.html#a3728d27af357a79523869821d2eb1df4">dogecoin_script_op</a> *op)</td></tr>
<tr class="memdesc:a1202671b6692b3d8e5a5f51d377ffe9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function checks whether the script operation has an opcode label of less than or equal to 16.  <a href="script_8c.html#a1202671b6692b3d8e5a5f51d377ffe9c">More...</a><br /></td></tr>
<tr class="separator:a1202671b6692b3d8e5a5f51d377ffe9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9d6b3f63ad8603c55d8ed5770a4097b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#aa9d6b3f63ad8603c55d8ed5770a4097b">dogecoin_script_is_multisig</a> (const <a class="el" href="structvector.html">vector</a> *ops)</td></tr>
<tr class="memdesc:aa9d6b3f63ad8603c55d8ed5770a4097b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks whether a script is a multisig script, which is true if the vector is composed of between 3 and 19 scripts (inclusive), the first operation has a small int opcode, the second-to-last operation has a small int opcode, the last operation is OP_CHECKMULTISIG, and all operations in between push pubkeys to the stack.  <a href="script_8c.html#aa9d6b3f63ad8603c55d8ed5770a4097b">More...</a><br /></td></tr>
<tr class="separator:aa9d6b3f63ad8603c55d8ed5770a4097b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d6b89b42ceddc5e8debbe66fdc55cec"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="script_8h.html#ab75ea367046ee2a256023effe4574b1b">dogecoin_tx_out_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a8d6b89b42ceddc5e8debbe66fdc55cec">dogecoin_script_classify_ops</a> (const <a class="el" href="structvector.html">vector</a> *ops)</td></tr>
<tr class="memdesc:a8d6b89b42ceddc5e8debbe66fdc55cec"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function classifies a script as one of four types: pubkey, pubkey hash, script hash, or multisig.  <a href="script_8c.html#a8d6b89b42ceddc5e8debbe66fdc55cec">More...</a><br /></td></tr>
<tr class="separator:a8d6b89b42ceddc5e8debbe66fdc55cec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e4fc90d9aed02c197383d3c368a494e"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="script_8h.html#ab75ea367046ee2a256023effe4574b1b">dogecoin_tx_out_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a5e4fc90d9aed02c197383d3c368a494e">dogecoin_script_classify</a> (const <a class="el" href="structcstring.html">cstring</a> *script, <a class="el" href="structvector.html">vector</a> *data_out)</td></tr>
<tr class="memdesc:a5e4fc90d9aed02c197383d3c368a494e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes a cstring representation of a script, classifies it as one of the four script types and loads the script data into data_out if it is not a multisig script.  <a href="script_8c.html#a5e4fc90d9aed02c197383d3c368a494e">More...</a><br /></td></tr>
<tr class="separator:a5e4fc90d9aed02c197383d3c368a494e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d192087731cb15526f5232a503c6d69"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a8d192087731cb15526f5232a503c6d69">dogecoin_encode_op_n</a> (const int n)</td></tr>
<tr class="memdesc:a8d192087731cb15526f5232a503c6d69"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes an int and translates it to a small int opcode if it is between 0 and 16, inclusive.  <a href="script_8c.html#a8d192087731cb15526f5232a503c6d69">More...</a><br /></td></tr>
<tr class="separator:a8d192087731cb15526f5232a503c6d69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b0626c2f7ba76d34c798a8bdd24b9b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a3b0626c2f7ba76d34c798a8bdd24b9b4">dogecoin_script_append_op</a> (<a class="el" href="structcstring.html">cstring</a> *script_in, enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a> op)</td></tr>
<tr class="memdesc:a3b0626c2f7ba76d34c798a8bdd24b9b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes an existing script in cstring form and appends another script operation to it. No data is pushed to the stack.  <a href="script_8c.html#a3b0626c2f7ba76d34c798a8bdd24b9b4">More...</a><br /></td></tr>
<tr class="separator:a3b0626c2f7ba76d34c798a8bdd24b9b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1559c9411a941208a71d89a69bf249af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a1559c9411a941208a71d89a69bf249af">dogecoin_script_append_pushdata</a> (<a class="el" href="structcstring.html">cstring</a> *script_in, const unsigned char *data, const size_t datalen)</td></tr>
<tr class="memdesc:a1559c9411a941208a71d89a69bf249af"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes an existing script in cstring form and appends an operation to push a specified buffer of data to the stack.  <a href="script_8c.html#a1559c9411a941208a71d89a69bf249af">More...</a><br /></td></tr>
<tr class="separator:a1559c9411a941208a71d89a69bf249af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac1841b84fa45a6faf1c2d67efb68201"><td class="memItemLeft" align="right" valign="top"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#aac1841b84fa45a6faf1c2d67efb68201">dogecoin_script_build_multisig</a> (<a class="el" href="structcstring.html">cstring</a> *script_in, const unsigned int required_signatures, const <a class="el" href="structvector.html">vector</a> *pubkeys_chars)</td></tr>
<tr class="memdesc:aac1841b84fa45a6faf1c2d67efb68201"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes a vector of dogecoin_pubkeys and builds a multisig script which pushes all pubkeys to the stack and checks that each one is valid.  <a href="script_8c.html#aac1841b84fa45a6faf1c2d67efb68201">More...</a><br /></td></tr>
<tr class="separator:aac1841b84fa45a6faf1c2d67efb68201"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3991a585f844969dcebd58651ec8a26f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a3991a585f844969dcebd58651ec8a26f">dogecoin_script_build_p2pkh</a> (<a class="el" href="structcstring.html">cstring</a> *script_in, const <a class="el" href="dogecoin_8h.html#aab46d644720ff920e4a685bcaed2ae6b">uint160</a> hash160)</td></tr>
<tr class="memdesc:a3991a585f844969dcebd58651ec8a26f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function builds a pay-to-public-key-hash script which duplicates the value at the top of the stack (a public key), hashes this value, checks that this hash equals the given uint160 object, and verifies the signature. This script is then loaded into the cstring script_in.  <a href="script_8c.html#a3991a585f844969dcebd58651ec8a26f">More...</a><br /></td></tr>
<tr class="separator:a3991a585f844969dcebd58651ec8a26f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31453fc5431fc388746655e60e800969"><td class="memItemLeft" align="right" valign="top"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a31453fc5431fc388746655e60e800969">dogecoin_script_build_p2sh</a> (<a class="el" href="structcstring.html">cstring</a> *script_in, const <a class="el" href="dogecoin_8h.html#aab46d644720ff920e4a685bcaed2ae6b">uint160</a> hash160)</td></tr>
<tr class="memdesc:a31453fc5431fc388746655e60e800969"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function builds a pay-to-script-hash script which hashes the value on the top of the stack (script data) and ensures that this equals the uint160 object given. The script is then loaded into the cstring script_in.  <a href="script_8c.html#a31453fc5431fc388746655e60e800969">More...</a><br /></td></tr>
<tr class="separator:a31453fc5431fc388746655e60e800969"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67d329ca5e5d4abefb45ea9ea949ec59"><td class="memItemLeft" align="right" valign="top"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a67d329ca5e5d4abefb45ea9ea949ec59">dogecoin_script_get_scripthash</a> (const <a class="el" href="structcstring.html">cstring</a> *script_in, <a class="el" href="dogecoin_8h.html#aab46d644720ff920e4a685bcaed2ae6b">uint160</a> scripthash)</td></tr>
<tr class="memdesc:a67d329ca5e5d4abefb45ea9ea949ec59"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes a script, computes its hash, and returns it as a uint160 object.  <a href="script_8c.html#a67d329ca5e5d4abefb45ea9ea949ec59">More...</a><br /></td></tr>
<tr class="separator:a67d329ca5e5d4abefb45ea9ea949ec59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a277f223fd0d455f2b382e0eada40329b"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a277f223fd0d455f2b382e0eada40329b">dogecoin_tx_out_type_to_str</a> (const enum <a class="el" href="script_8h.html#ab75ea367046ee2a256023effe4574b1b">dogecoin_tx_out_type</a> type)</td></tr>
<tr class="memdesc:a277f223fd0d455f2b382e0eada40329b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes a script type and translates it into string format.  <a href="script_8c.html#a277f223fd0d455f2b382e0eada40329b">More...</a><br /></td></tr>
<tr class="separator:a277f223fd0d455f2b382e0eada40329b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8d192087731cb15526f5232a503c6d69" name="a8d192087731cb15526f5232a503c6d69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d192087731cb15526f5232a503c6d69">&#9670;&nbsp;</a></span>dogecoin_encode_op_n()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a> dogecoin_encode_op_n </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes an int and translates it to a small int opcode if it is between 0 and 16, inclusive. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>The number of the desired small int opcode.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The small int opcode. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00508">508</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  509</span>{</div>
<div class="line"><span class="lineno">  510</span>    assert(n &gt;= 0 &amp;&amp; n &lt;= 16);</div>
<div class="line"><span class="lineno">  511</span>    <span class="keywordflow">if</span> (n == 0)</div>
<div class="line"><span class="lineno">  512</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaccd484dad2223fffdbdc2637c4f1e40e">OP_0</a>;</div>
<div class="line"><span class="lineno">  513</span>    <span class="keywordflow">return</span> (<span class="keyword">enum</span> <a class="code hl_enumeration" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a>)(<a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda7e89d91965ffa7edb7733a5e9bf8a9f3">OP_1</a> + n - 1);</div>
<div class="line"><span class="lineno">  514</span>}</div>
<div class="ttc" id="ascript_8h_html_a63e349a6089a54da9fe09a3d858648bd"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a></div><div class="ttdeci">opcodetype</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00054">script.h:54</a></div></div>
<div class="ttc" id="ascript_8h_html_a63e349a6089a54da9fe09a3d858648bda7e89d91965ffa7edb7733a5e9bf8a9f3"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda7e89d91965ffa7edb7733a5e9bf8a9f3">OP_1</a></div><div class="ttdeci">@ OP_1</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00063">script.h:63</a></div></div>
<div class="ttc" id="ascript_8h_html_a63e349a6089a54da9fe09a3d858648bdaccd484dad2223fffdbdc2637c4f1e40e"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaccd484dad2223fffdbdc2637c4f1e40e">OP_0</a></div><div class="ttdeci">@ OP_0</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00056">script.h:56</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="script_8h_source.html#l00056">OP_0</a>, and <a class="el" href="script_8h_source.html#l00063">OP_1</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00574">dogecoin_script_build_multisig()</a>.</p>

</div>
</div>
<a id="a3b0626c2f7ba76d34c798a8bdd24b9b4" name="a3b0626c2f7ba76d34c798a8bdd24b9b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b0626c2f7ba76d34c798a8bdd24b9b4">&#9670;&nbsp;</a></span>dogecoin_script_append_op()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dogecoin_script_append_op </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a>&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes an existing script in cstring form and appends another script operation to it. No data is pushed to the stack. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script_in</td><td>The pointer to the cstring containing the script. </td></tr>
    <tr><td class="paramname">op</td><td>The opcode to append.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Nothing. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00527">527</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  528</span>{</div>
<div class="line"><span class="lineno">  529</span>    <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_in, &amp;op, 1);</div>
<div class="line"><span class="lineno">  530</span>}</div>
<div class="ttc" id="acstr_8c_html_a4932f17c7ec853057cd0614dcd69724f"><div class="ttname"><a href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a></div><div class="ttdeci">int cstr_append_buf(cstring *s, const void *buf, size_t sz)</div><div class="ttdoc">This function appends the contents of a buffer to the buffer of the specified cstring,...</div><div class="ttdef"><b>Definition:</b> <a href="cstr_8c_source.html#l00235">cstr.c:235</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cstr_8c_source.html#l00235">cstr_append_buf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00544">dogecoin_script_append_pushdata()</a>, <a class="el" href="script_8c_source.html#l00611">dogecoin_script_build_p2pkh()</a>, <a class="el" href="script_8c_source.html#l00638">dogecoin_script_build_p2sh()</a>, <a class="el" href="tx_8c_source.html#l00849">dogecoin_tx_add_data_out()</a>, and <a class="el" href="tx_8c_source.html#l00878">dogecoin_tx_add_puzzle_out()</a>.</p>

</div>
</div>
<a id="a1559c9411a941208a71d89a69bf249af" name="a1559c9411a941208a71d89a69bf249af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1559c9411a941208a71d89a69bf249af">&#9670;&nbsp;</a></span>dogecoin_script_append_pushdata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dogecoin_script_append_pushdata </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>datalen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes an existing script in cstring form and appends an operation to push a specified buffer of data to the stack. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script_in</td><td>The pointer to the cstring containing the script. </td></tr>
    <tr><td class="paramname">data</td><td>The buffer to be pushed in the push operation. </td></tr>
    <tr><td class="paramname">datalen</td><td>The size in bytes of the buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Nothing. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00544">544</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  545</span>{</div>
<div class="line"><span class="lineno">  546</span>    <span class="keywordflow">if</span> (datalen &lt; <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941">OP_PUSHDATA1</a>) {</div>
<div class="line"><span class="lineno">  547</span>        <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_in, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)&amp;datalen, 1);</div>
<div class="line"><span class="lineno">  548</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datalen &lt;= 0xff) {</div>
<div class="line"><span class="lineno">  549</span>        <a class="code hl_function" href="script_8c.html#a3b0626c2f7ba76d34c798a8bdd24b9b4">dogecoin_script_append_op</a>(script_in, <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941">OP_PUSHDATA1</a>);</div>
<div class="line"><span class="lineno">  550</span>        <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_in, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)&amp;datalen, 1);</div>
<div class="line"><span class="lineno">  551</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datalen &lt;= 0xffff) {</div>
<div class="line"><span class="lineno">  552</span>        <a class="code hl_function" href="script_8c.html#a3b0626c2f7ba76d34c798a8bdd24b9b4">dogecoin_script_append_op</a>(script_in, <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdac494676b542e0b7fb882a72f3f42fe46">OP_PUSHDATA2</a>);</div>
<div class="line"><span class="lineno">  553</span>        <a class="code hl_typedef" href="winunistd_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> v = htole16((<a class="code hl_typedef" href="winunistd_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a>)datalen);</div>
<div class="line"><span class="lineno">  554</span>        <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_in, &amp;v, <span class="keyword">sizeof</span>(v));</div>
<div class="line"><span class="lineno">  555</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  556</span>        <a class="code hl_function" href="script_8c.html#a3b0626c2f7ba76d34c798a8bdd24b9b4">dogecoin_script_append_op</a>(script_in, <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02">OP_PUSHDATA4</a>);</div>
<div class="line"><span class="lineno">  557</span>        <a class="code hl_typedef" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> v = htole32((<a class="code hl_typedef" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>)datalen);</div>
<div class="line"><span class="lineno">  558</span>        <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_in, &amp;v, <span class="keyword">sizeof</span>(v));</div>
<div class="line"><span class="lineno">  559</span>    }</div>
<div class="line"><span class="lineno">  560</span>    <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_in, data, datalen);</div>
<div class="line"><span class="lineno">  561</span>}</div>
<div class="ttc" id="ascript_8c_html_a3b0626c2f7ba76d34c798a8bdd24b9b4"><div class="ttname"><a href="script_8c.html#a3b0626c2f7ba76d34c798a8bdd24b9b4">dogecoin_script_append_op</a></div><div class="ttdeci">void dogecoin_script_append_op(cstring *script_in, enum opcodetype op)</div><div class="ttdoc">This function takes an existing script in cstring form and appends another script operation to it....</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00527">script.c:527</a></div></div>
<div class="ttc" id="ascript_8h_html_a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02">OP_PUSHDATA4</a></div><div class="ttdeci">@ OP_PUSHDATA4</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00060">script.h:60</a></div></div>
<div class="ttc" id="ascript_8h_html_a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941">OP_PUSHDATA1</a></div><div class="ttdeci">@ OP_PUSHDATA1</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00058">script.h:58</a></div></div>
<div class="ttc" id="ascript_8h_html_a63e349a6089a54da9fe09a3d858648bdac494676b542e0b7fb882a72f3f42fe46"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdac494676b542e0b7fb882a72f3f42fe46">OP_PUSHDATA2</a></div><div class="ttdeci">@ OP_PUSHDATA2</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00059">script.h:59</a></div></div>
<div class="ttc" id="awinunistd_8h_html_a30af71eaf40c925c9832eb289a48da35"><div class="ttname"><a href="winunistd_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a></div><div class="ttdeci">unsigned __int16 uint16_t</div><div class="ttdef"><b>Definition:</b> <a href="winunistd_8h_source.html#l00057">winunistd.h:57</a></div></div>
<div class="ttc" id="awinunistd_8h_html_a6eb1e68cc391dd753bc8ce896dbb8315"><div class="ttname"><a href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a></div><div class="ttdeci">unsigned __int32 uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="winunistd_8h_source.html#l00058">winunistd.h:58</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cstr_8c_source.html#l00235">cstr_append_buf()</a>, <a class="el" href="script_8c_source.html#l00527">dogecoin_script_append_op()</a>, <a class="el" href="script_8h_source.html#l00058">OP_PUSHDATA1</a>, <a class="el" href="script_8h_source.html#l00059">OP_PUSHDATA2</a>, and <a class="el" href="script_8h_source.html#l00060">OP_PUSHDATA4</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00574">dogecoin_script_build_multisig()</a>, <a class="el" href="script_8c_source.html#l00611">dogecoin_script_build_p2pkh()</a>, <a class="el" href="script_8c_source.html#l00638">dogecoin_script_build_p2sh()</a>, <a class="el" href="tx_8c_source.html#l00849">dogecoin_tx_add_data_out()</a>, and <a class="el" href="tx_8c_source.html#l00878">dogecoin_tx_add_puzzle_out()</a>.</p>

</div>
</div>
<a id="aac1841b84fa45a6faf1c2d67efb68201" name="aac1841b84fa45a6faf1c2d67efb68201"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac1841b84fa45a6faf1c2d67efb68201">&#9670;&nbsp;</a></span>dogecoin_script_build_multisig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a> dogecoin_script_build_multisig </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>required_signatures</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>pubkeys_chars</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes a vector of dogecoin_pubkeys and builds a multisig script which pushes all pubkeys to the stack and checks that each one is valid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script_in</td><td>The pointer to the cstring where the new multisig script will be built. </td></tr>
    <tr><td class="paramname">required_signatures</td><td>The number of required signatures. </td></tr>
    <tr><td class="paramname">pubkeys_chars</td><td>The pointer to the vector of pubkey push operations to combine into the multisig.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the script was built successfully, 0 if more than 16 pubkeys are given. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00574">574</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  575</span>{</div>
<div class="line"><span class="lineno">  576</span>    <a class="code hl_function" href="cstr_8c.html#a44f9375e09ef9407d7132b047cdc36a7">cstr_resize</a>(script_in, 0); <span class="comment">//clear script</span></div>
<div class="line"><span class="lineno">  577</span> </div>
<div class="line"><span class="lineno">  578</span>    <span class="keywordflow">if</span> (required_signatures &gt; 16 || pubkeys_chars-&gt;<a class="code hl_variable" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> &gt; 16)</div>
<div class="line"><span class="lineno">  579</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  580</span>    <span class="keyword">enum</span> <a class="code hl_enumeration" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a> op_req_sig = <a class="code hl_function" href="script_8c.html#a8d192087731cb15526f5232a503c6d69">dogecoin_encode_op_n</a>(required_signatures);</div>
<div class="line"><span class="lineno">  581</span>    <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_in, &amp;op_req_sig, 1);</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  584</span>    <span class="keywordflow">for</span> (i = 0; i &lt; (int)pubkeys_chars-&gt;<a class="code hl_variable" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a>; i++) {</div>
<div class="line"><span class="lineno">  585</span>        <a class="code hl_struct" href="structdogecoin__pubkey__.html">dogecoin_pubkey</a>* pkey = pubkeys_chars-&gt;<a class="code hl_variable" href="structvector.html#a352aaf0cff9c642a2bf79d34d6d554d0">data</a>[i];</div>
<div class="line"><span class="lineno">  586</span>        <a class="code hl_function" href="script_8c.html#a1559c9411a941208a71d89a69bf249af">dogecoin_script_append_pushdata</a>(script_in, pkey-&gt;<a class="code hl_variable" href="structdogecoin__pubkey__.html#add150be281302a2a0fcf673f2504a110">pubkey</a>, (pkey-&gt;<a class="code hl_variable" href="structdogecoin__pubkey__.html#ada76b51286f1eb36ff73f174baa18388">compressed</a> ? <a class="code hl_define" href="dogecoin_8h.html#a67a3532477449dfadd603c67051cf842">DOGECOIN_ECKEY_COMPRESSED_LENGTH</a> : <a class="code hl_define" href="dogecoin_8h.html#abfdcb34512fe1053aad2cbb8f216e2ec">DOGECOIN_ECKEY_UNCOMPRESSED_LENGTH</a>));</div>
<div class="line"><span class="lineno">  587</span>    }</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span>    <span class="keyword">enum</span> <a class="code hl_enumeration" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a> op_pub_len = <a class="code hl_function" href="script_8c.html#a8d192087731cb15526f5232a503c6d69">dogecoin_encode_op_n</a>(pubkeys_chars-&gt;<a class="code hl_variable" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a>);</div>
<div class="line"><span class="lineno">  590</span>    <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_in, &amp;op_pub_len, 1);</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>    <span class="keyword">enum</span> <a class="code hl_enumeration" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a> op_checkmultisig = <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda237677a3bb15c383d342aa297e7e9526">OP_CHECKMULTISIG</a>;</div>
<div class="line"><span class="lineno">  593</span>    <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_in, &amp;op_checkmultisig, 1);</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  596</span>}</div>
<div class="ttc" id="acstr_8c_html_a44f9375e09ef9407d7132b047cdc36a7"><div class="ttname"><a href="cstr_8c.html#a44f9375e09ef9407d7132b047cdc36a7">cstr_resize</a></div><div class="ttdeci">int cstr_resize(cstring *s, size_t new_sz)</div><div class="ttdoc">This function resizes the buffer inside cstring object.</div><div class="ttdef"><b>Definition:</b> <a href="cstr_8c_source.html#l00196">cstr.c:196</a></div></div>
<div class="ttc" id="adogecoin_8h_html_a67a3532477449dfadd603c67051cf842"><div class="ttname"><a href="dogecoin_8h.html#a67a3532477449dfadd603c67051cf842">DOGECOIN_ECKEY_COMPRESSED_LENGTH</a></div><div class="ttdeci">#define DOGECOIN_ECKEY_COMPRESSED_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="dogecoin_8h_source.html#l00123">dogecoin.h:123</a></div></div>
<div class="ttc" id="adogecoin_8h_html_abfdcb34512fe1053aad2cbb8f216e2ec"><div class="ttname"><a href="dogecoin_8h.html#abfdcb34512fe1053aad2cbb8f216e2ec">DOGECOIN_ECKEY_UNCOMPRESSED_LENGTH</a></div><div class="ttdeci">#define DOGECOIN_ECKEY_UNCOMPRESSED_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="dogecoin_8h_source.html#l00122">dogecoin.h:122</a></div></div>
<div class="ttc" id="ascript_8c_html_a1559c9411a941208a71d89a69bf249af"><div class="ttname"><a href="script_8c.html#a1559c9411a941208a71d89a69bf249af">dogecoin_script_append_pushdata</a></div><div class="ttdeci">void dogecoin_script_append_pushdata(cstring *script_in, const unsigned char *data, const size_t datalen)</div><div class="ttdoc">This function takes an existing script in cstring form and appends an operation to push a specified b...</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00544">script.c:544</a></div></div>
<div class="ttc" id="ascript_8c_html_a8d192087731cb15526f5232a503c6d69"><div class="ttname"><a href="script_8c.html#a8d192087731cb15526f5232a503c6d69">dogecoin_encode_op_n</a></div><div class="ttdeci">enum opcodetype dogecoin_encode_op_n(const int n)</div><div class="ttdoc">This function takes an int and translates it to a small int opcode if it is between 0 and 16,...</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00508">script.c:508</a></div></div>
<div class="ttc" id="ascript_8h_html_a63e349a6089a54da9fe09a3d858648bda237677a3bb15c383d342aa297e7e9526"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda237677a3bb15c383d342aa297e7e9526">OP_CHECKMULTISIG</a></div><div class="ttdeci">@ OP_CHECKMULTISIG</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00172">script.h:172</a></div></div>
<div class="ttc" id="astructdogecoin__pubkey___html"><div class="ttname"><a href="structdogecoin__pubkey__.html">dogecoin_pubkey_</a></div><div class="ttdef"><b>Definition:</b> <a href="key_8h_source.html#l00042">key.h:42</a></div></div>
<div class="ttc" id="astructdogecoin__pubkey___html_ada76b51286f1eb36ff73f174baa18388"><div class="ttname"><a href="structdogecoin__pubkey__.html#ada76b51286f1eb36ff73f174baa18388">dogecoin_pubkey_::compressed</a></div><div class="ttdeci">dogecoin_bool compressed</div><div class="ttdef"><b>Definition:</b> <a href="key_8h_source.html#l00043">key.h:43</a></div></div>
<div class="ttc" id="astructdogecoin__pubkey___html_add150be281302a2a0fcf673f2504a110"><div class="ttname"><a href="structdogecoin__pubkey__.html#add150be281302a2a0fcf673f2504a110">dogecoin_pubkey_::pubkey</a></div><div class="ttdeci">uint8_t pubkey[DOGECOIN_ECKEY_UNCOMPRESSED_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="key_8h_source.html#l00044">key.h:44</a></div></div>
<div class="ttc" id="astructvector_html_a352aaf0cff9c642a2bf79d34d6d554d0"><div class="ttname"><a href="structvector.html#a352aaf0cff9c642a2bf79d34d6d554d0">vector::data</a></div><div class="ttdeci">void ** data</div><div class="ttdef"><b>Definition:</b> <a href="vector_8h_source.html#l00037">vector.h:37</a></div></div>
<div class="ttc" id="astructvector_html_abac364f9d74e0d6610c988003be1d167"><div class="ttname"><a href="structvector.html#abac364f9d74e0d6610c988003be1d167">vector::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="vector_8h_source.html#l00038">vector.h:38</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="key_8h_source.html#l00043">dogecoin_pubkey_::compressed</a>, <a class="el" href="cstr_8c_source.html#l00235">cstr_append_buf()</a>, <a class="el" href="cstr_8c_source.html#l00196">cstr_resize()</a>, <a class="el" href="vector_8h_source.html#l00037">vector::data</a>, <a class="el" href="dogecoin_8h_source.html#l00123">DOGECOIN_ECKEY_COMPRESSED_LENGTH</a>, <a class="el" href="dogecoin_8h_source.html#l00122">DOGECOIN_ECKEY_UNCOMPRESSED_LENGTH</a>, <a class="el" href="script_8c_source.html#l00508">dogecoin_encode_op_n()</a>, <a class="el" href="script_8c_source.html#l00544">dogecoin_script_append_pushdata()</a>, <a class="el" href="vector_8h_source.html#l00038">vector::len</a>, <a class="el" href="script_8h_source.html#l00172">OP_CHECKMULTISIG</a>, and <a class="el" href="key_8h_source.html#l00044">dogecoin_pubkey_::pubkey</a>.</p>

</div>
</div>
<a id="a3991a585f844969dcebd58651ec8a26f" name="a3991a585f844969dcebd58651ec8a26f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3991a585f844969dcebd58651ec8a26f">&#9670;&nbsp;</a></span>dogecoin_script_build_p2pkh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a> dogecoin_script_build_p2pkh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="dogecoin_8h.html#aab46d644720ff920e4a685bcaed2ae6b">uint160</a>&#160;</td>
          <td class="paramname"><em>hash160</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function builds a pay-to-public-key-hash script which duplicates the value at the top of the stack (a public key), hashes this value, checks that this hash equals the given uint160 object, and verifies the signature. This script is then loaded into the cstring script_in. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script_in</td><td>The pointer to the cstring where the p2pkh script will be built. </td></tr>
    <tr><td class="paramname">hash160</td><td>The hash160 of a public key.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the p2pkh script was built successfully. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00611">611</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  612</span>{</div>
<div class="line"><span class="lineno">  613</span>    <a class="code hl_function" href="cstr_8c.html#a44f9375e09ef9407d7132b047cdc36a7">cstr_resize</a>(script_in, 0); <span class="comment">//clear script</span></div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>    <a class="code hl_function" href="script_8c.html#a3b0626c2f7ba76d34c798a8bdd24b9b4">dogecoin_script_append_op</a>(script_in, <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda47360cbb2e673baa31591adbb153c9b3">OP_DUP</a>);</div>
<div class="line"><span class="lineno">  616</span>    <a class="code hl_function" href="script_8c.html#a3b0626c2f7ba76d34c798a8bdd24b9b4">dogecoin_script_append_op</a>(script_in, <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd">OP_HASH160</a>);</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>    <a class="code hl_function" href="script_8c.html#a1559c9411a941208a71d89a69bf249af">dogecoin_script_append_pushdata</a>(script_in, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)hash160, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="dogecoin_8h.html#aab46d644720ff920e4a685bcaed2ae6b">uint160</a>));</div>
<div class="line"><span class="lineno">  620</span>    <a class="code hl_function" href="script_8c.html#a3b0626c2f7ba76d34c798a8bdd24b9b4">dogecoin_script_append_op</a>(script_in, <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdae24d4b553a43d3d57bbac4d9bd4bdf24">OP_EQUALVERIFY</a>);</div>
<div class="line"><span class="lineno">  621</span>    <a class="code hl_function" href="script_8c.html#a3b0626c2f7ba76d34c798a8bdd24b9b4">dogecoin_script_append_op</a>(script_in, <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda2c190c5caf052f92d3d9ac31a0d96151">OP_CHECKSIG</a>);</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  624</span>}</div>
<div class="ttc" id="adogecoin_8h_html_aab46d644720ff920e4a685bcaed2ae6b"><div class="ttname"><a href="dogecoin_8h.html#aab46d644720ff920e4a685bcaed2ae6b">uint160</a></div><div class="ttdeci">uint8_t uint160[20]</div><div class="ttdef"><b>Definition:</b> <a href="dogecoin_8h_source.html#l00133">dogecoin.h:133</a></div></div>
<div class="ttc" id="ascript_8h_html_a63e349a6089a54da9fe09a3d858648bda2c190c5caf052f92d3d9ac31a0d96151"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda2c190c5caf052f92d3d9ac31a0d96151">OP_CHECKSIG</a></div><div class="ttdeci">@ OP_CHECKSIG</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00170">script.h:170</a></div></div>
<div class="ttc" id="ascript_8h_html_a63e349a6089a54da9fe09a3d858648bda47360cbb2e673baa31591adbb153c9b3"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda47360cbb2e673baa31591adbb153c9b3">OP_DUP</a></div><div class="ttdeci">@ OP_DUP</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00105">script.h:105</a></div></div>
<div class="ttc" id="ascript_8h_html_a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd">OP_HASH160</a></div><div class="ttdeci">@ OP_HASH160</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00167">script.h:167</a></div></div>
<div class="ttc" id="ascript_8h_html_a63e349a6089a54da9fe09a3d858648bdae24d4b553a43d3d57bbac4d9bd4bdf24"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdae24d4b553a43d3d57bbac4d9bd4bdf24">OP_EQUALVERIFY</a></div><div class="ttdeci">@ OP_EQUALVERIFY</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00127">script.h:127</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cstr_8c_source.html#l00196">cstr_resize()</a>, <a class="el" href="script_8c_source.html#l00527">dogecoin_script_append_op()</a>, <a class="el" href="script_8c_source.html#l00544">dogecoin_script_append_pushdata()</a>, <a class="el" href="script_8h_source.html#l00170">OP_CHECKSIG</a>, <a class="el" href="script_8h_source.html#l00105">OP_DUP</a>, <a class="el" href="script_8h_source.html#l00127">OP_EQUALVERIFY</a>, and <a class="el" href="script_8h_source.html#l00167">OP_HASH160</a>.</p>

<p class="reference">Referenced by <a class="el" href="tx_8c_source.html#l00933">dogecoin_tx_add_p2pkh_hash160_out()</a>.</p>

</div>
</div>
<a id="a31453fc5431fc388746655e60e800969" name="a31453fc5431fc388746655e60e800969"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31453fc5431fc388746655e60e800969">&#9670;&nbsp;</a></span>dogecoin_script_build_p2sh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a> dogecoin_script_build_p2sh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="dogecoin_8h.html#aab46d644720ff920e4a685bcaed2ae6b">uint160</a>&#160;</td>
          <td class="paramname"><em>hash160</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function builds a pay-to-script-hash script which hashes the value on the top of the stack (script data) and ensures that this equals the uint160 object given. The script is then loaded into the cstring script_in. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script_in</td><td>The pointer to the cstring where the p2sh script will be built. </td></tr>
    <tr><td class="paramname">hash160</td><td>The hash160 of a public key.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the p2sh script was built successfully. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00638">638</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  639</span>{</div>
<div class="line"><span class="lineno">  640</span>    <a class="code hl_function" href="cstr_8c.html#a44f9375e09ef9407d7132b047cdc36a7">cstr_resize</a>(script_in, 0); <span class="comment">//clear script</span></div>
<div class="line"><span class="lineno">  641</span>    <a class="code hl_function" href="script_8c.html#a3b0626c2f7ba76d34c798a8bdd24b9b4">dogecoin_script_append_op</a>(script_in, <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd">OP_HASH160</a>);</div>
<div class="line"><span class="lineno">  642</span>    <a class="code hl_function" href="script_8c.html#a1559c9411a941208a71d89a69bf249af">dogecoin_script_append_pushdata</a>(script_in, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)hash160, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="dogecoin_8h.html#aab46d644720ff920e4a685bcaed2ae6b">uint160</a>));</div>
<div class="line"><span class="lineno">  643</span>    <a class="code hl_function" href="script_8c.html#a3b0626c2f7ba76d34c798a8bdd24b9b4">dogecoin_script_append_op</a>(script_in, <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda383e0c5476b2ddc1839af951b393ca17">OP_EQUAL</a>);</div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  646</span>}</div>
<div class="ttc" id="ascript_8h_html_a63e349a6089a54da9fe09a3d858648bda383e0c5476b2ddc1839af951b393ca17"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda383e0c5476b2ddc1839af951b393ca17">OP_EQUAL</a></div><div class="ttdeci">@ OP_EQUAL</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00126">script.h:126</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cstr_8c_source.html#l00196">cstr_resize()</a>, <a class="el" href="script_8c_source.html#l00527">dogecoin_script_append_op()</a>, <a class="el" href="script_8c_source.html#l00544">dogecoin_script_append_pushdata()</a>, <a class="el" href="script_8h_source.html#l00126">OP_EQUAL</a>, and <a class="el" href="script_8h_source.html#l00167">OP_HASH160</a>.</p>

<p class="reference">Referenced by <a class="el" href="tx_8c_source.html#l00954">dogecoin_tx_add_p2sh_hash160_out()</a>.</p>

</div>
</div>
<a id="a5e4fc90d9aed02c197383d3c368a494e" name="a5e4fc90d9aed02c197383d3c368a494e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e4fc90d9aed02c197383d3c368a494e">&#9670;&nbsp;</a></span>dogecoin_script_classify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="script_8h.html#ab75ea367046ee2a256023effe4574b1b">dogecoin_tx_out_type</a> dogecoin_script_classify </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>data_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes a cstring representation of a script, classifies it as one of the four script types and loads the script data into data_out if it is not a multisig script. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script</td><td>The pointer to the cstring script to be parsed and classified. </td></tr>
    <tr><td class="paramname">data_out</td><td>The pointer to the vector that will contain the parsed scripts.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The script type. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00477">477</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  478</span>{</div>
<div class="line"><span class="lineno">  479</span>    <span class="comment">//INFO: could be speed up by not forming a vector</span></div>
<div class="line"><span class="lineno">  480</span>    <span class="comment">//      and directly parse the script cstring</span></div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>    <span class="keyword">enum</span> <a class="code hl_enumeration" href="script_8h.html#ab75ea367046ee2a256023effe4574b1b">dogecoin_tx_out_type</a> tx_out_type = <a class="code hl_enumvalue" href="script_8h.html#ab75ea367046ee2a256023effe4574b1bac59118d720ebe8419c6e2f8a98f3fc3a">DOGECOIN_TX_NONSTANDARD</a>;</div>
<div class="line"><span class="lineno">  483</span>    <a class="code hl_struct" href="structvector.html">vector</a>* ops = <a class="code hl_function" href="vector_8c.html#a1978f60d7ec6f124a85f616016d86465">vector_new</a>(10, <a class="code hl_function" href="script_8c.html#acbb7e12c33b946ecd164a4d1fceba82a">dogecoin_script_op_free_cb</a>);</div>
<div class="line"><span class="lineno">  484</span>    <a class="code hl_function" href="script_8c.html#a835fa79c6c664fbc646dd02cffb43e0a">dogecoin_script_get_ops</a>(script, ops);</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="script_8c.html#aa4d9698dde44c7c7b1698840b497a8bb">dogecoin_script_is_pubkeyhash</a>(ops, data_out))</div>
<div class="line"><span class="lineno">  487</span>        tx_out_type = <a class="code hl_enumvalue" href="script_8h.html#ab75ea367046ee2a256023effe4574b1badb7c91a93818352c5026868e19746ca0">DOGECOIN_TX_PUBKEYHASH</a>;</div>
<div class="line"><span class="lineno">  488</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="script_8c.html#a56862b180a334357cf320d863ce9519c">dogecoin_script_is_scripthash</a>(ops, data_out))</div>
<div class="line"><span class="lineno">  489</span>        tx_out_type = <a class="code hl_enumvalue" href="script_8h.html#ab75ea367046ee2a256023effe4574b1ba281feb54432e7fa9c0088ae3995c6afb">DOGECOIN_TX_SCRIPTHASH</a>;</div>
<div class="line"><span class="lineno">  490</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="script_8c.html#a7650d6ca38c4502fb27b6c872da9ef6b">dogecoin_script_is_pubkey</a>(ops, data_out))</div>
<div class="line"><span class="lineno">  491</span>        tx_out_type = <a class="code hl_enumvalue" href="script_8h.html#ab75ea367046ee2a256023effe4574b1ba6028ea503a8ea55b9e915dbb5376a6b9">DOGECOIN_TX_PUBKEY</a>;</div>
<div class="line"><span class="lineno">  492</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="script_8c.html#aa9d6b3f63ad8603c55d8ed5770a4097b">dogecoin_script_is_multisig</a>(ops))</div>
<div class="line"><span class="lineno">  493</span>        tx_out_type = <a class="code hl_enumvalue" href="script_8h.html#ab75ea367046ee2a256023effe4574b1ba06df59536e9760aaae2db2a617544f4f">DOGECOIN_TX_MULTISIG</a>;</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>    <a class="code hl_function" href="vector_8c.html#a5e270a6352fd1adc4ae8b000fc939348">vector_free</a>(ops, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  496</span>    <span class="keywordflow">return</span> tx_out_type;</div>
<div class="line"><span class="lineno">  497</span>}</div>
<div class="ttc" id="ascript_8c_html_a56862b180a334357cf320d863ce9519c"><div class="ttname"><a href="script_8c.html#a56862b180a334357cf320d863ce9519c">dogecoin_script_is_scripthash</a></div><div class="ttdeci">dogecoin_bool dogecoin_script_is_scripthash(const vector *ops, vector *data_out)</div><div class="ttdoc">This function checks whether the script matches the template for a script hash, which is composed of ...</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00379">script.c:379</a></div></div>
<div class="ttc" id="ascript_8c_html_a7650d6ca38c4502fb27b6c872da9ef6b"><div class="ttname"><a href="script_8c.html#a7650d6ca38c4502fb27b6c872da9ef6b">dogecoin_script_is_pubkey</a></div><div class="ttdeci">dogecoin_bool dogecoin_script_is_pubkey(const vector *ops, vector *data_out)</div><div class="ttdoc">This function checks whether the script matches the template for a pubkey script, which is composed o...</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00318">script.c:318</a></div></div>
<div class="ttc" id="ascript_8c_html_a835fa79c6c664fbc646dd02cffb43e0a"><div class="ttname"><a href="script_8c.html#a835fa79c6c664fbc646dd02cffb43e0a">dogecoin_script_get_ops</a></div><div class="ttdeci">dogecoin_bool dogecoin_script_get_ops(const cstring *script_in, vector *ops_out)</div><div class="ttdoc">This function converts a cstring script into a vector of dogecoin_script_op objects.</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00171">script.c:171</a></div></div>
<div class="ttc" id="ascript_8c_html_aa4d9698dde44c7c7b1698840b497a8bb"><div class="ttname"><a href="script_8c.html#aa4d9698dde44c7c7b1698840b497a8bb">dogecoin_script_is_pubkeyhash</a></div><div class="ttdeci">dogecoin_bool dogecoin_script_is_pubkeyhash(const vector *ops, vector *data_out)</div><div class="ttdoc">This function checks whether the script matches the template for a pubkey hash script,...</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00347">script.c:347</a></div></div>
<div class="ttc" id="ascript_8c_html_aa9d6b3f63ad8603c55d8ed5770a4097b"><div class="ttname"><a href="script_8c.html#aa9d6b3f63ad8603c55d8ed5770a4097b">dogecoin_script_is_multisig</a></div><div class="ttdeci">dogecoin_bool dogecoin_script_is_multisig(const vector *ops)</div><div class="ttdoc">This function checks whether a script is a multisig script, which is true if the vector is composed o...</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00426">script.c:426</a></div></div>
<div class="ttc" id="ascript_8c_html_acbb7e12c33b946ecd164a4d1fceba82a"><div class="ttname"><a href="script_8c.html#acbb7e12c33b946ecd164a4d1fceba82a">dogecoin_script_op_free_cb</a></div><div class="ttdeci">void dogecoin_script_op_free_cb(void *data)</div><div class="ttdoc">This function casts data from a channel buffer to a dogecoin_script_op object and then frees it by ca...</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00153">script.c:153</a></div></div>
<div class="ttc" id="ascript_8h_html_ab75ea367046ee2a256023effe4574b1b"><div class="ttname"><a href="script_8h.html#ab75ea367046ee2a256023effe4574b1b">dogecoin_tx_out_type</a></div><div class="ttdeci">dogecoin_tx_out_type</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00197">script.h:197</a></div></div>
<div class="ttc" id="ascript_8h_html_ab75ea367046ee2a256023effe4574b1ba06df59536e9760aaae2db2a617544f4f"><div class="ttname"><a href="script_8h.html#ab75ea367046ee2a256023effe4574b1ba06df59536e9760aaae2db2a617544f4f">DOGECOIN_TX_MULTISIG</a></div><div class="ttdeci">@ DOGECOIN_TX_MULTISIG</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00204">script.h:204</a></div></div>
<div class="ttc" id="ascript_8h_html_ab75ea367046ee2a256023effe4574b1ba281feb54432e7fa9c0088ae3995c6afb"><div class="ttname"><a href="script_8h.html#ab75ea367046ee2a256023effe4574b1ba281feb54432e7fa9c0088ae3995c6afb">DOGECOIN_TX_SCRIPTHASH</a></div><div class="ttdeci">@ DOGECOIN_TX_SCRIPTHASH</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00203">script.h:203</a></div></div>
<div class="ttc" id="ascript_8h_html_ab75ea367046ee2a256023effe4574b1ba6028ea503a8ea55b9e915dbb5376a6b9"><div class="ttname"><a href="script_8h.html#ab75ea367046ee2a256023effe4574b1ba6028ea503a8ea55b9e915dbb5376a6b9">DOGECOIN_TX_PUBKEY</a></div><div class="ttdeci">@ DOGECOIN_TX_PUBKEY</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00201">script.h:201</a></div></div>
<div class="ttc" id="ascript_8h_html_ab75ea367046ee2a256023effe4574b1bac59118d720ebe8419c6e2f8a98f3fc3a"><div class="ttname"><a href="script_8h.html#ab75ea367046ee2a256023effe4574b1bac59118d720ebe8419c6e2f8a98f3fc3a">DOGECOIN_TX_NONSTANDARD</a></div><div class="ttdeci">@ DOGECOIN_TX_NONSTANDARD</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00199">script.h:199</a></div></div>
<div class="ttc" id="ascript_8h_html_ab75ea367046ee2a256023effe4574b1badb7c91a93818352c5026868e19746ca0"><div class="ttname"><a href="script_8h.html#ab75ea367046ee2a256023effe4574b1badb7c91a93818352c5026868e19746ca0">DOGECOIN_TX_PUBKEYHASH</a></div><div class="ttdeci">@ DOGECOIN_TX_PUBKEYHASH</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00202">script.h:202</a></div></div>
<div class="ttc" id="astructvector_html"><div class="ttname"><a href="structvector.html">vector</a></div><div class="ttdef"><b>Definition:</b> <a href="vector_8h_source.html#l00036">vector.h:36</a></div></div>
<div class="ttc" id="avector_8c_html_a1978f60d7ec6f124a85f616016d86465"><div class="ttname"><a href="vector_8c.html#a1978f60d7ec6f124a85f616016d86465">vector_new</a></div><div class="ttdeci">vector * vector_new(size_t res, void(*free_f)(void *))</div><div class="ttdoc">This function creates a new vector object and initializes it to 0.</div><div class="ttdef"><b>Definition:</b> <a href="vector_8c_source.html#l00042">vector.c:42</a></div></div>
<div class="ttc" id="avector_8c_html_a5e270a6352fd1adc4ae8b000fc939348"><div class="ttname"><a href="vector_8c.html#a5e270a6352fd1adc4ae8b000fc939348">vector_free</a></div><div class="ttdeci">void vector_free(vector *vec, dogecoin_bool free_array)</div><div class="ttdoc">This function frees an entire vector object and all of its elements if specified.</div><div class="ttdef"><b>Definition:</b> <a href="vector_8c_source.html#l00103">vector.c:103</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="script_8c_source.html#l00171">dogecoin_script_get_ops()</a>, <a class="el" href="script_8c_source.html#l00426">dogecoin_script_is_multisig()</a>, <a class="el" href="script_8c_source.html#l00318">dogecoin_script_is_pubkey()</a>, <a class="el" href="script_8c_source.html#l00347">dogecoin_script_is_pubkeyhash()</a>, <a class="el" href="script_8c_source.html#l00379">dogecoin_script_is_scripthash()</a>, <a class="el" href="script_8c_source.html#l00153">dogecoin_script_op_free_cb()</a>, <a class="el" href="script_8h_source.html#l00204">DOGECOIN_TX_MULTISIG</a>, <a class="el" href="script_8h_source.html#l00199">DOGECOIN_TX_NONSTANDARD</a>, <a class="el" href="script_8h_source.html#l00201">DOGECOIN_TX_PUBKEY</a>, <a class="el" href="script_8h_source.html#l00202">DOGECOIN_TX_PUBKEYHASH</a>, <a class="el" href="script_8h_source.html#l00203">DOGECOIN_TX_SCRIPTHASH</a>, <a class="el" href="vector_8c_source.html#l00103">vector_free()</a>, and <a class="el" href="vector_8c_source.html#l00042">vector_new()</a>.</p>

<p class="reference">Referenced by <a class="el" href="tx_8c_source.html#l01064">dogecoin_tx_sign_input()</a>, <a class="el" href="such_8c_source.html#l00668">main()</a>, and <a class="el" href="transaction_8c_source.html#l00479">sign_raw_transaction()</a>.</p>

</div>
</div>
<a id="a8d6b89b42ceddc5e8debbe66fdc55cec" name="a8d6b89b42ceddc5e8debbe66fdc55cec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d6b89b42ceddc5e8debbe66fdc55cec">&#9670;&nbsp;</a></span>dogecoin_script_classify_ops()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="script_8h.html#ab75ea367046ee2a256023effe4574b1b">dogecoin_tx_out_type</a> dogecoin_script_classify_ops </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>ops</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function classifies a script as one of four types: pubkey, pubkey hash, script hash, or multisig. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ops</td><td>The pointer to the vector storing the script.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The type of script. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00451">451</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  452</span>{</div>
<div class="line"><span class="lineno">  453</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="script_8c.html#aa4d9698dde44c7c7b1698840b497a8bb">dogecoin_script_is_pubkeyhash</a>(ops, NULL))</div>
<div class="line"><span class="lineno">  454</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="script_8h.html#ab75ea367046ee2a256023effe4574b1badb7c91a93818352c5026868e19746ca0">DOGECOIN_TX_PUBKEYHASH</a>;</div>
<div class="line"><span class="lineno">  455</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="script_8c.html#a56862b180a334357cf320d863ce9519c">dogecoin_script_is_scripthash</a>(ops, NULL))</div>
<div class="line"><span class="lineno">  456</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="script_8h.html#ab75ea367046ee2a256023effe4574b1ba281feb54432e7fa9c0088ae3995c6afb">DOGECOIN_TX_SCRIPTHASH</a>;</div>
<div class="line"><span class="lineno">  457</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="script_8c.html#a7650d6ca38c4502fb27b6c872da9ef6b">dogecoin_script_is_pubkey</a>(ops, NULL))</div>
<div class="line"><span class="lineno">  458</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="script_8h.html#ab75ea367046ee2a256023effe4574b1ba6028ea503a8ea55b9e915dbb5376a6b9">DOGECOIN_TX_PUBKEY</a>;</div>
<div class="line"><span class="lineno">  459</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="script_8c.html#aa9d6b3f63ad8603c55d8ed5770a4097b">dogecoin_script_is_multisig</a>(ops))</div>
<div class="line"><span class="lineno">  460</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="script_8h.html#ab75ea367046ee2a256023effe4574b1ba06df59536e9760aaae2db2a617544f4f">DOGECOIN_TX_MULTISIG</a>;</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="script_8h.html#ab75ea367046ee2a256023effe4574b1bac59118d720ebe8419c6e2f8a98f3fc3a">DOGECOIN_TX_NONSTANDARD</a>;</div>
<div class="line"><span class="lineno">  463</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="script_8c_source.html#l00426">dogecoin_script_is_multisig()</a>, <a class="el" href="script_8c_source.html#l00318">dogecoin_script_is_pubkey()</a>, <a class="el" href="script_8c_source.html#l00347">dogecoin_script_is_pubkeyhash()</a>, <a class="el" href="script_8c_source.html#l00379">dogecoin_script_is_scripthash()</a>, <a class="el" href="script_8h_source.html#l00204">DOGECOIN_TX_MULTISIG</a>, <a class="el" href="script_8h_source.html#l00199">DOGECOIN_TX_NONSTANDARD</a>, <a class="el" href="script_8h_source.html#l00201">DOGECOIN_TX_PUBKEY</a>, <a class="el" href="script_8h_source.html#l00202">DOGECOIN_TX_PUBKEYHASH</a>, and <a class="el" href="script_8h_source.html#l00203">DOGECOIN_TX_SCRIPTHASH</a>.</p>

</div>
</div>
<a id="a89f6522a0ff3e1b5b9ea0135e74985bb" name="a89f6522a0ff3e1b5b9ea0135e74985bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89f6522a0ff3e1b5b9ea0135e74985bb">&#9670;&nbsp;</a></span>dogecoin_script_copy_without_op_codeseperator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a> dogecoin_script_copy_without_op_codeseperator </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function copies a script without the OP_CODESEPARATOR opcode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script_in</td><td>The pointer to the cstring which holds the script to be copied. </td></tr>
    <tr><td class="paramname">script_out</td><td>The pointer to the cstring to hold the script to be created.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if copied successfully, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00050">50</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   51</span>{</div>
<div class="line"><span class="lineno">   52</span>    <span class="keywordflow">if</span> (script_in-&gt;<a class="code hl_variable" href="structcstring.html#ad0eb3a0fea291824cc3a7176a4d6a345">len</a> == 0)</div>
<div class="line"><span class="lineno">   53</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">/* EOF */</span></div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structconst__buffer.html">const_buffer</a> buf = {script_in-&gt;<a class="code hl_variable" href="structcstring.html#a731cdf51b981dfd0c66713e2c942a43d">str</a>, script_in-&gt;<a class="code hl_variable" href="structcstring.html#ad0eb3a0fea291824cc3a7176a4d6a345">len</a>};</div>
<div class="line"><span class="lineno">   56</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> opcode;</div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordflow">while</span> (buf.<a class="code hl_variable" href="structconst__buffer.html#aeea2fa428f380d27375680cc0d7d9952">len</a> &gt; 0) {</div>
<div class="line"><span class="lineno">   58</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="serialize_8c.html#ad82109e83304903ea7939f5c63e7652d">deser_bytes</a>(&amp;opcode, &amp;buf, 1))</div>
<div class="line"><span class="lineno">   59</span>            <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>        <a class="code hl_typedef" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> data_len = 0;</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>        <span class="keywordflow">if</span> (opcode &lt; OP_PUSHDATA1 &amp;&amp; opcode &gt; <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaccd484dad2223fffdbdc2637c4f1e40e">OP_0</a>) {</div>
<div class="line"><span class="lineno">   64</span>            data_len = opcode;</div>
<div class="line"><span class="lineno">   65</span>            <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_out, &amp;opcode, 1);</div>
<div class="line"><span class="lineno">   66</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941">OP_PUSHDATA1</a>) {</div>
<div class="line"><span class="lineno">   67</span>            <a class="code hl_typedef" href="winunistd_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> v8;</div>
<div class="line"><span class="lineno">   68</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="serialize_8c.html#ad82109e83304903ea7939f5c63e7652d">deser_bytes</a>(&amp;v8, &amp;buf, 1))</div>
<div class="line"><span class="lineno">   69</span>                <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><span class="lineno">   70</span>            <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_out, &amp;opcode, 1);</div>
<div class="line"><span class="lineno">   71</span>            <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_out, &amp;v8, 1);</div>
<div class="line"><span class="lineno">   72</span>            data_len = v8;</div>
<div class="line"><span class="lineno">   73</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdac494676b542e0b7fb882a72f3f42fe46">OP_PUSHDATA2</a>) {</div>
<div class="line"><span class="lineno">   74</span>            <a class="code hl_typedef" href="winunistd_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> v16;</div>
<div class="line"><span class="lineno">   75</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="serialize_8c.html#a0504de2a511c3fbb73d8ef483e532c5c">deser_u16</a>(&amp;v16, &amp;buf))</div>
<div class="line"><span class="lineno">   76</span>                <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><span class="lineno">   77</span>            <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_out, &amp;opcode, 1);</div>
<div class="line"><span class="lineno">   78</span>            <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_out, &amp;v16, 2);</div>
<div class="line"><span class="lineno">   79</span>            data_len = v16;</div>
<div class="line"><span class="lineno">   80</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02">OP_PUSHDATA4</a>) {</div>
<div class="line"><span class="lineno">   81</span>            <a class="code hl_typedef" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> v32;</div>
<div class="line"><span class="lineno">   82</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="serialize_8c.html#a3efbb4723cef2673dc9481a29e332e62">deser_u32</a>(&amp;v32, &amp;buf))</div>
<div class="line"><span class="lineno">   83</span>                <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><span class="lineno">   84</span>            <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_out, &amp;opcode, 1);</div>
<div class="line"><span class="lineno">   85</span>            <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_out, &amp;v32, 4);</div>
<div class="line"><span class="lineno">   86</span>            data_len = v32;</div>
<div class="line"><span class="lineno">   87</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda57d43cf2c1d702fa2eae9c97f00dd0d9">OP_CODESEPARATOR</a>)</div>
<div class="line"><span class="lineno">   88</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>        <span class="keywordflow">if</span> (data_len &gt; 0) {</div>
<div class="line"><span class="lineno">   91</span>            assert(data_len &lt; 16777215); <span class="comment">//limit max push to 0xFFFFFF</span></div>
<div class="line"><span class="lineno">   92</span>            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* bufpush = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)<a class="code hl_function" href="mem_8c.html#a2eb6ed6a5cfda3a99145487a5445cfcf">dogecoin_calloc</a>(1, data_len);</div>
<div class="line"><span class="lineno">   93</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="serialize_8c.html#ad82109e83304903ea7939f5c63e7652d">deser_bytes</a>(bufpush, &amp;buf, data_len)) {</div>
<div class="line"><span class="lineno">   94</span>                <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(bufpush);</div>
<div class="line"><span class="lineno">   95</span>                <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><span class="lineno">   96</span>            }</div>
<div class="line"><span class="lineno">   97</span>            <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_out, bufpush, data_len);</div>
<div class="line"><span class="lineno">   98</span>            <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(bufpush);</div>
<div class="line"><span class="lineno">   99</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  100</span>            <a class="code hl_function" href="cstr_8c.html#a4932f17c7ec853057cd0614dcd69724f">cstr_append_buf</a>(script_out, &amp;opcode, 1);</div>
<div class="line"><span class="lineno">  101</span>    }</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>err_out:</div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  107</span>}</div>
<div class="ttc" id="amem_8c_html_a2eb6ed6a5cfda3a99145487a5445cfcf"><div class="ttname"><a href="mem_8c.html#a2eb6ed6a5cfda3a99145487a5445cfcf">dogecoin_calloc</a></div><div class="ttdeci">void * dogecoin_calloc(size_t count, size_t size)</div><div class="ttdoc">This function calls dogecoin_calloc_internal() using the current memory mapper.</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00092">mem.c:92</a></div></div>
<div class="ttc" id="amem_8c_html_ad02c72991a2ff7d7a89d69c0234c4315"><div class="ttname"><a href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a></div><div class="ttdeci">void dogecoin_free(void *ptr)</div><div class="ttdoc">This function calls dogecoin_free_internal() using the current memory mapper.</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00121">mem.c:121</a></div></div>
<div class="ttc" id="ascript_8h_html_a63e349a6089a54da9fe09a3d858648bda57d43cf2c1d702fa2eae9c97f00dd0d9"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda57d43cf2c1d702fa2eae9c97f00dd0d9">OP_CODESEPARATOR</a></div><div class="ttdeci">@ OP_CODESEPARATOR</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00169">script.h:169</a></div></div>
<div class="ttc" id="aserialize_8c_html_a0504de2a511c3fbb73d8ef483e532c5c"><div class="ttname"><a href="serialize_8c.html#a0504de2a511c3fbb73d8ef483e532c5c">deser_u16</a></div><div class="ttdeci">int deser_u16(uint16_t *vo, struct const_buffer *buf)</div><div class="ttdoc">This function deserializes 2 bytes from a const_buffer into a uint16_t object.</div><div class="ttdef"><b>Definition:</b> <a href="serialize_8c_source.html#l00267">serialize.c:267</a></div></div>
<div class="ttc" id="aserialize_8c_html_a3efbb4723cef2673dc9481a29e332e62"><div class="ttname"><a href="serialize_8c.html#a3efbb4723cef2673dc9481a29e332e62">deser_u32</a></div><div class="ttdeci">int deser_u32(uint32_t *vo, struct const_buffer *buf)</div><div class="ttdoc">This function deserializes 4 bytes from a const_buffer into a uint32_t object.</div><div class="ttdef"><b>Definition:</b> <a href="serialize_8c_source.html#l00310">serialize.c:310</a></div></div>
<div class="ttc" id="aserialize_8c_html_ad82109e83304903ea7939f5c63e7652d"><div class="ttname"><a href="serialize_8c.html#ad82109e83304903ea7939f5c63e7652d">deser_bytes</a></div><div class="ttdeci">int deser_bytes(void *po, struct const_buffer *buf, size_t len)</div><div class="ttdoc">This function takes a const_buffer and consumes the first len bytes, which are then placed into a voi...</div><div class="ttdef"><b>Definition:</b> <a href="serialize_8c_source.html#l00241">serialize.c:241</a></div></div>
<div class="ttc" id="astructconst__buffer_html"><div class="ttname"><a href="structconst__buffer.html">const_buffer</a></div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00042">buffer.h:42</a></div></div>
<div class="ttc" id="astructconst__buffer_html_aeea2fa428f380d27375680cc0d7d9952"><div class="ttname"><a href="structconst__buffer.html#aeea2fa428f380d27375680cc0d7d9952">const_buffer::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00044">buffer.h:44</a></div></div>
<div class="ttc" id="astructcstring_html_a731cdf51b981dfd0c66713e2c942a43d"><div class="ttname"><a href="structcstring.html#a731cdf51b981dfd0c66713e2c942a43d">cstring::str</a></div><div class="ttdeci">char * str</div><div class="ttdef"><b>Definition:</b> <a href="cstr_8h_source.html#l00038">cstr.h:38</a></div></div>
<div class="ttc" id="astructcstring_html_ad0eb3a0fea291824cc3a7176a4d6a345"><div class="ttname"><a href="structcstring.html#ad0eb3a0fea291824cc3a7176a4d6a345">cstring::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="cstr_8h_source.html#l00039">cstr.h:39</a></div></div>
<div class="ttc" id="awinunistd_8h_html_a9a941819355e6f658991890ff66b4b0e"><div class="ttname"><a href="winunistd_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a></div><div class="ttdeci">unsigned __int8 uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="winunistd_8h_source.html#l00056">winunistd.h:56</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cstr_8c_source.html#l00235">cstr_append_buf()</a>, <a class="el" href="serialize_8c_source.html#l00241">deser_bytes()</a>, <a class="el" href="serialize_8c_source.html#l00267">deser_u16()</a>, <a class="el" href="serialize_8c_source.html#l00310">deser_u32()</a>, <a class="el" href="mem_8c_source.html#l00092">dogecoin_calloc()</a>, <a class="el" href="mem_8c_source.html#l00121">dogecoin_free()</a>, <a class="el" href="buffer_8h_source.html#l00044">const_buffer::len</a>, <a class="el" href="cstr_8h_source.html#l00039">cstring::len</a>, <a class="el" href="script_8h_source.html#l00056">OP_0</a>, <a class="el" href="script_8h_source.html#l00169">OP_CODESEPARATOR</a>, <a class="el" href="script_8h_source.html#l00058">OP_PUSHDATA1</a>, <a class="el" href="script_8h_source.html#l00059">OP_PUSHDATA2</a>, <a class="el" href="script_8h_source.html#l00060">OP_PUSHDATA4</a>, and <a class="el" href="cstr_8h_source.html#l00038">cstring::str</a>.</p>

<p class="reference">Referenced by <a class="el" href="tx_8c_source.html#l00750">dogecoin_tx_sighash()</a>.</p>

</div>
</div>
<a id="a835fa79c6c664fbc646dd02cffb43e0a" name="a835fa79c6c664fbc646dd02cffb43e0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a835fa79c6c664fbc646dd02cffb43e0a">&#9670;&nbsp;</a></span>dogecoin_script_get_ops()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a> dogecoin_script_get_ops </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>ops_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function converts a cstring script into a vector of dogecoin_script_op objects. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script_in</td><td>The pointer to the cstring holding the script to be parsed. </td></tr>
    <tr><td class="paramname">ops_out</td><td>The pointer to a vector that will store the parsed script operations.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if converted successfully, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00171">171</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  172</span>{</div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordflow">if</span> (script_in-&gt;<a class="code hl_variable" href="structcstring.html#ad0eb3a0fea291824cc3a7176a4d6a345">len</a> == 0)</div>
<div class="line"><span class="lineno">  174</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">/* EOF */</span></div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structconst__buffer.html">const_buffer</a> buf = {script_in-&gt;<a class="code hl_variable" href="structcstring.html#a731cdf51b981dfd0c66713e2c942a43d">str</a>, script_in-&gt;<a class="code hl_variable" href="structcstring.html#ad0eb3a0fea291824cc3a7176a4d6a345">len</a>};</div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> opcode;</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    <a class="code hl_struct" href="structdogecoin__script__op__.html">dogecoin_script_op</a>* op = NULL;</div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">while</span> (buf.<a class="code hl_variable" href="structconst__buffer.html#aeea2fa428f380d27375680cc0d7d9952">len</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  181</span>        op = <a class="code hl_function" href="script_8c.html#a9bebfe2ef20079d39e0dc13c88c631ec">dogecoin_script_op_new</a>();</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="serialize_8c.html#ad82109e83304903ea7939f5c63e7652d">deser_bytes</a>(&amp;opcode, &amp;buf, 1))</div>
<div class="line"><span class="lineno">  184</span>            <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>        op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#ac1ab6cd747adc0a3e4f606e4f2de0c23">op</a> = opcode;</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>        <a class="code hl_typedef" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> data_len;</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>        <span class="keywordflow">if</span> (opcode &lt; <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941">OP_PUSHDATA1</a>) {</div>
<div class="line"><span class="lineno">  191</span>            data_len = opcode;</div>
<div class="line"><span class="lineno">  192</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941">OP_PUSHDATA1</a>) {</div>
<div class="line"><span class="lineno">  193</span>            <a class="code hl_typedef" href="winunistd_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> v8;</div>
<div class="line"><span class="lineno">  194</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="serialize_8c.html#ad82109e83304903ea7939f5c63e7652d">deser_bytes</a>(&amp;v8, &amp;buf, 1))</div>
<div class="line"><span class="lineno">  195</span>                <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><span class="lineno">  196</span>            data_len = v8;</div>
<div class="line"><span class="lineno">  197</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdac494676b542e0b7fb882a72f3f42fe46">OP_PUSHDATA2</a>) {</div>
<div class="line"><span class="lineno">  198</span>            <a class="code hl_typedef" href="winunistd_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a> v16;</div>
<div class="line"><span class="lineno">  199</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="serialize_8c.html#a0504de2a511c3fbb73d8ef483e532c5c">deser_u16</a>(&amp;v16, &amp;buf))</div>
<div class="line"><span class="lineno">  200</span>                <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><span class="lineno">  201</span>            data_len = v16;</div>
<div class="line"><span class="lineno">  202</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02">OP_PUSHDATA4</a>) {</div>
<div class="line"><span class="lineno">  203</span>            <a class="code hl_typedef" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> v32;</div>
<div class="line"><span class="lineno">  204</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="serialize_8c.html#a3efbb4723cef2673dc9481a29e332e62">deser_u32</a>(&amp;v32, &amp;buf))</div>
<div class="line"><span class="lineno">  205</span>                <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><span class="lineno">  206</span>            data_len = v32;</div>
<div class="line"><span class="lineno">  207</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  208</span>            <a class="code hl_function" href="vector_8c.html#af631040a8dbb1a2b7ce422ac40ef0085">vector_add</a>(ops_out, op);</div>
<div class="line"><span class="lineno">  209</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  210</span>        }</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>        <span class="comment">// don&#39;t alloc a push buffer if there is no more data available</span></div>
<div class="line"><span class="lineno">  213</span>        <span class="keywordflow">if</span> (buf.<a class="code hl_variable" href="structconst__buffer.html#aeea2fa428f380d27375680cc0d7d9952">len</a> == 0 || data_len &gt; buf.<a class="code hl_variable" href="structconst__buffer.html#aeea2fa428f380d27375680cc0d7d9952">len</a>) {</div>
<div class="line"><span class="lineno">  214</span>            <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><span class="lineno">  215</span>        }</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>        op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#a70f05d4a279d1957959bc94e8ba4fd9a">data</a> = <a class="code hl_function" href="mem_8c.html#a2eb6ed6a5cfda3a99145487a5445cfcf">dogecoin_calloc</a>(1, data_len);</div>
<div class="line"><span class="lineno">  218</span>        <a class="code hl_function" href="mem_8c.html#ab5b323a3ddeb02bdcb2b5a8a46e2a4b7">memcpy_safe</a>(op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#a70f05d4a279d1957959bc94e8ba4fd9a">data</a>, buf.<a class="code hl_variable" href="structconst__buffer.html#a0f8f88d516b9e6a9088aa7927b780f01">p</a>, data_len);</div>
<div class="line"><span class="lineno">  219</span>        op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#af65580f7b14a649ede064ec049eb1045">datalen</a> = data_len;</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>        <a class="code hl_function" href="vector_8c.html#af631040a8dbb1a2b7ce422ac40ef0085">vector_add</a>(ops_out, op);</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="serialize_8c.html#ac9a8540293a59dfd3603bf0f22b5124f">deser_skip</a>(&amp;buf, data_len))</div>
<div class="line"><span class="lineno">  224</span>            <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><span class="lineno">  225</span>    }</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  228</span>err_out:</div>
<div class="line"><span class="lineno">  229</span>    <a class="code hl_function" href="script_8c.html#acbb7e12c33b946ecd164a4d1fceba82a">dogecoin_script_op_free_cb</a>(op);</div>
<div class="line"><span class="lineno">  230</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  231</span>}</div>
<div class="ttc" id="amem_8c_html_ab5b323a3ddeb02bdcb2b5a8a46e2a4b7"><div class="ttname"><a href="mem_8c.html#ab5b323a3ddeb02bdcb2b5a8a46e2a4b7">memcpy_safe</a></div><div class="ttdeci">void * memcpy_safe(void *destination, const void *source, size_t count)</div><div class="ttdef"><b>Definition:</b> <a href="mem_8c_source.html#l00209">mem.c:209</a></div></div>
<div class="ttc" id="ascript_8c_html_a9bebfe2ef20079d39e0dc13c88c631ec"><div class="ttname"><a href="script_8c.html#a9bebfe2ef20079d39e0dc13c88c631ec">dogecoin_script_op_new</a></div><div class="ttdeci">dogecoin_script_op * dogecoin_script_op_new()</div><div class="ttdoc">This function allocates the memory for a new dogecoin_script_op object.</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00116">script.c:116</a></div></div>
<div class="ttc" id="aserialize_8c_html_ac9a8540293a59dfd3603bf0f22b5124f"><div class="ttname"><a href="serialize_8c.html#ac9a8540293a59dfd3603bf0f22b5124f">deser_skip</a></div><div class="ttdeci">int deser_skip(struct const_buffer *buf, size_t len)</div><div class="ttdoc">This function skips the next len bytes of a const_buffer by moving the pointer up by len bytes and su...</div><div class="ttdef"><b>Definition:</b> <a href="serialize_8c_source.html#l00214">serialize.c:214</a></div></div>
<div class="ttc" id="astructconst__buffer_html_a0f8f88d516b9e6a9088aa7927b780f01"><div class="ttname"><a href="structconst__buffer.html#a0f8f88d516b9e6a9088aa7927b780f01">const_buffer::p</a></div><div class="ttdeci">const void * p</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00043">buffer.h:43</a></div></div>
<div class="ttc" id="astructdogecoin__script__op___html"><div class="ttname"><a href="structdogecoin__script__op__.html">dogecoin_script_op_</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00207">script.h:207</a></div></div>
<div class="ttc" id="astructdogecoin__script__op___html_a70f05d4a279d1957959bc94e8ba4fd9a"><div class="ttname"><a href="structdogecoin__script__op__.html#a70f05d4a279d1957959bc94e8ba4fd9a">dogecoin_script_op_::data</a></div><div class="ttdeci">unsigned char * data</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00209">script.h:209</a></div></div>
<div class="ttc" id="astructdogecoin__script__op___html_ac1ab6cd747adc0a3e4f606e4f2de0c23"><div class="ttname"><a href="structdogecoin__script__op__.html#ac1ab6cd747adc0a3e4f606e4f2de0c23">dogecoin_script_op_::op</a></div><div class="ttdeci">enum opcodetype op</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00208">script.h:208</a></div></div>
<div class="ttc" id="astructdogecoin__script__op___html_af65580f7b14a649ede064ec049eb1045"><div class="ttname"><a href="structdogecoin__script__op__.html#af65580f7b14a649ede064ec049eb1045">dogecoin_script_op_::datalen</a></div><div class="ttdeci">size_t datalen</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00210">script.h:210</a></div></div>
<div class="ttc" id="avector_8c_html_af631040a8dbb1a2b7ce422ac40ef0085"><div class="ttname"><a href="vector_8c.html#af631040a8dbb1a2b7ce422ac40ef0085">vector_add</a></div><div class="ttdeci">dogecoin_bool vector_add(vector *vec, void *data)</div><div class="ttdoc">This function adds an element to an existing vector, growing it by one if necessary.</div><div class="ttdef"><b>Definition:</b> <a href="vector_8c_source.html#l00182">vector.c:182</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="script_8h_source.html#l00209">dogecoin_script_op_::data</a>, <a class="el" href="script_8h_source.html#l00210">dogecoin_script_op_::datalen</a>, <a class="el" href="serialize_8c_source.html#l00241">deser_bytes()</a>, <a class="el" href="serialize_8c_source.html#l00214">deser_skip()</a>, <a class="el" href="serialize_8c_source.html#l00267">deser_u16()</a>, <a class="el" href="serialize_8c_source.html#l00310">deser_u32()</a>, <a class="el" href="mem_8c_source.html#l00092">dogecoin_calloc()</a>, <a class="el" href="script_8c_source.html#l00153">dogecoin_script_op_free_cb()</a>, <a class="el" href="script_8c_source.html#l00116">dogecoin_script_op_new()</a>, <a class="el" href="buffer_8h_source.html#l00044">const_buffer::len</a>, <a class="el" href="cstr_8h_source.html#l00039">cstring::len</a>, <a class="el" href="mem_8c_source.html#l00209">memcpy_safe()</a>, <a class="el" href="script_8h_source.html#l00208">dogecoin_script_op_::op</a>, <a class="el" href="script_8h_source.html#l00058">OP_PUSHDATA1</a>, <a class="el" href="script_8h_source.html#l00059">OP_PUSHDATA2</a>, <a class="el" href="script_8h_source.html#l00060">OP_PUSHDATA4</a>, <a class="el" href="buffer_8h_source.html#l00043">const_buffer::p</a>, <a class="el" href="cstr_8h_source.html#l00038">cstring::str</a>, and <a class="el" href="vector_8c_source.html#l00182">vector_add()</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00477">dogecoin_script_classify()</a>.</p>

</div>
</div>
<a id="a67d329ca5e5d4abefb45ea9ea949ec59" name="a67d329ca5e5d4abefb45ea9ea949ec59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67d329ca5e5d4abefb45ea9ea949ec59">&#9670;&nbsp;</a></span>dogecoin_script_get_scripthash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a> dogecoin_script_get_scripthash </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="dogecoin_8h.html#aab46d644720ff920e4a685bcaed2ae6b">uint160</a>&#160;</td>
          <td class="paramname"><em>scripthash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes a script, computes its hash, and returns it as a uint160 object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script_in</td><td>The pointer to the cstring which holds the script. </td></tr>
    <tr><td class="paramname">scripthash</td><td>The uint160 object that will hold the hash of the script.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the script was hashed correctly, 0 if a null cstring was provided. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00658">658</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  659</span>{</div>
<div class="line"><span class="lineno">  660</span>    <span class="keywordflow">if</span> (!script_in) {</div>
<div class="line"><span class="lineno">  661</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  662</span>    }</div>
<div class="line"><span class="lineno">  663</span>    <a class="code hl_variable" href="dogecoin_8h.html#a7b1e8040e3117539e0382dbdfb55f942">uint256</a> hash;</div>
<div class="line"><span class="lineno">  664</span>    <a class="code hl_function" href="include_2dogecoin_2hash_8h.html#afe25444335ae2514d766d55482891f0f">dogecoin_hash_sngl_sha256</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)script_in-&gt;<a class="code hl_variable" href="structcstring.html#a731cdf51b981dfd0c66713e2c942a43d">str</a>, script_in-&gt;<a class="code hl_variable" href="structcstring.html#ad0eb3a0fea291824cc3a7176a4d6a345">len</a>, hash);</div>
<div class="line"><span class="lineno">  665</span>    <a class="code hl_function" href="rmd160_8c.html#a59de8ca63333f51e2b44cfb52fcda867">rmd160</a>(hash, <span class="keyword">sizeof</span>(hash), scripthash);</div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  668</span>}</div>
<div class="ttc" id="adogecoin_8h_html_a7b1e8040e3117539e0382dbdfb55f942"><div class="ttname"><a href="dogecoin_8h.html#a7b1e8040e3117539e0382dbdfb55f942">uint256</a></div><div class="ttdeci">LIBDOGECOIN_BEGIN_DECL typedef uint8_t uint256[32]</div><div class="ttdef"><b>Definition:</b> <a href="dogecoin_8h_source.html#l00132">dogecoin.h:132</a></div></div>
<div class="ttc" id="ainclude_2dogecoin_2hash_8h_html_afe25444335ae2514d766d55482891f0f"><div class="ttname"><a href="include_2dogecoin_2hash_8h.html#afe25444335ae2514d766d55482891f0f">dogecoin_hash_sngl_sha256</a></div><div class="ttdeci">static LIBDOGECOIN_API void dogecoin_hash_sngl_sha256(const unsigned char *datain, size_t length, uint256 hashout)</div><div class="ttdef"><b>Definition:</b> <a href="include_2dogecoin_2hash_8h_source.html#l00073">hash.h:73</a></div></div>
<div class="ttc" id="armd160_8c_html_a59de8ca63333f51e2b44cfb52fcda867"><div class="ttname"><a href="rmd160_8c.html#a59de8ca63333f51e2b44cfb52fcda867">rmd160</a></div><div class="ttdeci">void rmd160(const uint8_t *msg, uint32_t msg_len, uint8_t *hash)</div><div class="ttdef"><b>Definition:</b> <a href="rmd160_8c_source.html#l00294">rmd160.c:294</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="include_2dogecoin_2hash_8h_source.html#l00073">dogecoin_hash_sngl_sha256()</a>, <a class="el" href="cstr_8h_source.html#l00039">cstring::len</a>, <a class="el" href="rmd160_8c_source.html#l00294">rmd160()</a>, <a class="el" href="cstr_8h_source.html#l00038">cstring::str</a>, and <a class="el" href="dogecoin_8h_source.html#l00132">uint256</a>.</p>

</div>
</div>
<a id="aa9d6b3f63ad8603c55d8ed5770a4097b" name="aa9d6b3f63ad8603c55d8ed5770a4097b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9d6b3f63ad8603c55d8ed5770a4097b">&#9670;&nbsp;</a></span>dogecoin_script_is_multisig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a> dogecoin_script_is_multisig </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>ops</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function checks whether a script is a multisig script, which is true if the vector is composed of between 3 and 19 scripts (inclusive), the first operation has a small int opcode, the second-to-last operation has a small int opcode, the last operation is OP_CHECKMULTISIG, and all operations in between push pubkeys to the stack. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ops</td><td>The pointer to the vector storing the script.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the script is a multisig script, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00426">426</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  427</span>{</div>
<div class="line"><span class="lineno">  428</span>    <span class="keywordflow">if</span> ((ops-&gt;<a class="code hl_variable" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> &lt; 3) || (ops-&gt;<a class="code hl_variable" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> &gt; (16 + 3)) ||</div>
<div class="line"><span class="lineno">  429</span>        !<a class="code hl_function" href="script_8c.html#a1202671b6692b3d8e5a5f51d377ffe9c">dogecoin_script_is_op_smallint</a>(<a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 0)) ||</div>
<div class="line"><span class="lineno">  430</span>        !<a class="code hl_function" href="script_8c.html#a1202671b6692b3d8e5a5f51d377ffe9c">dogecoin_script_is_op_smallint</a>(<a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, ops-&gt;<a class="code hl_variable" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> - 2)) ||</div>
<div class="line"><span class="lineno">  431</span>        !<a class="code hl_function" href="script_8c.html#ab99cb7bc6b3bd9434399580da4d43ff3">dogecoin_script_is_op</a>(<a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, ops-&gt;<a class="code hl_variable" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> - 1), <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda237677a3bb15c383d342aa297e7e9526">OP_CHECKMULTISIG</a>))</div>
<div class="line"><span class="lineno">  432</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  433</span> </div>
<div class="line"><span class="lineno">  434</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  435</span>    <span class="keywordflow">for</span> (i = 1; i &lt; (ops-&gt;<a class="code hl_variable" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> - 2); i++)</div>
<div class="line"><span class="lineno">  436</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="script_8c.html#a8b67694af4f04a0bc6690ac40a72d58f">dogecoin_script_is_op_pubkey</a>(<a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, i)))</div>
<div class="line"><span class="lineno">  437</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  440</span>}</div>
<div class="ttc" id="ascript_8c_html_a1202671b6692b3d8e5a5f51d377ffe9c"><div class="ttname"><a href="script_8c.html#a1202671b6692b3d8e5a5f51d377ffe9c">dogecoin_script_is_op_smallint</a></div><div class="ttdeci">static dogecoin_bool dogecoin_script_is_op_smallint(const dogecoin_script_op *op)</div><div class="ttdoc">The function checks whether the script operation has an opcode label of less than or equal to 16.</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00407">script.c:407</a></div></div>
<div class="ttc" id="ascript_8c_html_a8b67694af4f04a0bc6690ac40a72d58f"><div class="ttname"><a href="script_8c.html#a8b67694af4f04a0bc6690ac40a72d58f">dogecoin_script_is_op_pubkey</a></div><div class="ttdeci">static dogecoin_bool dogecoin_script_is_op_pubkey(const dogecoin_script_op *op)</div><div class="ttdoc">This function checks whether a given script operation pushes a pubkey to the stack....</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00274">script.c:274</a></div></div>
<div class="ttc" id="ascript_8c_html_ab99cb7bc6b3bd9434399580da4d43ff3"><div class="ttname"><a href="script_8c.html#ab99cb7bc6b3bd9434399580da4d43ff3">dogecoin_script_is_op</a></div><div class="ttdeci">static dogecoin_bool dogecoin_script_is_op(const dogecoin_script_op *op, enum opcodetype opcode)</div><div class="ttdoc">This function checks whether the opcode of a given script operation matches the specified opcode.</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00257">script.c:257</a></div></div>
<div class="ttc" id="avector_8h_html_a73977ea5971aad9c5d4a476d25ff1bc3"><div class="ttname"><a href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a></div><div class="ttdeci">#define vector_idx(vec, idx)</div><div class="ttdef"><b>Definition:</b> <a href="vector_8h_source.html#l00044">vector.h:44</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="script_8c_source.html#l00257">dogecoin_script_is_op()</a>, <a class="el" href="script_8c_source.html#l00274">dogecoin_script_is_op_pubkey()</a>, <a class="el" href="script_8c_source.html#l00407">dogecoin_script_is_op_smallint()</a>, <a class="el" href="vector_8h_source.html#l00038">vector::len</a>, <a class="el" href="script_8h_source.html#l00172">OP_CHECKMULTISIG</a>, and <a class="el" href="vector_8h_source.html#l00044">vector_idx</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00477">dogecoin_script_classify()</a>, and <a class="el" href="script_8c_source.html#l00451">dogecoin_script_classify_ops()</a>.</p>

</div>
</div>
<a id="ab99cb7bc6b3bd9434399580da4d43ff3" name="ab99cb7bc6b3bd9434399580da4d43ff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab99cb7bc6b3bd9434399580da4d43ff3">&#9670;&nbsp;</a></span>dogecoin_script_is_op()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a> dogecoin_script_is_op </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="script_8h.html#a3728d27af357a79523869821d2eb1df4">dogecoin_script_op</a> *&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a>&#160;</td>
          <td class="paramname"><em>opcode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function checks whether the opcode of a given script operation matches the specified opcode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">op</td><td>The pointer to the script operation whose opcode will be checked. </td></tr>
    <tr><td class="paramname">opcode</td><td>The reference opcode.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the opcodes match, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00257">257</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  258</span>{</div>
<div class="line"><span class="lineno">  259</span>    <span class="keywordflow">return</span> (op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#ac1ab6cd747adc0a3e4f606e4f2de0c23">op</a> == opcode);</div>
<div class="line"><span class="lineno">  260</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="script_8h_source.html#l00208">dogecoin_script_op_::op</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00426">dogecoin_script_is_multisig()</a>, <a class="el" href="script_8c_source.html#l00318">dogecoin_script_is_pubkey()</a>, <a class="el" href="script_8c_source.html#l00347">dogecoin_script_is_pubkeyhash()</a>, and <a class="el" href="script_8c_source.html#l00379">dogecoin_script_is_scripthash()</a>.</p>

</div>
</div>
<a id="a8b67694af4f04a0bc6690ac40a72d58f" name="a8b67694af4f04a0bc6690ac40a72d58f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b67694af4f04a0bc6690ac40a72d58f">&#9670;&nbsp;</a></span>dogecoin_script_is_op_pubkey()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a> dogecoin_script_is_op_pubkey </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="script_8h.html#a3728d27af357a79523869821d2eb1df4">dogecoin_script_op</a> *&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function checks whether a given script operation pushes a pubkey to the stack. This is true if the script operation has a pushdata opcode and that its data is the same length as a compressed or uncompressed EC key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">op</td><td>The pointer to the script operation to be checked.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the script resembles the pubkey template, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00274">274</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  275</span>{</div>
<div class="line"><span class="lineno">  276</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="script_8c.html#a821f282735ff2d7e5f07e934364096ee">dogecoin_script_is_pushdata</a>(op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#ac1ab6cd747adc0a3e4f606e4f2de0c23">op</a>))</div>
<div class="line"><span class="lineno">  277</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  278</span>    <span class="keywordflow">if</span> (op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#af65580f7b14a649ede064ec049eb1045">datalen</a> != <a class="code hl_define" href="dogecoin_8h.html#a67a3532477449dfadd603c67051cf842">DOGECOIN_ECKEY_COMPRESSED_LENGTH</a> &amp;&amp; op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#af65580f7b14a649ede064ec049eb1045">datalen</a> != <a class="code hl_define" href="dogecoin_8h.html#abfdcb34512fe1053aad2cbb8f216e2ec">DOGECOIN_ECKEY_UNCOMPRESSED_LENGTH</a>)</div>
<div class="line"><span class="lineno">  279</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  280</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="key_8c.html#ae821bf2ce270637bd9da4c7685ac9034">dogecoin_pubkey_get_length</a>(op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#a70f05d4a279d1957959bc94e8ba4fd9a">data</a>[0]) != op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#af65580f7b14a649ede064ec049eb1045">datalen</a>) {</div>
<div class="line"><span class="lineno">  281</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  282</span>    }</div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  284</span>}</div>
<div class="ttc" id="akey_8c_html_ae821bf2ce270637bd9da4c7685ac9034"><div class="ttname"><a href="key_8c.html#ae821bf2ce270637bd9da4c7685ac9034">dogecoin_pubkey_get_length</a></div><div class="ttdeci">unsigned int dogecoin_pubkey_get_length(unsigned char ch_header)</div><div class="ttdef"><b>Definition:</b> <a href="key_8c_source.html#l00131">key.c:131</a></div></div>
<div class="ttc" id="ascript_8c_html_a821f282735ff2d7e5f07e934364096ee"><div class="ttname"><a href="script_8c.html#a821f282735ff2d7e5f07e934364096ee">dogecoin_script_is_pushdata</a></div><div class="ttdeci">static dogecoin_bool dogecoin_script_is_pushdata(const enum opcodetype op)</div><div class="ttdoc">This function checks whether an opcode is a pushdata opcode.</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00242">script.c:242</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="script_8h_source.html#l00209">dogecoin_script_op_::data</a>, <a class="el" href="script_8h_source.html#l00210">dogecoin_script_op_::datalen</a>, <a class="el" href="dogecoin_8h_source.html#l00123">DOGECOIN_ECKEY_COMPRESSED_LENGTH</a>, <a class="el" href="dogecoin_8h_source.html#l00122">DOGECOIN_ECKEY_UNCOMPRESSED_LENGTH</a>, <a class="el" href="key_8c_source.html#l00131">dogecoin_pubkey_get_length()</a>, <a class="el" href="script_8c_source.html#l00242">dogecoin_script_is_pushdata()</a>, and <a class="el" href="script_8h_source.html#l00208">dogecoin_script_op_::op</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00426">dogecoin_script_is_multisig()</a>, and <a class="el" href="script_8c_source.html#l00318">dogecoin_script_is_pubkey()</a>.</p>

</div>
</div>
<a id="ac6f452f07b063e1a6b820bfeb068bcc0" name="ac6f452f07b063e1a6b820bfeb068bcc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6f452f07b063e1a6b820bfeb068bcc0">&#9670;&nbsp;</a></span>dogecoin_script_is_op_pubkeyhash()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a> dogecoin_script_is_op_pubkeyhash </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="script_8h.html#a3728d27af357a79523869821d2eb1df4">dogecoin_script_op</a> *&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function checks whether the given script operation pushes a pubkey hash to the stack. This is true if the script operation has a pushdata opcode and that its data is 20 bytes in size. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">op</td><td>The pointer to the script operation to be checked.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the script resembles the pubkey hash template, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00297">297</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  298</span>{</div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="script_8c.html#a821f282735ff2d7e5f07e934364096ee">dogecoin_script_is_pushdata</a>(op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#ac1ab6cd747adc0a3e4f606e4f2de0c23">op</a>))</div>
<div class="line"><span class="lineno">  300</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  301</span>    <span class="keywordflow">if</span> (op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#af65580f7b14a649ede064ec049eb1045">datalen</a> != 20)</div>
<div class="line"><span class="lineno">  302</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  303</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  304</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="script_8h_source.html#l00210">dogecoin_script_op_::datalen</a>, <a class="el" href="script_8c_source.html#l00242">dogecoin_script_is_pushdata()</a>, and <a class="el" href="script_8h_source.html#l00208">dogecoin_script_op_::op</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00347">dogecoin_script_is_pubkeyhash()</a>, and <a class="el" href="script_8c_source.html#l00379">dogecoin_script_is_scripthash()</a>.</p>

</div>
</div>
<a id="a1202671b6692b3d8e5a5f51d377ffe9c" name="a1202671b6692b3d8e5a5f51d377ffe9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1202671b6692b3d8e5a5f51d377ffe9c">&#9670;&nbsp;</a></span>dogecoin_script_is_op_smallint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a> dogecoin_script_is_op_smallint </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="script_8h.html#a3728d27af357a79523869821d2eb1df4">dogecoin_script_op</a> *&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The function checks whether the script operation has an opcode label of less than or equal to 16. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">op</td><td>The pointer to the operation to be checked.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if it has a small int opcode, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00407">407</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  408</span>{</div>
<div class="line"><span class="lineno">  409</span>    <span class="keywordflow">return</span> ((op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#ac1ab6cd747adc0a3e4f606e4f2de0c23">op</a> == <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaccd484dad2223fffdbdc2637c4f1e40e">OP_0</a>) ||</div>
<div class="line"><span class="lineno">  410</span>            (op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#ac1ab6cd747adc0a3e4f606e4f2de0c23">op</a> &gt;= <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda7e89d91965ffa7edb7733a5e9bf8a9f3">OP_1</a> &amp;&amp; op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#ac1ab6cd747adc0a3e4f606e4f2de0c23">op</a> &lt;= <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda2ee6a5016b745258463b6d206e7332c9">OP_16</a>));</div>
<div class="line"><span class="lineno">  411</span>}</div>
<div class="ttc" id="ascript_8h_html_a63e349a6089a54da9fe09a3d858648bda2ee6a5016b745258463b6d206e7332c9"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda2ee6a5016b745258463b6d206e7332c9">OP_16</a></div><div class="ttdeci">@ OP_16</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00079">script.h:79</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="script_8h_source.html#l00208">dogecoin_script_op_::op</a>, <a class="el" href="script_8h_source.html#l00056">OP_0</a>, <a class="el" href="script_8h_source.html#l00063">OP_1</a>, and <a class="el" href="script_8h_source.html#l00079">OP_16</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00426">dogecoin_script_is_multisig()</a>.</p>

</div>
</div>
<a id="a7650d6ca38c4502fb27b6c872da9ef6b" name="a7650d6ca38c4502fb27b6c872da9ef6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7650d6ca38c4502fb27b6c872da9ef6b">&#9670;&nbsp;</a></span>dogecoin_script_is_pubkey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a> dogecoin_script_is_pubkey </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>data_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function checks whether the script matches the template for a pubkey script, which is composed of a push pubkey operation followed by an OP_CHECKSIG. The pubkey is then loaded into data_out. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ops</td><td>The pointer to a vector storing script data to be checked. </td></tr>
    <tr><td class="paramname">data_out</td><td>The pointer to a vector which will hold the pubkey data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the script is the correct format, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00318">318</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  319</span>{</div>
<div class="line"><span class="lineno">  320</span>    <span class="keywordflow">if</span> ((ops-&gt;<a class="code hl_variable" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> == 2) &amp;&amp;</div>
<div class="line"><span class="lineno">  321</span>        <a class="code hl_function" href="script_8c.html#ab99cb7bc6b3bd9434399580da4d43ff3">dogecoin_script_is_op</a>(<a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 1), <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda2c190c5caf052f92d3d9ac31a0d96151">OP_CHECKSIG</a>) &amp;&amp;</div>
<div class="line"><span class="lineno">  322</span>        <a class="code hl_function" href="script_8c.html#a8b67694af4f04a0bc6690ac40a72d58f">dogecoin_script_is_op_pubkey</a>(<a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 0))) {</div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordflow">if</span> (data_out) {</div>
<div class="line"><span class="lineno">  324</span>            <span class="comment">//copy the full pubkey (33 or 65) in case of a non empty vector</span></div>
<div class="line"><span class="lineno">  325</span>            <span class="keyword">const</span> <a class="code hl_struct" href="structdogecoin__script__op__.html">dogecoin_script_op</a>* op = <a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 0);</div>
<div class="line"><span class="lineno">  326</span>            <a class="code hl_typedef" href="winunistd_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a>* <a class="code hl_struct" href="structbuffer.html">buffer</a> = <a class="code hl_function" href="mem_8c.html#a2eb6ed6a5cfda3a99145487a5445cfcf">dogecoin_calloc</a>(1, op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#af65580f7b14a649ede064ec049eb1045">datalen</a>);</div>
<div class="line"><span class="lineno">  327</span>            <a class="code hl_function" href="mem_8c.html#ab5b323a3ddeb02bdcb2b5a8a46e2a4b7">memcpy_safe</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#a70f05d4a279d1957959bc94e8ba4fd9a">data</a>, op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#af65580f7b14a649ede064ec049eb1045">datalen</a>);</div>
<div class="line"><span class="lineno">  328</span>            <a class="code hl_function" href="vector_8c.html#af631040a8dbb1a2b7ce422ac40ef0085">vector_add</a>(data_out, <a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  329</span>        }</div>
<div class="line"><span class="lineno">  330</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  331</span>    }</div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  333</span>}</div>
<div class="ttc" id="astructbuffer_html"><div class="ttname"><a href="structbuffer.html">buffer</a></div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00037">buffer.h:37</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="script_8h_source.html#l00209">dogecoin_script_op_::data</a>, <a class="el" href="script_8h_source.html#l00210">dogecoin_script_op_::datalen</a>, <a class="el" href="mem_8c_source.html#l00092">dogecoin_calloc()</a>, <a class="el" href="script_8c_source.html#l00257">dogecoin_script_is_op()</a>, <a class="el" href="script_8c_source.html#l00274">dogecoin_script_is_op_pubkey()</a>, <a class="el" href="vector_8h_source.html#l00038">vector::len</a>, <a class="el" href="mem_8c_source.html#l00209">memcpy_safe()</a>, <a class="el" href="script_8h_source.html#l00170">OP_CHECKSIG</a>, <a class="el" href="vector_8c_source.html#l00182">vector_add()</a>, and <a class="el" href="vector_8h_source.html#l00044">vector_idx</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00477">dogecoin_script_classify()</a>, and <a class="el" href="script_8c_source.html#l00451">dogecoin_script_classify_ops()</a>.</p>

</div>
</div>
<a id="aa4d9698dde44c7c7b1698840b497a8bb" name="aa4d9698dde44c7c7b1698840b497a8bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4d9698dde44c7c7b1698840b497a8bb">&#9670;&nbsp;</a></span>dogecoin_script_is_pubkeyhash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a> dogecoin_script_is_pubkeyhash </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>data_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function checks whether the script matches the template for a pubkey hash script, which is composed of an OP_DUP, an OP_HASH160, a push pubkey hash operation, an OP_EQUALVERIFY, and an OP_CHECKSIG, in that order. The pubkey hash is then loaded into data_out. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ops</td><td>The pointer to a vector storing script data to be checked. </td></tr>
    <tr><td class="paramname">data_out</td><td>The pointer to a vector where script data will be copied to.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the script is a valid pubkey hash, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00347">347</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  348</span>{</div>
<div class="line"><span class="lineno">  349</span>    <span class="keywordflow">if</span> ((ops-&gt;<a class="code hl_variable" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> == 5) &amp;&amp;</div>
<div class="line"><span class="lineno">  350</span>        <a class="code hl_function" href="script_8c.html#ab99cb7bc6b3bd9434399580da4d43ff3">dogecoin_script_is_op</a>(<a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 0), <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda47360cbb2e673baa31591adbb153c9b3">OP_DUP</a>) &amp;&amp;</div>
<div class="line"><span class="lineno">  351</span>        <a class="code hl_function" href="script_8c.html#ab99cb7bc6b3bd9434399580da4d43ff3">dogecoin_script_is_op</a>(<a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 1), <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd">OP_HASH160</a>) &amp;&amp;</div>
<div class="line"><span class="lineno">  352</span>        <a class="code hl_function" href="script_8c.html#ac6f452f07b063e1a6b820bfeb068bcc0">dogecoin_script_is_op_pubkeyhash</a>(<a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 2)) &amp;&amp;</div>
<div class="line"><span class="lineno">  353</span>        <a class="code hl_function" href="script_8c.html#ab99cb7bc6b3bd9434399580da4d43ff3">dogecoin_script_is_op</a>(<a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 3), <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdae24d4b553a43d3d57bbac4d9bd4bdf24">OP_EQUALVERIFY</a>) &amp;&amp;</div>
<div class="line"><span class="lineno">  354</span>        <a class="code hl_function" href="script_8c.html#ab99cb7bc6b3bd9434399580da4d43ff3">dogecoin_script_is_op</a>(<a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 4), <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda2c190c5caf052f92d3d9ac31a0d96151">OP_CHECKSIG</a>)) {</div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordflow">if</span> (data_out) {</div>
<div class="line"><span class="lineno">  356</span>            <span class="comment">//copy the data (hash160) in case of a non empty vector</span></div>
<div class="line"><span class="lineno">  357</span>            <span class="keyword">const</span> <a class="code hl_struct" href="structdogecoin__script__op__.html">dogecoin_script_op</a>* op = <a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 2);</div>
<div class="line"><span class="lineno">  358</span>            <a class="code hl_typedef" href="winunistd_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a>* <a class="code hl_struct" href="structbuffer.html">buffer</a> = <a class="code hl_function" href="mem_8c.html#a2eb6ed6a5cfda3a99145487a5445cfcf">dogecoin_calloc</a>(1, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="dogecoin_8h.html#aab46d644720ff920e4a685bcaed2ae6b">uint160</a>));</div>
<div class="line"><span class="lineno">  359</span>            <a class="code hl_function" href="mem_8c.html#ab5b323a3ddeb02bdcb2b5a8a46e2a4b7">memcpy_safe</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#a70f05d4a279d1957959bc94e8ba4fd9a">data</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="dogecoin_8h.html#aab46d644720ff920e4a685bcaed2ae6b">uint160</a>));</div>
<div class="line"><span class="lineno">  360</span>            <a class="code hl_function" href="vector_8c.html#af631040a8dbb1a2b7ce422ac40ef0085">vector_add</a>(data_out, <a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  361</span>        }</div>
<div class="line"><span class="lineno">  362</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  363</span>    }</div>
<div class="line"><span class="lineno">  364</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  365</span>}</div>
<div class="ttc" id="ascript_8c_html_ac6f452f07b063e1a6b820bfeb068bcc0"><div class="ttname"><a href="script_8c.html#ac6f452f07b063e1a6b820bfeb068bcc0">dogecoin_script_is_op_pubkeyhash</a></div><div class="ttdeci">static dogecoin_bool dogecoin_script_is_op_pubkeyhash(const dogecoin_script_op *op)</div><div class="ttdoc">This function checks whether the given script operation pushes a pubkey hash to the stack....</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00297">script.c:297</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="script_8h_source.html#l00209">dogecoin_script_op_::data</a>, <a class="el" href="mem_8c_source.html#l00092">dogecoin_calloc()</a>, <a class="el" href="script_8c_source.html#l00257">dogecoin_script_is_op()</a>, <a class="el" href="script_8c_source.html#l00297">dogecoin_script_is_op_pubkeyhash()</a>, <a class="el" href="vector_8h_source.html#l00038">vector::len</a>, <a class="el" href="mem_8c_source.html#l00209">memcpy_safe()</a>, <a class="el" href="script_8h_source.html#l00170">OP_CHECKSIG</a>, <a class="el" href="script_8h_source.html#l00105">OP_DUP</a>, <a class="el" href="script_8h_source.html#l00127">OP_EQUALVERIFY</a>, <a class="el" href="script_8h_source.html#l00167">OP_HASH160</a>, <a class="el" href="vector_8c_source.html#l00182">vector_add()</a>, and <a class="el" href="vector_8h_source.html#l00044">vector_idx</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00477">dogecoin_script_classify()</a>, and <a class="el" href="script_8c_source.html#l00451">dogecoin_script_classify_ops()</a>.</p>

</div>
</div>
<a id="a821f282735ff2d7e5f07e934364096ee" name="a821f282735ff2d7e5f07e934364096ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a821f282735ff2d7e5f07e934364096ee">&#9670;&nbsp;</a></span>dogecoin_script_is_pushdata()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a> dogecoin_script_is_pushdata </td>
          <td>(</td>
          <td class="paramtype">const enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a>&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function checks whether an opcode is a pushdata opcode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">op</td><td>The opcode to check.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if opcode is a pushdata opcode, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00242">242</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  243</span>{</div>
<div class="line"><span class="lineno">  244</span>    <span class="keywordflow">return</span> (op &lt;= <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02">OP_PUSHDATA4</a>);</div>
<div class="line"><span class="lineno">  245</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="script_8h_source.html#l00060">OP_PUSHDATA4</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00274">dogecoin_script_is_op_pubkey()</a>, and <a class="el" href="script_8c_source.html#l00297">dogecoin_script_is_op_pubkeyhash()</a>.</p>

</div>
</div>
<a id="a56862b180a334357cf320d863ce9519c" name="a56862b180a334357cf320d863ce9519c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56862b180a334357cf320d863ce9519c">&#9670;&nbsp;</a></span>dogecoin_script_is_scripthash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="dogecoin_8h.html#adb4b0440bc7e61a0efea47634d9b75b0">dogecoin_bool</a> dogecoin_script_is_scripthash </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>data_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function checks whether the script matches the template for a script hash, which is composed of an OP_HASH160, a push pubkey hash operation, and an OP_EQUAL, in that order. The script hash is then loaded into data_out. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ops</td><td>The pointer to the vector storing script data to be checked. </td></tr>
    <tr><td class="paramname">data_out</td><td>The pointer to a vector where script data will be copied to.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the script is a script hash, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00379">379</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  380</span>{</div>
<div class="line"><span class="lineno">  381</span>    <span class="keywordflow">if</span> ((ops-&gt;<a class="code hl_variable" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> == 3) &amp;&amp;</div>
<div class="line"><span class="lineno">  382</span>        <a class="code hl_function" href="script_8c.html#ab99cb7bc6b3bd9434399580da4d43ff3">dogecoin_script_is_op</a>(<a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 0), <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd">OP_HASH160</a>) &amp;&amp;</div>
<div class="line"><span class="lineno">  383</span>        <a class="code hl_function" href="script_8c.html#ac6f452f07b063e1a6b820bfeb068bcc0">dogecoin_script_is_op_pubkeyhash</a>(<a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 1)) &amp;&amp;</div>
<div class="line"><span class="lineno">  384</span>        <a class="code hl_function" href="script_8c.html#ab99cb7bc6b3bd9434399580da4d43ff3">dogecoin_script_is_op</a>(<a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 2), <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda383e0c5476b2ddc1839af951b393ca17">OP_EQUAL</a>)) {</div>
<div class="line"><span class="lineno">  385</span>        <span class="keywordflow">if</span> (data_out) {</div>
<div class="line"><span class="lineno">  386</span>            <span class="comment">//copy the data (hash160) in case of a non empty vector</span></div>
<div class="line"><span class="lineno">  387</span>            <span class="keyword">const</span> <a class="code hl_struct" href="structdogecoin__script__op__.html">dogecoin_script_op</a>* op = <a class="code hl_define" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 1);</div>
<div class="line"><span class="lineno">  388</span>            <a class="code hl_typedef" href="winunistd_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a>* <a class="code hl_struct" href="structbuffer.html">buffer</a> = <a class="code hl_function" href="mem_8c.html#a2eb6ed6a5cfda3a99145487a5445cfcf">dogecoin_calloc</a>(1, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="dogecoin_8h.html#aab46d644720ff920e4a685bcaed2ae6b">uint160</a>));</div>
<div class="line"><span class="lineno">  389</span>            <a class="code hl_function" href="mem_8c.html#ab5b323a3ddeb02bdcb2b5a8a46e2a4b7">memcpy_safe</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#a70f05d4a279d1957959bc94e8ba4fd9a">data</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="dogecoin_8h.html#aab46d644720ff920e4a685bcaed2ae6b">uint160</a>));</div>
<div class="line"><span class="lineno">  390</span>            <a class="code hl_function" href="vector_8c.html#af631040a8dbb1a2b7ce422ac40ef0085">vector_add</a>(data_out, <a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  391</span>        }</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  394</span>    }</div>
<div class="line"><span class="lineno">  395</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  396</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="script_8h_source.html#l00209">dogecoin_script_op_::data</a>, <a class="el" href="mem_8c_source.html#l00092">dogecoin_calloc()</a>, <a class="el" href="script_8c_source.html#l00257">dogecoin_script_is_op()</a>, <a class="el" href="script_8c_source.html#l00297">dogecoin_script_is_op_pubkeyhash()</a>, <a class="el" href="vector_8h_source.html#l00038">vector::len</a>, <a class="el" href="mem_8c_source.html#l00209">memcpy_safe()</a>, <a class="el" href="script_8h_source.html#l00126">OP_EQUAL</a>, <a class="el" href="script_8h_source.html#l00167">OP_HASH160</a>, <a class="el" href="vector_8c_source.html#l00182">vector_add()</a>, and <a class="el" href="vector_8h_source.html#l00044">vector_idx</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00477">dogecoin_script_classify()</a>, and <a class="el" href="script_8c_source.html#l00451">dogecoin_script_classify_ops()</a>.</p>

</div>
</div>
<a id="a8029e1959d97bdd2558af0d0e52870dd" name="a8029e1959d97bdd2558af0d0e52870dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8029e1959d97bdd2558af0d0e52870dd">&#9670;&nbsp;</a></span>dogecoin_script_op_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dogecoin_script_op_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="script_8h.html#a3728d27af357a79523869821d2eb1df4">dogecoin_script_op</a> *&#160;</td>
          <td class="paramname"><em>script_op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function frees the pointer to a dogecoin_script_op object and sets the pointer to NULL. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">script_op</td><td>The pointer to the script operation to be freed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Nothing. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00133">133</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  134</span>{</div>
<div class="line"><span class="lineno">  135</span>    <span class="keywordflow">if</span> (script_op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#a70f05d4a279d1957959bc94e8ba4fd9a">data</a>) {</div>
<div class="line"><span class="lineno">  136</span>        <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(script_op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#a70f05d4a279d1957959bc94e8ba4fd9a">data</a>);</div>
<div class="line"><span class="lineno">  137</span>        script_op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#a70f05d4a279d1957959bc94e8ba4fd9a">data</a> = NULL;</div>
<div class="line"><span class="lineno">  138</span>    }</div>
<div class="line"><span class="lineno">  139</span>    script_op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#af65580f7b14a649ede064ec049eb1045">datalen</a> = 0;</div>
<div class="line"><span class="lineno">  140</span>    script_op-&gt;<a class="code hl_variable" href="structdogecoin__script__op__.html#ac1ab6cd747adc0a3e4f606e4f2de0c23">op</a> = <a class="code hl_enumvalue" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaccd484dad2223fffdbdc2637c4f1e40e">OP_0</a>;</div>
<div class="line"><span class="lineno">  141</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="script_8h_source.html#l00209">dogecoin_script_op_::data</a>, <a class="el" href="script_8h_source.html#l00210">dogecoin_script_op_::datalen</a>, <a class="el" href="mem_8c_source.html#l00121">dogecoin_free()</a>, <a class="el" href="script_8h_source.html#l00208">dogecoin_script_op_::op</a>, and <a class="el" href="script_8h_source.html#l00056">OP_0</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00153">dogecoin_script_op_free_cb()</a>.</p>

</div>
</div>
<a id="acbb7e12c33b946ecd164a4d1fceba82a" name="acbb7e12c33b946ecd164a4d1fceba82a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbb7e12c33b946ecd164a4d1fceba82a">&#9670;&nbsp;</a></span>dogecoin_script_op_free_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dogecoin_script_op_free_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function casts data from a channel buffer to a dogecoin_script_op object and then frees it by calling <a class="el" href="script_8c.html#a8029e1959d97bdd2558af0d0e52870dd" title="This function frees the pointer to a dogecoin_script_op object and sets the pointer to NULL.">dogecoin_script_op_free()</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>The pointer to the data that must be cast.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Nothing. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00153">153</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  154</span>{</div>
<div class="line"><span class="lineno">  155</span>    <a class="code hl_struct" href="structdogecoin__script__op__.html">dogecoin_script_op</a>* script_op = data;</div>
<div class="line"><span class="lineno">  156</span>    <a class="code hl_function" href="script_8c.html#a8029e1959d97bdd2558af0d0e52870dd">dogecoin_script_op_free</a>(script_op);</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>    <a class="code hl_function" href="mem_8c.html#ad02c72991a2ff7d7a89d69c0234c4315">dogecoin_free</a>(script_op);</div>
<div class="line"><span class="lineno">  159</span>}</div>
<div class="ttc" id="ascript_8c_html_a8029e1959d97bdd2558af0d0e52870dd"><div class="ttname"><a href="script_8c.html#a8029e1959d97bdd2558af0d0e52870dd">dogecoin_script_op_free</a></div><div class="ttdeci">void dogecoin_script_op_free(dogecoin_script_op *script_op)</div><div class="ttdoc">This function frees the pointer to a dogecoin_script_op object and sets the pointer to NULL.</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00133">script.c:133</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mem_8c_source.html#l00121">dogecoin_free()</a>, and <a class="el" href="script_8c_source.html#l00133">dogecoin_script_op_free()</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00477">dogecoin_script_classify()</a>, and <a class="el" href="script_8c_source.html#l00171">dogecoin_script_get_ops()</a>.</p>

</div>
</div>
<a id="a9bebfe2ef20079d39e0dc13c88c631ec" name="a9bebfe2ef20079d39e0dc13c88c631ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bebfe2ef20079d39e0dc13c88c631ec">&#9670;&nbsp;</a></span>dogecoin_script_op_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="script_8h.html#a3728d27af357a79523869821d2eb1df4">dogecoin_script_op</a> * dogecoin_script_op_new </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allocates the memory for a new dogecoin_script_op object. </p>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the new script operation. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00116">116</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  117</span>{</div>
<div class="line"><span class="lineno">  118</span>    <a class="code hl_struct" href="structdogecoin__script__op__.html">dogecoin_script_op</a>* script_op;</div>
<div class="line"><span class="lineno">  119</span>    script_op = <a class="code hl_function" href="mem_8c.html#a2eb6ed6a5cfda3a99145487a5445cfcf">dogecoin_calloc</a>(1, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structdogecoin__script__op__.html">dogecoin_script_op</a>));</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    <span class="keywordflow">return</span> script_op;</div>
<div class="line"><span class="lineno">  122</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mem_8c_source.html#l00092">dogecoin_calloc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="script_8c_source.html#l00171">dogecoin_script_get_ops()</a>.</p>

</div>
</div>
<a id="a277f223fd0d455f2b382e0eada40329b" name="a277f223fd0d455f2b382e0eada40329b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a277f223fd0d455f2b382e0eada40329b">&#9670;&nbsp;</a></span>dogecoin_tx_out_type_to_str()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * dogecoin_tx_out_type_to_str </td>
          <td>(</td>
          <td class="paramtype">const enum <a class="el" href="script_8h.html#ab75ea367046ee2a256023effe4574b1b">dogecoin_tx_out_type</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes a script type and translates it into string format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>The type of script.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The string representation of the script. </dd></dl>

<p class="definition">Definition at line <a class="el" href="script_8c_source.html#l00679">679</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  680</span>{</div>
<div class="line"><span class="lineno">  681</span>    <span class="keywordflow">if</span> (type == <a class="code hl_enumvalue" href="script_8h.html#ab75ea367046ee2a256023effe4574b1ba6028ea503a8ea55b9e915dbb5376a6b9">DOGECOIN_TX_PUBKEY</a>) {</div>
<div class="line"><span class="lineno">  682</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;TX_PUBKEY&quot;</span>;</div>
<div class="line"><span class="lineno">  683</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code hl_enumvalue" href="script_8h.html#ab75ea367046ee2a256023effe4574b1badb7c91a93818352c5026868e19746ca0">DOGECOIN_TX_PUBKEYHASH</a>) {</div>
<div class="line"><span class="lineno">  684</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;TX_PUBKEYHASH&quot;</span>;</div>
<div class="line"><span class="lineno">  685</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code hl_enumvalue" href="script_8h.html#ab75ea367046ee2a256023effe4574b1ba281feb54432e7fa9c0088ae3995c6afb">DOGECOIN_TX_SCRIPTHASH</a>) {</div>
<div class="line"><span class="lineno">  686</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;TX_SCRIPTHASH&quot;</span>;</div>
<div class="line"><span class="lineno">  687</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code hl_enumvalue" href="script_8h.html#ab75ea367046ee2a256023effe4574b1ba06df59536e9760aaae2db2a617544f4f">DOGECOIN_TX_MULTISIG</a>) {</div>
<div class="line"><span class="lineno">  688</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;TX_MULTISIG&quot;</span>;</div>
<div class="line"><span class="lineno">  689</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  690</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;TX_NONSTANDARD&quot;</span>;</div>
<div class="line"><span class="lineno">  691</span>    }</div>
<div class="line"><span class="lineno">  692</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="script_8h_source.html#l00204">DOGECOIN_TX_MULTISIG</a>, <a class="el" href="script_8h_source.html#l00201">DOGECOIN_TX_PUBKEY</a>, <a class="el" href="script_8h_source.html#l00202">DOGECOIN_TX_PUBKEYHASH</a>, and <a class="el" href="script_8h_source.html#l00203">DOGECOIN_TX_SCRIPTHASH</a>.</p>

<p class="reference">Referenced by <a class="el" href="such_8c_source.html#l00668">main()</a>, and <a class="el" href="transaction_8c_source.html#l00479">sign_raw_transaction()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
