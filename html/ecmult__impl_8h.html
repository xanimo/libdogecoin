<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libdogecoin: src/secp256k1/src/ecmult_impl.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libdogecoin
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_44f34d1e62fda08bdb4ca69ab2d205ae.html">secp256k1</a></li><li class="navelem"><a class="el" href="dir_8db2ef784512d48b2a7d00369dfaac28.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">ecmult_impl.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;<a class="el" href="util_8h_source.html">util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="group_8h_source.html">group.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="scalar_8h_source.html">scalar.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ecmult_8h_source.html">ecmult.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="precomputed__ecmult_8h_source.html">precomputed_ecmult.h</a>&quot;</code><br />
</div>
<p><a href="ecmult__impl_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsecp256k1__strauss__point__state.html">secp256k1_strauss_point_state</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsecp256k1__strauss__state.html">secp256k1_strauss_state</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsecp256k1__pippenger__point__state.html">secp256k1_pippenger_point_state</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsecp256k1__pippenger__state.html">secp256k1_pippenger_state</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6216c81c6adbb8796c55fe0c8d3b6718"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a6216c81c6adbb8796c55fe0c8d3b6718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ca5efdae3396a6261bcc836e4a32739"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a7ca5efdae3396a6261bcc836e4a32739">WNAF_BITS</a>&#160;&#160;&#160;128</td></tr>
<tr class="separator:a7ca5efdae3396a6261bcc836e4a32739"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade3191685190c40779d2de9d0664216d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#ade3191685190c40779d2de9d0664216d">WNAF_SIZE_BITS</a>(bits,  w)&#160;&#160;&#160;(((bits) + (w) - 1) / (w))</td></tr>
<tr class="separator:ade3191685190c40779d2de9d0664216d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23d9fb349265ae338b9977f7f7aab065"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a23d9fb349265ae338b9977f7f7aab065">WNAF_SIZE</a>(w)&#160;&#160;&#160;<a class="el" href="ecmult__impl_8h.html#ade3191685190c40779d2de9d0664216d">WNAF_SIZE_BITS</a>(<a class="el" href="ecmult__impl_8h.html#a7ca5efdae3396a6261bcc836e4a32739">WNAF_BITS</a>, w)</td></tr>
<tr class="separator:a23d9fb349265ae338b9977f7f7aab065"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a991c52a2d9fa18dd39f5a9fffe373922"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a991c52a2d9fa18dd39f5a9fffe373922">PIPPENGER_SCRATCH_OBJECTS</a>&#160;&#160;&#160;6</td></tr>
<tr class="separator:a991c52a2d9fa18dd39f5a9fffe373922"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0447eb99687dea95c58a48eb6b6e17e2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a0447eb99687dea95c58a48eb6b6e17e2">STRAUSS_SCRATCH_OBJECTS</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a0447eb99687dea95c58a48eb6b6e17e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9114820daf51f54afc1858640539ac6d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a9114820daf51f54afc1858640539ac6d">PIPPENGER_MAX_BUCKET_WINDOW</a>&#160;&#160;&#160;12</td></tr>
<tr class="separator:a9114820daf51f54afc1858640539ac6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71e7f4ad865cad35efddc0495b59fcf3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a71e7f4ad865cad35efddc0495b59fcf3">ECMULT_PIPPENGER_THRESHOLD</a>&#160;&#160;&#160;88</td></tr>
<tr class="separator:a71e7f4ad865cad35efddc0495b59fcf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8be09901326f35f4390bb788d9fa2fea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a8be09901326f35f4390bb788d9fa2fea">ECMULT_MAX_POINTS_PER_BATCH</a>&#160;&#160;&#160;5000000</td></tr>
<tr class="separator:a8be09901326f35f4390bb788d9fa2fea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d4fb351e4919c5933128215d871052e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a5d4fb351e4919c5933128215d871052e">SECP256K1_ECMULT_TABLE_VERIFY</a>(n,  w)</td></tr>
<tr class="separator:a5d4fb351e4919c5933128215d871052e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:afedbad22c020fec93edb5823e9d385ed"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#afedbad22c020fec93edb5823e9d385ed">secp256k1_ecmult_multi_func</a>) (const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *error_callback, <a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *, <a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *, const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *, <a class="el" href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a> cb, void *, size_t)</td></tr>
<tr class="separator:afedbad22c020fec93edb5823e9d385ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aed8dc2160c07c97c063bdeffbffa46a8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#aed8dc2160c07c97c063bdeffbffa46a8">secp256k1_ecmult_odd_multiples_table</a> (int n, <a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *pre_a, <a class="el" href="structsecp256k1__fe.html">secp256k1_fe</a> *zr, <a class="el" href="structsecp256k1__fe.html">secp256k1_fe</a> *z, const <a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *a)</td></tr>
<tr class="separator:aed8dc2160c07c97c063bdeffbffa46a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc5af5df03e9ee8d78ea2489c05338bc"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#abc5af5df03e9ee8d78ea2489c05338bc">secp256k1_ecmult_table_get_ge</a> (<a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *r, const <a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *pre, int n, int w)</td></tr>
<tr class="separator:abc5af5df03e9ee8d78ea2489c05338bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c5a19ad45aa3f057dc34e92ae6bf1df"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a5c5a19ad45aa3f057dc34e92ae6bf1df">secp256k1_ecmult_table_get_ge_lambda</a> (<a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *r, const <a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *pre, const <a class="el" href="structsecp256k1__fe.html">secp256k1_fe</a> *x, int n, int w)</td></tr>
<tr class="separator:a5c5a19ad45aa3f057dc34e92ae6bf1df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cd4a3ce3d9292cd197283fc0e17749c"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a4cd4a3ce3d9292cd197283fc0e17749c">secp256k1_ecmult_table_get_ge_storage</a> (<a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *r, const <a class="el" href="structsecp256k1__ge__storage.html">secp256k1_ge_storage</a> *pre, int n, int w)</td></tr>
<tr class="separator:a4cd4a3ce3d9292cd197283fc0e17749c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48a8b6bbead18d4475c8a29d28376c5b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a48a8b6bbead18d4475c8a29d28376c5b">secp256k1_ecmult_wnaf</a> (int *wnaf, int len, const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *a, int w)</td></tr>
<tr class="separator:a48a8b6bbead18d4475c8a29d28376c5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af712c07897d43e290c166f73d11fd110"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#af712c07897d43e290c166f73d11fd110">secp256k1_ecmult_strauss_wnaf</a> (const struct <a class="el" href="structsecp256k1__strauss__state.html">secp256k1_strauss_state</a> *state, <a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *r, size_t num, const <a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *a, const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *na, const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *ng)</td></tr>
<tr class="separator:af712c07897d43e290c166f73d11fd110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa405bbca6527b19cbdfe5658272044db"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#aa405bbca6527b19cbdfe5658272044db">secp256k1_ecmult</a> (<a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *r, const <a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *a, const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *na, const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *ng)</td></tr>
<tr class="separator:aa405bbca6527b19cbdfe5658272044db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7146d7f05cdd7440271523da3674004c"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a7146d7f05cdd7440271523da3674004c">secp256k1_strauss_scratch_size</a> (size_t n_points)</td></tr>
<tr class="separator:a7146d7f05cdd7440271523da3674004c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa185e51cc47dae567c15da179a1b4b7c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#aa185e51cc47dae567c15da179a1b4b7c">secp256k1_ecmult_strauss_batch</a> (const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *error_callback, <a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *scratch, <a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *r, const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *inp_g_sc, <a class="el" href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a> cb, void *cbdata, size_t n_points, size_t cb_offset)</td></tr>
<tr class="separator:aa185e51cc47dae567c15da179a1b4b7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24500d7bf818b6782b88e2e53dcf85e2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a24500d7bf818b6782b88e2e53dcf85e2">secp256k1_ecmult_strauss_batch_single</a> (const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *error_callback, <a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *scratch, <a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *r, const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *inp_g_sc, <a class="el" href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a> cb, void *cbdata, size_t n)</td></tr>
<tr class="separator:a24500d7bf818b6782b88e2e53dcf85e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ed67cbaf00f8ccdfff87129844b8635"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a2ed67cbaf00f8ccdfff87129844b8635">secp256k1_strauss_max_points</a> (const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *error_callback, <a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *scratch)</td></tr>
<tr class="separator:a2ed67cbaf00f8ccdfff87129844b8635"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a346b925ab43432349898ad6a7ac9c31a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a346b925ab43432349898ad6a7ac9c31a">secp256k1_wnaf_fixed</a> (int *wnaf, const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *s, int w)</td></tr>
<tr class="separator:a346b925ab43432349898ad6a7ac9c31a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9fa16936f32ca87ef0fa602dd440e61"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#ab9fa16936f32ca87ef0fa602dd440e61">secp256k1_ecmult_pippenger_wnaf</a> (<a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *buckets, int bucket_window, struct <a class="el" href="structsecp256k1__pippenger__state.html">secp256k1_pippenger_state</a> *state, <a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *r, const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *sc, const <a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *pt, size_t num)</td></tr>
<tr class="separator:ab9fa16936f32ca87ef0fa602dd440e61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ab4c858354f0c2f67bf76642b15d82c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a7ab4c858354f0c2f67bf76642b15d82c">secp256k1_pippenger_bucket_window</a> (size_t n)</td></tr>
<tr class="separator:a7ab4c858354f0c2f67bf76642b15d82c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a087cc0c7875deb19ebefb6c7f86979e0"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a087cc0c7875deb19ebefb6c7f86979e0">secp256k1_pippenger_bucket_window_inv</a> (int bucket_window)</td></tr>
<tr class="separator:a087cc0c7875deb19ebefb6c7f86979e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b82a0af2e50a893f660ee0c0cad6886"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a3b82a0af2e50a893f660ee0c0cad6886">secp256k1_ecmult_endo_split</a> (<a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *s1, <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *s2, <a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *p1, <a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *p2)</td></tr>
<tr class="separator:a3b82a0af2e50a893f660ee0c0cad6886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb210b3b61e37937e46f58e3d78f89d1"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#abb210b3b61e37937e46f58e3d78f89d1">secp256k1_pippenger_scratch_size</a> (size_t n_points, int bucket_window)</td></tr>
<tr class="separator:abb210b3b61e37937e46f58e3d78f89d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1372e3ca22fc9730cc744a2007c6b1f3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a1372e3ca22fc9730cc744a2007c6b1f3">secp256k1_ecmult_pippenger_batch</a> (const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *error_callback, <a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *scratch, <a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *r, const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *inp_g_sc, <a class="el" href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a> cb, void *cbdata, size_t n_points, size_t cb_offset)</td></tr>
<tr class="separator:a1372e3ca22fc9730cc744a2007c6b1f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b70dc19eefeb37607ba72cf32f61847"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a7b70dc19eefeb37607ba72cf32f61847">secp256k1_ecmult_pippenger_batch_single</a> (const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *error_callback, <a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *scratch, <a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *r, const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *inp_g_sc, <a class="el" href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a> cb, void *cbdata, size_t n)</td></tr>
<tr class="separator:a7b70dc19eefeb37607ba72cf32f61847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a117129015e68d74721e8c62320bb86c7"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a117129015e68d74721e8c62320bb86c7">secp256k1_pippenger_max_points</a> (const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *error_callback, <a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *scratch)</td></tr>
<tr class="separator:a117129015e68d74721e8c62320bb86c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77c14862f4d2e7d6306a884c64baa8ad"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a77c14862f4d2e7d6306a884c64baa8ad">secp256k1_ecmult_multi_simple_var</a> (<a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *r, const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *inp_g_sc, <a class="el" href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a> cb, void *cbdata, size_t n_points)</td></tr>
<tr class="separator:a77c14862f4d2e7d6306a884c64baa8ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab645acb4c1b1831b5183926474c7335"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#aab645acb4c1b1831b5183926474c7335">secp256k1_ecmult_multi_batch_size_helper</a> (size_t *n_batches, size_t *n_batch_points, size_t max_n_batch_points, size_t n)</td></tr>
<tr class="separator:aab645acb4c1b1831b5183926474c7335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a570f27c620391853d1ca8e4be199eb66"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecmult__impl_8h.html#a570f27c620391853d1ca8e4be199eb66">secp256k1_ecmult_multi_var</a> (const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *error_callback, <a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *scratch, <a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *r, const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *inp_g_sc, <a class="el" href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a> cb, void *cbdata, size_t n)</td></tr>
<tr class="separator:a570f27c620391853d1ca8e4be199eb66"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a8be09901326f35f4390bb788d9fa2fea" name="a8be09901326f35f4390bb788d9fa2fea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8be09901326f35f4390bb788d9fa2fea">&#9670;&nbsp;</a></span>ECMULT_MAX_POINTS_PER_BATCH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ECMULT_MAX_POINTS_PER_BATCH&#160;&#160;&#160;5000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00057">57</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>

</div>
</div>
<a id="a71e7f4ad865cad35efddc0495b59fcf3" name="a71e7f4ad865cad35efddc0495b59fcf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71e7f4ad865cad35efddc0495b59fcf3">&#9670;&nbsp;</a></span>ECMULT_PIPPENGER_THRESHOLD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ECMULT_PIPPENGER_THRESHOLD&#160;&#160;&#160;88</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00055">55</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>

</div>
</div>
<a id="a9114820daf51f54afc1858640539ac6d" name="a9114820daf51f54afc1858640539ac6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9114820daf51f54afc1858640539ac6d">&#9670;&nbsp;</a></span>PIPPENGER_MAX_BUCKET_WINDOW</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIPPENGER_MAX_BUCKET_WINDOW&#160;&#160;&#160;12</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00052">52</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>

</div>
</div>
<a id="a991c52a2d9fa18dd39f5a9fffe373922" name="a991c52a2d9fa18dd39f5a9fffe373922"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a991c52a2d9fa18dd39f5a9fffe373922">&#9670;&nbsp;</a></span>PIPPENGER_SCRATCH_OBJECTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIPPENGER_SCRATCH_OBJECTS&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00049">49</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>

</div>
</div>
<a id="a5d4fb351e4919c5933128215d871052e" name="a5d4fb351e4919c5933128215d871052e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d4fb351e4919c5933128215d871052e">&#9670;&nbsp;</a></span>SECP256K1_ECMULT_TABLE_VERIFY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SECP256K1_ECMULT_TABLE_VERIFY</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <a class="code hl_define" href="util_8h.html#aca8ac5ae73fd966db106de59160a178b">VERIFY_CHECK</a>(((n) &amp; 1) == 1); \</div>
<div class="line">    VERIFY_CHECK((n) &gt;= -((1 &lt;&lt; ((w)-1)) - 1)); \</div>
<div class="line">    VERIFY_CHECK((n) &lt;=  ((1 &lt;&lt; ((w)-1)) - 1));</div>
<div class="ttc" id="autil_8h_html_aca8ac5ae73fd966db106de59160a178b"><div class="ttname"><a href="util_8h.html#aca8ac5ae73fd966db106de59160a178b">VERIFY_CHECK</a></div><div class="ttdeci">#define VERIFY_CHECK(cond)</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00095">util.h:95</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00117">117</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>

</div>
</div>
<a id="a0447eb99687dea95c58a48eb6b6e17e2" name="a0447eb99687dea95c58a48eb6b6e17e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0447eb99687dea95c58a48eb6b6e17e2">&#9670;&nbsp;</a></span>STRAUSS_SCRATCH_OBJECTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STRAUSS_SCRATCH_OBJECTS&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00050">50</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>

</div>
</div>
<a id="a6216c81c6adbb8796c55fe0c8d3b6718" name="a6216c81c6adbb8796c55fe0c8d3b6718"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6216c81c6adbb8796c55fe0c8d3b6718">&#9670;&nbsp;</a></span>WINDOW_A</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WINDOW_A&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00032">32</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>

</div>
</div>
<a id="a7ca5efdae3396a6261bcc836e4a32739" name="a7ca5efdae3396a6261bcc836e4a32739"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ca5efdae3396a6261bcc836e4a32739">&#9670;&nbsp;</a></span>WNAF_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WNAF_BITS&#160;&#160;&#160;128</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Larger values for ECMULT_WINDOW_SIZE result in possibly better performance at the cost of an exponentially larger precomputed table. The exact table size is (1 &lt;&lt; (WINDOW_G - 2)) * sizeof(secp256k1_ge_storage) bytes, where sizeof(secp256k1_ge_storage) is typically 64 bytes but can be larger due to platform-specific padding and alignment. Two tables of this size are used (due to the endomorphism optimization). </p>

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00044">44</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>

</div>
</div>
<a id="a23d9fb349265ae338b9977f7f7aab065" name="a23d9fb349265ae338b9977f7f7aab065"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23d9fb349265ae338b9977f7f7aab065">&#9670;&nbsp;</a></span>WNAF_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WNAF_SIZE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="ecmult__impl_8h.html#ade3191685190c40779d2de9d0664216d">WNAF_SIZE_BITS</a>(<a class="el" href="ecmult__impl_8h.html#a7ca5efdae3396a6261bcc836e4a32739">WNAF_BITS</a>, w)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00046">46</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>

</div>
</div>
<a id="ade3191685190c40779d2de9d0664216d" name="ade3191685190c40779d2de9d0664216d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade3191685190c40779d2de9d0664216d">&#9670;&nbsp;</a></span>WNAF_SIZE_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WNAF_SIZE_BITS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">bits, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((bits) + (w) - 1) / (w))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00045">45</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="afedbad22c020fec93edb5823e9d385ed" name="afedbad22c020fec93edb5823e9d385ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afedbad22c020fec93edb5823e9d385ed">&#9670;&nbsp;</a></span>secp256k1_ecmult_multi_func</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* secp256k1_ecmult_multi_func) (const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *error_callback, <a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *, <a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *, const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *, <a class="el" href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a> cb, void *, size_t)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00810">810</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa405bbca6527b19cbdfe5658272044db" name="aa405bbca6527b19cbdfe5658272044db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa405bbca6527b19cbdfe5658272044db">&#9670;&nbsp;</a></span>secp256k1_ecmult()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void secp256k1_ecmult </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>na</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>ng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00338">338</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  338</span>                                                                                                                               {</div>
<div class="line"><span class="lineno">  339</span>    <a class="code hl_struct" href="structsecp256k1__fe.html">secp256k1_fe</a> aux[<a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>)];</div>
<div class="line"><span class="lineno">  340</span>    <a class="code hl_struct" href="structsecp256k1__ge.html">secp256k1_ge</a> pre_a[<a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>)];</div>
<div class="line"><span class="lineno">  341</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structsecp256k1__strauss__point__state.html">secp256k1_strauss_point_state</a> ps[1];</div>
<div class="line"><span class="lineno">  342</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structsecp256k1__strauss__state.html">secp256k1_strauss_state</a> state;</div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>    state.<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a120d3c972fb65e1b85dd3b9480d340a3">aux</a> = <a class="code hl_variable" href="structsecp256k1__strauss__state.html#a120d3c972fb65e1b85dd3b9480d340a3">aux</a>;</div>
<div class="line"><span class="lineno">  345</span>    state.pre_a = <a class="code hl_variable" href="structsecp256k1__strauss__state.html#af259a5034686dfa2147d502f09498bbf">pre_a</a>;</div>
<div class="line"><span class="lineno">  346</span>    state.ps = <a class="code hl_variable" href="structsecp256k1__strauss__state.html#a2fdfe126142acc077aed3667a8401504">ps</a>;</div>
<div class="line"><span class="lineno">  347</span>    <a class="code hl_function" href="ecmult__impl_8h.html#af712c07897d43e290c166f73d11fd110">secp256k1_ecmult_strauss_wnaf</a>(&amp;state, r, 1, a, na, ng);</div>
<div class="line"><span class="lineno">  348</span>}</div>
<div class="ttc" id="aecmult_8h_html_a97c6c6e5aa98f202eec77c4c931e02f1"><div class="ttname"><a href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a></div><div class="ttdeci">#define ECMULT_TABLE_SIZE(w)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult_8h_source.html#l00030">ecmult.h:30</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_a6216c81c6adbb8796c55fe0c8d3b6718"><div class="ttname"><a href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a></div><div class="ttdeci">#define WINDOW_A</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00032">ecmult_impl.h:32</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_af712c07897d43e290c166f73d11fd110"><div class="ttname"><a href="ecmult__impl_8h.html#af712c07897d43e290c166f73d11fd110">secp256k1_ecmult_strauss_wnaf</a></div><div class="ttdeci">static void secp256k1_ecmult_strauss_wnaf(const struct secp256k1_strauss_state *state, secp256k1_gej *r, size_t num, const secp256k1_gej *a, const secp256k1_scalar *na, const secp256k1_scalar *ng)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00225">ecmult_impl.h:225</a></div></div>
<div class="ttc" id="astructsecp256k1__fe_html"><div class="ttname"><a href="structsecp256k1__fe.html">secp256k1_fe</a></div><div class="ttdef"><b>Definition:</b> <a href="field__10x26_8h_source.html#l00012">field_10x26.h:12</a></div></div>
<div class="ttc" id="astructsecp256k1__ge_html"><div class="ttname"><a href="structsecp256k1__ge.html">secp256k1_ge</a></div><div class="ttdef"><b>Definition:</b> <a href="group_8h_source.html#l00016">group.h:16</a></div></div>
<div class="ttc" id="astructsecp256k1__strauss__point__state_html"><div class="ttname"><a href="structsecp256k1__strauss__point__state.html">secp256k1_strauss_point_state</a></div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00211">ecmult_impl.h:211</a></div></div>
<div class="ttc" id="astructsecp256k1__strauss__state_html"><div class="ttname"><a href="structsecp256k1__strauss__state.html">secp256k1_strauss_state</a></div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00218">ecmult_impl.h:218</a></div></div>
<div class="ttc" id="astructsecp256k1__strauss__state_html_a120d3c972fb65e1b85dd3b9480d340a3"><div class="ttname"><a href="structsecp256k1__strauss__state.html#a120d3c972fb65e1b85dd3b9480d340a3">secp256k1_strauss_state::aux</a></div><div class="ttdeci">secp256k1_fe * aux</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00220">ecmult_impl.h:220</a></div></div>
<div class="ttc" id="astructsecp256k1__strauss__state_html_a2fdfe126142acc077aed3667a8401504"><div class="ttname"><a href="structsecp256k1__strauss__state.html#a2fdfe126142acc077aed3667a8401504">secp256k1_strauss_state::ps</a></div><div class="ttdeci">struct secp256k1_strauss_point_state * ps</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00222">ecmult_impl.h:222</a></div></div>
<div class="ttc" id="astructsecp256k1__strauss__state_html_af259a5034686dfa2147d502f09498bbf"><div class="ttname"><a href="structsecp256k1__strauss__state.html#af259a5034686dfa2147d502f09498bbf">secp256k1_strauss_state::pre_a</a></div><div class="ttdeci">secp256k1_ge * pre_a</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00221">ecmult_impl.h:221</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00220">secp256k1_strauss_state::aux</a>, <a class="el" href="ecmult_8h_source.html#l00030">ECMULT_TABLE_SIZE</a>, <a class="el" href="ecmult__impl_8h_source.html#l00221">secp256k1_strauss_state::pre_a</a>, <a class="el" href="ecmult__impl_8h_source.html#l00222">secp256k1_strauss_state::ps</a>, <a class="el" href="ecmult__impl_8h_source.html#l00225">secp256k1_ecmult_strauss_wnaf()</a>, and <a class="el" href="ecmult__impl_8h_source.html#l00032">WINDOW_A</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00765">secp256k1_ecmult_multi_simple_var()</a>, and <a class="el" href="ecmult__impl_8h_source.html#l00811">secp256k1_ecmult_multi_var()</a>.</p>

</div>
</div>
<a id="a3b82a0af2e50a893f660ee0c0cad6886" name="a3b82a0af2e50a893f660ee0c0cad6886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b82a0af2e50a893f660ee0c0cad6886">&#9670;&nbsp;</a></span>secp256k1_ecmult_endo_split()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> void secp256k1_ecmult_endo_split </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>s1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>s2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *&#160;</td>
          <td class="paramname"><em>p2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00618">618</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  618</span>                                                                                                                                         {</div>
<div class="line"><span class="lineno">  619</span>    <a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a> tmp = *s1;</div>
<div class="line"><span class="lineno">  620</span>    <a class="code hl_function" href="scalar_8h.html#add6996401338effdcd60490839857583">secp256k1_scalar_split_lambda</a>(s1, s2, &amp;tmp);</div>
<div class="line"><span class="lineno">  621</span>    <a class="code hl_function" href="group_8h.html#a29878e618b862a27fa3e68b25cdb2ec8">secp256k1_ge_mul_lambda</a>(p2, p1);</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="scalar_8h.html#aab66620cbbe49bec3c7c02f4a1219c05">secp256k1_scalar_is_high</a>(s1)) {</div>
<div class="line"><span class="lineno">  624</span>        <a class="code hl_function" href="scalar_8h.html#aa3f1c1d4536adf835ee256878c222968">secp256k1_scalar_negate</a>(s1, s1);</div>
<div class="line"><span class="lineno">  625</span>        <a class="code hl_function" href="group_8h.html#abcb34de0cfdf82a125e059f4f98de1d9">secp256k1_ge_neg</a>(p1, p1);</div>
<div class="line"><span class="lineno">  626</span>    }</div>
<div class="line"><span class="lineno">  627</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="scalar_8h.html#aab66620cbbe49bec3c7c02f4a1219c05">secp256k1_scalar_is_high</a>(s2)) {</div>
<div class="line"><span class="lineno">  628</span>        <a class="code hl_function" href="scalar_8h.html#aa3f1c1d4536adf835ee256878c222968">secp256k1_scalar_negate</a>(s2, s2);</div>
<div class="line"><span class="lineno">  629</span>        <a class="code hl_function" href="group_8h.html#abcb34de0cfdf82a125e059f4f98de1d9">secp256k1_ge_neg</a>(p2, p2);</div>
<div class="line"><span class="lineno">  630</span>    }</div>
<div class="line"><span class="lineno">  631</span>}</div>
<div class="ttc" id="agroup_8h_html_a29878e618b862a27fa3e68b25cdb2ec8"><div class="ttname"><a href="group_8h.html#a29878e618b862a27fa3e68b25cdb2ec8">secp256k1_ge_mul_lambda</a></div><div class="ttdeci">static void secp256k1_ge_mul_lambda(secp256k1_ge *r, const secp256k1_ge *a)</div></div>
<div class="ttc" id="agroup_8h_html_abcb34de0cfdf82a125e059f4f98de1d9"><div class="ttname"><a href="group_8h.html#abcb34de0cfdf82a125e059f4f98de1d9">secp256k1_ge_neg</a></div><div class="ttdeci">static void secp256k1_ge_neg(secp256k1_ge *r, const secp256k1_ge *a)</div></div>
<div class="ttc" id="ascalar_8h_html_aa3f1c1d4536adf835ee256878c222968"><div class="ttname"><a href="scalar_8h.html#aa3f1c1d4536adf835ee256878c222968">secp256k1_scalar_negate</a></div><div class="ttdeci">static void secp256k1_scalar_negate(secp256k1_scalar *r, const secp256k1_scalar *a)</div></div>
<div class="ttc" id="ascalar_8h_html_aab66620cbbe49bec3c7c02f4a1219c05"><div class="ttname"><a href="scalar_8h.html#aab66620cbbe49bec3c7c02f4a1219c05">secp256k1_scalar_is_high</a></div><div class="ttdeci">static int secp256k1_scalar_is_high(const secp256k1_scalar *a)</div></div>
<div class="ttc" id="ascalar_8h_html_add6996401338effdcd60490839857583"><div class="ttname"><a href="scalar_8h.html#add6996401338effdcd60490839857583">secp256k1_scalar_split_lambda</a></div><div class="ttdeci">static void secp256k1_scalar_split_lambda(secp256k1_scalar *r1, secp256k1_scalar *r2, const secp256k1_scalar *k)</div></div>
<div class="ttc" id="astructsecp256k1__scalar_html"><div class="ttname"><a href="structsecp256k1__scalar.html">secp256k1_scalar</a></div><div class="ttdef"><b>Definition:</b> <a href="scalar__4x64_8h_source.html#l00013">scalar_4x64.h:13</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="group_8h.html#a29878e618b862a27fa3e68b25cdb2ec8">secp256k1_ge_mul_lambda()</a>, <a class="el" href="group_8h.html#abcb34de0cfdf82a125e059f4f98de1d9">secp256k1_ge_neg()</a>, <a class="el" href="scalar_8h.html#aab66620cbbe49bec3c7c02f4a1219c05">secp256k1_scalar_is_high()</a>, <a class="el" href="scalar_8h.html#aa3f1c1d4536adf835ee256878c222968">secp256k1_scalar_negate()</a>, and <a class="el" href="scalar_8h.html#add6996401338effdcd60490839857583">secp256k1_scalar_split_lambda()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00643">secp256k1_ecmult_pippenger_batch()</a>.</p>

</div>
</div>
<a id="aab645acb4c1b1831b5183926474c7335" name="aab645acb4c1b1831b5183926474c7335"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab645acb4c1b1831b5183926474c7335">&#9670;&nbsp;</a></span>secp256k1_ecmult_multi_batch_size_helper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int secp256k1_ecmult_multi_batch_size_helper </td>
          <td>(</td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>n_batches</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>n_batch_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_n_batch_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00792">792</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  792</span>                                                                                                                                    {</div>
<div class="line"><span class="lineno">  793</span>    <span class="keywordflow">if</span> (max_n_batch_points == 0) {</div>
<div class="line"><span class="lineno">  794</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  795</span>    }</div>
<div class="line"><span class="lineno">  796</span>    <span class="keywordflow">if</span> (max_n_batch_points &gt; <a class="code hl_define" href="ecmult__impl_8h.html#a8be09901326f35f4390bb788d9fa2fea">ECMULT_MAX_POINTS_PER_BATCH</a>) {</div>
<div class="line"><span class="lineno">  797</span>        max_n_batch_points = <a class="code hl_define" href="ecmult__impl_8h.html#a8be09901326f35f4390bb788d9fa2fea">ECMULT_MAX_POINTS_PER_BATCH</a>;</div>
<div class="line"><span class="lineno">  798</span>    }</div>
<div class="line"><span class="lineno">  799</span>    <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line"><span class="lineno">  800</span>        *n_batches = 0;</div>
<div class="line"><span class="lineno">  801</span>        *n_batch_points = 0;</div>
<div class="line"><span class="lineno">  802</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  803</span>    }</div>
<div class="line"><span class="lineno">  804</span>    <span class="comment">/* Compute ceil(n/max_n_batch_points) and ceil(n/n_batches) */</span></div>
<div class="line"><span class="lineno">  805</span>    *n_batches = 1 + (n - 1) / max_n_batch_points;</div>
<div class="line"><span class="lineno">  806</span>    *n_batch_points = 1 + (n - 1) / *n_batches;</div>
<div class="line"><span class="lineno">  807</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  808</span>}</div>
<div class="ttc" id="aecmult__impl_8h_html_a8be09901326f35f4390bb788d9fa2fea"><div class="ttname"><a href="ecmult__impl_8h.html#a8be09901326f35f4390bb788d9fa2fea">ECMULT_MAX_POINTS_PER_BATCH</a></div><div class="ttdeci">#define ECMULT_MAX_POINTS_PER_BATCH</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00057">ecmult_impl.h:57</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00057">ECMULT_MAX_POINTS_PER_BATCH</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00811">secp256k1_ecmult_multi_var()</a>, and <a class="el" href="tests_8c_source.html#l04338">test_ecmult_multi_batch_size_helper()</a>.</p>

</div>
</div>
<a id="a77c14862f4d2e7d6306a884c64baa8ad" name="a77c14862f4d2e7d6306a884c64baa8ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77c14862f4d2e7d6306a884c64baa8ad">&#9670;&nbsp;</a></span>secp256k1_ecmult_multi_simple_var()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int secp256k1_ecmult_multi_simple_var </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>inp_g_sc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cbdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_points</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00765">765</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  765</span>                                                                                                                                                                    {</div>
<div class="line"><span class="lineno">  766</span>    <span class="keywordtype">size_t</span> point_idx;</div>
<div class="line"><span class="lineno">  767</span>    <a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a> szero;</div>
<div class="line"><span class="lineno">  768</span>    <a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a> tmpj;</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>    <a class="code hl_function" href="scalar_8h.html#a41cb11650e4dea0fe7ac5b59b9fce9dc">secp256k1_scalar_set_int</a>(&amp;szero, 0);</div>
<div class="line"><span class="lineno">  771</span>    <a class="code hl_function" href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity</a>(r);</div>
<div class="line"><span class="lineno">  772</span>    <a class="code hl_function" href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity</a>(&amp;tmpj);</div>
<div class="line"><span class="lineno">  773</span>    <span class="comment">/* r = inp_g_sc*G */</span></div>
<div class="line"><span class="lineno">  774</span>    <a class="code hl_function" href="ecmult__impl_8h.html#aa405bbca6527b19cbdfe5658272044db">secp256k1_ecmult</a>(r, &amp;tmpj, &amp;szero, inp_g_sc);</div>
<div class="line"><span class="lineno">  775</span>    <span class="keywordflow">for</span> (point_idx = 0; point_idx &lt; n_points; point_idx++) {</div>
<div class="line"><span class="lineno">  776</span>        <a class="code hl_struct" href="structsecp256k1__ge.html">secp256k1_ge</a> point;</div>
<div class="line"><span class="lineno">  777</span>        <a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a> pointj;</div>
<div class="line"><span class="lineno">  778</span>        <a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a> scalar;</div>
<div class="line"><span class="lineno">  779</span>        <span class="keywordflow">if</span> (!cb(&amp;scalar, &amp;point, point_idx, cbdata)) {</div>
<div class="line"><span class="lineno">  780</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  781</span>        }</div>
<div class="line"><span class="lineno">  782</span>        <span class="comment">/* r += scalar*point */</span></div>
<div class="line"><span class="lineno">  783</span>        <a class="code hl_function" href="group_8h.html#ad5f813e26afb239f03e83f0e61e05498">secp256k1_gej_set_ge</a>(&amp;pointj, &amp;point);</div>
<div class="line"><span class="lineno">  784</span>        <a class="code hl_function" href="ecmult__impl_8h.html#aa405bbca6527b19cbdfe5658272044db">secp256k1_ecmult</a>(&amp;tmpj, &amp;pointj, &amp;scalar, NULL);</div>
<div class="line"><span class="lineno">  785</span>        <a class="code hl_function" href="group_8h.html#a8df21f3ef7412e6c4d39fb67dc0140c6">secp256k1_gej_add_var</a>(r, r, &amp;tmpj, NULL);</div>
<div class="line"><span class="lineno">  786</span>    }</div>
<div class="line"><span class="lineno">  787</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  788</span>}</div>
<div class="ttc" id="aecmult__impl_8h_html_aa405bbca6527b19cbdfe5658272044db"><div class="ttname"><a href="ecmult__impl_8h.html#aa405bbca6527b19cbdfe5658272044db">secp256k1_ecmult</a></div><div class="ttdeci">static void secp256k1_ecmult(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_scalar *na, const secp256k1_scalar *ng)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00338">ecmult_impl.h:338</a></div></div>
<div class="ttc" id="agroup_8h_html_a2c6b24a2db08260d89e891eab7035b2c"><div class="ttname"><a href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity</a></div><div class="ttdeci">static void secp256k1_gej_set_infinity(secp256k1_gej *r)</div></div>
<div class="ttc" id="agroup_8h_html_a8df21f3ef7412e6c4d39fb67dc0140c6"><div class="ttname"><a href="group_8h.html#a8df21f3ef7412e6c4d39fb67dc0140c6">secp256k1_gej_add_var</a></div><div class="ttdeci">static void secp256k1_gej_add_var(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_gej *b, secp256k1_fe *rzr)</div></div>
<div class="ttc" id="agroup_8h_html_ad5f813e26afb239f03e83f0e61e05498"><div class="ttname"><a href="group_8h.html#ad5f813e26afb239f03e83f0e61e05498">secp256k1_gej_set_ge</a></div><div class="ttdeci">static void secp256k1_gej_set_ge(secp256k1_gej *r, const secp256k1_ge *a)</div></div>
<div class="ttc" id="ascalar_8h_html_a41cb11650e4dea0fe7ac5b59b9fce9dc"><div class="ttname"><a href="scalar_8h.html#a41cb11650e4dea0fe7ac5b59b9fce9dc">secp256k1_scalar_set_int</a></div><div class="ttdeci">static void secp256k1_scalar_set_int(secp256k1_scalar *r, unsigned int v)</div></div>
<div class="ttc" id="astructsecp256k1__gej_html"><div class="ttname"><a href="structsecp256k1__gej.html">secp256k1_gej</a></div><div class="ttdef"><b>Definition:</b> <a href="group_8h_source.html#l00028">group.h:28</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00338">secp256k1_ecmult()</a>, <a class="el" href="group_8h.html#a8df21f3ef7412e6c4d39fb67dc0140c6">secp256k1_gej_add_var()</a>, <a class="el" href="group_8h.html#ad5f813e26afb239f03e83f0e61e05498">secp256k1_gej_set_ge()</a>, <a class="el" href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity()</a>, and <a class="el" href="scalar_8h.html#a41cb11650e4dea0fe7ac5b59b9fce9dc">secp256k1_scalar_set_int()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00811">secp256k1_ecmult_multi_var()</a>.</p>

</div>
</div>
<a id="a570f27c620391853d1ca8e4be199eb66" name="a570f27c620391853d1ca8e4be199eb66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a570f27c620391853d1ca8e4be199eb66">&#9670;&nbsp;</a></span>secp256k1_ecmult_multi_var()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int secp256k1_ecmult_multi_var </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *&#160;</td>
          <td class="paramname"><em>error_callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *&#160;</td>
          <td class="paramname"><em>scratch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>inp_g_sc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cbdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00811">811</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  811</span>                                                                                                                                                                                                                            {</div>
<div class="line"><span class="lineno">  812</span>    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span>    int (*f)(<span class="keyword">const</span> <a class="code hl_struct" href="structsecp256k1__callback.html">secp256k1_callback</a>* error_callback, <a class="code hl_struct" href="structsecp256k1__scratch__space__struct.html">secp256k1_scratch</a>*, <a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a>*, <span class="keyword">const</span> <a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a>*, <a class="code hl_typedef" href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a> cb, <span class="keywordtype">void</span>*, size_t, size_t);</div>
<div class="line"><span class="lineno">  815</span>    <span class="keywordtype">size_t</span> n_batches;</div>
<div class="line"><span class="lineno">  816</span>    <span class="keywordtype">size_t</span> n_batch_points;</div>
<div class="line"><span class="lineno">  817</span> </div>
<div class="line"><span class="lineno">  818</span>    <a class="code hl_function" href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity</a>(r);</div>
<div class="line"><span class="lineno">  819</span>    <span class="keywordflow">if</span> (inp_g_sc == NULL &amp;&amp; n == 0) {</div>
<div class="line"><span class="lineno">  820</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  821</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line"><span class="lineno">  822</span>        <a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a> szero;</div>
<div class="line"><span class="lineno">  823</span>        <a class="code hl_function" href="scalar_8h.html#a41cb11650e4dea0fe7ac5b59b9fce9dc">secp256k1_scalar_set_int</a>(&amp;szero, 0);</div>
<div class="line"><span class="lineno">  824</span>        <a class="code hl_function" href="ecmult__impl_8h.html#aa405bbca6527b19cbdfe5658272044db">secp256k1_ecmult</a>(r, r, &amp;szero, inp_g_sc);</div>
<div class="line"><span class="lineno">  825</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  826</span>    }</div>
<div class="line"><span class="lineno">  827</span>    <span class="keywordflow">if</span> (scratch == NULL) {</div>
<div class="line"><span class="lineno">  828</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="ecmult__impl_8h.html#a77c14862f4d2e7d6306a884c64baa8ad">secp256k1_ecmult_multi_simple_var</a>(r, inp_g_sc, cb, cbdata, n);</div>
<div class="line"><span class="lineno">  829</span>    }</div>
<div class="line"><span class="lineno">  830</span> </div>
<div class="line"><span class="lineno">  831</span>    <span class="comment">/* Compute the batch sizes for Pippenger&#39;s algorithm given a scratch space. If it&#39;s greater than</span></div>
<div class="line"><span class="lineno">  832</span><span class="comment">     * a threshold use Pippenger&#39;s algorithm. Otherwise use Strauss&#39; algorithm.</span></div>
<div class="line"><span class="lineno">  833</span><span class="comment">     * As a first step check if there&#39;s enough space for Pippenger&#39;s algo (which requires less space</span></div>
<div class="line"><span class="lineno">  834</span><span class="comment">     * than Strauss&#39; algo) and if not, use the simple algorithm. */</span></div>
<div class="line"><span class="lineno">  835</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="ecmult__impl_8h.html#aab645acb4c1b1831b5183926474c7335">secp256k1_ecmult_multi_batch_size_helper</a>(&amp;n_batches, &amp;n_batch_points, <a class="code hl_function" href="ecmult__impl_8h.html#a117129015e68d74721e8c62320bb86c7">secp256k1_pippenger_max_points</a>(error_callback, scratch), n)) {</div>
<div class="line"><span class="lineno">  836</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="ecmult__impl_8h.html#a77c14862f4d2e7d6306a884c64baa8ad">secp256k1_ecmult_multi_simple_var</a>(r, inp_g_sc, cb, cbdata, n);</div>
<div class="line"><span class="lineno">  837</span>    }</div>
<div class="line"><span class="lineno">  838</span>    <span class="keywordflow">if</span> (n_batch_points &gt;= <a class="code hl_define" href="ecmult__impl_8h.html#a71e7f4ad865cad35efddc0495b59fcf3">ECMULT_PIPPENGER_THRESHOLD</a>) {</div>
<div class="line"><span class="lineno">  839</span>        f = <a class="code hl_function" href="ecmult__impl_8h.html#a1372e3ca22fc9730cc744a2007c6b1f3">secp256k1_ecmult_pippenger_batch</a>;</div>
<div class="line"><span class="lineno">  840</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  841</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="ecmult__impl_8h.html#aab645acb4c1b1831b5183926474c7335">secp256k1_ecmult_multi_batch_size_helper</a>(&amp;n_batches, &amp;n_batch_points, <a class="code hl_function" href="ecmult__impl_8h.html#a2ed67cbaf00f8ccdfff87129844b8635">secp256k1_strauss_max_points</a>(error_callback, scratch), n)) {</div>
<div class="line"><span class="lineno">  842</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="ecmult__impl_8h.html#a77c14862f4d2e7d6306a884c64baa8ad">secp256k1_ecmult_multi_simple_var</a>(r, inp_g_sc, cb, cbdata, n);</div>
<div class="line"><span class="lineno">  843</span>        }</div>
<div class="line"><span class="lineno">  844</span>        f = <a class="code hl_function" href="ecmult__impl_8h.html#aa185e51cc47dae567c15da179a1b4b7c">secp256k1_ecmult_strauss_batch</a>;</div>
<div class="line"><span class="lineno">  845</span>    }</div>
<div class="line"><span class="lineno">  846</span>    <span class="keywordflow">for</span>(i = 0; i &lt; n_batches; i++) {</div>
<div class="line"><span class="lineno">  847</span>        <span class="keywordtype">size_t</span> nbp = n &lt; n_batch_points ? n : n_batch_points;</div>
<div class="line"><span class="lineno">  848</span>        <span class="keywordtype">size_t</span> offset = n_batch_points*i;</div>
<div class="line"><span class="lineno">  849</span>        <a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a> tmp;</div>
<div class="line"><span class="lineno">  850</span>        <span class="keywordflow">if</span> (!f(error_callback, scratch, &amp;tmp, i == 0 ? inp_g_sc : NULL, cb, cbdata, nbp, offset)) {</div>
<div class="line"><span class="lineno">  851</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  852</span>        }</div>
<div class="line"><span class="lineno">  853</span>        <a class="code hl_function" href="group_8h.html#a8df21f3ef7412e6c4d39fb67dc0140c6">secp256k1_gej_add_var</a>(r, r, &amp;tmp, NULL);</div>
<div class="line"><span class="lineno">  854</span>        n -= nbp;</div>
<div class="line"><span class="lineno">  855</span>    }</div>
<div class="line"><span class="lineno">  856</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  857</span>}</div>
<div class="ttc" id="aecmult_8h_html_ad93ba815a113f52bd5649e9d27a921a0"><div class="ttname"><a href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a></div><div class="ttdeci">int() secp256k1_ecmult_multi_callback(secp256k1_scalar *sc, secp256k1_ge *pt, size_t idx, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult_8h_source.html#l00035">ecmult.h:35</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_a117129015e68d74721e8c62320bb86c7"><div class="ttname"><a href="ecmult__impl_8h.html#a117129015e68d74721e8c62320bb86c7">secp256k1_pippenger_max_points</a></div><div class="ttdeci">static size_t secp256k1_pippenger_max_points(const secp256k1_callback *error_callback, secp256k1_scratch *scratch)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00729">ecmult_impl.h:729</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_a1372e3ca22fc9730cc744a2007c6b1f3"><div class="ttname"><a href="ecmult__impl_8h.html#a1372e3ca22fc9730cc744a2007c6b1f3">secp256k1_ecmult_pippenger_batch</a></div><div class="ttdeci">static int secp256k1_ecmult_pippenger_batch(const secp256k1_callback *error_callback, secp256k1_scratch *scratch, secp256k1_gej *r, const secp256k1_scalar *inp_g_sc, secp256k1_ecmult_multi_callback cb, void *cbdata, size_t n_points, size_t cb_offset)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00643">ecmult_impl.h:643</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_a2ed67cbaf00f8ccdfff87129844b8635"><div class="ttname"><a href="ecmult__impl_8h.html#a2ed67cbaf00f8ccdfff87129844b8635">secp256k1_strauss_max_points</a></div><div class="ttdeci">static size_t secp256k1_strauss_max_points(const secp256k1_callback *error_callback, secp256k1_scratch *scratch)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00399">ecmult_impl.h:399</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_a71e7f4ad865cad35efddc0495b59fcf3"><div class="ttname"><a href="ecmult__impl_8h.html#a71e7f4ad865cad35efddc0495b59fcf3">ECMULT_PIPPENGER_THRESHOLD</a></div><div class="ttdeci">#define ECMULT_PIPPENGER_THRESHOLD</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00055">ecmult_impl.h:55</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_a77c14862f4d2e7d6306a884c64baa8ad"><div class="ttname"><a href="ecmult__impl_8h.html#a77c14862f4d2e7d6306a884c64baa8ad">secp256k1_ecmult_multi_simple_var</a></div><div class="ttdeci">static int secp256k1_ecmult_multi_simple_var(secp256k1_gej *r, const secp256k1_scalar *inp_g_sc, secp256k1_ecmult_multi_callback cb, void *cbdata, size_t n_points)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00765">ecmult_impl.h:765</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_aa185e51cc47dae567c15da179a1b4b7c"><div class="ttname"><a href="ecmult__impl_8h.html#aa185e51cc47dae567c15da179a1b4b7c">secp256k1_ecmult_strauss_batch</a></div><div class="ttdeci">static int secp256k1_ecmult_strauss_batch(const secp256k1_callback *error_callback, secp256k1_scratch *scratch, secp256k1_gej *r, const secp256k1_scalar *inp_g_sc, secp256k1_ecmult_multi_callback cb, void *cbdata, size_t n_points, size_t cb_offset)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00355">ecmult_impl.h:355</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_aab645acb4c1b1831b5183926474c7335"><div class="ttname"><a href="ecmult__impl_8h.html#aab645acb4c1b1831b5183926474c7335">secp256k1_ecmult_multi_batch_size_helper</a></div><div class="ttdeci">static int secp256k1_ecmult_multi_batch_size_helper(size_t *n_batches, size_t *n_batch_points, size_t max_n_batch_points, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00792">ecmult_impl.h:792</a></div></div>
<div class="ttc" id="astructsecp256k1__callback_html"><div class="ttname"><a href="structsecp256k1__callback.html">secp256k1_callback</a></div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00019">util.h:19</a></div></div>
<div class="ttc" id="astructsecp256k1__scratch__space__struct_html"><div class="ttname"><a href="structsecp256k1__scratch__space__struct.html">secp256k1_scratch_space_struct</a></div><div class="ttdef"><b>Definition:</b> <a href="scratch_8h_source.html#l00012">scratch.h:12</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00055">ECMULT_PIPPENGER_THRESHOLD</a>, <a class="el" href="ecmult__impl_8h_source.html#l00338">secp256k1_ecmult()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00792">secp256k1_ecmult_multi_batch_size_helper()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00765">secp256k1_ecmult_multi_simple_var()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00643">secp256k1_ecmult_pippenger_batch()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00355">secp256k1_ecmult_strauss_batch()</a>, <a class="el" href="group_8h.html#a8df21f3ef7412e6c4d39fb67dc0140c6">secp256k1_gej_add_var()</a>, <a class="el" href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00729">secp256k1_pippenger_max_points()</a>, <a class="el" href="scalar_8h.html#a41cb11650e4dea0fe7ac5b59b9fce9dc">secp256k1_scalar_set_int()</a>, and <a class="el" href="ecmult__impl_8h_source.html#l00399">secp256k1_strauss_max_points()</a>.</p>

</div>
</div>
<a id="aed8dc2160c07c97c063bdeffbffa46a8" name="aed8dc2160c07c97c063bdeffbffa46a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed8dc2160c07c97c063bdeffbffa46a8">&#9670;&nbsp;</a></span>secp256k1_ecmult_odd_multiples_table()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void secp256k1_ecmult_odd_multiples_table </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *&#160;</td>
          <td class="paramname"><em>pre_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsecp256k1__fe.html">secp256k1_fe</a> *&#160;</td>
          <td class="paramname"><em>zr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsecp256k1__fe.html">secp256k1_fe</a> *&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Fill a table 'pre_a' with precomputed odd multiples of a. pre_a will contain [1*a,3*a,...,(2*n-1)*a], so it needs space for n group elements. zr needs space for n field elements.</p>
<p >Although pre_a is an array of _ge rather than _gej, it actually represents elements in Jacobian coordinates with their z coordinates omitted. The omitted z-coordinates can be recovered using z and zr. Using the notation z(b) to represent the omitted z coordinate of b:</p><ul>
<li>z(pre_a[n-1]) = 'z'</li>
<li>z(pre_a[i-1]) = z(pre_a[i]) / zr[i] for n &gt; i &gt; 0</li>
</ul>
<p >Lastly the zr[0] value, which isn't used above, is set so that:</p><ul>
<li>a.z = z(pre_a[0]) / zr[0] </li>
</ul>

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00073">73</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   73</span>                                                                                                                                        {</div>
<div class="line"><span class="lineno">   74</span>    <a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a> d, ai;</div>
<div class="line"><span class="lineno">   75</span>    <a class="code hl_struct" href="structsecp256k1__ge.html">secp256k1_ge</a> d_ge;</div>
<div class="line"><span class="lineno">   76</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>    <a class="code hl_define" href="util_8h.html#aca8ac5ae73fd966db106de59160a178b">VERIFY_CHECK</a>(!a-&gt;<a class="code hl_variable" href="structsecp256k1__gej.html#ab3ec8168caf27aa3a092d512eaadaad9">infinity</a>);</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>    <a class="code hl_function" href="group_8h.html#a033aa434a4d0838f649ad757dd44db46">secp256k1_gej_double_var</a>(&amp;d, a, NULL);</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">   83</span><span class="comment">     * Perform the additions using an isomorphic curve Y^2 = X^3 + 7*C^6 where C := d.z.</span></div>
<div class="line"><span class="lineno">   84</span><span class="comment">     * The isomorphism, phi, maps a secp256k1 point (x, y) to the point (x*C^2, y*C^3) on the other curve.</span></div>
<div class="line"><span class="lineno">   85</span><span class="comment">     * In Jacobian coordinates phi maps (x, y, z) to (x*C^2, y*C^3, z) or, equivalently to (x, y, z/C).</span></div>
<div class="line"><span class="lineno">   86</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno">   87</span><span class="comment">     *     phi(x, y, z) = (x*C^2, y*C^3, z) = (x, y, z/C)</span></div>
<div class="line"><span class="lineno">   88</span><span class="comment">     *   d_ge := phi(d) = (d.x, d.y, 1)</span></div>
<div class="line"><span class="lineno">   89</span><span class="comment">     *     ai := phi(a) = (a.x*C^2, a.y*C^3, a.z)</span></div>
<div class="line"><span class="lineno">   90</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno">   91</span><span class="comment">     * The group addition functions work correctly on these isomorphic curves.</span></div>
<div class="line"><span class="lineno">   92</span><span class="comment">     * In particular phi(d) is easy to represent in affine coordinates under this isomorphism.</span></div>
<div class="line"><span class="lineno">   93</span><span class="comment">     * This lets us use the faster secp256k1_gej_add_ge_var group addition function that we wouldn&#39;t be able to use otherwise.</span></div>
<div class="line"><span class="lineno">   94</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">   95</span>    <a class="code hl_function" href="group_8h.html#a34ab3d1a9a0a7ff0ed1cedff9db5f73c">secp256k1_ge_set_xy</a>(&amp;d_ge, &amp;d.<a class="code hl_variable" href="structsecp256k1__gej.html#a7d2451c89411d62628ac466eb28c8ff5">x</a>, &amp;d.<a class="code hl_variable" href="structsecp256k1__gej.html#a29d5184060ad790d85a0c89a13820e0d">y</a>);</div>
<div class="line"><span class="lineno">   96</span>    <a class="code hl_function" href="group__impl_8h.html#a6492f6aad16e545239c0ec52780d2e1f">secp256k1_ge_set_gej_zinv</a>(&amp;pre_a[0], a, &amp;d.<a class="code hl_variable" href="structsecp256k1__gej.html#ae41776408dba32cbe28b5e345b5f2286">z</a>);</div>
<div class="line"><span class="lineno">   97</span>    <a class="code hl_function" href="group_8h.html#ad5f813e26afb239f03e83f0e61e05498">secp256k1_gej_set_ge</a>(&amp;ai, &amp;pre_a[0]);</div>
<div class="line"><span class="lineno">   98</span>    ai.<a class="code hl_variable" href="structsecp256k1__gej.html#ae41776408dba32cbe28b5e345b5f2286">z</a> = a-&gt;<a class="code hl_variable" href="structsecp256k1__gej.html#ae41776408dba32cbe28b5e345b5f2286">z</a>;</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>    <span class="comment">/* pre_a[0] is the point (a.x*C^2, a.y*C^3, a.z*C) which is equvalent to a.</span></div>
<div class="line"><span class="lineno">  101</span><span class="comment">     * Set zr[0] to C, which is the ratio between the omitted z(pre_a[0]) value and a.z.</span></div>
<div class="line"><span class="lineno">  102</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  103</span>    zr[0] = d.<a class="code hl_variable" href="structsecp256k1__gej.html#ae41776408dba32cbe28b5e345b5f2286">z</a>;</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordflow">for</span> (i = 1; i &lt; n; i++) {</div>
<div class="line"><span class="lineno">  106</span>        <a class="code hl_function" href="group_8h.html#a4d0338f50b08d082caa32f8e72707b55">secp256k1_gej_add_ge_var</a>(&amp;ai, &amp;ai, &amp;d_ge, &amp;zr[i]);</div>
<div class="line"><span class="lineno">  107</span>        <a class="code hl_function" href="group_8h.html#a34ab3d1a9a0a7ff0ed1cedff9db5f73c">secp256k1_ge_set_xy</a>(&amp;pre_a[i], &amp;ai.<a class="code hl_variable" href="structsecp256k1__gej.html#a7d2451c89411d62628ac466eb28c8ff5">x</a>, &amp;ai.<a class="code hl_variable" href="structsecp256k1__gej.html#a29d5184060ad790d85a0c89a13820e0d">y</a>);</div>
<div class="line"><span class="lineno">  108</span>    }</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    <span class="comment">/* Multiply the last z-coordinate by C to undo the isomorphism.</span></div>
<div class="line"><span class="lineno">  111</span><span class="comment">     * Since the z-coordinates of the pre_a values are implied by the zr array of z-coordinate ratios,</span></div>
<div class="line"><span class="lineno">  112</span><span class="comment">     * undoing the isomorphism here undoes the isomorphism for all pre_a values.</span></div>
<div class="line"><span class="lineno">  113</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  114</span>    <a class="code hl_function" href="field_8h.html#a542b97d2574d9687c563d002587cf9a2">secp256k1_fe_mul</a>(z, &amp;ai.<a class="code hl_variable" href="structsecp256k1__gej.html#ae41776408dba32cbe28b5e345b5f2286">z</a>, &amp;d.<a class="code hl_variable" href="structsecp256k1__gej.html#ae41776408dba32cbe28b5e345b5f2286">z</a>);</div>
<div class="line"><span class="lineno">  115</span>}</div>
<div class="ttc" id="afield_8h_html_a542b97d2574d9687c563d002587cf9a2"><div class="ttname"><a href="field_8h.html#a542b97d2574d9687c563d002587cf9a2">secp256k1_fe_mul</a></div><div class="ttdeci">static void secp256k1_fe_mul(secp256k1_fe *r, const secp256k1_fe *a, const secp256k1_fe *SECP256K1_RESTRICT b)</div></div>
<div class="ttc" id="agroup_8h_html_a033aa434a4d0838f649ad757dd44db46"><div class="ttname"><a href="group_8h.html#a033aa434a4d0838f649ad757dd44db46">secp256k1_gej_double_var</a></div><div class="ttdeci">static void secp256k1_gej_double_var(secp256k1_gej *r, const secp256k1_gej *a, secp256k1_fe *rzr)</div></div>
<div class="ttc" id="agroup_8h_html_a34ab3d1a9a0a7ff0ed1cedff9db5f73c"><div class="ttname"><a href="group_8h.html#a34ab3d1a9a0a7ff0ed1cedff9db5f73c">secp256k1_ge_set_xy</a></div><div class="ttdeci">static void secp256k1_ge_set_xy(secp256k1_ge *r, const secp256k1_fe *x, const secp256k1_fe *y)</div></div>
<div class="ttc" id="agroup_8h_html_a4d0338f50b08d082caa32f8e72707b55"><div class="ttname"><a href="group_8h.html#a4d0338f50b08d082caa32f8e72707b55">secp256k1_gej_add_ge_var</a></div><div class="ttdeci">static void secp256k1_gej_add_ge_var(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_ge *b, secp256k1_fe *rzr)</div></div>
<div class="ttc" id="agroup__impl_8h_html_a6492f6aad16e545239c0ec52780d2e1f"><div class="ttname"><a href="group__impl_8h.html#a6492f6aad16e545239c0ec52780d2e1f">secp256k1_ge_set_gej_zinv</a></div><div class="ttdeci">static void secp256k1_ge_set_gej_zinv(secp256k1_ge *r, const secp256k1_gej *a, const secp256k1_fe *zi)</div><div class="ttdef"><b>Definition:</b> <a href="group__impl_8h_source.html#l00067">group_impl.h:67</a></div></div>
<div class="ttc" id="astructsecp256k1__gej_html_a29d5184060ad790d85a0c89a13820e0d"><div class="ttname"><a href="structsecp256k1__gej.html#a29d5184060ad790d85a0c89a13820e0d">secp256k1_gej::y</a></div><div class="ttdeci">secp256k1_fe y</div><div class="ttdef"><b>Definition:</b> <a href="group_8h_source.html#l00030">group.h:30</a></div></div>
<div class="ttc" id="astructsecp256k1__gej_html_a7d2451c89411d62628ac466eb28c8ff5"><div class="ttname"><a href="structsecp256k1__gej.html#a7d2451c89411d62628ac466eb28c8ff5">secp256k1_gej::x</a></div><div class="ttdeci">secp256k1_fe x</div><div class="ttdef"><b>Definition:</b> <a href="group_8h_source.html#l00029">group.h:29</a></div></div>
<div class="ttc" id="astructsecp256k1__gej_html_ab3ec8168caf27aa3a092d512eaadaad9"><div class="ttname"><a href="structsecp256k1__gej.html#ab3ec8168caf27aa3a092d512eaadaad9">secp256k1_gej::infinity</a></div><div class="ttdeci">int infinity</div><div class="ttdef"><b>Definition:</b> <a href="group_8h_source.html#l00032">group.h:32</a></div></div>
<div class="ttc" id="astructsecp256k1__gej_html_ae41776408dba32cbe28b5e345b5f2286"><div class="ttname"><a href="structsecp256k1__gej.html#ae41776408dba32cbe28b5e345b5f2286">secp256k1_gej::z</a></div><div class="ttdeci">secp256k1_fe z</div><div class="ttdef"><b>Definition:</b> <a href="group_8h_source.html#l00031">group.h:31</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="group_8h_source.html#l00032">secp256k1_gej::infinity</a>, <a class="el" href="field_8h.html#a542b97d2574d9687c563d002587cf9a2">secp256k1_fe_mul()</a>, <a class="el" href="group__impl_8h_source.html#l00067">secp256k1_ge_set_gej_zinv()</a>, <a class="el" href="group_8h.html#a34ab3d1a9a0a7ff0ed1cedff9db5f73c">secp256k1_ge_set_xy()</a>, <a class="el" href="group_8h.html#a4d0338f50b08d082caa32f8e72707b55">secp256k1_gej_add_ge_var()</a>, <a class="el" href="group_8h.html#a033aa434a4d0838f649ad757dd44db46">secp256k1_gej_double_var()</a>, <a class="el" href="group_8h.html#ad5f813e26afb239f03e83f0e61e05498">secp256k1_gej_set_ge()</a>, <a class="el" href="util_8h_source.html#l00095">VERIFY_CHECK</a>, <a class="el" href="group_8h_source.html#l00029">secp256k1_gej::x</a>, <a class="el" href="group_8h_source.html#l00030">secp256k1_gej::y</a>, and <a class="el" href="group_8h_source.html#l00031">secp256k1_gej::z</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__const__impl_8h_source.html#l00021">secp256k1_ecmult_odd_multiples_table_globalz_windowa()</a>, and <a class="el" href="ecmult__impl_8h_source.html#l00225">secp256k1_ecmult_strauss_wnaf()</a>.</p>

</div>
</div>
<a id="a1372e3ca22fc9730cc744a2007c6b1f3" name="a1372e3ca22fc9730cc744a2007c6b1f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1372e3ca22fc9730cc744a2007c6b1f3">&#9670;&nbsp;</a></span>secp256k1_ecmult_pippenger_batch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int secp256k1_ecmult_pippenger_batch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *&#160;</td>
          <td class="paramname"><em>error_callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *&#160;</td>
          <td class="paramname"><em>scratch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>inp_g_sc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cbdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>cb_offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00643">643</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  643</span>                                                                                                                                                                                                                                                           {</div>
<div class="line"><span class="lineno">  644</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> scratch_checkpoint = <a class="code hl_function" href="scratch_8h.html#a8b0a351a29bbd30be1b48e4a6323e648">secp256k1_scratch_checkpoint</a>(error_callback, scratch);</div>
<div class="line"><span class="lineno">  645</span>    <span class="comment">/* Use 2(n+1) with the endomorphism, when calculating batch</span></div>
<div class="line"><span class="lineno">  646</span><span class="comment">     * sizes. The reason for +1 is that we add the G scalar to the list of</span></div>
<div class="line"><span class="lineno">  647</span><span class="comment">     * other scalars. */</span></div>
<div class="line"><span class="lineno">  648</span>    <span class="keywordtype">size_t</span> entries = 2*n_points + 2;</div>
<div class="line"><span class="lineno">  649</span>    <a class="code hl_struct" href="structsecp256k1__ge.html">secp256k1_ge</a> *points;</div>
<div class="line"><span class="lineno">  650</span>    <a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *scalars;</div>
<div class="line"><span class="lineno">  651</span>    <a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a> *buckets;</div>
<div class="line"><span class="lineno">  652</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structsecp256k1__pippenger__state.html">secp256k1_pippenger_state</a> *state_space;</div>
<div class="line"><span class="lineno">  653</span>    <span class="keywordtype">size_t</span> idx = 0;</div>
<div class="line"><span class="lineno">  654</span>    <span class="keywordtype">size_t</span> point_idx = 0;</div>
<div class="line"><span class="lineno">  655</span>    <span class="keywordtype">int</span> i, j;</div>
<div class="line"><span class="lineno">  656</span>    <span class="keywordtype">int</span> bucket_window;</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>    <a class="code hl_function" href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity</a>(r);</div>
<div class="line"><span class="lineno">  659</span>    <span class="keywordflow">if</span> (inp_g_sc == NULL &amp;&amp; n_points == 0) {</div>
<div class="line"><span class="lineno">  660</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  661</span>    }</div>
<div class="line"><span class="lineno">  662</span>    bucket_window = <a class="code hl_function" href="ecmult__impl_8h.html#a7ab4c858354f0c2f67bf76642b15d82c">secp256k1_pippenger_bucket_window</a>(n_points);</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>    <span class="comment">/* We allocate PIPPENGER_SCRATCH_OBJECTS objects on the scratch space. If</span></div>
<div class="line"><span class="lineno">  665</span><span class="comment">     * these allocations change, make sure to update the</span></div>
<div class="line"><span class="lineno">  666</span><span class="comment">     * PIPPENGER_SCRATCH_OBJECTS constant and pippenger_scratch_size</span></div>
<div class="line"><span class="lineno">  667</span><span class="comment">     * accordingly. */</span></div>
<div class="line"><span class="lineno">  668</span>    points = (<a class="code hl_struct" href="structsecp256k1__ge.html">secp256k1_ge</a> *) <a class="code hl_function" href="scratch_8h.html#a7e01ac251aa70b8ccf07d435bc0c2816">secp256k1_scratch_alloc</a>(error_callback, scratch, entries * <span class="keyword">sizeof</span>(*points));</div>
<div class="line"><span class="lineno">  669</span>    scalars = (<a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *) <a class="code hl_function" href="scratch_8h.html#a7e01ac251aa70b8ccf07d435bc0c2816">secp256k1_scratch_alloc</a>(error_callback, scratch, entries * <span class="keyword">sizeof</span>(*scalars));</div>
<div class="line"><span class="lineno">  670</span>    state_space = (<span class="keyword">struct </span><a class="code hl_struct" href="structsecp256k1__pippenger__state.html">secp256k1_pippenger_state</a> *) <a class="code hl_function" href="scratch_8h.html#a7e01ac251aa70b8ccf07d435bc0c2816">secp256k1_scratch_alloc</a>(error_callback, scratch, <span class="keyword">sizeof</span>(*state_space));</div>
<div class="line"><span class="lineno">  671</span>    <span class="keywordflow">if</span> (points == NULL || scalars == NULL || state_space == NULL) {</div>
<div class="line"><span class="lineno">  672</span>        <a class="code hl_function" href="scratch_8h.html#a0a7d14c245d1b379930e6b88b06f0faa">secp256k1_scratch_apply_checkpoint</a>(error_callback, scratch, scratch_checkpoint);</div>
<div class="line"><span class="lineno">  673</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  674</span>    }</div>
<div class="line"><span class="lineno">  675</span>    state_space-&gt;<a class="code hl_variable" href="structsecp256k1__pippenger__state.html#a7f0ade83fedd93e6aa341f874a4bc53f">ps</a> = (<span class="keyword">struct </span><a class="code hl_struct" href="structsecp256k1__pippenger__point__state.html">secp256k1_pippenger_point_state</a> *) <a class="code hl_function" href="scratch_8h.html#a7e01ac251aa70b8ccf07d435bc0c2816">secp256k1_scratch_alloc</a>(error_callback, scratch, entries * <span class="keyword">sizeof</span>(*state_space-&gt;<a class="code hl_variable" href="structsecp256k1__pippenger__state.html#a7f0ade83fedd93e6aa341f874a4bc53f">ps</a>));</div>
<div class="line"><span class="lineno">  676</span>    state_space-&gt;<a class="code hl_variable" href="structsecp256k1__pippenger__state.html#a1d85b4e6a712e4ee95832542f7d08af7">wnaf_na</a> = (<span class="keywordtype">int</span> *) <a class="code hl_function" href="scratch_8h.html#a7e01ac251aa70b8ccf07d435bc0c2816">secp256k1_scratch_alloc</a>(error_callback, scratch, entries*(<a class="code hl_define" href="ecmult__impl_8h.html#a23d9fb349265ae338b9977f7f7aab065">WNAF_SIZE</a>(bucket_window+1)) * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  677</span>    buckets = (<a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a> *) <a class="code hl_function" href="scratch_8h.html#a7e01ac251aa70b8ccf07d435bc0c2816">secp256k1_scratch_alloc</a>(error_callback, scratch, (1&lt;&lt;bucket_window) * <span class="keyword">sizeof</span>(*buckets));</div>
<div class="line"><span class="lineno">  678</span>    <span class="keywordflow">if</span> (state_space-&gt;<a class="code hl_variable" href="structsecp256k1__pippenger__state.html#a7f0ade83fedd93e6aa341f874a4bc53f">ps</a> == NULL || state_space-&gt;<a class="code hl_variable" href="structsecp256k1__pippenger__state.html#a1d85b4e6a712e4ee95832542f7d08af7">wnaf_na</a> == NULL || buckets == NULL) {</div>
<div class="line"><span class="lineno">  679</span>        <a class="code hl_function" href="scratch_8h.html#a0a7d14c245d1b379930e6b88b06f0faa">secp256k1_scratch_apply_checkpoint</a>(error_callback, scratch, scratch_checkpoint);</div>
<div class="line"><span class="lineno">  680</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  681</span>    }</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>    <span class="keywordflow">if</span> (inp_g_sc != NULL) {</div>
<div class="line"><span class="lineno">  684</span>        scalars[0] = *inp_g_sc;</div>
<div class="line"><span class="lineno">  685</span>        points[0] = <a class="code hl_variable" href="group__impl_8h.html#ac2075a99877abe469ea60a119fe68e6c">secp256k1_ge_const_g</a>;</div>
<div class="line"><span class="lineno">  686</span>        idx++;</div>
<div class="line"><span class="lineno">  687</span>        <a class="code hl_function" href="ecmult__impl_8h.html#a3b82a0af2e50a893f660ee0c0cad6886">secp256k1_ecmult_endo_split</a>(&amp;scalars[0], &amp;scalars[1], &amp;points[0], &amp;points[1]);</div>
<div class="line"><span class="lineno">  688</span>        idx++;</div>
<div class="line"><span class="lineno">  689</span>    }</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span>    <span class="keywordflow">while</span> (point_idx &lt; n_points) {</div>
<div class="line"><span class="lineno">  692</span>        <span class="keywordflow">if</span> (!cb(&amp;scalars[idx], &amp;points[idx], point_idx + cb_offset, cbdata)) {</div>
<div class="line"><span class="lineno">  693</span>            <a class="code hl_function" href="scratch_8h.html#a0a7d14c245d1b379930e6b88b06f0faa">secp256k1_scratch_apply_checkpoint</a>(error_callback, scratch, scratch_checkpoint);</div>
<div class="line"><span class="lineno">  694</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  695</span>        }</div>
<div class="line"><span class="lineno">  696</span>        idx++;</div>
<div class="line"><span class="lineno">  697</span>        <a class="code hl_function" href="ecmult__impl_8h.html#a3b82a0af2e50a893f660ee0c0cad6886">secp256k1_ecmult_endo_split</a>(&amp;scalars[idx - 1], &amp;scalars[idx], &amp;points[idx - 1], &amp;points[idx]);</div>
<div class="line"><span class="lineno">  698</span>        idx++;</div>
<div class="line"><span class="lineno">  699</span>        point_idx++;</div>
<div class="line"><span class="lineno">  700</span>    }</div>
<div class="line"><span class="lineno">  701</span> </div>
<div class="line"><span class="lineno">  702</span>    <a class="code hl_function" href="ecmult__impl_8h.html#ab9fa16936f32ca87ef0fa602dd440e61">secp256k1_ecmult_pippenger_wnaf</a>(buckets, bucket_window, state_space, r, scalars, points, idx);</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>    <span class="comment">/* Clear data */</span></div>
<div class="line"><span class="lineno">  705</span>    <span class="keywordflow">for</span>(i = 0; (size_t)i &lt; idx; i++) {</div>
<div class="line"><span class="lineno">  706</span>        <a class="code hl_function" href="scalar_8h.html#ad8fb9bc2a828903963bf37806d8edd11">secp256k1_scalar_clear</a>(&amp;scalars[i]);</div>
<div class="line"><span class="lineno">  707</span>        state_space-&gt;<a class="code hl_variable" href="structsecp256k1__pippenger__state.html#a7f0ade83fedd93e6aa341f874a4bc53f">ps</a>[i].<a class="code hl_variable" href="structsecp256k1__pippenger__point__state.html#a8cf2398f7d23b02b4ab5fb26b376cee4">skew_na</a> = 0;</div>
<div class="line"><span class="lineno">  708</span>        <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code hl_define" href="ecmult__impl_8h.html#a23d9fb349265ae338b9977f7f7aab065">WNAF_SIZE</a>(bucket_window+1); j++) {</div>
<div class="line"><span class="lineno">  709</span>            state_space-&gt;<a class="code hl_variable" href="structsecp256k1__pippenger__state.html#a1d85b4e6a712e4ee95832542f7d08af7">wnaf_na</a>[i * <a class="code hl_define" href="ecmult__impl_8h.html#a23d9fb349265ae338b9977f7f7aab065">WNAF_SIZE</a>(bucket_window+1) + j] = 0;</div>
<div class="line"><span class="lineno">  710</span>        }</div>
<div class="line"><span class="lineno">  711</span>    }</div>
<div class="line"><span class="lineno">  712</span>    <span class="keywordflow">for</span>(i = 0; i &lt; 1&lt;&lt;bucket_window; i++) {</div>
<div class="line"><span class="lineno">  713</span>        <a class="code hl_function" href="group_8h.html#a2454dfbe1e75eba118d2c0a4184a9acc">secp256k1_gej_clear</a>(&amp;buckets[i]);</div>
<div class="line"><span class="lineno">  714</span>    }</div>
<div class="line"><span class="lineno">  715</span>    <a class="code hl_function" href="scratch_8h.html#a0a7d14c245d1b379930e6b88b06f0faa">secp256k1_scratch_apply_checkpoint</a>(error_callback, scratch, scratch_checkpoint);</div>
<div class="line"><span class="lineno">  716</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  717</span>}</div>
<div class="ttc" id="aecmult__impl_8h_html_a23d9fb349265ae338b9977f7f7aab065"><div class="ttname"><a href="ecmult__impl_8h.html#a23d9fb349265ae338b9977f7f7aab065">WNAF_SIZE</a></div><div class="ttdeci">#define WNAF_SIZE(w)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00046">ecmult_impl.h:46</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_a3b82a0af2e50a893f660ee0c0cad6886"><div class="ttname"><a href="ecmult__impl_8h.html#a3b82a0af2e50a893f660ee0c0cad6886">secp256k1_ecmult_endo_split</a></div><div class="ttdeci">static SECP256K1_INLINE void secp256k1_ecmult_endo_split(secp256k1_scalar *s1, secp256k1_scalar *s2, secp256k1_ge *p1, secp256k1_ge *p2)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00618">ecmult_impl.h:618</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_a7ab4c858354f0c2f67bf76642b15d82c"><div class="ttname"><a href="ecmult__impl_8h.html#a7ab4c858354f0c2f67bf76642b15d82c">secp256k1_pippenger_bucket_window</a></div><div class="ttdeci">static int secp256k1_pippenger_bucket_window(size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00570">ecmult_impl.h:570</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_ab9fa16936f32ca87ef0fa602dd440e61"><div class="ttname"><a href="ecmult__impl_8h.html#ab9fa16936f32ca87ef0fa602dd440e61">secp256k1_ecmult_pippenger_wnaf</a></div><div class="ttdeci">static int secp256k1_ecmult_pippenger_wnaf(secp256k1_gej *buckets, int bucket_window, struct secp256k1_pippenger_state *state, secp256k1_gej *r, const secp256k1_scalar *sc, const secp256k1_ge *pt, size_t num)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00489">ecmult_impl.h:489</a></div></div>
<div class="ttc" id="agroup_8h_html_a2454dfbe1e75eba118d2c0a4184a9acc"><div class="ttname"><a href="group_8h.html#a2454dfbe1e75eba118d2c0a4184a9acc">secp256k1_gej_clear</a></div><div class="ttdeci">static void secp256k1_gej_clear(secp256k1_gej *r)</div></div>
<div class="ttc" id="agroup__impl_8h_html_ac2075a99877abe469ea60a119fe68e6c"><div class="ttname"><a href="group__impl_8h.html#ac2075a99877abe469ea60a119fe68e6c">secp256k1_ge_const_g</a></div><div class="ttdeci">static const secp256k1_ge secp256k1_ge_const_g</div><div class="ttdef"><b>Definition:</b> <a href="group__impl_8h_source.html#l00062">group_impl.h:62</a></div></div>
<div class="ttc" id="ascalar_8h_html_ad8fb9bc2a828903963bf37806d8edd11"><div class="ttname"><a href="scalar_8h.html#ad8fb9bc2a828903963bf37806d8edd11">secp256k1_scalar_clear</a></div><div class="ttdeci">static void secp256k1_scalar_clear(secp256k1_scalar *r)</div></div>
<div class="ttc" id="ascratch_8h_html_a0a7d14c245d1b379930e6b88b06f0faa"><div class="ttname"><a href="scratch_8h.html#a0a7d14c245d1b379930e6b88b06f0faa">secp256k1_scratch_apply_checkpoint</a></div><div class="ttdeci">static void secp256k1_scratch_apply_checkpoint(const secp256k1_callback *error_callback, secp256k1_scratch *scratch, size_t checkpoint)</div></div>
<div class="ttc" id="ascratch_8h_html_a7e01ac251aa70b8ccf07d435bc0c2816"><div class="ttname"><a href="scratch_8h.html#a7e01ac251aa70b8ccf07d435bc0c2816">secp256k1_scratch_alloc</a></div><div class="ttdeci">static void * secp256k1_scratch_alloc(const secp256k1_callback *error_callback, secp256k1_scratch *scratch, size_t n)</div></div>
<div class="ttc" id="ascratch_8h_html_a8b0a351a29bbd30be1b48e4a6323e648"><div class="ttname"><a href="scratch_8h.html#a8b0a351a29bbd30be1b48e4a6323e648">secp256k1_scratch_checkpoint</a></div><div class="ttdeci">static size_t secp256k1_scratch_checkpoint(const secp256k1_callback *error_callback, const secp256k1_scratch *scratch)</div></div>
<div class="ttc" id="astructsecp256k1__pippenger__point__state_html"><div class="ttname"><a href="structsecp256k1__pippenger__point__state.html">secp256k1_pippenger_point_state</a></div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00472">ecmult_impl.h:472</a></div></div>
<div class="ttc" id="astructsecp256k1__pippenger__point__state_html_a8cf2398f7d23b02b4ab5fb26b376cee4"><div class="ttname"><a href="structsecp256k1__pippenger__point__state.html#a8cf2398f7d23b02b4ab5fb26b376cee4">secp256k1_pippenger_point_state::skew_na</a></div><div class="ttdeci">int skew_na</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00473">ecmult_impl.h:473</a></div></div>
<div class="ttc" id="astructsecp256k1__pippenger__state_html"><div class="ttname"><a href="structsecp256k1__pippenger__state.html">secp256k1_pippenger_state</a></div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00477">ecmult_impl.h:477</a></div></div>
<div class="ttc" id="astructsecp256k1__pippenger__state_html_a1d85b4e6a712e4ee95832542f7d08af7"><div class="ttname"><a href="structsecp256k1__pippenger__state.html#a1d85b4e6a712e4ee95832542f7d08af7">secp256k1_pippenger_state::wnaf_na</a></div><div class="ttdeci">int * wnaf_na</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00478">ecmult_impl.h:478</a></div></div>
<div class="ttc" id="astructsecp256k1__pippenger__state_html_a7f0ade83fedd93e6aa341f874a4bc53f"><div class="ttname"><a href="structsecp256k1__pippenger__state.html#a7f0ade83fedd93e6aa341f874a4bc53f">secp256k1_pippenger_state::ps</a></div><div class="ttdeci">struct secp256k1_pippenger_point_state * ps</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00479">ecmult_impl.h:479</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00479">secp256k1_pippenger_state::ps</a>, <a class="el" href="ecmult__impl_8h_source.html#l00618">secp256k1_ecmult_endo_split()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00489">secp256k1_ecmult_pippenger_wnaf()</a>, <a class="el" href="group__impl_8h_source.html#l00062">secp256k1_ge_const_g</a>, <a class="el" href="group_8h.html#a2454dfbe1e75eba118d2c0a4184a9acc">secp256k1_gej_clear()</a>, <a class="el" href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00570">secp256k1_pippenger_bucket_window()</a>, <a class="el" href="scalar_8h.html#ad8fb9bc2a828903963bf37806d8edd11">secp256k1_scalar_clear()</a>, <a class="el" href="scratch_8h.html#a7e01ac251aa70b8ccf07d435bc0c2816">secp256k1_scratch_alloc()</a>, <a class="el" href="scratch_8h.html#a0a7d14c245d1b379930e6b88b06f0faa">secp256k1_scratch_apply_checkpoint()</a>, <a class="el" href="scratch_8h.html#a8b0a351a29bbd30be1b48e4a6323e648">secp256k1_scratch_checkpoint()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00473">secp256k1_pippenger_point_state::skew_na</a>, <a class="el" href="ecmult__impl_8h_source.html#l00478">secp256k1_pippenger_state::wnaf_na</a>, and <a class="el" href="ecmult__impl_8h_source.html#l00046">WNAF_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00811">secp256k1_ecmult_multi_var()</a>, and <a class="el" href="ecmult__impl_8h_source.html#l00720">secp256k1_ecmult_pippenger_batch_single()</a>.</p>

</div>
</div>
<a id="a7b70dc19eefeb37607ba72cf32f61847" name="a7b70dc19eefeb37607ba72cf32f61847"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b70dc19eefeb37607ba72cf32f61847">&#9670;&nbsp;</a></span>secp256k1_ecmult_pippenger_batch_single()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int secp256k1_ecmult_pippenger_batch_single </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *&#160;</td>
          <td class="paramname"><em>error_callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *&#160;</td>
          <td class="paramname"><em>scratch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>inp_g_sc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cbdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00720">720</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  720</span>                                                                                                                                                                                                                                         {</div>
<div class="line"><span class="lineno">  721</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="ecmult__impl_8h.html#a1372e3ca22fc9730cc744a2007c6b1f3">secp256k1_ecmult_pippenger_batch</a>(error_callback, scratch, r, inp_g_sc, cb, cbdata, n, 0);</div>
<div class="line"><span class="lineno">  722</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00643">secp256k1_ecmult_pippenger_batch()</a>.</p>

<p class="reference">Referenced by <a class="el" href="bench__ecmult_8c_source.html#l00281">main()</a>, <a class="el" href="tests_8c_source.html#l04453">run_ecmult_multi_tests()</a>, and <a class="el" href="tests_8c_source.html#l04097">test_ecmult_multi_random()</a>.</p>

</div>
</div>
<a id="ab9fa16936f32ca87ef0fa602dd440e61" name="ab9fa16936f32ca87ef0fa602dd440e61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9fa16936f32ca87ef0fa602dd440e61">&#9670;&nbsp;</a></span>secp256k1_ecmult_pippenger_wnaf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int secp256k1_ecmult_pippenger_wnaf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *&#160;</td>
          <td class="paramname"><em>buckets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bucket_window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsecp256k1__pippenger__state.html">secp256k1_pippenger_state</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>sc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00489">489</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  489</span>                                                                                                                                                                                                                 {</div>
<div class="line"><span class="lineno">  490</span>    <span class="keywordtype">size_t</span> n_wnaf = <a class="code hl_define" href="ecmult__impl_8h.html#a23d9fb349265ae338b9977f7f7aab065">WNAF_SIZE</a>(bucket_window+1);</div>
<div class="line"><span class="lineno">  491</span>    <span class="keywordtype">size_t</span> np;</div>
<div class="line"><span class="lineno">  492</span>    <span class="keywordtype">size_t</span> no = 0;</div>
<div class="line"><span class="lineno">  493</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  494</span>    <span class="keywordtype">int</span> j;</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>    <span class="keywordflow">for</span> (np = 0; np &lt; num; ++np) {</div>
<div class="line"><span class="lineno">  497</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="scalar_8h.html#a3f0ac84fe49a1c1f51212582a2c149d4">secp256k1_scalar_is_zero</a>(&amp;sc[np]) || <a class="code hl_function" href="group_8h.html#ac83592db46af97faf7ba9b9a39a1f6ff">secp256k1_ge_is_infinity</a>(&amp;pt[np])) {</div>
<div class="line"><span class="lineno">  498</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  499</span>        }</div>
<div class="line"><span class="lineno">  500</span>        state-&gt;<a class="code hl_variable" href="structsecp256k1__pippenger__state.html#a7f0ade83fedd93e6aa341f874a4bc53f">ps</a>[no].<a class="code hl_variable" href="structsecp256k1__pippenger__point__state.html#a06f70a62665df6fea5ee61d87a0c5a0b">input_pos</a> = np;</div>
<div class="line"><span class="lineno">  501</span>        state-&gt;<a class="code hl_variable" href="structsecp256k1__pippenger__state.html#a7f0ade83fedd93e6aa341f874a4bc53f">ps</a>[no].<a class="code hl_variable" href="structsecp256k1__pippenger__point__state.html#a8cf2398f7d23b02b4ab5fb26b376cee4">skew_na</a> = <a class="code hl_function" href="ecmult__impl_8h.html#a346b925ab43432349898ad6a7ac9c31a">secp256k1_wnaf_fixed</a>(&amp;state-&gt;<a class="code hl_variable" href="structsecp256k1__pippenger__state.html#a1d85b4e6a712e4ee95832542f7d08af7">wnaf_na</a>[no*n_wnaf], &amp;sc[np], bucket_window+1);</div>
<div class="line"><span class="lineno">  502</span>        no++;</div>
<div class="line"><span class="lineno">  503</span>    }</div>
<div class="line"><span class="lineno">  504</span>    <a class="code hl_function" href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity</a>(r);</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>    <span class="keywordflow">if</span> (no == 0) {</div>
<div class="line"><span class="lineno">  507</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  508</span>    }</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>    <span class="keywordflow">for</span> (i = n_wnaf - 1; i &gt;= 0; i--) {</div>
<div class="line"><span class="lineno">  511</span>        <a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a> running_sum;</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>        <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(bucket_window+2); j++) {</div>
<div class="line"><span class="lineno">  514</span>            <a class="code hl_function" href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity</a>(&amp;buckets[j]);</div>
<div class="line"><span class="lineno">  515</span>        }</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>        <span class="keywordflow">for</span> (np = 0; np &lt; no; ++np) {</div>
<div class="line"><span class="lineno">  518</span>            <span class="keywordtype">int</span> n = state-&gt;<a class="code hl_variable" href="structsecp256k1__pippenger__state.html#a1d85b4e6a712e4ee95832542f7d08af7">wnaf_na</a>[np*n_wnaf + i];</div>
<div class="line"><span class="lineno">  519</span>            <span class="keyword">struct </span><a class="code hl_struct" href="structsecp256k1__pippenger__point__state.html">secp256k1_pippenger_point_state</a> point_state = state-&gt;<a class="code hl_variable" href="structsecp256k1__pippenger__state.html#a7f0ade83fedd93e6aa341f874a4bc53f">ps</a>[np];</div>
<div class="line"><span class="lineno">  520</span>            <a class="code hl_struct" href="structsecp256k1__ge.html">secp256k1_ge</a> tmp;</div>
<div class="line"><span class="lineno">  521</span>            <span class="keywordtype">int</span> idx;</div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span>            <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><span class="lineno">  524</span>                <span class="comment">/* correct for wnaf skew */</span></div>
<div class="line"><span class="lineno">  525</span>                <span class="keywordtype">int</span> skew = point_state.<a class="code hl_variable" href="structsecp256k1__pippenger__point__state.html#a8cf2398f7d23b02b4ab5fb26b376cee4">skew_na</a>;</div>
<div class="line"><span class="lineno">  526</span>                <span class="keywordflow">if</span> (skew) {</div>
<div class="line"><span class="lineno">  527</span>                    <a class="code hl_function" href="group_8h.html#abcb34de0cfdf82a125e059f4f98de1d9">secp256k1_ge_neg</a>(&amp;tmp, &amp;pt[point_state.<a class="code hl_variable" href="structsecp256k1__pippenger__point__state.html#a06f70a62665df6fea5ee61d87a0c5a0b">input_pos</a>]);</div>
<div class="line"><span class="lineno">  528</span>                    <a class="code hl_function" href="group_8h.html#a4d0338f50b08d082caa32f8e72707b55">secp256k1_gej_add_ge_var</a>(&amp;buckets[0], &amp;buckets[0], &amp;tmp, NULL);</div>
<div class="line"><span class="lineno">  529</span>                }</div>
<div class="line"><span class="lineno">  530</span>            }</div>
<div class="line"><span class="lineno">  531</span>            <span class="keywordflow">if</span> (n &gt; 0) {</div>
<div class="line"><span class="lineno">  532</span>                idx = (n - 1)/2;</div>
<div class="line"><span class="lineno">  533</span>                <a class="code hl_function" href="group_8h.html#a4d0338f50b08d082caa32f8e72707b55">secp256k1_gej_add_ge_var</a>(&amp;buckets[idx], &amp;buckets[idx], &amp;pt[point_state.<a class="code hl_variable" href="structsecp256k1__pippenger__point__state.html#a06f70a62665df6fea5ee61d87a0c5a0b">input_pos</a>], NULL);</div>
<div class="line"><span class="lineno">  534</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &lt; 0) {</div>
<div class="line"><span class="lineno">  535</span>                idx = -(n + 1)/2;</div>
<div class="line"><span class="lineno">  536</span>                <a class="code hl_function" href="group_8h.html#abcb34de0cfdf82a125e059f4f98de1d9">secp256k1_ge_neg</a>(&amp;tmp, &amp;pt[point_state.<a class="code hl_variable" href="structsecp256k1__pippenger__point__state.html#a06f70a62665df6fea5ee61d87a0c5a0b">input_pos</a>]);</div>
<div class="line"><span class="lineno">  537</span>                <a class="code hl_function" href="group_8h.html#a4d0338f50b08d082caa32f8e72707b55">secp256k1_gej_add_ge_var</a>(&amp;buckets[idx], &amp;buckets[idx], &amp;tmp, NULL);</div>
<div class="line"><span class="lineno">  538</span>            }</div>
<div class="line"><span class="lineno">  539</span>        }</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>        <span class="keywordflow">for</span>(j = 0; j &lt; bucket_window; j++) {</div>
<div class="line"><span class="lineno">  542</span>            <a class="code hl_function" href="group_8h.html#a033aa434a4d0838f649ad757dd44db46">secp256k1_gej_double_var</a>(r, r, NULL);</div>
<div class="line"><span class="lineno">  543</span>        }</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>        <a class="code hl_function" href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity</a>(&amp;running_sum);</div>
<div class="line"><span class="lineno">  546</span>        <span class="comment">/* Accumulate the sum: bucket[0] + 3*bucket[1] + 5*bucket[2] + 7*bucket[3] + ...</span></div>
<div class="line"><span class="lineno">  547</span><span class="comment">         *                   = bucket[0] +   bucket[1] +   bucket[2] +   bucket[3] + ...</span></div>
<div class="line"><span class="lineno">  548</span><span class="comment">         *                   +         2 *  (bucket[1] + 2*bucket[2] + 3*bucket[3] + ...)</span></div>
<div class="line"><span class="lineno">  549</span><span class="comment">         * using an intermediate running sum:</span></div>
<div class="line"><span class="lineno">  550</span><span class="comment">         * running_sum = bucket[0] +   bucket[1] +   bucket[2] + ...</span></div>
<div class="line"><span class="lineno">  551</span><span class="comment">         *</span></div>
<div class="line"><span class="lineno">  552</span><span class="comment">         * The doubling is done implicitly by deferring the final window doubling (of &#39;r&#39;).</span></div>
<div class="line"><span class="lineno">  553</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">  554</span>        <span class="keywordflow">for</span>(j = <a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(bucket_window+2) - 1; j &gt; 0; j--) {</div>
<div class="line"><span class="lineno">  555</span>            <a class="code hl_function" href="group_8h.html#a8df21f3ef7412e6c4d39fb67dc0140c6">secp256k1_gej_add_var</a>(&amp;running_sum, &amp;running_sum, &amp;buckets[j], NULL);</div>
<div class="line"><span class="lineno">  556</span>            <a class="code hl_function" href="group_8h.html#a8df21f3ef7412e6c4d39fb67dc0140c6">secp256k1_gej_add_var</a>(r, r, &amp;running_sum, NULL);</div>
<div class="line"><span class="lineno">  557</span>        }</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>        <a class="code hl_function" href="group_8h.html#a8df21f3ef7412e6c4d39fb67dc0140c6">secp256k1_gej_add_var</a>(&amp;running_sum, &amp;running_sum, &amp;buckets[0], NULL);</div>
<div class="line"><span class="lineno">  560</span>        <a class="code hl_function" href="group_8h.html#a033aa434a4d0838f649ad757dd44db46">secp256k1_gej_double_var</a>(r, r, NULL);</div>
<div class="line"><span class="lineno">  561</span>        <a class="code hl_function" href="group_8h.html#a8df21f3ef7412e6c4d39fb67dc0140c6">secp256k1_gej_add_var</a>(r, r, &amp;running_sum, NULL);</div>
<div class="line"><span class="lineno">  562</span>    }</div>
<div class="line"><span class="lineno">  563</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  564</span>}</div>
<div class="ttc" id="aecmult__impl_8h_html_a346b925ab43432349898ad6a7ac9c31a"><div class="ttname"><a href="ecmult__impl_8h.html#a346b925ab43432349898ad6a7ac9c31a">secp256k1_wnaf_fixed</a></div><div class="ttdeci">static int secp256k1_wnaf_fixed(int *wnaf, const secp256k1_scalar *s, int w)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00410">ecmult_impl.h:410</a></div></div>
<div class="ttc" id="agroup_8h_html_ac83592db46af97faf7ba9b9a39a1f6ff"><div class="ttname"><a href="group_8h.html#ac83592db46af97faf7ba9b9a39a1f6ff">secp256k1_ge_is_infinity</a></div><div class="ttdeci">static int secp256k1_ge_is_infinity(const secp256k1_ge *a)</div></div>
<div class="ttc" id="ascalar_8h_html_a3f0ac84fe49a1c1f51212582a2c149d4"><div class="ttname"><a href="scalar_8h.html#a3f0ac84fe49a1c1f51212582a2c149d4">secp256k1_scalar_is_zero</a></div><div class="ttdeci">static int secp256k1_scalar_is_zero(const secp256k1_scalar *a)</div></div>
<div class="ttc" id="astructsecp256k1__pippenger__point__state_html_a06f70a62665df6fea5ee61d87a0c5a0b"><div class="ttname"><a href="structsecp256k1__pippenger__point__state.html#a06f70a62665df6fea5ee61d87a0c5a0b">secp256k1_pippenger_point_state::input_pos</a></div><div class="ttdeci">size_t input_pos</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00474">ecmult_impl.h:474</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult_8h_source.html#l00030">ECMULT_TABLE_SIZE</a>, <a class="el" href="ecmult__impl_8h_source.html#l00474">secp256k1_pippenger_point_state::input_pos</a>, <a class="el" href="ecmult__impl_8h_source.html#l00479">secp256k1_pippenger_state::ps</a>, <a class="el" href="group_8h.html#ac83592db46af97faf7ba9b9a39a1f6ff">secp256k1_ge_is_infinity()</a>, <a class="el" href="group_8h.html#abcb34de0cfdf82a125e059f4f98de1d9">secp256k1_ge_neg()</a>, <a class="el" href="group_8h.html#a4d0338f50b08d082caa32f8e72707b55">secp256k1_gej_add_ge_var()</a>, <a class="el" href="group_8h.html#a8df21f3ef7412e6c4d39fb67dc0140c6">secp256k1_gej_add_var()</a>, <a class="el" href="group_8h.html#a033aa434a4d0838f649ad757dd44db46">secp256k1_gej_double_var()</a>, <a class="el" href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity()</a>, <a class="el" href="scalar_8h.html#a3f0ac84fe49a1c1f51212582a2c149d4">secp256k1_scalar_is_zero()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00410">secp256k1_wnaf_fixed()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00473">secp256k1_pippenger_point_state::skew_na</a>, <a class="el" href="ecmult__impl_8h_source.html#l00478">secp256k1_pippenger_state::wnaf_na</a>, and <a class="el" href="ecmult__impl_8h_source.html#l00046">WNAF_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00643">secp256k1_ecmult_pippenger_batch()</a>.</p>

</div>
</div>
<a id="aa185e51cc47dae567c15da179a1b4b7c" name="aa185e51cc47dae567c15da179a1b4b7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa185e51cc47dae567c15da179a1b4b7c">&#9670;&nbsp;</a></span>secp256k1_ecmult_strauss_batch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int secp256k1_ecmult_strauss_batch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *&#160;</td>
          <td class="paramname"><em>error_callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *&#160;</td>
          <td class="paramname"><em>scratch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>inp_g_sc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cbdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>cb_offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00355">355</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  355</span>                                                                                                                                                                                                                                                         {</div>
<div class="line"><span class="lineno">  356</span>    <a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a>* points;</div>
<div class="line"><span class="lineno">  357</span>    <a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a>* scalars;</div>
<div class="line"><span class="lineno">  358</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structsecp256k1__strauss__state.html">secp256k1_strauss_state</a> state;</div>
<div class="line"><span class="lineno">  359</span>    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><span class="lineno">  360</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> scratch_checkpoint = <a class="code hl_function" href="scratch_8h.html#a8b0a351a29bbd30be1b48e4a6323e648">secp256k1_scratch_checkpoint</a>(error_callback, scratch);</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>    <a class="code hl_function" href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity</a>(r);</div>
<div class="line"><span class="lineno">  363</span>    <span class="keywordflow">if</span> (inp_g_sc == NULL &amp;&amp; n_points == 0) {</div>
<div class="line"><span class="lineno">  364</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  365</span>    }</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>    <span class="comment">/* We allocate STRAUSS_SCRATCH_OBJECTS objects on the scratch space. If these</span></div>
<div class="line"><span class="lineno">  368</span><span class="comment">     * allocations change, make sure to update the STRAUSS_SCRATCH_OBJECTS</span></div>
<div class="line"><span class="lineno">  369</span><span class="comment">     * constant and strauss_scratch_size accordingly. */</span></div>
<div class="line"><span class="lineno">  370</span>    points = (<a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a>*)<a class="code hl_function" href="scratch_8h.html#a7e01ac251aa70b8ccf07d435bc0c2816">secp256k1_scratch_alloc</a>(error_callback, scratch, n_points * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a>));</div>
<div class="line"><span class="lineno">  371</span>    scalars = (<a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a>*)<a class="code hl_function" href="scratch_8h.html#a7e01ac251aa70b8ccf07d435bc0c2816">secp256k1_scratch_alloc</a>(error_callback, scratch, n_points * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a>));</div>
<div class="line"><span class="lineno">  372</span>    state.aux = (<a class="code hl_struct" href="structsecp256k1__fe.html">secp256k1_fe</a>*)<a class="code hl_function" href="scratch_8h.html#a7e01ac251aa70b8ccf07d435bc0c2816">secp256k1_scratch_alloc</a>(error_callback, scratch, n_points * <a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>) * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structsecp256k1__fe.html">secp256k1_fe</a>));</div>
<div class="line"><span class="lineno">  373</span>    state.pre_a = (<a class="code hl_struct" href="structsecp256k1__ge.html">secp256k1_ge</a>*)<a class="code hl_function" href="scratch_8h.html#a7e01ac251aa70b8ccf07d435bc0c2816">secp256k1_scratch_alloc</a>(error_callback, scratch, n_points * <a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>) * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structsecp256k1__ge.html">secp256k1_ge</a>));</div>
<div class="line"><span class="lineno">  374</span>    state.ps = (<span class="keyword">struct </span><a class="code hl_struct" href="structsecp256k1__strauss__point__state.html">secp256k1_strauss_point_state</a>*)<a class="code hl_function" href="scratch_8h.html#a7e01ac251aa70b8ccf07d435bc0c2816">secp256k1_scratch_alloc</a>(error_callback, scratch, n_points * <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="structsecp256k1__strauss__point__state.html">secp256k1_strauss_point_state</a>));</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>    <span class="keywordflow">if</span> (points == NULL || scalars == NULL || state.aux == NULL || state.pre_a == NULL || state.ps == NULL) {</div>
<div class="line"><span class="lineno">  377</span>        <a class="code hl_function" href="scratch_8h.html#a0a7d14c245d1b379930e6b88b06f0faa">secp256k1_scratch_apply_checkpoint</a>(error_callback, scratch, scratch_checkpoint);</div>
<div class="line"><span class="lineno">  378</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  379</span>    }</div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span>    <span class="keywordflow">for</span> (i = 0; i &lt; n_points; i++) {</div>
<div class="line"><span class="lineno">  382</span>        <a class="code hl_struct" href="structsecp256k1__ge.html">secp256k1_ge</a> point;</div>
<div class="line"><span class="lineno">  383</span>        <span class="keywordflow">if</span> (!cb(&amp;scalars[i], &amp;point, i+cb_offset, cbdata)) {</div>
<div class="line"><span class="lineno">  384</span>            <a class="code hl_function" href="scratch_8h.html#a0a7d14c245d1b379930e6b88b06f0faa">secp256k1_scratch_apply_checkpoint</a>(error_callback, scratch, scratch_checkpoint);</div>
<div class="line"><span class="lineno">  385</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  386</span>        }</div>
<div class="line"><span class="lineno">  387</span>        <a class="code hl_function" href="group_8h.html#ad5f813e26afb239f03e83f0e61e05498">secp256k1_gej_set_ge</a>(&amp;points[i], &amp;point);</div>
<div class="line"><span class="lineno">  388</span>    }</div>
<div class="line"><span class="lineno">  389</span>    <a class="code hl_function" href="ecmult__impl_8h.html#af712c07897d43e290c166f73d11fd110">secp256k1_ecmult_strauss_wnaf</a>(&amp;state, r, n_points, points, scalars, inp_g_sc);</div>
<div class="line"><span class="lineno">  390</span>    <a class="code hl_function" href="scratch_8h.html#a0a7d14c245d1b379930e6b88b06f0faa">secp256k1_scratch_apply_checkpoint</a>(error_callback, scratch, scratch_checkpoint);</div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  392</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00220">secp256k1_strauss_state::aux</a>, <a class="el" href="ecmult_8h_source.html#l00030">ECMULT_TABLE_SIZE</a>, <a class="el" href="ecmult__impl_8h_source.html#l00221">secp256k1_strauss_state::pre_a</a>, <a class="el" href="ecmult__impl_8h_source.html#l00222">secp256k1_strauss_state::ps</a>, <a class="el" href="ecmult__impl_8h_source.html#l00225">secp256k1_ecmult_strauss_wnaf()</a>, <a class="el" href="group_8h.html#ad5f813e26afb239f03e83f0e61e05498">secp256k1_gej_set_ge()</a>, <a class="el" href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity()</a>, <a class="el" href="scratch_8h.html#a7e01ac251aa70b8ccf07d435bc0c2816">secp256k1_scratch_alloc()</a>, <a class="el" href="scratch_8h.html#a0a7d14c245d1b379930e6b88b06f0faa">secp256k1_scratch_apply_checkpoint()</a>, <a class="el" href="scratch_8h.html#a8b0a351a29bbd30be1b48e4a6323e648">secp256k1_scratch_checkpoint()</a>, and <a class="el" href="ecmult__impl_8h_source.html#l00032">WINDOW_A</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00811">secp256k1_ecmult_multi_var()</a>, and <a class="el" href="ecmult__impl_8h_source.html#l00395">secp256k1_ecmult_strauss_batch_single()</a>.</p>

</div>
</div>
<a id="a24500d7bf818b6782b88e2e53dcf85e2" name="a24500d7bf818b6782b88e2e53dcf85e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24500d7bf818b6782b88e2e53dcf85e2">&#9670;&nbsp;</a></span>secp256k1_ecmult_strauss_batch_single()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int secp256k1_ecmult_strauss_batch_single </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *&#160;</td>
          <td class="paramname"><em>error_callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *&#160;</td>
          <td class="paramname"><em>scratch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>inp_g_sc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ecmult_8h.html#ad93ba815a113f52bd5649e9d27a921a0">secp256k1_ecmult_multi_callback</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cbdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00395">395</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  395</span>                                                                                                                                                                                                                                       {</div>
<div class="line"><span class="lineno">  396</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="ecmult__impl_8h.html#aa185e51cc47dae567c15da179a1b4b7c">secp256k1_ecmult_strauss_batch</a>(error_callback, scratch, r, inp_g_sc, cb, cbdata, n, 0);</div>
<div class="line"><span class="lineno">  397</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00355">secp256k1_ecmult_strauss_batch()</a>.</p>

<p class="reference">Referenced by <a class="el" href="bench__ecmult_8c_source.html#l00281">main()</a>, <a class="el" href="tests_8c_source.html#l04453">run_ecmult_multi_tests()</a>, and <a class="el" href="tests_8c_source.html#l04097">test_ecmult_multi_random()</a>.</p>

</div>
</div>
<a id="af712c07897d43e290c166f73d11fd110" name="af712c07897d43e290c166f73d11fd110"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af712c07897d43e290c166f73d11fd110">&#9670;&nbsp;</a></span>secp256k1_ecmult_strauss_wnaf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void secp256k1_ecmult_strauss_wnaf </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structsecp256k1__strauss__state.html">secp256k1_strauss_state</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__gej.html">secp256k1_gej</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>na</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>ng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00225">225</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  225</span>                                                                                                                                                                                                     {</div>
<div class="line"><span class="lineno">  226</span>    <a class="code hl_struct" href="structsecp256k1__ge.html">secp256k1_ge</a> tmpa;</div>
<div class="line"><span class="lineno">  227</span>    <a class="code hl_struct" href="structsecp256k1__fe.html">secp256k1_fe</a> Z;</div>
<div class="line"><span class="lineno">  228</span>    <span class="comment">/* Split G factors. */</span></div>
<div class="line"><span class="lineno">  229</span>    <a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a> ng_1, ng_128;</div>
<div class="line"><span class="lineno">  230</span>    <span class="keywordtype">int</span> wnaf_ng_1[129];</div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordtype">int</span> bits_ng_1 = 0;</div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordtype">int</span> wnaf_ng_128[129];</div>
<div class="line"><span class="lineno">  233</span>    <span class="keywordtype">int</span> bits_ng_128 = 0;</div>
<div class="line"><span class="lineno">  234</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordtype">int</span> bits = 0;</div>
<div class="line"><span class="lineno">  236</span>    <span class="keywordtype">size_t</span> np;</div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordtype">size_t</span> no = 0;</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>    <a class="code hl_function" href="field_8h.html#a4bfba9980b6d6960ad623f1ddbbc547e">secp256k1_fe_set_int</a>(&amp;Z, 1);</div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordflow">for</span> (np = 0; np &lt; num; ++np) {</div>
<div class="line"><span class="lineno">  241</span>        <a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a> tmp;</div>
<div class="line"><span class="lineno">  242</span>        <a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a> na_1, na_lam;</div>
<div class="line"><span class="lineno">  243</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="scalar_8h.html#a3f0ac84fe49a1c1f51212582a2c149d4">secp256k1_scalar_is_zero</a>(&amp;na[np]) || <a class="code hl_function" href="group_8h.html#a33786d5853579c92d46fac51f6a40093">secp256k1_gej_is_infinity</a>(&amp;a[np])) {</div>
<div class="line"><span class="lineno">  244</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  245</span>        }</div>
<div class="line"><span class="lineno">  246</span>        <span class="comment">/* split na into na_1 and na_lam (where na = na_1 + na_lam*lambda, and na_1 and na_lam are ~128 bit) */</span></div>
<div class="line"><span class="lineno">  247</span>        <a class="code hl_function" href="scalar_8h.html#add6996401338effdcd60490839857583">secp256k1_scalar_split_lambda</a>(&amp;na_1, &amp;na_lam, &amp;na[np]);</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>        <span class="comment">/* build wnaf representation for na_1 and na_lam. */</span></div>
<div class="line"><span class="lineno">  250</span>        state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a2fdfe126142acc077aed3667a8401504">ps</a>[no].<a class="code hl_variable" href="structsecp256k1__strauss__point__state.html#a3690ebb84f53d6becbdab91c86b9f8c5">bits_na_1</a>   = <a class="code hl_function" href="ecmult__impl_8h.html#a48a8b6bbead18d4475c8a29d28376c5b">secp256k1_ecmult_wnaf</a>(state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a2fdfe126142acc077aed3667a8401504">ps</a>[no].<a class="code hl_variable" href="structsecp256k1__strauss__point__state.html#aea2e6d9512708b7ff0682266ffb8f850">wnaf_na_1</a>,   129, &amp;na_1,   <a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>);</div>
<div class="line"><span class="lineno">  251</span>        state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a2fdfe126142acc077aed3667a8401504">ps</a>[no].<a class="code hl_variable" href="structsecp256k1__strauss__point__state.html#ad0a467120f581fef6680899d11b2de27">bits_na_lam</a> = <a class="code hl_function" href="ecmult__impl_8h.html#a48a8b6bbead18d4475c8a29d28376c5b">secp256k1_ecmult_wnaf</a>(state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a2fdfe126142acc077aed3667a8401504">ps</a>[no].<a class="code hl_variable" href="structsecp256k1__strauss__point__state.html#a4f54739d4b1bd359bf0e7e22c4b911c6">wnaf_na_lam</a>, 129, &amp;na_lam, <a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>);</div>
<div class="line"><span class="lineno">  252</span>        <a class="code hl_define" href="util_8h.html#aca8ac5ae73fd966db106de59160a178b">VERIFY_CHECK</a>(state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a2fdfe126142acc077aed3667a8401504">ps</a>[no].<a class="code hl_variable" href="structsecp256k1__strauss__point__state.html#a3690ebb84f53d6becbdab91c86b9f8c5">bits_na_1</a> &lt;= 129);</div>
<div class="line"><span class="lineno">  253</span>        <a class="code hl_define" href="util_8h.html#aca8ac5ae73fd966db106de59160a178b">VERIFY_CHECK</a>(state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a2fdfe126142acc077aed3667a8401504">ps</a>[no].<a class="code hl_variable" href="structsecp256k1__strauss__point__state.html#ad0a467120f581fef6680899d11b2de27">bits_na_lam</a> &lt;= 129);</div>
<div class="line"><span class="lineno">  254</span>        <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a2fdfe126142acc077aed3667a8401504">ps</a>[no].<a class="code hl_variable" href="structsecp256k1__strauss__point__state.html#a3690ebb84f53d6becbdab91c86b9f8c5">bits_na_1</a> &gt; bits) {</div>
<div class="line"><span class="lineno">  255</span>            bits = state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a2fdfe126142acc077aed3667a8401504">ps</a>[no].<a class="code hl_variable" href="structsecp256k1__strauss__point__state.html#a3690ebb84f53d6becbdab91c86b9f8c5">bits_na_1</a>;</div>
<div class="line"><span class="lineno">  256</span>        }</div>
<div class="line"><span class="lineno">  257</span>        <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a2fdfe126142acc077aed3667a8401504">ps</a>[no].<a class="code hl_variable" href="structsecp256k1__strauss__point__state.html#ad0a467120f581fef6680899d11b2de27">bits_na_lam</a> &gt; bits) {</div>
<div class="line"><span class="lineno">  258</span>            bits = state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a2fdfe126142acc077aed3667a8401504">ps</a>[no].<a class="code hl_variable" href="structsecp256k1__strauss__point__state.html#ad0a467120f581fef6680899d11b2de27">bits_na_lam</a>;</div>
<div class="line"><span class="lineno">  259</span>        }</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>        <span class="comment">/* Calculate odd multiples of a.</span></div>
<div class="line"><span class="lineno">  262</span><span class="comment">         * All multiples are brought to the same Z &#39;denominator&#39;, which is stored</span></div>
<div class="line"><span class="lineno">  263</span><span class="comment">         * in Z. Due to secp256k1&#39; isomorphism we can do all operations pretending</span></div>
<div class="line"><span class="lineno">  264</span><span class="comment">         * that the Z coordinate was 1, use affine addition formulae, and correct</span></div>
<div class="line"><span class="lineno">  265</span><span class="comment">         * the Z coordinate of the result once at the end.</span></div>
<div class="line"><span class="lineno">  266</span><span class="comment">         * The exception is the precomputed G table points, which are actually</span></div>
<div class="line"><span class="lineno">  267</span><span class="comment">         * affine. Compared to the base used for other points, they have a Z ratio</span></div>
<div class="line"><span class="lineno">  268</span><span class="comment">         * of 1/Z, so we can use secp256k1_gej_add_zinv_var, which uses the same</span></div>
<div class="line"><span class="lineno">  269</span><span class="comment">         * isomorphism to efficiently add with a known Z inverse.</span></div>
<div class="line"><span class="lineno">  270</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">  271</span>        tmp = a[np];</div>
<div class="line"><span class="lineno">  272</span>        <span class="keywordflow">if</span> (no) {</div>
<div class="line"><span class="lineno">  273</span><span class="preprocessor">#ifdef VERIFY</span></div>
<div class="line"><span class="lineno">  274</span>            <a class="code hl_function" href="field_8h.html#a2d45c987537eadb2923c93aa3af9db71">secp256k1_fe_normalize_var</a>(&amp;Z);</div>
<div class="line"><span class="lineno">  275</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  276</span>            <a class="code hl_function" href="group_8h.html#a96ba360f6eb5f21c88e019e741a098ee">secp256k1_gej_rescale</a>(&amp;tmp, &amp;Z);</div>
<div class="line"><span class="lineno">  277</span>        }</div>
<div class="line"><span class="lineno">  278</span>        <a class="code hl_function" href="ecmult__impl_8h.html#aed8dc2160c07c97c063bdeffbffa46a8">secp256k1_ecmult_odd_multiples_table</a>(<a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>), state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#af259a5034686dfa2147d502f09498bbf">pre_a</a> + no * <a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>), state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a120d3c972fb65e1b85dd3b9480d340a3">aux</a> + no * <a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>), &amp;Z, &amp;tmp);</div>
<div class="line"><span class="lineno">  279</span>        <span class="keywordflow">if</span> (no) <a class="code hl_function" href="field_8h.html#a542b97d2574d9687c563d002587cf9a2">secp256k1_fe_mul</a>(state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a120d3c972fb65e1b85dd3b9480d340a3">aux</a> + no * <a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>), state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a120d3c972fb65e1b85dd3b9480d340a3">aux</a> + no * <a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>), &amp;(a[np].z));</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>        ++no;</div>
<div class="line"><span class="lineno">  282</span>    }</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>    <span class="comment">/* Bring them to the same Z denominator. */</span></div>
<div class="line"><span class="lineno">  285</span>    <a class="code hl_function" href="group_8h.html#ab59513862a3cd8b4e4bf3b5711a4e91f">secp256k1_ge_table_set_globalz</a>(<a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>) * no, state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#af259a5034686dfa2147d502f09498bbf">pre_a</a>, state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a120d3c972fb65e1b85dd3b9480d340a3">aux</a>);</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>    <span class="keywordflow">for</span> (np = 0; np &lt; no; ++np) {</div>
<div class="line"><span class="lineno">  288</span>        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>); i++) {</div>
<div class="line"><span class="lineno">  289</span>            <a class="code hl_function" href="field_8h.html#a542b97d2574d9687c563d002587cf9a2">secp256k1_fe_mul</a>(&amp;state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a120d3c972fb65e1b85dd3b9480d340a3">aux</a>[np * <a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>) + i], &amp;state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#af259a5034686dfa2147d502f09498bbf">pre_a</a>[np * <a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>) + i].x, &amp;<a class="code hl_variable" href="field_8h.html#a4b62b945e225e26d9597fbd7e642410a">secp256k1_const_beta</a>);</div>
<div class="line"><span class="lineno">  290</span>        }</div>
<div class="line"><span class="lineno">  291</span>    }</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>    <span class="keywordflow">if</span> (ng) {</div>
<div class="line"><span class="lineno">  294</span>        <span class="comment">/* split ng into ng_1 and ng_128 (where gn = gn_1 + gn_128*2^128, and gn_1 and gn_128 are ~128 bit) */</span></div>
<div class="line"><span class="lineno">  295</span>        <a class="code hl_function" href="scalar_8h.html#a1e5ba69db007520f97e9e5dc6eb03866">secp256k1_scalar_split_128</a>(&amp;ng_1, &amp;ng_128, ng);</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>        <span class="comment">/* Build wnaf representation for ng_1 and ng_128 */</span></div>
<div class="line"><span class="lineno">  298</span>        bits_ng_1   = <a class="code hl_function" href="ecmult__impl_8h.html#a48a8b6bbead18d4475c8a29d28376c5b">secp256k1_ecmult_wnaf</a>(wnaf_ng_1,   129, &amp;ng_1,   <a class="code hl_define" href="precomputed__ecmult_8c.html#afe951ac62b5b06848cb4e6f4dbc69616">WINDOW_G</a>);</div>
<div class="line"><span class="lineno">  299</span>        bits_ng_128 = <a class="code hl_function" href="ecmult__impl_8h.html#a48a8b6bbead18d4475c8a29d28376c5b">secp256k1_ecmult_wnaf</a>(wnaf_ng_128, 129, &amp;ng_128, <a class="code hl_define" href="precomputed__ecmult_8c.html#afe951ac62b5b06848cb4e6f4dbc69616">WINDOW_G</a>);</div>
<div class="line"><span class="lineno">  300</span>        <span class="keywordflow">if</span> (bits_ng_1 &gt; bits) {</div>
<div class="line"><span class="lineno">  301</span>            bits = bits_ng_1;</div>
<div class="line"><span class="lineno">  302</span>        }</div>
<div class="line"><span class="lineno">  303</span>        <span class="keywordflow">if</span> (bits_ng_128 &gt; bits) {</div>
<div class="line"><span class="lineno">  304</span>            bits = bits_ng_128;</div>
<div class="line"><span class="lineno">  305</span>        }</div>
<div class="line"><span class="lineno">  306</span>    }</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>    <a class="code hl_function" href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity</a>(r);</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>    <span class="keywordflow">for</span> (i = bits - 1; i &gt;= 0; i--) {</div>
<div class="line"><span class="lineno">  311</span>        <span class="keywordtype">int</span> n;</div>
<div class="line"><span class="lineno">  312</span>        <a class="code hl_function" href="group_8h.html#a033aa434a4d0838f649ad757dd44db46">secp256k1_gej_double_var</a>(r, r, NULL);</div>
<div class="line"><span class="lineno">  313</span>        <span class="keywordflow">for</span> (np = 0; np &lt; no; ++np) {</div>
<div class="line"><span class="lineno">  314</span>            <span class="keywordflow">if</span> (i &lt; state-&gt;ps[np].bits_na_1 &amp;&amp; (n = state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a2fdfe126142acc077aed3667a8401504">ps</a>[np].<a class="code hl_variable" href="structsecp256k1__strauss__point__state.html#aea2e6d9512708b7ff0682266ffb8f850">wnaf_na_1</a>[i])) {</div>
<div class="line"><span class="lineno">  315</span>                <a class="code hl_function" href="ecmult__impl_8h.html#abc5af5df03e9ee8d78ea2489c05338bc">secp256k1_ecmult_table_get_ge</a>(&amp;tmpa, state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#af259a5034686dfa2147d502f09498bbf">pre_a</a> + np * <a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>), n, <a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>);</div>
<div class="line"><span class="lineno">  316</span>                <a class="code hl_function" href="group_8h.html#a4d0338f50b08d082caa32f8e72707b55">secp256k1_gej_add_ge_var</a>(r, r, &amp;tmpa, NULL);</div>
<div class="line"><span class="lineno">  317</span>            }</div>
<div class="line"><span class="lineno">  318</span>            <span class="keywordflow">if</span> (i &lt; state-&gt;ps[np].bits_na_lam &amp;&amp; (n = state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a2fdfe126142acc077aed3667a8401504">ps</a>[np].<a class="code hl_variable" href="structsecp256k1__strauss__point__state.html#a4f54739d4b1bd359bf0e7e22c4b911c6">wnaf_na_lam</a>[i])) {</div>
<div class="line"><span class="lineno">  319</span>                <a class="code hl_function" href="ecmult__impl_8h.html#a5c5a19ad45aa3f057dc34e92ae6bf1df">secp256k1_ecmult_table_get_ge_lambda</a>(&amp;tmpa, state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#af259a5034686dfa2147d502f09498bbf">pre_a</a> + np * <a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>), state-&gt;<a class="code hl_variable" href="structsecp256k1__strauss__state.html#a120d3c972fb65e1b85dd3b9480d340a3">aux</a> + np * <a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>), n, <a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>);</div>
<div class="line"><span class="lineno">  320</span>                <a class="code hl_function" href="group_8h.html#a4d0338f50b08d082caa32f8e72707b55">secp256k1_gej_add_ge_var</a>(r, r, &amp;tmpa, NULL);</div>
<div class="line"><span class="lineno">  321</span>            }</div>
<div class="line"><span class="lineno">  322</span>        }</div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordflow">if</span> (i &lt; bits_ng_1 &amp;&amp; (n = wnaf_ng_1[i])) {</div>
<div class="line"><span class="lineno">  324</span>            <a class="code hl_function" href="ecmult__impl_8h.html#a4cd4a3ce3d9292cd197283fc0e17749c">secp256k1_ecmult_table_get_ge_storage</a>(&amp;tmpa, <a class="code hl_variable" href="precomputed__ecmult_8c.html#ab052c377e10c0ce101f47af9f6dcb4a7">secp256k1_pre_g</a>, n, <a class="code hl_define" href="precomputed__ecmult_8c.html#afe951ac62b5b06848cb4e6f4dbc69616">WINDOW_G</a>);</div>
<div class="line"><span class="lineno">  325</span>            <a class="code hl_function" href="group_8h.html#a180d4e54e906f101ce0f1e74563ce5f6">secp256k1_gej_add_zinv_var</a>(r, r, &amp;tmpa, &amp;Z);</div>
<div class="line"><span class="lineno">  326</span>        }</div>
<div class="line"><span class="lineno">  327</span>        <span class="keywordflow">if</span> (i &lt; bits_ng_128 &amp;&amp; (n = wnaf_ng_128[i])) {</div>
<div class="line"><span class="lineno">  328</span>            <a class="code hl_function" href="ecmult__impl_8h.html#a4cd4a3ce3d9292cd197283fc0e17749c">secp256k1_ecmult_table_get_ge_storage</a>(&amp;tmpa, <a class="code hl_variable" href="precomputed__ecmult_8c.html#ab047348edae9da6233f4d4a21eef0d0c">secp256k1_pre_g_128</a>, n, <a class="code hl_define" href="precomputed__ecmult_8c.html#afe951ac62b5b06848cb4e6f4dbc69616">WINDOW_G</a>);</div>
<div class="line"><span class="lineno">  329</span>            <a class="code hl_function" href="group_8h.html#a180d4e54e906f101ce0f1e74563ce5f6">secp256k1_gej_add_zinv_var</a>(r, r, &amp;tmpa, &amp;Z);</div>
<div class="line"><span class="lineno">  330</span>        }</div>
<div class="line"><span class="lineno">  331</span>    }</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>    <span class="keywordflow">if</span> (!r-&gt;<a class="code hl_variable" href="structsecp256k1__gej.html#ab3ec8168caf27aa3a092d512eaadaad9">infinity</a>) {</div>
<div class="line"><span class="lineno">  334</span>        <a class="code hl_function" href="field_8h.html#a542b97d2574d9687c563d002587cf9a2">secp256k1_fe_mul</a>(&amp;r-&gt;<a class="code hl_variable" href="structsecp256k1__gej.html#ae41776408dba32cbe28b5e345b5f2286">z</a>, &amp;r-&gt;<a class="code hl_variable" href="structsecp256k1__gej.html#ae41776408dba32cbe28b5e345b5f2286">z</a>, &amp;Z);</div>
<div class="line"><span class="lineno">  335</span>    }</div>
<div class="line"><span class="lineno">  336</span>}</div>
<div class="ttc" id="aecmult__impl_8h_html_a48a8b6bbead18d4475c8a29d28376c5b"><div class="ttname"><a href="ecmult__impl_8h.html#a48a8b6bbead18d4475c8a29d28376c5b">secp256k1_ecmult_wnaf</a></div><div class="ttdeci">static int secp256k1_ecmult_wnaf(int *wnaf, int len, const secp256k1_scalar *a, int w)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00159">ecmult_impl.h:159</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_a4cd4a3ce3d9292cd197283fc0e17749c"><div class="ttname"><a href="ecmult__impl_8h.html#a4cd4a3ce3d9292cd197283fc0e17749c">secp256k1_ecmult_table_get_ge_storage</a></div><div class="ttdeci">static SECP256K1_INLINE void secp256k1_ecmult_table_get_ge_storage(secp256k1_ge *r, const secp256k1_ge_storage *pre, int n, int w)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00142">ecmult_impl.h:142</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_a5c5a19ad45aa3f057dc34e92ae6bf1df"><div class="ttname"><a href="ecmult__impl_8h.html#a5c5a19ad45aa3f057dc34e92ae6bf1df">secp256k1_ecmult_table_get_ge_lambda</a></div><div class="ttdeci">static SECP256K1_INLINE void secp256k1_ecmult_table_get_ge_lambda(secp256k1_ge *r, const secp256k1_ge *pre, const secp256k1_fe *x, int n, int w)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00132">ecmult_impl.h:132</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_abc5af5df03e9ee8d78ea2489c05338bc"><div class="ttname"><a href="ecmult__impl_8h.html#abc5af5df03e9ee8d78ea2489c05338bc">secp256k1_ecmult_table_get_ge</a></div><div class="ttdeci">static SECP256K1_INLINE void secp256k1_ecmult_table_get_ge(secp256k1_ge *r, const secp256k1_ge *pre, int n, int w)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00122">ecmult_impl.h:122</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_aed8dc2160c07c97c063bdeffbffa46a8"><div class="ttname"><a href="ecmult__impl_8h.html#aed8dc2160c07c97c063bdeffbffa46a8">secp256k1_ecmult_odd_multiples_table</a></div><div class="ttdeci">static void secp256k1_ecmult_odd_multiples_table(int n, secp256k1_ge *pre_a, secp256k1_fe *zr, secp256k1_fe *z, const secp256k1_gej *a)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00073">ecmult_impl.h:73</a></div></div>
<div class="ttc" id="afield_8h_html_a2d45c987537eadb2923c93aa3af9db71"><div class="ttname"><a href="field_8h.html#a2d45c987537eadb2923c93aa3af9db71">secp256k1_fe_normalize_var</a></div><div class="ttdeci">static void secp256k1_fe_normalize_var(secp256k1_fe *r)</div></div>
<div class="ttc" id="afield_8h_html_a4b62b945e225e26d9597fbd7e642410a"><div class="ttname"><a href="field_8h.html#a4b62b945e225e26d9597fbd7e642410a">secp256k1_const_beta</a></div><div class="ttdeci">static const secp256k1_fe secp256k1_const_beta</div><div class="ttdef"><b>Definition:</b> <a href="field_8h_source.html#l00036">field.h:36</a></div></div>
<div class="ttc" id="afield_8h_html_a4bfba9980b6d6960ad623f1ddbbc547e"><div class="ttname"><a href="field_8h.html#a4bfba9980b6d6960ad623f1ddbbc547e">secp256k1_fe_set_int</a></div><div class="ttdeci">static void secp256k1_fe_set_int(secp256k1_fe *r, int a)</div></div>
<div class="ttc" id="agroup_8h_html_a180d4e54e906f101ce0f1e74563ce5f6"><div class="ttname"><a href="group_8h.html#a180d4e54e906f101ce0f1e74563ce5f6">secp256k1_gej_add_zinv_var</a></div><div class="ttdeci">static void secp256k1_gej_add_zinv_var(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_ge *b, const secp256k1_fe *bzinv)</div></div>
<div class="ttc" id="agroup_8h_html_a33786d5853579c92d46fac51f6a40093"><div class="ttname"><a href="group_8h.html#a33786d5853579c92d46fac51f6a40093">secp256k1_gej_is_infinity</a></div><div class="ttdeci">static int secp256k1_gej_is_infinity(const secp256k1_gej *a)</div></div>
<div class="ttc" id="agroup_8h_html_a96ba360f6eb5f21c88e019e741a098ee"><div class="ttname"><a href="group_8h.html#a96ba360f6eb5f21c88e019e741a098ee">secp256k1_gej_rescale</a></div><div class="ttdeci">static void secp256k1_gej_rescale(secp256k1_gej *r, const secp256k1_fe *b)</div></div>
<div class="ttc" id="agroup_8h_html_ab59513862a3cd8b4e4bf3b5711a4e91f"><div class="ttname"><a href="group_8h.html#ab59513862a3cd8b4e4bf3b5711a4e91f">secp256k1_ge_table_set_globalz</a></div><div class="ttdeci">static void secp256k1_ge_table_set_globalz(size_t len, secp256k1_ge *a, const secp256k1_fe *zr)</div></div>
<div class="ttc" id="aprecomputed__ecmult_8c_html_ab047348edae9da6233f4d4a21eef0d0c"><div class="ttname"><a href="precomputed__ecmult_8c.html#ab047348edae9da6233f4d4a21eef0d0c">secp256k1_pre_g_128</a></div><div class="ttdeci">const secp256k1_ge_storage secp256k1_pre_g_128[ECMULT_TABLE_SIZE(WINDOW_G)]</div><div class="ttdef"><b>Definition:</b> <a href="precomputed__ecmult_8c_source.html#l08240">precomputed_ecmult.c:8240</a></div></div>
<div class="ttc" id="aprecomputed__ecmult_8c_html_ab052c377e10c0ce101f47af9f6dcb4a7"><div class="ttname"><a href="precomputed__ecmult_8c.html#ab052c377e10c0ce101f47af9f6dcb4a7">secp256k1_pre_g</a></div><div class="ttdeci">const secp256k1_ge_storage secp256k1_pre_g[ECMULT_TABLE_SIZE(WINDOW_G)]</div><div class="ttdef"><b>Definition:</b> <a href="precomputed__ecmult_8c_source.html#l00020">precomputed_ecmult.c:20</a></div></div>
<div class="ttc" id="aprecomputed__ecmult_8c_html_afe951ac62b5b06848cb4e6f4dbc69616"><div class="ttname"><a href="precomputed__ecmult_8c.html#afe951ac62b5b06848cb4e6f4dbc69616">WINDOW_G</a></div><div class="ttdeci">#define WINDOW_G</div><div class="ttdef"><b>Definition:</b> <a href="precomputed__ecmult_8c_source.html#l00019">precomputed_ecmult.c:19</a></div></div>
<div class="ttc" id="ascalar_8h_html_a1e5ba69db007520f97e9e5dc6eb03866"><div class="ttname"><a href="scalar_8h.html#a1e5ba69db007520f97e9e5dc6eb03866">secp256k1_scalar_split_128</a></div><div class="ttdeci">static void secp256k1_scalar_split_128(secp256k1_scalar *r1, secp256k1_scalar *r2, const secp256k1_scalar *k)</div></div>
<div class="ttc" id="astructsecp256k1__strauss__point__state_html_a3690ebb84f53d6becbdab91c86b9f8c5"><div class="ttname"><a href="structsecp256k1__strauss__point__state.html#a3690ebb84f53d6becbdab91c86b9f8c5">secp256k1_strauss_point_state::bits_na_1</a></div><div class="ttdeci">int bits_na_1</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00214">ecmult_impl.h:214</a></div></div>
<div class="ttc" id="astructsecp256k1__strauss__point__state_html_a4f54739d4b1bd359bf0e7e22c4b911c6"><div class="ttname"><a href="structsecp256k1__strauss__point__state.html#a4f54739d4b1bd359bf0e7e22c4b911c6">secp256k1_strauss_point_state::wnaf_na_lam</a></div><div class="ttdeci">int wnaf_na_lam[129]</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00213">ecmult_impl.h:213</a></div></div>
<div class="ttc" id="astructsecp256k1__strauss__point__state_html_ad0a467120f581fef6680899d11b2de27"><div class="ttname"><a href="structsecp256k1__strauss__point__state.html#ad0a467120f581fef6680899d11b2de27">secp256k1_strauss_point_state::bits_na_lam</a></div><div class="ttdeci">int bits_na_lam</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00215">ecmult_impl.h:215</a></div></div>
<div class="ttc" id="astructsecp256k1__strauss__point__state_html_aea2e6d9512708b7ff0682266ffb8f850"><div class="ttname"><a href="structsecp256k1__strauss__point__state.html#aea2e6d9512708b7ff0682266ffb8f850">secp256k1_strauss_point_state::wnaf_na_1</a></div><div class="ttdeci">int wnaf_na_1[129]</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00212">ecmult_impl.h:212</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00220">secp256k1_strauss_state::aux</a>, <a class="el" href="ecmult__impl_8h_source.html#l00214">secp256k1_strauss_point_state::bits_na_1</a>, <a class="el" href="ecmult__impl_8h_source.html#l00215">secp256k1_strauss_point_state::bits_na_lam</a>, <a class="el" href="ecmult_8h_source.html#l00030">ECMULT_TABLE_SIZE</a>, <a class="el" href="group_8h_source.html#l00032">secp256k1_gej::infinity</a>, <a class="el" href="ecmult__impl_8h_source.html#l00221">secp256k1_strauss_state::pre_a</a>, <a class="el" href="ecmult__impl_8h_source.html#l00222">secp256k1_strauss_state::ps</a>, <a class="el" href="field_8h_source.html#l00036">secp256k1_const_beta</a>, <a class="el" href="ecmult__impl_8h_source.html#l00073">secp256k1_ecmult_odd_multiples_table()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00122">secp256k1_ecmult_table_get_ge()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00132">secp256k1_ecmult_table_get_ge_lambda()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00142">secp256k1_ecmult_table_get_ge_storage()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00159">secp256k1_ecmult_wnaf()</a>, <a class="el" href="field_8h.html#a542b97d2574d9687c563d002587cf9a2">secp256k1_fe_mul()</a>, <a class="el" href="field_8h.html#a2d45c987537eadb2923c93aa3af9db71">secp256k1_fe_normalize_var()</a>, <a class="el" href="field_8h.html#a4bfba9980b6d6960ad623f1ddbbc547e">secp256k1_fe_set_int()</a>, <a class="el" href="group_8h.html#ab59513862a3cd8b4e4bf3b5711a4e91f">secp256k1_ge_table_set_globalz()</a>, <a class="el" href="group_8h.html#a4d0338f50b08d082caa32f8e72707b55">secp256k1_gej_add_ge_var()</a>, <a class="el" href="group_8h.html#a180d4e54e906f101ce0f1e74563ce5f6">secp256k1_gej_add_zinv_var()</a>, <a class="el" href="group_8h.html#a033aa434a4d0838f649ad757dd44db46">secp256k1_gej_double_var()</a>, <a class="el" href="group_8h.html#a33786d5853579c92d46fac51f6a40093">secp256k1_gej_is_infinity()</a>, <a class="el" href="group_8h.html#a96ba360f6eb5f21c88e019e741a098ee">secp256k1_gej_rescale()</a>, <a class="el" href="group_8h.html#a2c6b24a2db08260d89e891eab7035b2c">secp256k1_gej_set_infinity()</a>, <a class="el" href="precomputed__ecmult_8c_source.html#l00020">secp256k1_pre_g</a>, <a class="el" href="precomputed__ecmult_8c_source.html#l08240">secp256k1_pre_g_128</a>, <a class="el" href="scalar_8h.html#a3f0ac84fe49a1c1f51212582a2c149d4">secp256k1_scalar_is_zero()</a>, <a class="el" href="scalar_8h.html#a1e5ba69db007520f97e9e5dc6eb03866">secp256k1_scalar_split_128()</a>, <a class="el" href="scalar_8h.html#add6996401338effdcd60490839857583">secp256k1_scalar_split_lambda()</a>, <a class="el" href="util_8h_source.html#l00095">VERIFY_CHECK</a>, <a class="el" href="ecmult__impl_8h_source.html#l00032">WINDOW_A</a>, <a class="el" href="precomputed__ecmult_8c_source.html#l00019">WINDOW_G</a>, <a class="el" href="ecmult__impl_8h_source.html#l00212">secp256k1_strauss_point_state::wnaf_na_1</a>, <a class="el" href="ecmult__impl_8h_source.html#l00213">secp256k1_strauss_point_state::wnaf_na_lam</a>, and <a class="el" href="group_8h_source.html#l00031">secp256k1_gej::z</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00338">secp256k1_ecmult()</a>, and <a class="el" href="ecmult__impl_8h_source.html#l00355">secp256k1_ecmult_strauss_batch()</a>.</p>

</div>
</div>
<a id="abc5af5df03e9ee8d78ea2489c05338bc" name="abc5af5df03e9ee8d78ea2489c05338bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc5af5df03e9ee8d78ea2489c05338bc">&#9670;&nbsp;</a></span>secp256k1_ecmult_table_get_ge()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> void secp256k1_ecmult_table_get_ge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *&#160;</td>
          <td class="paramname"><em>pre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00122">122</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  122</span>                                                                                                                   {</div>
<div class="line"><span class="lineno">  123</span>    <a class="code hl_define" href="ecmult__impl_8h.html#a5d4fb351e4919c5933128215d871052e">SECP256K1_ECMULT_TABLE_VERIFY</a>(n,w)</div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">if</span> (n &gt; 0) {</div>
<div class="line"><span class="lineno">  125</span>        *r = pre[(n-1)/2];</div>
<div class="line"><span class="lineno">  126</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  127</span>        *r = pre[(-n-1)/2];</div>
<div class="line"><span class="lineno">  128</span>        <a class="code hl_function" href="field_8h.html#a4543ff08a66fc870acd56c921f2b30f7">secp256k1_fe_negate</a>(&amp;(r-&gt;<a class="code hl_variable" href="structsecp256k1__ge.html#a604295983a1f4aa6e8b5b0f1e46f9ee0">y</a>), &amp;(r-&gt;<a class="code hl_variable" href="structsecp256k1__ge.html#a604295983a1f4aa6e8b5b0f1e46f9ee0">y</a>), 1);</div>
<div class="line"><span class="lineno">  129</span>    }</div>
<div class="line"><span class="lineno">  130</span>}</div>
<div class="ttc" id="aecmult__impl_8h_html_a5d4fb351e4919c5933128215d871052e"><div class="ttname"><a href="ecmult__impl_8h.html#a5d4fb351e4919c5933128215d871052e">SECP256K1_ECMULT_TABLE_VERIFY</a></div><div class="ttdeci">#define SECP256K1_ECMULT_TABLE_VERIFY(n, w)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00117">ecmult_impl.h:117</a></div></div>
<div class="ttc" id="afield_8h_html_a4543ff08a66fc870acd56c921f2b30f7"><div class="ttname"><a href="field_8h.html#a4543ff08a66fc870acd56c921f2b30f7">secp256k1_fe_negate</a></div><div class="ttdeci">static void secp256k1_fe_negate(secp256k1_fe *r, const secp256k1_fe *a, int m)</div></div>
<div class="ttc" id="astructsecp256k1__ge_html_a604295983a1f4aa6e8b5b0f1e46f9ee0"><div class="ttname"><a href="structsecp256k1__ge.html#a604295983a1f4aa6e8b5b0f1e46f9ee0">secp256k1_ge::y</a></div><div class="ttdeci">secp256k1_fe y</div><div class="ttdef"><b>Definition:</b> <a href="group_8h_source.html#l00018">group.h:18</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00117">SECP256K1_ECMULT_TABLE_VERIFY</a>, <a class="el" href="field_8h.html#a4543ff08a66fc870acd56c921f2b30f7">secp256k1_fe_negate()</a>, and <a class="el" href="group_8h_source.html#l00018">secp256k1_ge::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00225">secp256k1_ecmult_strauss_wnaf()</a>.</p>

</div>
</div>
<a id="a5c5a19ad45aa3f057dc34e92ae6bf1df" name="a5c5a19ad45aa3f057dc34e92ae6bf1df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c5a19ad45aa3f057dc34e92ae6bf1df">&#9670;&nbsp;</a></span>secp256k1_ecmult_table_get_ge_lambda()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> void secp256k1_ecmult_table_get_ge_lambda </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *&#160;</td>
          <td class="paramname"><em>pre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__fe.html">secp256k1_fe</a> *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00132">132</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  132</span>                                                                                                                                                 {</div>
<div class="line"><span class="lineno">  133</span>    <a class="code hl_define" href="ecmult__impl_8h.html#a5d4fb351e4919c5933128215d871052e">SECP256K1_ECMULT_TABLE_VERIFY</a>(n,w)</div>
<div class="line"><span class="lineno">  134</span>    <span class="keywordflow">if</span> (n &gt; 0) {</div>
<div class="line"><span class="lineno">  135</span>        <a class="code hl_function" href="group_8h.html#a34ab3d1a9a0a7ff0ed1cedff9db5f73c">secp256k1_ge_set_xy</a>(r, &amp;x[(n-1)/2], &amp;pre[(n-1)/2].y);</div>
<div class="line"><span class="lineno">  136</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  137</span>        <a class="code hl_function" href="group_8h.html#a34ab3d1a9a0a7ff0ed1cedff9db5f73c">secp256k1_ge_set_xy</a>(r, &amp;x[(-n-1)/2], &amp;pre[(-n-1)/2].y);</div>
<div class="line"><span class="lineno">  138</span>        <a class="code hl_function" href="field_8h.html#a4543ff08a66fc870acd56c921f2b30f7">secp256k1_fe_negate</a>(&amp;(r-&gt;<a class="code hl_variable" href="structsecp256k1__ge.html#a604295983a1f4aa6e8b5b0f1e46f9ee0">y</a>), &amp;(r-&gt;<a class="code hl_variable" href="structsecp256k1__ge.html#a604295983a1f4aa6e8b5b0f1e46f9ee0">y</a>), 1);</div>
<div class="line"><span class="lineno">  139</span>    }</div>
<div class="line"><span class="lineno">  140</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00117">SECP256K1_ECMULT_TABLE_VERIFY</a>, <a class="el" href="field_8h.html#a4543ff08a66fc870acd56c921f2b30f7">secp256k1_fe_negate()</a>, <a class="el" href="group_8h.html#a34ab3d1a9a0a7ff0ed1cedff9db5f73c">secp256k1_ge_set_xy()</a>, and <a class="el" href="group_8h_source.html#l00018">secp256k1_ge::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00225">secp256k1_ecmult_strauss_wnaf()</a>.</p>

</div>
</div>
<a id="a4cd4a3ce3d9292cd197283fc0e17749c" name="a4cd4a3ce3d9292cd197283fc0e17749c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cd4a3ce3d9292cd197283fc0e17749c">&#9670;&nbsp;</a></span>secp256k1_ecmult_table_get_ge_storage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> void secp256k1_ecmult_table_get_ge_storage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsecp256k1__ge.html">secp256k1_ge</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__ge__storage.html">secp256k1_ge_storage</a> *&#160;</td>
          <td class="paramname"><em>pre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00142">142</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  142</span>                                                                                                                                   {</div>
<div class="line"><span class="lineno">  143</span>    <a class="code hl_define" href="ecmult__impl_8h.html#a5d4fb351e4919c5933128215d871052e">SECP256K1_ECMULT_TABLE_VERIFY</a>(n,w)</div>
<div class="line"><span class="lineno">  144</span>    <span class="keywordflow">if</span> (n &gt; 0) {</div>
<div class="line"><span class="lineno">  145</span>        <a class="code hl_function" href="group_8h.html#a8c1e7f328284d9ba56404bb8d99bf765">secp256k1_ge_from_storage</a>(r, &amp;pre[(n-1)/2]);</div>
<div class="line"><span class="lineno">  146</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  147</span>        <a class="code hl_function" href="group_8h.html#a8c1e7f328284d9ba56404bb8d99bf765">secp256k1_ge_from_storage</a>(r, &amp;pre[(-n-1)/2]);</div>
<div class="line"><span class="lineno">  148</span>        <a class="code hl_function" href="field_8h.html#a4543ff08a66fc870acd56c921f2b30f7">secp256k1_fe_negate</a>(&amp;(r-&gt;<a class="code hl_variable" href="structsecp256k1__ge.html#a604295983a1f4aa6e8b5b0f1e46f9ee0">y</a>), &amp;(r-&gt;<a class="code hl_variable" href="structsecp256k1__ge.html#a604295983a1f4aa6e8b5b0f1e46f9ee0">y</a>), 1);</div>
<div class="line"><span class="lineno">  149</span>    }</div>
<div class="line"><span class="lineno">  150</span>}</div>
<div class="ttc" id="agroup_8h_html_a8c1e7f328284d9ba56404bb8d99bf765"><div class="ttname"><a href="group_8h.html#a8c1e7f328284d9ba56404bb8d99bf765">secp256k1_ge_from_storage</a></div><div class="ttdeci">static void secp256k1_ge_from_storage(secp256k1_ge *r, const secp256k1_ge_storage *a)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00117">SECP256K1_ECMULT_TABLE_VERIFY</a>, <a class="el" href="field_8h.html#a4543ff08a66fc870acd56c921f2b30f7">secp256k1_fe_negate()</a>, <a class="el" href="group_8h.html#a8c1e7f328284d9ba56404bb8d99bf765">secp256k1_ge_from_storage()</a>, and <a class="el" href="group_8h_source.html#l00018">secp256k1_ge::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00225">secp256k1_ecmult_strauss_wnaf()</a>.</p>

</div>
</div>
<a id="a48a8b6bbead18d4475c8a29d28376c5b" name="a48a8b6bbead18d4475c8a29d28376c5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48a8b6bbead18d4475c8a29d28376c5b">&#9670;&nbsp;</a></span>secp256k1_ecmult_wnaf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int secp256k1_ecmult_wnaf </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>wnaf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Convert a number to WNAF notation. The number becomes represented by sum(2^i * wnaf[i], i=0..bits), with the following guarantees:</p><ul>
<li>each wnaf[i] is either 0, or an odd integer between -(1&lt;&lt;(w-1) - 1) and (1&lt;&lt;(w-1) - 1)</li>
<li>two non-zero entries in wnaf are separated by at least w-1 zeroes.</li>
<li>the number of set values in wnaf is returned. This number is at most 256, and at most one more than the number of bits in the (absolute value) of the input. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00159">159</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  159</span>                                                                                       {</div>
<div class="line"><span class="lineno">  160</span>    <a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a> s;</div>
<div class="line"><span class="lineno">  161</span>    <span class="keywordtype">int</span> last_set_bit = -1;</div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordtype">int</span> bit = 0;</div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordtype">int</span> sign = 1;</div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordtype">int</span> carry = 0;</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>    <a class="code hl_define" href="util_8h.html#aca8ac5ae73fd966db106de59160a178b">VERIFY_CHECK</a>(wnaf != NULL);</div>
<div class="line"><span class="lineno">  167</span>    <a class="code hl_define" href="util_8h.html#aca8ac5ae73fd966db106de59160a178b">VERIFY_CHECK</a>(0 &lt;= len &amp;&amp; len &lt;= 256);</div>
<div class="line"><span class="lineno">  168</span>    <a class="code hl_define" href="util_8h.html#aca8ac5ae73fd966db106de59160a178b">VERIFY_CHECK</a>(a != NULL);</div>
<div class="line"><span class="lineno">  169</span>    <a class="code hl_define" href="util_8h.html#aca8ac5ae73fd966db106de59160a178b">VERIFY_CHECK</a>(2 &lt;= w &amp;&amp; w &lt;= 31);</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>    memset(wnaf, 0, len * <span class="keyword">sizeof</span>(wnaf[0]));</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    s = *a;</div>
<div class="line"><span class="lineno">  174</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="scalar_8h.html#a70d7af05e9c9a579ed5cb20d9f22eeba">secp256k1_scalar_get_bits</a>(&amp;s, 255, 1)) {</div>
<div class="line"><span class="lineno">  175</span>        <a class="code hl_function" href="scalar_8h.html#aa3f1c1d4536adf835ee256878c222968">secp256k1_scalar_negate</a>(&amp;s, &amp;s);</div>
<div class="line"><span class="lineno">  176</span>        sign = -1;</div>
<div class="line"><span class="lineno">  177</span>    }</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">while</span> (bit &lt; len) {</div>
<div class="line"><span class="lineno">  180</span>        <span class="keywordtype">int</span> now;</div>
<div class="line"><span class="lineno">  181</span>        <span class="keywordtype">int</span> word;</div>
<div class="line"><span class="lineno">  182</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="scalar_8h.html#a70d7af05e9c9a579ed5cb20d9f22eeba">secp256k1_scalar_get_bits</a>(&amp;s, bit, 1) == (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)carry) {</div>
<div class="line"><span class="lineno">  183</span>            bit++;</div>
<div class="line"><span class="lineno">  184</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  185</span>        }</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>        now = w;</div>
<div class="line"><span class="lineno">  188</span>        <span class="keywordflow">if</span> (now &gt; len - bit) {</div>
<div class="line"><span class="lineno">  189</span>            now = len - bit;</div>
<div class="line"><span class="lineno">  190</span>        }</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>        word = <a class="code hl_function" href="scalar_8h.html#abede7dbe3b5a38a51b388d46f4c5b52d">secp256k1_scalar_get_bits_var</a>(&amp;s, bit, now) + carry;</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>        carry = (word &gt;&gt; (w-1)) &amp; 1;</div>
<div class="line"><span class="lineno">  195</span>        word -= carry &lt;&lt; w;</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>        wnaf[bit] = sign * word;</div>
<div class="line"><span class="lineno">  198</span>        last_set_bit = bit;</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>        bit += now;</div>
<div class="line"><span class="lineno">  201</span>    }</div>
<div class="line"><span class="lineno">  202</span><span class="preprocessor">#ifdef VERIFY</span></div>
<div class="line"><span class="lineno">  203</span>    <a class="code hl_define" href="util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(carry == 0);</div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">while</span> (bit &lt; 256) {</div>
<div class="line"><span class="lineno">  205</span>        <a class="code hl_define" href="util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a>(<a class="code hl_function" href="scalar_8h.html#a70d7af05e9c9a579ed5cb20d9f22eeba">secp256k1_scalar_get_bits</a>(&amp;s, bit++, 1) == 0);</div>
<div class="line"><span class="lineno">  206</span>    }</div>
<div class="line"><span class="lineno">  207</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">return</span> last_set_bit + 1;</div>
<div class="line"><span class="lineno">  209</span>}</div>
<div class="ttc" id="ascalar_8h_html_a70d7af05e9c9a579ed5cb20d9f22eeba"><div class="ttname"><a href="scalar_8h.html#a70d7af05e9c9a579ed5cb20d9f22eeba">secp256k1_scalar_get_bits</a></div><div class="ttdeci">static unsigned int secp256k1_scalar_get_bits(const secp256k1_scalar *a, unsigned int offset, unsigned int count)</div></div>
<div class="ttc" id="ascalar_8h_html_abede7dbe3b5a38a51b388d46f4c5b52d"><div class="ttname"><a href="scalar_8h.html#abede7dbe3b5a38a51b388d46f4c5b52d">secp256k1_scalar_get_bits_var</a></div><div class="ttdeci">static unsigned int secp256k1_scalar_get_bits_var(const secp256k1_scalar *a, unsigned int offset, unsigned int count)</div></div>
<div class="ttc" id="autil_8h_html_aba1590ff86288c886c47dc8a27b30467"><div class="ttname"><a href="util_8h.html#aba1590ff86288c886c47dc8a27b30467">CHECK</a></div><div class="ttdeci">#define CHECK(cond)</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00080">util.h:80</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="util_8h_source.html#l00080">CHECK</a>, <a class="el" href="scalar_8h.html#a70d7af05e9c9a579ed5cb20d9f22eeba">secp256k1_scalar_get_bits()</a>, <a class="el" href="scalar_8h.html#abede7dbe3b5a38a51b388d46f4c5b52d">secp256k1_scalar_get_bits_var()</a>, <a class="el" href="scalar_8h.html#aa3f1c1d4536adf835ee256878c222968">secp256k1_scalar_negate()</a>, and <a class="el" href="util_8h_source.html#l00095">VERIFY_CHECK</a>.</p>

<p class="reference">Referenced by <a class="el" href="bench__internal_8c_source.html#l00268">bench_ecmult_wnaf()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00225">secp256k1_ecmult_strauss_wnaf()</a>, and <a class="el" href="tests_8c_source.html#l04480">test_wnaf()</a>.</p>

</div>
</div>
<a id="a7ab4c858354f0c2f67bf76642b15d82c" name="a7ab4c858354f0c2f67bf76642b15d82c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ab4c858354f0c2f67bf76642b15d82c">&#9670;&nbsp;</a></span>secp256k1_pippenger_bucket_window()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int secp256k1_pippenger_bucket_window </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Returns optimal bucket_window (number of bits of a scalar represented by a set of buckets) for a given number of points. </p>

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00570">570</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  570</span>                                                       {</div>
<div class="line"><span class="lineno">  571</span>    <span class="keywordflow">if</span> (n &lt;= 1) {</div>
<div class="line"><span class="lineno">  572</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  573</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &lt;= 4) {</div>
<div class="line"><span class="lineno">  574</span>        <span class="keywordflow">return</span> 2;</div>
<div class="line"><span class="lineno">  575</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &lt;= 20) {</div>
<div class="line"><span class="lineno">  576</span>        <span class="keywordflow">return</span> 3;</div>
<div class="line"><span class="lineno">  577</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &lt;= 57) {</div>
<div class="line"><span class="lineno">  578</span>        <span class="keywordflow">return</span> 4;</div>
<div class="line"><span class="lineno">  579</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &lt;= 136) {</div>
<div class="line"><span class="lineno">  580</span>        <span class="keywordflow">return</span> 5;</div>
<div class="line"><span class="lineno">  581</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &lt;= 235) {</div>
<div class="line"><span class="lineno">  582</span>        <span class="keywordflow">return</span> 6;</div>
<div class="line"><span class="lineno">  583</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &lt;= 1260) {</div>
<div class="line"><span class="lineno">  584</span>        <span class="keywordflow">return</span> 7;</div>
<div class="line"><span class="lineno">  585</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &lt;= 4420) {</div>
<div class="line"><span class="lineno">  586</span>        <span class="keywordflow">return</span> 9;</div>
<div class="line"><span class="lineno">  587</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &lt;= 7880) {</div>
<div class="line"><span class="lineno">  588</span>        <span class="keywordflow">return</span> 10;</div>
<div class="line"><span class="lineno">  589</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &lt;= 16050) {</div>
<div class="line"><span class="lineno">  590</span>        <span class="keywordflow">return</span> 11;</div>
<div class="line"><span class="lineno">  591</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  592</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="ecmult__impl_8h.html#a9114820daf51f54afc1858640539ac6d">PIPPENGER_MAX_BUCKET_WINDOW</a>;</div>
<div class="line"><span class="lineno">  593</span>    }</div>
<div class="line"><span class="lineno">  594</span>}</div>
<div class="ttc" id="aecmult__impl_8h_html_a9114820daf51f54afc1858640539ac6d"><div class="ttname"><a href="ecmult__impl_8h.html#a9114820daf51f54afc1858640539ac6d">PIPPENGER_MAX_BUCKET_WINDOW</a></div><div class="ttdeci">#define PIPPENGER_MAX_BUCKET_WINDOW</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00052">ecmult_impl.h:52</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00052">PIPPENGER_MAX_BUCKET_WINDOW</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00643">secp256k1_ecmult_pippenger_batch()</a>, <a class="el" href="tests_8c_source.html#l04386">test_ecmult_multi_batching()</a>, <a class="el" href="tests_8c_source.html#l04305">test_ecmult_multi_pippenger_max_points()</a>, and <a class="el" href="tests_8c_source.html#l04285">test_secp256k1_pippenger_bucket_window_inv()</a>.</p>

</div>
</div>
<a id="a087cc0c7875deb19ebefb6c7f86979e0" name="a087cc0c7875deb19ebefb6c7f86979e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a087cc0c7875deb19ebefb6c7f86979e0">&#9670;&nbsp;</a></span>secp256k1_pippenger_bucket_window_inv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t secp256k1_pippenger_bucket_window_inv </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bucket_window</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Returns the maximum optimal number of points for a bucket_window. </p>

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00599">599</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  599</span>                                                                       {</div>
<div class="line"><span class="lineno">  600</span>    <span class="keywordflow">switch</span>(bucket_window) {</div>
<div class="line"><span class="lineno">  601</span>        <span class="keywordflow">case</span> 1: <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  602</span>        <span class="keywordflow">case</span> 2: <span class="keywordflow">return</span> 4;</div>
<div class="line"><span class="lineno">  603</span>        <span class="keywordflow">case</span> 3: <span class="keywordflow">return</span> 20;</div>
<div class="line"><span class="lineno">  604</span>        <span class="keywordflow">case</span> 4: <span class="keywordflow">return</span> 57;</div>
<div class="line"><span class="lineno">  605</span>        <span class="keywordflow">case</span> 5: <span class="keywordflow">return</span> 136;</div>
<div class="line"><span class="lineno">  606</span>        <span class="keywordflow">case</span> 6: <span class="keywordflow">return</span> 235;</div>
<div class="line"><span class="lineno">  607</span>        <span class="keywordflow">case</span> 7: <span class="keywordflow">return</span> 1260;</div>
<div class="line"><span class="lineno">  608</span>        <span class="keywordflow">case</span> 8: <span class="keywordflow">return</span> 1260;</div>
<div class="line"><span class="lineno">  609</span>        <span class="keywordflow">case</span> 9: <span class="keywordflow">return</span> 4420;</div>
<div class="line"><span class="lineno">  610</span>        <span class="keywordflow">case</span> 10: <span class="keywordflow">return</span> 7880;</div>
<div class="line"><span class="lineno">  611</span>        <span class="keywordflow">case</span> 11: <span class="keywordflow">return</span> 16050;</div>
<div class="line"><span class="lineno">  612</span>        <span class="keywordflow">case</span> <a class="code hl_define" href="ecmult__impl_8h.html#a9114820daf51f54afc1858640539ac6d">PIPPENGER_MAX_BUCKET_WINDOW</a>: <span class="keywordflow">return</span> SIZE_MAX;</div>
<div class="line"><span class="lineno">  613</span>    }</div>
<div class="line"><span class="lineno">  614</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  615</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00052">PIPPENGER_MAX_BUCKET_WINDOW</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00729">secp256k1_pippenger_max_points()</a>, <a class="el" href="tests_8c_source.html#l04305">test_ecmult_multi_pippenger_max_points()</a>, and <a class="el" href="tests_8c_source.html#l04285">test_secp256k1_pippenger_bucket_window_inv()</a>.</p>

</div>
</div>
<a id="a117129015e68d74721e8c62320bb86c7" name="a117129015e68d74721e8c62320bb86c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a117129015e68d74721e8c62320bb86c7">&#9670;&nbsp;</a></span>secp256k1_pippenger_max_points()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t secp256k1_pippenger_max_points </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *&#160;</td>
          <td class="paramname"><em>error_callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *&#160;</td>
          <td class="paramname"><em>scratch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Returns the maximum number of points in addition to G that can be used with a given scratch space. The function ensures that fewer points may also be used. </p>

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00729">729</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  729</span>                                                                                                                   {</div>
<div class="line"><span class="lineno">  730</span>    <span class="keywordtype">size_t</span> max_alloc = <a class="code hl_function" href="scratch_8h.html#a7bafc5e853208fab3aeb50e8d70e4d07">secp256k1_scratch_max_allocation</a>(error_callback, scratch, <a class="code hl_define" href="ecmult__impl_8h.html#a991c52a2d9fa18dd39f5a9fffe373922">PIPPENGER_SCRATCH_OBJECTS</a>);</div>
<div class="line"><span class="lineno">  731</span>    <span class="keywordtype">int</span> bucket_window;</div>
<div class="line"><span class="lineno">  732</span>    <span class="keywordtype">size_t</span> res = 0;</div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span>    <span class="keywordflow">for</span> (bucket_window = 1; bucket_window &lt;= <a class="code hl_define" href="ecmult__impl_8h.html#a9114820daf51f54afc1858640539ac6d">PIPPENGER_MAX_BUCKET_WINDOW</a>; bucket_window++) {</div>
<div class="line"><span class="lineno">  735</span>        <span class="keywordtype">size_t</span> n_points;</div>
<div class="line"><span class="lineno">  736</span>        <span class="keywordtype">size_t</span> max_points = <a class="code hl_function" href="ecmult__impl_8h.html#a087cc0c7875deb19ebefb6c7f86979e0">secp256k1_pippenger_bucket_window_inv</a>(bucket_window);</div>
<div class="line"><span class="lineno">  737</span>        <span class="keywordtype">size_t</span> space_for_points;</div>
<div class="line"><span class="lineno">  738</span>        <span class="keywordtype">size_t</span> space_overhead;</div>
<div class="line"><span class="lineno">  739</span>        <span class="keywordtype">size_t</span> entry_size = <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structsecp256k1__ge.html">secp256k1_ge</a>) + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a>) + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code hl_struct" href="structsecp256k1__pippenger__point__state.html">secp256k1_pippenger_point_state</a>) + (<a class="code hl_define" href="ecmult__impl_8h.html#a23d9fb349265ae338b9977f7f7aab065">WNAF_SIZE</a>(bucket_window+1)+1)*<span class="keyword">sizeof</span>(int);</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>        entry_size = 2*entry_size;</div>
<div class="line"><span class="lineno">  742</span>        space_overhead = (<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a>) &lt;&lt; bucket_window) + entry_size + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code hl_struct" href="structsecp256k1__pippenger__state.html">secp256k1_pippenger_state</a>);</div>
<div class="line"><span class="lineno">  743</span>        <span class="keywordflow">if</span> (space_overhead &gt; max_alloc) {</div>
<div class="line"><span class="lineno">  744</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  745</span>        }</div>
<div class="line"><span class="lineno">  746</span>        space_for_points = max_alloc - space_overhead;</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>        n_points = space_for_points/entry_size;</div>
<div class="line"><span class="lineno">  749</span>        n_points = n_points &gt; max_points ? max_points : n_points;</div>
<div class="line"><span class="lineno">  750</span>        <span class="keywordflow">if</span> (n_points &gt; res) {</div>
<div class="line"><span class="lineno">  751</span>            res = n_points;</div>
<div class="line"><span class="lineno">  752</span>        }</div>
<div class="line"><span class="lineno">  753</span>        <span class="keywordflow">if</span> (n_points &lt; max_points) {</div>
<div class="line"><span class="lineno">  754</span>            <span class="comment">/* A larger bucket_window may support even more points. But if we</span></div>
<div class="line"><span class="lineno">  755</span><span class="comment">             * would choose that then the caller couldn&#39;t safely use any number</span></div>
<div class="line"><span class="lineno">  756</span><span class="comment">             * smaller than what this function returns */</span></div>
<div class="line"><span class="lineno">  757</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  758</span>        }</div>
<div class="line"><span class="lineno">  759</span>    }</div>
<div class="line"><span class="lineno">  760</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">  761</span>}</div>
<div class="ttc" id="aecmult__impl_8h_html_a087cc0c7875deb19ebefb6c7f86979e0"><div class="ttname"><a href="ecmult__impl_8h.html#a087cc0c7875deb19ebefb6c7f86979e0">secp256k1_pippenger_bucket_window_inv</a></div><div class="ttdeci">static size_t secp256k1_pippenger_bucket_window_inv(int bucket_window)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00599">ecmult_impl.h:599</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_a991c52a2d9fa18dd39f5a9fffe373922"><div class="ttname"><a href="ecmult__impl_8h.html#a991c52a2d9fa18dd39f5a9fffe373922">PIPPENGER_SCRATCH_OBJECTS</a></div><div class="ttdeci">#define PIPPENGER_SCRATCH_OBJECTS</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00049">ecmult_impl.h:49</a></div></div>
<div class="ttc" id="ascratch_8h_html_a7bafc5e853208fab3aeb50e8d70e4d07"><div class="ttname"><a href="scratch_8h.html#a7bafc5e853208fab3aeb50e8d70e4d07">secp256k1_scratch_max_allocation</a></div><div class="ttdeci">static size_t secp256k1_scratch_max_allocation(const secp256k1_callback *error_callback, const secp256k1_scratch *scratch, size_t n_objects)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00052">PIPPENGER_MAX_BUCKET_WINDOW</a>, <a class="el" href="ecmult__impl_8h_source.html#l00049">PIPPENGER_SCRATCH_OBJECTS</a>, <a class="el" href="ecmult__impl_8h_source.html#l00599">secp256k1_pippenger_bucket_window_inv()</a>, <a class="el" href="scratch_8h.html#a7bafc5e853208fab3aeb50e8d70e4d07">secp256k1_scratch_max_allocation()</a>, and <a class="el" href="ecmult__impl_8h_source.html#l00046">WNAF_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00811">secp256k1_ecmult_multi_var()</a>, and <a class="el" href="tests_8c_source.html#l04305">test_ecmult_multi_pippenger_max_points()</a>.</p>

</div>
</div>
<a id="abb210b3b61e37937e46f58e3d78f89d1" name="abb210b3b61e37937e46f58e3d78f89d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb210b3b61e37937e46f58e3d78f89d1">&#9670;&nbsp;</a></span>secp256k1_pippenger_scratch_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t secp256k1_pippenger_scratch_size </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bucket_window</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Returns the scratch size required for a given number of points (excluding base point G) without considering alignment. </p>

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00637">637</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  637</span>                                                                                   {</div>
<div class="line"><span class="lineno">  638</span>    <span class="keywordtype">size_t</span> entries = 2*n_points + 2;</div>
<div class="line"><span class="lineno">  639</span>    <span class="keywordtype">size_t</span> entry_size = <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structsecp256k1__ge.html">secp256k1_ge</a>) + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a>) + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code hl_struct" href="structsecp256k1__pippenger__point__state.html">secp256k1_pippenger_point_state</a>) + (<a class="code hl_define" href="ecmult__impl_8h.html#a23d9fb349265ae338b9977f7f7aab065">WNAF_SIZE</a>(bucket_window+1)+1)*<span class="keyword">sizeof</span>(int);</div>
<div class="line"><span class="lineno">  640</span>    <span class="keywordflow">return</span> (<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a>) &lt;&lt; bucket_window) + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="structsecp256k1__pippenger__state.html">secp256k1_pippenger_state</a>) + entries * entry_size;</div>
<div class="line"><span class="lineno">  641</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult__impl_8h_source.html#l00046">WNAF_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="tests_8c_source.html#l04386">test_ecmult_multi_batching()</a>, and <a class="el" href="tests_8c_source.html#l04305">test_ecmult_multi_pippenger_max_points()</a>.</p>

</div>
</div>
<a id="a2ed67cbaf00f8ccdfff87129844b8635" name="a2ed67cbaf00f8ccdfff87129844b8635"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ed67cbaf00f8ccdfff87129844b8635">&#9670;&nbsp;</a></span>secp256k1_strauss_max_points()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t secp256k1_strauss_max_points </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__callback.html">secp256k1_callback</a> *&#160;</td>
          <td class="paramname"><em>error_callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="scratch_8h.html#a84bdf30f4ca993587d89471cf1ae8be7">secp256k1_scratch</a> *&#160;</td>
          <td class="paramname"><em>scratch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00399">399</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  399</span>                                                                                                                 {</div>
<div class="line"><span class="lineno">  400</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="scratch_8h.html#a7bafc5e853208fab3aeb50e8d70e4d07">secp256k1_scratch_max_allocation</a>(error_callback, scratch, <a class="code hl_define" href="ecmult__impl_8h.html#a0447eb99687dea95c58a48eb6b6e17e2">STRAUSS_SCRATCH_OBJECTS</a>) / <a class="code hl_function" href="ecmult__impl_8h.html#a7146d7f05cdd7440271523da3674004c">secp256k1_strauss_scratch_size</a>(1);</div>
<div class="line"><span class="lineno">  401</span>}</div>
<div class="ttc" id="aecmult__impl_8h_html_a0447eb99687dea95c58a48eb6b6e17e2"><div class="ttname"><a href="ecmult__impl_8h.html#a0447eb99687dea95c58a48eb6b6e17e2">STRAUSS_SCRATCH_OBJECTS</a></div><div class="ttdeci">#define STRAUSS_SCRATCH_OBJECTS</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00050">ecmult_impl.h:50</a></div></div>
<div class="ttc" id="aecmult__impl_8h_html_a7146d7f05cdd7440271523da3674004c"><div class="ttname"><a href="ecmult__impl_8h.html#a7146d7f05cdd7440271523da3674004c">secp256k1_strauss_scratch_size</a></div><div class="ttdeci">static size_t secp256k1_strauss_scratch_size(size_t n_points)</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00350">ecmult_impl.h:350</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="scratch_8h.html#a7bafc5e853208fab3aeb50e8d70e4d07">secp256k1_scratch_max_allocation()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00350">secp256k1_strauss_scratch_size()</a>, and <a class="el" href="ecmult__impl_8h_source.html#l00050">STRAUSS_SCRATCH_OBJECTS</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00811">secp256k1_ecmult_multi_var()</a>.</p>

</div>
</div>
<a id="a7146d7f05cdd7440271523da3674004c" name="a7146d7f05cdd7440271523da3674004c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7146d7f05cdd7440271523da3674004c">&#9670;&nbsp;</a></span>secp256k1_strauss_scratch_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t secp256k1_strauss_scratch_size </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_points</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00350">350</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  350</span>                                                              {</div>
<div class="line"><span class="lineno">  351</span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> point_size = (<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structsecp256k1__ge.html">secp256k1_ge</a>) + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structsecp256k1__fe.html">secp256k1_fe</a>)) * <a class="code hl_define" href="ecmult_8h.html#a97c6c6e5aa98f202eec77c4c931e02f1">ECMULT_TABLE_SIZE</a>(<a class="code hl_define" href="ecmult__impl_8h.html#a6216c81c6adbb8796c55fe0c8d3b6718">WINDOW_A</a>) + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code hl_struct" href="structsecp256k1__strauss__point__state.html">secp256k1_strauss_point_state</a>) + sizeof(<a class="code hl_struct" href="structsecp256k1__gej.html">secp256k1_gej</a>) + sizeof(<a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a>);</div>
<div class="line"><span class="lineno">  352</span>    <span class="keywordflow">return</span> n_points*point_size;</div>
<div class="line"><span class="lineno">  353</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ecmult_8h_source.html#l00030">ECMULT_TABLE_SIZE</a>, and <a class="el" href="ecmult__impl_8h_source.html#l00032">WINDOW_A</a>.</p>

<p class="reference">Referenced by <a class="el" href="bench__ecmult_8c_source.html#l00281">main()</a>, <a class="el" href="tests_8c_source.html#l04453">run_ecmult_multi_tests()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00399">secp256k1_strauss_max_points()</a>, and <a class="el" href="tests_8c_source.html#l04386">test_ecmult_multi_batching()</a>.</p>

</div>
</div>
<a id="a346b925ab43432349898ad6a7ac9c31a" name="a346b925ab43432349898ad6a7ac9c31a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a346b925ab43432349898ad6a7ac9c31a">&#9670;&nbsp;</a></span>secp256k1_wnaf_fixed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int secp256k1_wnaf_fixed </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>wnaf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Convert a number to WNAF notation. The number becomes represented by sum(2^{wi} * wnaf[i], i=0..<a class="el" href="ecmult__impl_8h.html#a23d9fb349265ae338b9977f7f7aab065">WNAF_SIZE(w)</a>+1) - return_val. It has the following guarantees:</p><ul>
<li>each wnaf[i] is either 0 or an odd integer between -(1 &lt;&lt; w) and (1 &lt;&lt; w)</li>
<li>the number of words set is always <a class="el" href="ecmult__impl_8h.html#a23d9fb349265ae338b9977f7f7aab065">WNAF_SIZE(w)</a></li>
<li>the returned skew is 0 or 1 </li>
</ul>

<p class="definition">Definition at line <a class="el" href="ecmult__impl_8h_source.html#l00410">410</a> of file <a class="el" href="ecmult__impl_8h_source.html">ecmult_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  410</span>                                                                             {</div>
<div class="line"><span class="lineno">  411</span>    <span class="keywordtype">int</span> skew = 0;</div>
<div class="line"><span class="lineno">  412</span>    <span class="keywordtype">int</span> pos;</div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordtype">int</span> max_pos;</div>
<div class="line"><span class="lineno">  414</span>    <span class="keywordtype">int</span> last_w;</div>
<div class="line"><span class="lineno">  415</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structsecp256k1__scalar.html">secp256k1_scalar</a> *work = s;</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="scalar_8h.html#a3f0ac84fe49a1c1f51212582a2c149d4">secp256k1_scalar_is_zero</a>(s)) {</div>
<div class="line"><span class="lineno">  418</span>        <span class="keywordflow">for</span> (pos = 0; pos &lt; <a class="code hl_define" href="ecmult__impl_8h.html#a23d9fb349265ae338b9977f7f7aab065">WNAF_SIZE</a>(w); pos++) {</div>
<div class="line"><span class="lineno">  419</span>            wnaf[pos] = 0;</div>
<div class="line"><span class="lineno">  420</span>        }</div>
<div class="line"><span class="lineno">  421</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  422</span>    }</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="scalar_8h.html#a3eb65cf9bfad7c430cbb3dc26d494a95">secp256k1_scalar_is_even</a>(s)) {</div>
<div class="line"><span class="lineno">  425</span>        skew = 1;</div>
<div class="line"><span class="lineno">  426</span>    }</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>    wnaf[0] = <a class="code hl_function" href="scalar_8h.html#abede7dbe3b5a38a51b388d46f4c5b52d">secp256k1_scalar_get_bits_var</a>(work, 0, w) + skew;</div>
<div class="line"><span class="lineno">  429</span>    <span class="comment">/* Compute last window size. Relevant when window size doesn&#39;t divide the</span></div>
<div class="line"><span class="lineno">  430</span><span class="comment">     * number of bits in the scalar */</span></div>
<div class="line"><span class="lineno">  431</span>    last_w = <a class="code hl_define" href="ecmult__impl_8h.html#a7ca5efdae3396a6261bcc836e4a32739">WNAF_BITS</a> - (<a class="code hl_define" href="ecmult__impl_8h.html#a23d9fb349265ae338b9977f7f7aab065">WNAF_SIZE</a>(w) - 1) * w;</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>    <span class="comment">/* Store the position of the first nonzero word in max_pos to allow</span></div>
<div class="line"><span class="lineno">  434</span><span class="comment">     * skipping leading zeros when calculating the wnaf. */</span></div>
<div class="line"><span class="lineno">  435</span>    <span class="keywordflow">for</span> (pos = <a class="code hl_define" href="ecmult__impl_8h.html#a23d9fb349265ae338b9977f7f7aab065">WNAF_SIZE</a>(w) - 1; pos &gt; 0; pos--) {</div>
<div class="line"><span class="lineno">  436</span>        <span class="keywordtype">int</span> val = <a class="code hl_function" href="scalar_8h.html#abede7dbe3b5a38a51b388d46f4c5b52d">secp256k1_scalar_get_bits_var</a>(work, pos * w, pos == <a class="code hl_define" href="ecmult__impl_8h.html#a23d9fb349265ae338b9977f7f7aab065">WNAF_SIZE</a>(w)-1 ? last_w : w);</div>
<div class="line"><span class="lineno">  437</span>        <span class="keywordflow">if</span>(val != 0) {</div>
<div class="line"><span class="lineno">  438</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  439</span>        }</div>
<div class="line"><span class="lineno">  440</span>        wnaf[pos] = 0;</div>
<div class="line"><span class="lineno">  441</span>    }</div>
<div class="line"><span class="lineno">  442</span>    max_pos = pos;</div>
<div class="line"><span class="lineno">  443</span>    pos = 1;</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>    <span class="keywordflow">while</span> (pos &lt;= max_pos) {</div>
<div class="line"><span class="lineno">  446</span>        <span class="keywordtype">int</span> val = <a class="code hl_function" href="scalar_8h.html#abede7dbe3b5a38a51b388d46f4c5b52d">secp256k1_scalar_get_bits_var</a>(work, pos * w, pos == <a class="code hl_define" href="ecmult__impl_8h.html#a23d9fb349265ae338b9977f7f7aab065">WNAF_SIZE</a>(w)-1 ? last_w : w);</div>
<div class="line"><span class="lineno">  447</span>        <span class="keywordflow">if</span> ((val &amp; 1) == 0) {</div>
<div class="line"><span class="lineno">  448</span>            wnaf[pos - 1] -= (1 &lt;&lt; w);</div>
<div class="line"><span class="lineno">  449</span>            wnaf[pos] = (val + 1);</div>
<div class="line"><span class="lineno">  450</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  451</span>            wnaf[pos] = val;</div>
<div class="line"><span class="lineno">  452</span>        }</div>
<div class="line"><span class="lineno">  453</span>        <span class="comment">/* Set a coefficient to zero if it is 1 or -1 and the proceeding digit</span></div>
<div class="line"><span class="lineno">  454</span><span class="comment">         * is strictly negative or strictly positive respectively. Only change</span></div>
<div class="line"><span class="lineno">  455</span><span class="comment">         * coefficients at previous positions because above code assumes that</span></div>
<div class="line"><span class="lineno">  456</span><span class="comment">         * wnaf[pos - 1] is odd.</span></div>
<div class="line"><span class="lineno">  457</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">  458</span>        <span class="keywordflow">if</span> (pos &gt;= 2 &amp;&amp; ((wnaf[pos - 1] == 1 &amp;&amp; wnaf[pos - 2] &lt; 0) || (wnaf[pos - 1] == -1 &amp;&amp; wnaf[pos - 2] &gt; 0))) {</div>
<div class="line"><span class="lineno">  459</span>            <span class="keywordflow">if</span> (wnaf[pos - 1] == 1) {</div>
<div class="line"><span class="lineno">  460</span>                wnaf[pos - 2] += 1 &lt;&lt; w;</div>
<div class="line"><span class="lineno">  461</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  462</span>                wnaf[pos - 2] -= 1 &lt;&lt; w;</div>
<div class="line"><span class="lineno">  463</span>            }</div>
<div class="line"><span class="lineno">  464</span>            wnaf[pos - 1] = 0;</div>
<div class="line"><span class="lineno">  465</span>        }</div>
<div class="line"><span class="lineno">  466</span>        ++pos;</div>
<div class="line"><span class="lineno">  467</span>    }</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span>    <span class="keywordflow">return</span> skew;</div>
<div class="line"><span class="lineno">  470</span>}</div>
<div class="ttc" id="aecmult__impl_8h_html_a7ca5efdae3396a6261bcc836e4a32739"><div class="ttname"><a href="ecmult__impl_8h.html#a7ca5efdae3396a6261bcc836e4a32739">WNAF_BITS</a></div><div class="ttdeci">#define WNAF_BITS</div><div class="ttdef"><b>Definition:</b> <a href="ecmult__impl_8h_source.html#l00044">ecmult_impl.h:44</a></div></div>
<div class="ttc" id="ascalar_8h_html_a3eb65cf9bfad7c430cbb3dc26d494a95"><div class="ttname"><a href="scalar_8h.html#a3eb65cf9bfad7c430cbb3dc26d494a95">secp256k1_scalar_is_even</a></div><div class="ttdeci">static int secp256k1_scalar_is_even(const secp256k1_scalar *a)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="scalar_8h.html#abede7dbe3b5a38a51b388d46f4c5b52d">secp256k1_scalar_get_bits_var()</a>, <a class="el" href="scalar_8h.html#a3eb65cf9bfad7c430cbb3dc26d494a95">secp256k1_scalar_is_even()</a>, <a class="el" href="scalar_8h.html#a3f0ac84fe49a1c1f51212582a2c149d4">secp256k1_scalar_is_zero()</a>, <a class="el" href="ecmult__impl_8h_source.html#l00044">WNAF_BITS</a>, and <a class="el" href="ecmult__impl_8h_source.html#l00046">WNAF_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="ecmult__impl_8h_source.html#l00489">secp256k1_ecmult_pippenger_wnaf()</a>, <a class="el" href="tests_8c_source.html#l04569">test_fixed_wnaf()</a>, and <a class="el" href="tests_8c_source.html#l04616">test_fixed_wnaf_small()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
