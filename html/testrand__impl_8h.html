<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libdogecoin: src/secp256k1/src/testrand_impl.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libdogecoin
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_44f34d1e62fda08bdb4ca69ab2d205ae.html">secp256k1</a></li><li class="navelem"><a class="el" href="dir_8db2ef784512d48b2a7d00369dfaac28.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">testrand_impl.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="testrand_8h_source.html">testrand.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="src_2secp256k1_2src_2hash_8h_source.html">hash.h</a>&quot;</code><br />
</div>
<p><a href="testrand__impl_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a835ef8c228f215183caffe5fc419cea1"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="testrand__impl_8h.html#a835ef8c228f215183caffe5fc419cea1">secp256k1_testrand_seed</a> (const unsigned char *seed16)</td></tr>
<tr class="separator:a835ef8c228f215183caffe5fc419cea1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc76d9ba4177d706d636532c8a419685"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> <a class="el" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="testrand__impl_8h.html#adc76d9ba4177d706d636532c8a419685">rotl</a> (const <a class="el" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> x, int k)</td></tr>
<tr class="separator:adc76d9ba4177d706d636532c8a419685"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f891fccba27dc1f5b1e348ee18cf2ce"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> <a class="el" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="testrand__impl_8h.html#a5f891fccba27dc1f5b1e348ee18cf2ce">secp256k1_testrand64</a> (void)</td></tr>
<tr class="separator:a5f891fccba27dc1f5b1e348ee18cf2ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae71379297d0fa0c044644cadd367fa73"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> <a class="el" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="testrand__impl_8h.html#ae71379297d0fa0c044644cadd367fa73">secp256k1_testrand_bits</a> (int bits)</td></tr>
<tr class="separator:ae71379297d0fa0c044644cadd367fa73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaee4d7357bb39ca64772bc5461fee2aa"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> <a class="el" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="testrand__impl_8h.html#aaee4d7357bb39ca64772bc5461fee2aa">secp256k1_testrand32</a> (void)</td></tr>
<tr class="separator:aaee4d7357bb39ca64772bc5461fee2aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f55974d7daa58f497e0b9a8e1ce28f2"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="testrand__impl_8h.html#a0f55974d7daa58f497e0b9a8e1ce28f2">secp256k1_testrand_int</a> (<a class="el" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> range)</td></tr>
<tr class="separator:a0f55974d7daa58f497e0b9a8e1ce28f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a718f730e34f30097c7bbc6ba5fe81453"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="testrand__impl_8h.html#a718f730e34f30097c7bbc6ba5fe81453">secp256k1_testrand256</a> (unsigned char *b32)</td></tr>
<tr class="separator:a718f730e34f30097c7bbc6ba5fe81453"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d37d60a6e89bd90153dcae7a20b8449"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="testrand__impl_8h.html#a5d37d60a6e89bd90153dcae7a20b8449">secp256k1_testrand_bytes_test</a> (unsigned char *bytes, size_t len)</td></tr>
<tr class="separator:a5d37d60a6e89bd90153dcae7a20b8449"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0a3405e29f442821f30e42fb69158e0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="testrand__impl_8h.html#ae0a3405e29f442821f30e42fb69158e0">secp256k1_testrand256_test</a> (unsigned char *b32)</td></tr>
<tr class="separator:ae0a3405e29f442821f30e42fb69158e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e06bb022ee8d565423217d6e7d5ce02"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="testrand__impl_8h.html#a4e06bb022ee8d565423217d6e7d5ce02">secp256k1_testrand_flip</a> (unsigned char *b, size_t len)</td></tr>
<tr class="separator:a4e06bb022ee8d565423217d6e7d5ce02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b6a1f394bbf9cbbc506c48d7a3a40f0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="testrand__impl_8h.html#a8b6a1f394bbf9cbbc506c48d7a3a40f0">secp256k1_testrand_init</a> (const char *hexseed)</td></tr>
<tr class="separator:a8b6a1f394bbf9cbbc506c48d7a3a40f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae2b9ac86e6e781e3f9ad4b199f7fe5f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="testrand__impl_8h.html#aae2b9ac86e6e781e3f9ad4b199f7fe5f">secp256k1_testrand_finish</a> (void)</td></tr>
<tr class="separator:aae2b9ac86e6e781e3f9ad4b199f7fe5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a9eaa0389446c8eda584d5dac9dde09b0"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a> [4]</td></tr>
<tr class="separator:a9eaa0389446c8eda584d5dac9dde09b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addbcc9384fcfdbc8b20747c1d568faa0"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="testrand__impl_8h.html#addbcc9384fcfdbc8b20747c1d568faa0">secp256k1_test_rng_integer</a></td></tr>
<tr class="separator:addbcc9384fcfdbc8b20747c1d568faa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02d548f05b0fdc33cf1ad06856908fe2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="testrand__impl_8h.html#a02d548f05b0fdc33cf1ad06856908fe2">secp256k1_test_rng_integer_bits_left</a> = 0</td></tr>
<tr class="separator:a02d548f05b0fdc33cf1ad06856908fe2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="adc76d9ba4177d706d636532c8a419685" name="adc76d9ba4177d706d636532c8a419685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc76d9ba4177d706d636532c8a419685">&#9670;&nbsp;</a></span>rotl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> <a class="el" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> rotl </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testrand__impl_8h_source.html#l00041">41</a> of file <a class="el" href="testrand__impl_8h_source.html">testrand_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   41</span>                                                               {</div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordflow">return</span> (x &lt;&lt; k) | (x &gt;&gt; (64 - k));</div>
<div class="line"><span class="lineno">   43</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="testrand__impl_8h_source.html#l00045">secp256k1_testrand64()</a>.</p>

</div>
</div>
<a id="a718f730e34f30097c7bbc6ba5fe81453" name="a718f730e34f30097c7bbc6ba5fe81453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a718f730e34f30097c7bbc6ba5fe81453">&#9670;&nbsp;</a></span>secp256k1_testrand256()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void secp256k1_testrand256 </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>b32</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testrand__impl_8h_source.html#l00114">114</a> of file <a class="el" href="testrand__impl_8h_source.html">testrand_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  114</span>                                                      {</div>
<div class="line"><span class="lineno">  115</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">for</span> (i = 0; i &lt; 4; ++i) {</div>
<div class="line"><span class="lineno">  117</span>        <a class="code hl_typedef" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> val = <a class="code hl_function" href="testrand__impl_8h.html#a5f891fccba27dc1f5b1e348ee18cf2ce">secp256k1_testrand64</a>();</div>
<div class="line"><span class="lineno">  118</span>        b32[0] = val;</div>
<div class="line"><span class="lineno">  119</span>        b32[1] = val &gt;&gt; 8;</div>
<div class="line"><span class="lineno">  120</span>        b32[2] = val &gt;&gt; 16;</div>
<div class="line"><span class="lineno">  121</span>        b32[3] = val &gt;&gt; 24;</div>
<div class="line"><span class="lineno">  122</span>        b32[4] = val &gt;&gt; 32;</div>
<div class="line"><span class="lineno">  123</span>        b32[5] = val &gt;&gt; 40;</div>
<div class="line"><span class="lineno">  124</span>        b32[6] = val &gt;&gt; 48;</div>
<div class="line"><span class="lineno">  125</span>        b32[7] = val &gt;&gt; 56;</div>
<div class="line"><span class="lineno">  126</span>        b32 += 8;</div>
<div class="line"><span class="lineno">  127</span>    }</div>
<div class="line"><span class="lineno">  128</span>}</div>
<div class="ttc" id="atestrand__impl_8h_html_a5f891fccba27dc1f5b1e348ee18cf2ce"><div class="ttname"><a href="testrand__impl_8h.html#a5f891fccba27dc1f5b1e348ee18cf2ce">secp256k1_testrand64</a></div><div class="ttdeci">static SECP256K1_INLINE uint64_t secp256k1_testrand64(void)</div><div class="ttdef"><b>Definition:</b> <a href="testrand__impl_8h_source.html#l00045">testrand_impl.h:45</a></div></div>
<div class="ttc" id="awinunistd_8h_html_aec6fcb673ff035718c238c8c9d544c47"><div class="ttname"><a href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a></div><div class="ttdeci">unsigned __int64 uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="winunistd_8h_source.html#l00059">winunistd.h:59</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testrand__impl_8h_source.html#l00045">secp256k1_testrand64()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testrand__impl_8h_source.html#l00191">secp256k1_testrand_finish()</a>.</p>

</div>
</div>
<a id="ae0a3405e29f442821f30e42fb69158e0" name="ae0a3405e29f442821f30e42fb69158e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0a3405e29f442821f30e42fb69158e0">&#9670;&nbsp;</a></span>secp256k1_testrand256_test()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void secp256k1_testrand256_test </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>b32</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testrand__impl_8h_source.html#l00146">146</a> of file <a class="el" href="testrand__impl_8h_source.html">testrand_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  146</span>                                                           {</div>
<div class="line"><span class="lineno">  147</span>    <a class="code hl_function" href="testrand__impl_8h.html#a5d37d60a6e89bd90153dcae7a20b8449">secp256k1_testrand_bytes_test</a>(b32, 32);</div>
<div class="line"><span class="lineno">  148</span>}</div>
<div class="ttc" id="atestrand__impl_8h_html_a5d37d60a6e89bd90153dcae7a20b8449"><div class="ttname"><a href="testrand__impl_8h.html#a5d37d60a6e89bd90153dcae7a20b8449">secp256k1_testrand_bytes_test</a></div><div class="ttdeci">static void secp256k1_testrand_bytes_test(unsigned char *bytes, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="testrand__impl_8h_source.html#l00130">testrand_impl.h:130</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testrand__impl_8h_source.html#l00130">secp256k1_testrand_bytes_test()</a>.</p>

</div>
</div>
<a id="aaee4d7357bb39ca64772bc5461fee2aa" name="aaee4d7357bb39ca64772bc5461fee2aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaee4d7357bb39ca64772bc5461fee2aa">&#9670;&nbsp;</a></span>secp256k1_testrand32()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> <a class="el" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> secp256k1_testrand32 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testrand__impl_8h_source.html#l00071">71</a> of file <a class="el" href="testrand__impl_8h_source.html">testrand_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   71</span>                                                            {</div>
<div class="line"><span class="lineno">   72</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="testrand__impl_8h.html#ae71379297d0fa0c044644cadd367fa73">secp256k1_testrand_bits</a>(32);</div>
<div class="line"><span class="lineno">   73</span>}</div>
<div class="ttc" id="atestrand__impl_8h_html_ae71379297d0fa0c044644cadd367fa73"><div class="ttname"><a href="testrand__impl_8h.html#ae71379297d0fa0c044644cadd367fa73">secp256k1_testrand_bits</a></div><div class="ttdeci">static SECP256K1_INLINE uint64_t secp256k1_testrand_bits(int bits)</div><div class="ttdef"><b>Definition:</b> <a href="testrand__impl_8h_source.html#l00058">testrand_impl.h:58</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testrand__impl_8h_source.html#l00058">secp256k1_testrand_bits()</a>.</p>

</div>
</div>
<a id="a5f891fccba27dc1f5b1e348ee18cf2ce" name="a5f891fccba27dc1f5b1e348ee18cf2ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f891fccba27dc1f5b1e348ee18cf2ce">&#9670;&nbsp;</a></span>secp256k1_testrand64()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> <a class="el" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> secp256k1_testrand64 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testrand__impl_8h_source.html#l00045">45</a> of file <a class="el" href="testrand__impl_8h_source.html">testrand_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   45</span>                                                            {</div>
<div class="line"><span class="lineno">   46</span>    <span class="comment">/* Test-only Xoshiro256++ RNG. See https://prng.di.unimi.it/ */</span></div>
<div class="line"><span class="lineno">   47</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> result = <a class="code hl_function" href="testrand__impl_8h.html#adc76d9ba4177d706d636532c8a419685">rotl</a>(<a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[0] + <a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[3], 23) + <a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[0];</div>
<div class="line"><span class="lineno">   48</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> t = <a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[1] &lt;&lt; 17;</div>
<div class="line"><span class="lineno">   49</span>    <a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[2] ^= <a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[0];</div>
<div class="line"><span class="lineno">   50</span>    <a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[3] ^= <a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[1];</div>
<div class="line"><span class="lineno">   51</span>    <a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[1] ^= <a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[2];</div>
<div class="line"><span class="lineno">   52</span>    <a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[0] ^= <a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[3];</div>
<div class="line"><span class="lineno">   53</span>    <a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[2] ^= t;</div>
<div class="line"><span class="lineno">   54</span>    <a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[3] = <a class="code hl_function" href="testrand__impl_8h.html#adc76d9ba4177d706d636532c8a419685">rotl</a>(<a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[3], 45);</div>
<div class="line"><span class="lineno">   55</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">   56</span>}</div>
<div class="ttc" id="atestrand__impl_8h_html_a9eaa0389446c8eda584d5dac9dde09b0"><div class="ttname"><a href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a></div><div class="ttdeci">static uint64_t secp256k1_test_state[4]</div><div class="ttdef"><b>Definition:</b> <a href="testrand__impl_8h_source.html#l00017">testrand_impl.h:17</a></div></div>
<div class="ttc" id="atestrand__impl_8h_html_adc76d9ba4177d706d636532c8a419685"><div class="ttname"><a href="testrand__impl_8h.html#adc76d9ba4177d706d636532c8a419685">rotl</a></div><div class="ttdeci">static SECP256K1_INLINE uint64_t rotl(const uint64_t x, int k)</div><div class="ttdef"><b>Definition:</b> <a href="testrand__impl_8h_source.html#l00041">testrand_impl.h:41</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testrand__impl_8h_source.html#l00041">rotl()</a>, and <a class="el" href="testrand__impl_8h_source.html#l00017">secp256k1_test_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="testrand__impl_8h_source.html#l00114">secp256k1_testrand256()</a>, and <a class="el" href="testrand__impl_8h_source.html#l00058">secp256k1_testrand_bits()</a>.</p>

</div>
</div>
<a id="ae71379297d0fa0c044644cadd367fa73" name="ae71379297d0fa0c044644cadd367fa73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae71379297d0fa0c044644cadd367fa73">&#9670;&nbsp;</a></span>secp256k1_testrand_bits()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> <a class="el" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> secp256k1_testrand_bits </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bits</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testrand__impl_8h_source.html#l00058">58</a> of file <a class="el" href="testrand__impl_8h_source.html">testrand_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   58</span>                                                                   {</div>
<div class="line"><span class="lineno">   59</span>    <a class="code hl_typedef" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> ret;</div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="testrand__impl_8h.html#a02d548f05b0fdc33cf1ad06856908fe2">secp256k1_test_rng_integer_bits_left</a> &lt; bits) {</div>
<div class="line"><span class="lineno">   61</span>        <a class="code hl_variable" href="testrand__impl_8h.html#addbcc9384fcfdbc8b20747c1d568faa0">secp256k1_test_rng_integer</a> = <a class="code hl_function" href="testrand__impl_8h.html#a5f891fccba27dc1f5b1e348ee18cf2ce">secp256k1_testrand64</a>();</div>
<div class="line"><span class="lineno">   62</span>        <a class="code hl_variable" href="testrand__impl_8h.html#a02d548f05b0fdc33cf1ad06856908fe2">secp256k1_test_rng_integer_bits_left</a> = 64;</div>
<div class="line"><span class="lineno">   63</span>    }</div>
<div class="line"><span class="lineno">   64</span>    ret = <a class="code hl_variable" href="testrand__impl_8h.html#addbcc9384fcfdbc8b20747c1d568faa0">secp256k1_test_rng_integer</a>;</div>
<div class="line"><span class="lineno">   65</span>    <a class="code hl_variable" href="testrand__impl_8h.html#addbcc9384fcfdbc8b20747c1d568faa0">secp256k1_test_rng_integer</a> &gt;&gt;= bits;</div>
<div class="line"><span class="lineno">   66</span>    <a class="code hl_variable" href="testrand__impl_8h.html#a02d548f05b0fdc33cf1ad06856908fe2">secp256k1_test_rng_integer_bits_left</a> -= bits;</div>
<div class="line"><span class="lineno">   67</span>    ret &amp;= ((~((<a class="code hl_typedef" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>)0)) &gt;&gt; (64 - bits));</div>
<div class="line"><span class="lineno">   68</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">   69</span>}</div>
<div class="ttc" id="atestrand__impl_8h_html_a02d548f05b0fdc33cf1ad06856908fe2"><div class="ttname"><a href="testrand__impl_8h.html#a02d548f05b0fdc33cf1ad06856908fe2">secp256k1_test_rng_integer_bits_left</a></div><div class="ttdeci">static int secp256k1_test_rng_integer_bits_left</div><div class="ttdef"><b>Definition:</b> <a href="testrand__impl_8h_source.html#l00019">testrand_impl.h:19</a></div></div>
<div class="ttc" id="atestrand__impl_8h_html_addbcc9384fcfdbc8b20747c1d568faa0"><div class="ttname"><a href="testrand__impl_8h.html#addbcc9384fcfdbc8b20747c1d568faa0">secp256k1_test_rng_integer</a></div><div class="ttdeci">static uint64_t secp256k1_test_rng_integer</div><div class="ttdef"><b>Definition:</b> <a href="testrand__impl_8h_source.html#l00018">testrand_impl.h:18</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testrand__impl_8h_source.html#l00018">secp256k1_test_rng_integer</a>, <a class="el" href="testrand__impl_8h_source.html#l00019">secp256k1_test_rng_integer_bits_left</a>, and <a class="el" href="testrand__impl_8h_source.html#l00045">secp256k1_testrand64()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testrand__impl_8h_source.html#l00071">secp256k1_testrand32()</a>, <a class="el" href="testrand__impl_8h_source.html#l00130">secp256k1_testrand_bytes_test()</a>, <a class="el" href="testrand__impl_8h_source.html#l00150">secp256k1_testrand_flip()</a>, and <a class="el" href="testrand__impl_8h_source.html#l00075">secp256k1_testrand_int()</a>.</p>

</div>
</div>
<a id="a5d37d60a6e89bd90153dcae7a20b8449" name="a5d37d60a6e89bd90153dcae7a20b8449"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d37d60a6e89bd90153dcae7a20b8449">&#9670;&nbsp;</a></span>secp256k1_testrand_bytes_test()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void secp256k1_testrand_bytes_test </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testrand__impl_8h_source.html#l00130">130</a> of file <a class="el" href="testrand__impl_8h_source.html">testrand_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  130</span>                                                                            {</div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordtype">size_t</span> bits = 0;</div>
<div class="line"><span class="lineno">  132</span>    memset(bytes, 0, len);</div>
<div class="line"><span class="lineno">  133</span>    <span class="keywordflow">while</span> (bits &lt; len * 8) {</div>
<div class="line"><span class="lineno">  134</span>        <span class="keywordtype">int</span> now;</div>
<div class="line"><span class="lineno">  135</span>        <a class="code hl_typedef" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> val;</div>
<div class="line"><span class="lineno">  136</span>        now = 1 + (<a class="code hl_function" href="testrand__impl_8h.html#ae71379297d0fa0c044644cadd367fa73">secp256k1_testrand_bits</a>(6) * <a class="code hl_function" href="testrand__impl_8h.html#ae71379297d0fa0c044644cadd367fa73">secp256k1_testrand_bits</a>(5) + 16) / 31;</div>
<div class="line"><span class="lineno">  137</span>        val = <a class="code hl_function" href="testrand__impl_8h.html#ae71379297d0fa0c044644cadd367fa73">secp256k1_testrand_bits</a>(1);</div>
<div class="line"><span class="lineno">  138</span>        <span class="keywordflow">while</span> (now &gt; 0 &amp;&amp; bits &lt; len * 8) {</div>
<div class="line"><span class="lineno">  139</span>            bytes[bits / 8] |= val &lt;&lt; (bits % 8);</div>
<div class="line"><span class="lineno">  140</span>            now--;</div>
<div class="line"><span class="lineno">  141</span>            bits++;</div>
<div class="line"><span class="lineno">  142</span>        }</div>
<div class="line"><span class="lineno">  143</span>    }</div>
<div class="line"><span class="lineno">  144</span>}</div>
<div class="ttc" id="awinunistd_8h_html_a6eb1e68cc391dd753bc8ce896dbb8315"><div class="ttname"><a href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a></div><div class="ttdeci">unsigned __int32 uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="winunistd_8h_source.html#l00058">winunistd.h:58</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testrand__impl_8h_source.html#l00058">secp256k1_testrand_bits()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testrand__impl_8h_source.html#l00146">secp256k1_testrand256_test()</a>.</p>

</div>
</div>
<a id="aae2b9ac86e6e781e3f9ad4b199f7fe5f" name="aae2b9ac86e6e781e3f9ad4b199f7fe5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae2b9ac86e6e781e3f9ad4b199f7fe5f">&#9670;&nbsp;</a></span>secp256k1_testrand_finish()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void secp256k1_testrand_finish </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testrand__impl_8h_source.html#l00191">191</a> of file <a class="el" href="testrand__impl_8h_source.html">testrand_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  191</span>                                            {</div>
<div class="line"><span class="lineno">  192</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> run32[32];</div>
<div class="line"><span class="lineno">  193</span>    <a class="code hl_function" href="testrand__impl_8h.html#a718f730e34f30097c7bbc6ba5fe81453">secp256k1_testrand256</a>(run32);</div>
<div class="line"><span class="lineno">  194</span>    printf(<span class="stringliteral">&quot;random run = %02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x\n&quot;</span>, run32[0], run32[1], run32[2], run32[3], run32[4], run32[5], run32[6], run32[7], run32[8], run32[9], run32[10], run32[11], run32[12], run32[13], run32[14], run32[15]);</div>
<div class="line"><span class="lineno">  195</span>}</div>
<div class="ttc" id="atestrand__impl_8h_html_a718f730e34f30097c7bbc6ba5fe81453"><div class="ttname"><a href="testrand__impl_8h.html#a718f730e34f30097c7bbc6ba5fe81453">secp256k1_testrand256</a></div><div class="ttdeci">static void secp256k1_testrand256(unsigned char *b32)</div><div class="ttdef"><b>Definition:</b> <a href="testrand__impl_8h_source.html#l00114">testrand_impl.h:114</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testrand__impl_8h_source.html#l00114">secp256k1_testrand256()</a>.</p>

</div>
</div>
<a id="a4e06bb022ee8d565423217d6e7d5ce02" name="a4e06bb022ee8d565423217d6e7d5ce02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e06bb022ee8d565423217d6e7d5ce02">&#9670;&nbsp;</a></span>secp256k1_testrand_flip()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void secp256k1_testrand_flip </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testrand__impl_8h_source.html#l00150">150</a> of file <a class="el" href="testrand__impl_8h_source.html">testrand_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  150</span>                                                                  {</div>
<div class="line"><span class="lineno">  151</span>    b[<a class="code hl_function" href="testrand__impl_8h.html#a0f55974d7daa58f497e0b9a8e1ce28f2">secp256k1_testrand_int</a>(len)] ^= (1 &lt;&lt; <a class="code hl_function" href="testrand__impl_8h.html#ae71379297d0fa0c044644cadd367fa73">secp256k1_testrand_bits</a>(3));</div>
<div class="line"><span class="lineno">  152</span>}</div>
<div class="ttc" id="atestrand__impl_8h_html_a0f55974d7daa58f497e0b9a8e1ce28f2"><div class="ttname"><a href="testrand__impl_8h.html#a0f55974d7daa58f497e0b9a8e1ce28f2">secp256k1_testrand_int</a></div><div class="ttdeci">static uint32_t secp256k1_testrand_int(uint32_t range)</div><div class="ttdef"><b>Definition:</b> <a href="testrand__impl_8h_source.html#l00075">testrand_impl.h:75</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testrand__impl_8h_source.html#l00058">secp256k1_testrand_bits()</a>, and <a class="el" href="testrand__impl_8h_source.html#l00075">secp256k1_testrand_int()</a>.</p>

</div>
</div>
<a id="a8b6a1f394bbf9cbbc506c48d7a3a40f0" name="a8b6a1f394bbf9cbbc506c48d7a3a40f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b6a1f394bbf9cbbc506c48d7a3a40f0">&#9670;&nbsp;</a></span>secp256k1_testrand_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void secp256k1_testrand_init </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hexseed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testrand__impl_8h_source.html#l00154">154</a> of file <a class="el" href="testrand__impl_8h_source.html">testrand_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  154</span>                                                         {</div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> seed16[16] = {0};</div>
<div class="line"><span class="lineno">  156</span>    <span class="keywordflow">if</span> (hexseed &amp;&amp; strlen(hexseed) != 0) {</div>
<div class="line"><span class="lineno">  157</span>        <span class="keywordtype">int</span> pos = 0;</div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">while</span> (pos &lt; 16 &amp;&amp; hexseed[0] != 0 &amp;&amp; hexseed[1] != 0) {</div>
<div class="line"><span class="lineno">  159</span>            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> sh;</div>
<div class="line"><span class="lineno">  160</span>            <span class="keywordflow">if</span> ((sscanf(hexseed, <span class="stringliteral">&quot;%2hx&quot;</span>, &amp;sh)) == 1) {</div>
<div class="line"><span class="lineno">  161</span>                seed16[pos] = sh;</div>
<div class="line"><span class="lineno">  162</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  163</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  164</span>            }</div>
<div class="line"><span class="lineno">  165</span>            hexseed += 2;</div>
<div class="line"><span class="lineno">  166</span>            pos++;</div>
<div class="line"><span class="lineno">  167</span>        }</div>
<div class="line"><span class="lineno">  168</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  169</span>        FILE *frand = fopen(<span class="stringliteral">&quot;/dev/urandom&quot;</span>, <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">if</span> ((frand == NULL) || fread(&amp;seed16, 1, <span class="keyword">sizeof</span>(seed16), frand) != <span class="keyword">sizeof</span>(seed16)) {</div>
<div class="line"><span class="lineno">  171</span>            <a class="code hl_typedef" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> t = time(NULL) * (<a class="code hl_typedef" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a>)1337;</div>
<div class="line"><span class="lineno">  172</span>            fprintf(stderr, <span class="stringliteral">&quot;WARNING: could not read 16 bytes from /dev/urandom; falling back to insecure PRNG\n&quot;</span>);</div>
<div class="line"><span class="lineno">  173</span>            seed16[0] ^= t;</div>
<div class="line"><span class="lineno">  174</span>            seed16[1] ^= t &gt;&gt; 8;</div>
<div class="line"><span class="lineno">  175</span>            seed16[2] ^= t &gt;&gt; 16;</div>
<div class="line"><span class="lineno">  176</span>            seed16[3] ^= t &gt;&gt; 24;</div>
<div class="line"><span class="lineno">  177</span>            seed16[4] ^= t &gt;&gt; 32;</div>
<div class="line"><span class="lineno">  178</span>            seed16[5] ^= t &gt;&gt; 40;</div>
<div class="line"><span class="lineno">  179</span>            seed16[6] ^= t &gt;&gt; 48;</div>
<div class="line"><span class="lineno">  180</span>            seed16[7] ^= t &gt;&gt; 56;</div>
<div class="line"><span class="lineno">  181</span>        }</div>
<div class="line"><span class="lineno">  182</span>        <span class="keywordflow">if</span> (frand) {</div>
<div class="line"><span class="lineno">  183</span>            fclose(frand);</div>
<div class="line"><span class="lineno">  184</span>        }</div>
<div class="line"><span class="lineno">  185</span>    }</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>    printf(<span class="stringliteral">&quot;random seed = %02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x\n&quot;</span>, seed16[0], seed16[1], seed16[2], seed16[3], seed16[4], seed16[5], seed16[6], seed16[7], seed16[8], seed16[9], seed16[10], seed16[11], seed16[12], seed16[13], seed16[14], seed16[15]);</div>
<div class="line"><span class="lineno">  188</span>    <a class="code hl_function" href="testrand__impl_8h.html#a835ef8c228f215183caffe5fc419cea1">secp256k1_testrand_seed</a>(seed16);</div>
<div class="line"><span class="lineno">  189</span>}</div>
<div class="ttc" id="atestrand__impl_8h_html_a835ef8c228f215183caffe5fc419cea1"><div class="ttname"><a href="testrand__impl_8h.html#a835ef8c228f215183caffe5fc419cea1">secp256k1_testrand_seed</a></div><div class="ttdeci">static SECP256K1_INLINE void secp256k1_testrand_seed(const unsigned char *seed16)</div><div class="ttdef"><b>Definition:</b> <a href="testrand__impl_8h_source.html#l00021">testrand_impl.h:21</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testrand__impl_8h_source.html#l00021">secp256k1_testrand_seed()</a>.</p>

</div>
</div>
<a id="a0f55974d7daa58f497e0b9a8e1ce28f2" name="a0f55974d7daa58f497e0b9a8e1ce28f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f55974d7daa58f497e0b9a8e1ce28f2">&#9670;&nbsp;</a></span>secp256k1_testrand_int()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> secp256k1_testrand_int </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>&#160;</td>
          <td class="paramname"><em>range</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testrand__impl_8h_source.html#l00075">75</a> of file <a class="el" href="testrand__impl_8h_source.html">testrand_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   75</span>                                                       {</div>
<div class="line"><span class="lineno">   76</span>    <span class="comment">/* We want a uniform integer between 0 and range-1, inclusive.</span></div>
<div class="line"><span class="lineno">   77</span><span class="comment">     * B is the smallest number such that range &lt;= 2**B.</span></div>
<div class="line"><span class="lineno">   78</span><span class="comment">     * two mechanisms implemented here:</span></div>
<div class="line"><span class="lineno">   79</span><span class="comment">     * - generate B bits numbers until one below range is found, and return it</span></div>
<div class="line"><span class="lineno">   80</span><span class="comment">     * - find the largest multiple M of range that is &lt;= 2**(B+A), generate B+A</span></div>
<div class="line"><span class="lineno">   81</span><span class="comment">     *   bits numbers until one below M is found, and return it modulo range</span></div>
<div class="line"><span class="lineno">   82</span><span class="comment">     * The second mechanism consumes A more bits of entropy in every iteration,</span></div>
<div class="line"><span class="lineno">   83</span><span class="comment">     * but may need fewer iterations due to M being closer to 2**(B+A) then</span></div>
<div class="line"><span class="lineno">   84</span><span class="comment">     * range is to 2**B. The array below (indexed by B) contains a 0 when the</span></div>
<div class="line"><span class="lineno">   85</span><span class="comment">     * first mechanism is to be used, and the number A otherwise.</span></div>
<div class="line"><span class="lineno">   86</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">   87</span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> addbits[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 1, 0};</div>
<div class="line"><span class="lineno">   88</span>    <a class="code hl_typedef" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> trange, mult;</div>
<div class="line"><span class="lineno">   89</span>    <span class="keywordtype">int</span> bits = 0;</div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordflow">if</span> (range &lt;= 1) {</div>
<div class="line"><span class="lineno">   91</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   92</span>    }</div>
<div class="line"><span class="lineno">   93</span>    trange = range - 1;</div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">while</span> (trange &gt; 0) {</div>
<div class="line"><span class="lineno">   95</span>        trange &gt;&gt;= 1;</div>
<div class="line"><span class="lineno">   96</span>        bits++;</div>
<div class="line"><span class="lineno">   97</span>    }</div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordflow">if</span> (addbits[bits]) {</div>
<div class="line"><span class="lineno">   99</span>        bits = bits + addbits[bits];</div>
<div class="line"><span class="lineno">  100</span>        mult = ((~((<a class="code hl_typedef" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>)0)) &gt;&gt; (32 - bits)) / range;</div>
<div class="line"><span class="lineno">  101</span>        trange = range * mult;</div>
<div class="line"><span class="lineno">  102</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  103</span>        trange = range;</div>
<div class="line"><span class="lineno">  104</span>        mult = 1;</div>
<div class="line"><span class="lineno">  105</span>    }</div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">while</span>(1) {</div>
<div class="line"><span class="lineno">  107</span>        <a class="code hl_typedef" href="winunistd_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a> x = <a class="code hl_function" href="testrand__impl_8h.html#ae71379297d0fa0c044644cadd367fa73">secp256k1_testrand_bits</a>(bits);</div>
<div class="line"><span class="lineno">  108</span>        <span class="keywordflow">if</span> (x &lt; trange) {</div>
<div class="line"><span class="lineno">  109</span>            <span class="keywordflow">return</span> (mult == 1) ? x : (x % range);</div>
<div class="line"><span class="lineno">  110</span>        }</div>
<div class="line"><span class="lineno">  111</span>    }</div>
<div class="line"><span class="lineno">  112</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testrand__impl_8h_source.html#l00058">secp256k1_testrand_bits()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testrand__impl_8h_source.html#l00150">secp256k1_testrand_flip()</a>.</p>

</div>
</div>
<a id="a835ef8c228f215183caffe5fc419cea1" name="a835ef8c228f215183caffe5fc419cea1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a835ef8c228f215183caffe5fc419cea1">&#9670;&nbsp;</a></span>secp256k1_testrand_seed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="secp256k1_8h.html#a7ddc487fd46aee88f21cabedb7268b1e">SECP256K1_INLINE</a> void secp256k1_testrand_seed </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>seed16</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testrand__impl_8h_source.html#l00021">21</a> of file <a class="el" href="testrand__impl_8h_source.html">testrand_impl.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   21</span>                                                                                  {</div>
<div class="line"><span class="lineno">   22</span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> PREFIX[19] = <span class="stringliteral">&quot;secp256k1 test init&quot;</span>;</div>
<div class="line"><span class="lineno">   23</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> out32[32];</div>
<div class="line"><span class="lineno">   24</span>    <a class="code hl_struct" href="structsecp256k1__sha256.html">secp256k1_sha256</a> hash;</div>
<div class="line"><span class="lineno">   25</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">   26</span> </div>
<div class="line"><span class="lineno">   27</span>    <span class="comment">/* Use SHA256(PREFIX || seed16) as initial state. */</span></div>
<div class="line"><span class="lineno">   28</span>    <a class="code hl_function" href="src_2secp256k1_2src_2hash_8h.html#a1959aeb6a33d7ecc544fb3e9264f4fa6">secp256k1_sha256_initialize</a>(&amp;hash);</div>
<div class="line"><span class="lineno">   29</span>    <a class="code hl_function" href="src_2secp256k1_2src_2hash_8h.html#ac280de2696890f5fc17f94da1a50ec2d">secp256k1_sha256_write</a>(&amp;hash, PREFIX, <span class="keyword">sizeof</span>(PREFIX));</div>
<div class="line"><span class="lineno">   30</span>    <a class="code hl_function" href="src_2secp256k1_2src_2hash_8h.html#ac280de2696890f5fc17f94da1a50ec2d">secp256k1_sha256_write</a>(&amp;hash, seed16, 16);</div>
<div class="line"><span class="lineno">   31</span>    <a class="code hl_function" href="src_2secp256k1_2src_2hash_8h.html#a6f603c9ce5d0d94de8578a70b0236a9e">secp256k1_sha256_finalize</a>(&amp;hash, out32);</div>
<div class="line"><span class="lineno">   32</span>    <span class="keywordflow">for</span> (i = 0; i &lt; 4; ++i) {</div>
<div class="line"><span class="lineno">   33</span>        <a class="code hl_typedef" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> s = 0;</div>
<div class="line"><span class="lineno">   34</span>        <span class="keywordtype">int</span> j;</div>
<div class="line"><span class="lineno">   35</span>        <span class="keywordflow">for</span> (j = 0; j &lt; 8; ++j) s = (s &lt;&lt; 8) | out32[8*i + j];</div>
<div class="line"><span class="lineno">   36</span>        <a class="code hl_variable" href="testrand__impl_8h.html#a9eaa0389446c8eda584d5dac9dde09b0">secp256k1_test_state</a>[i] = s;</div>
<div class="line"><span class="lineno">   37</span>    }</div>
<div class="line"><span class="lineno">   38</span>    <a class="code hl_variable" href="testrand__impl_8h.html#a02d548f05b0fdc33cf1ad06856908fe2">secp256k1_test_rng_integer_bits_left</a> = 0;</div>
<div class="line"><span class="lineno">   39</span>}</div>
<div class="ttc" id="asrc_2secp256k1_2src_2hash_8h_html_a1959aeb6a33d7ecc544fb3e9264f4fa6"><div class="ttname"><a href="src_2secp256k1_2src_2hash_8h.html#a1959aeb6a33d7ecc544fb3e9264f4fa6">secp256k1_sha256_initialize</a></div><div class="ttdeci">static void secp256k1_sha256_initialize(secp256k1_sha256 *hash)</div></div>
<div class="ttc" id="asrc_2secp256k1_2src_2hash_8h_html_a6f603c9ce5d0d94de8578a70b0236a9e"><div class="ttname"><a href="src_2secp256k1_2src_2hash_8h.html#a6f603c9ce5d0d94de8578a70b0236a9e">secp256k1_sha256_finalize</a></div><div class="ttdeci">static void secp256k1_sha256_finalize(secp256k1_sha256 *hash, unsigned char *out32)</div></div>
<div class="ttc" id="asrc_2secp256k1_2src_2hash_8h_html_ac280de2696890f5fc17f94da1a50ec2d"><div class="ttname"><a href="src_2secp256k1_2src_2hash_8h.html#ac280de2696890f5fc17f94da1a50ec2d">secp256k1_sha256_write</a></div><div class="ttdeci">static void secp256k1_sha256_write(secp256k1_sha256 *hash, const unsigned char *data, size_t size)</div></div>
<div class="ttc" id="astructsecp256k1__sha256_html"><div class="ttname"><a href="structsecp256k1__sha256.html">secp256k1_sha256</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2secp256k1_2src_2hash_8h_source.html#l00013">hash.h:13</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="src_2secp256k1_2src_2hash_8h.html#a6f603c9ce5d0d94de8578a70b0236a9e">secp256k1_sha256_finalize()</a>, <a class="el" href="src_2secp256k1_2src_2hash_8h.html#a1959aeb6a33d7ecc544fb3e9264f4fa6">secp256k1_sha256_initialize()</a>, <a class="el" href="src_2secp256k1_2src_2hash_8h.html#ac280de2696890f5fc17f94da1a50ec2d">secp256k1_sha256_write()</a>, <a class="el" href="testrand__impl_8h_source.html#l00019">secp256k1_test_rng_integer_bits_left</a>, and <a class="el" href="testrand__impl_8h_source.html#l00017">secp256k1_test_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="testrand__impl_8h_source.html#l00154">secp256k1_testrand_init()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="addbcc9384fcfdbc8b20747c1d568faa0" name="addbcc9384fcfdbc8b20747c1d568faa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addbcc9384fcfdbc8b20747c1d568faa0">&#9670;&nbsp;</a></span>secp256k1_test_rng_integer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> secp256k1_test_rng_integer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testrand__impl_8h_source.html#l00018">18</a> of file <a class="el" href="testrand__impl_8h_source.html">testrand_impl.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="testrand__impl_8h_source.html#l00058">secp256k1_testrand_bits()</a>.</p>

</div>
</div>
<a id="a02d548f05b0fdc33cf1ad06856908fe2" name="a02d548f05b0fdc33cf1ad06856908fe2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02d548f05b0fdc33cf1ad06856908fe2">&#9670;&nbsp;</a></span>secp256k1_test_rng_integer_bits_left</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int secp256k1_test_rng_integer_bits_left = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testrand__impl_8h_source.html#l00019">19</a> of file <a class="el" href="testrand__impl_8h_source.html">testrand_impl.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="testrand__impl_8h_source.html#l00058">secp256k1_testrand_bits()</a>, and <a class="el" href="testrand__impl_8h_source.html#l00021">secp256k1_testrand_seed()</a>.</p>

</div>
</div>
<a id="a9eaa0389446c8eda584d5dac9dde09b0" name="a9eaa0389446c8eda584d5dac9dde09b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9eaa0389446c8eda584d5dac9dde09b0">&#9670;&nbsp;</a></span>secp256k1_test_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="winunistd_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> secp256k1_test_state[4]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testrand__impl_8h_source.html#l00017">17</a> of file <a class="el" href="testrand__impl_8h_source.html">testrand_impl.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="testrand__impl_8h_source.html#l00045">secp256k1_testrand64()</a>, and <a class="el" href="testrand__impl_8h_source.html#l00021">secp256k1_testrand_seed()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
