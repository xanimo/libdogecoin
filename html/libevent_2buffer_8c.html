<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libdogecoin: src/libevent/buffer.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libdogecoin
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_97979c17d049e8002d2e089c4964ead4.html">libevent</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">buffer.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;event2/event-config.h&quot;</code><br />
<code>#include &quot;evconfig-private.h&quot;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;limits.h&gt;</code><br />
<code>#include &quot;event2/event.h&quot;</code><br />
<code>#include &quot;event2/buffer.h&quot;</code><br />
<code>#include &quot;event2/buffer_compat.h&quot;</code><br />
<code>#include &quot;event2/bufferevent.h&quot;</code><br />
<code>#include &quot;event2/bufferevent_compat.h&quot;</code><br />
<code>#include &quot;event2/bufferevent_struct.h&quot;</code><br />
<code>#include &quot;event2/thread.h&quot;</code><br />
<code>#include &quot;<a class="el" href="log-internal_8h_source.html">log-internal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mm-internal_8h_source.html">mm-internal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-internal_8h_source.html">util-internal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="evthread-internal_8h_source.html">evthread-internal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="evbuffer-internal_8h_source.html">evbuffer-internal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="bufferevent-internal_8h_source.html">bufferevent-internal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="event-internal_8h_source.html">event-internal.h</a>&quot;</code><br />
</div>
<p><a href="libevent_2buffer_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a8523dcf952f6ff059a3bed717e4f1296"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a8523dcf952f6ff059a3bed717e4f1296">MAP_FAILED</a>&#160;&#160;&#160;((void *)-1)</td></tr>
<tr class="separator:a8523dcf952f6ff059a3bed717e4f1296"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ac58b211f7dbca3d3d265ceeea5e84c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a5ac58b211f7dbca3d3d265ceeea5e84c">EVBUFFER_CB_USER_FLAGS</a>&#160;&#160;&#160;0xffff</td></tr>
<tr class="separator:a5ac58b211f7dbca3d3d265ceeea5e84c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8785f45e257923c1355076285681760"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ad8785f45e257923c1355076285681760">EVBUFFER_CB_INTERNAL_FLAGS</a>&#160;&#160;&#160;0xffff0000</td></tr>
<tr class="separator:ad8785f45e257923c1355076285681760"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01e8c8d803941dfdaae3c2308603437c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a01e8c8d803941dfdaae3c2308603437c">EVBUFFER_CB_OBSOLETE</a>&#160;&#160;&#160;0x00040000</td></tr>
<tr class="separator:a01e8c8d803941dfdaae3c2308603437c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17846db51ec6b10c559ec8af1b30e379"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a17846db51ec6b10c559ec8af1b30e379">CHAIN_SPACE_PTR</a>(ch)&#160;&#160;&#160;((ch)-&gt;<a class="el" href="structbuffer.html">buffer</a> + (ch)-&gt;misalign + (ch)-&gt;off)</td></tr>
<tr class="separator:a17846db51ec6b10c559ec8af1b30e379"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1381150c8f2120296bd2726cf00f3284"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(ch)</td></tr>
<tr class="separator:a1381150c8f2120296bd2726cf00f3284"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c587915f15eb124dc0c69d768093319"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a6c587915f15eb124dc0c69d768093319">CHAIN_PINNED</a>(ch)&#160;&#160;&#160;(((ch)-&gt;flags &amp; <a class="el" href="evbuffer-internal_8h.html#a2ddf04d9ba9e2d6f56c67250acdf6e8e">EVBUFFER_MEM_PINNED_ANY</a>) != 0)</td></tr>
<tr class="separator:a6c587915f15eb124dc0c69d768093319"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae415a92292709e1ae7eac7ebcebce494"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ae415a92292709e1ae7eac7ebcebce494">CHAIN_PINNED_R</a>(ch)&#160;&#160;&#160;(((ch)-&gt;flags &amp; <a class="el" href="evbuffer-internal_8h.html#a07f97541f1b57f6ab70af2c555749161">EVBUFFER_MEM_PINNED_R</a>) != 0)</td></tr>
<tr class="separator:ae415a92292709e1ae7eac7ebcebce494"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85a672d3751a1c49b2374d439cc7bf55"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a85a672d3751a1c49b2374d439cc7bf55">PTR_NOT_FOUND</a>(ptr)</td></tr>
<tr class="separator:a85a672d3751a1c49b2374d439cc7bf55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29a60cb0a04a05e4e0b3e88ddd312c79"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a29a60cb0a04a05e4e0b3e88ddd312c79">CHUNK_SZ</a>&#160;&#160;&#160;128</td></tr>
<tr class="separator:a29a60cb0a04a05e4e0b3e88ddd312c79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d41c8b45ee1b03021a2bafa1935f2d4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a2d41c8b45ee1b03021a2bafa1935f2d4">EVBUFFER_CHAIN_MAX_AUTO_SIZE</a>&#160;&#160;&#160;4096</td></tr>
<tr class="separator:a2d41c8b45ee1b03021a2bafa1935f2d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a390a7600d2b1cf434e95976de7176593"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a390a7600d2b1cf434e95976de7176593">MAX_TO_COPY_IN_EXPAND</a>&#160;&#160;&#160;4096</td></tr>
<tr class="separator:a390a7600d2b1cf434e95976de7176593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec949b6b2128a73deab65d152d378167"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#aec949b6b2128a73deab65d152d378167">MAX_TO_REALIGN_IN_EXPAND</a>&#160;&#160;&#160;2048</td></tr>
<tr class="separator:aec949b6b2128a73deab65d152d378167"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d7d34f52e59cad4a53c7afb41b3ce1b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a8d7d34f52e59cad4a53c7afb41b3ce1b">NUM_READ_IOVEC</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a8d7d34f52e59cad4a53c7afb41b3ce1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af22cda87cfe7fa6b9a07c4c645bcb754"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#af22cda87cfe7fa6b9a07c4c645bcb754">EVBUFFER_MAX_READ</a>&#160;&#160;&#160;4096</td></tr>
<tr class="separator:af22cda87cfe7fa6b9a07c4c645bcb754"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad36243a66d6b30f74fd72dd0f78d7264"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ad36243a66d6b30f74fd72dd0f78d7264">va_copy</a>(dst,  src)&#160;&#160;&#160;memcpy(&amp;(dst), &amp;(src), sizeof(va_list))</td></tr>
<tr class="separator:ad36243a66d6b30f74fd72dd0f78d7264"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af9aadddcff964430df6ae27bb8c03fa9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#af9aadddcff964430df6ae27bb8c03fa9">evbuffer_chain_align</a> (struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *chain)</td></tr>
<tr class="separator:af9aadddcff964430df6ae27bb8c03fa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf7d52654d190f4a196f0e2e58ff0bb1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#abf7d52654d190f4a196f0e2e58ff0bb1">evbuffer_chain_should_realign</a> (struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *chain, size_t datalen)</td></tr>
<tr class="separator:abf7d52654d190f4a196f0e2e58ff0bb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69bf3e1c3d322c805036c31cf2b81e41"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a69bf3e1c3d322c805036c31cf2b81e41">evbuffer_deferred_callback</a> (struct event_callback *cb, void *arg)</td></tr>
<tr class="separator:a69bf3e1c3d322c805036c31cf2b81e41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31a6529210bd5b3285d926cc9f8f304b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a31a6529210bd5b3285d926cc9f8f304b">evbuffer_ptr_memcmp</a> (const struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, const struct evbuffer_ptr *pos, const char *mem, size_t len)</td></tr>
<tr class="separator:a31a6529210bd5b3285d926cc9f8f304b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af29382773b8c1cbe484de86282e6fb87"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#af29382773b8c1cbe484de86282e6fb87">evbuffer_expand_singlechain</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, size_t datlen)</td></tr>
<tr class="separator:af29382773b8c1cbe484de86282e6fb87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a773c9681d248f1a77895f70f4fb34c0e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a773c9681d248f1a77895f70f4fb34c0e">evbuffer_ptr_subtract</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, struct evbuffer_ptr *pos, size_t howfar)</td></tr>
<tr class="separator:a773c9681d248f1a77895f70f4fb34c0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc653891dd5d75823201026646b53c20"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#afc653891dd5d75823201026646b53c20">evbuffer_file_segment_materialize</a> (struct <a class="el" href="structevbuffer__file__segment.html">evbuffer_file_segment</a> *seg)</td></tr>
<tr class="separator:afc653891dd5d75823201026646b53c20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f7dba1c74e9de8db292c2308e70b462"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a8f7dba1c74e9de8db292c2308e70b462">evbuffer_chain_incref</a> (struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *chain)</td></tr>
<tr class="separator:a8f7dba1c74e9de8db292c2308e70b462"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8a73fb51f7ddbe1641be56eaa45a00f"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a> (size_t size)</td></tr>
<tr class="separator:ab8a73fb51f7ddbe1641be56eaa45a00f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7acdd31f1b39fc7c74f58103b23b6b0a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a7acdd31f1b39fc7c74f58103b23b6b0a">evbuffer_chain_free</a> (struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *chain)</td></tr>
<tr class="separator:a7acdd31f1b39fc7c74f58103b23b6b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a853df8a453a607c6dfe27b18f7cda889"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a853df8a453a607c6dfe27b18f7cda889">evbuffer_free_all_chains</a> (struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *chain)</td></tr>
<tr class="separator:a853df8a453a607c6dfe27b18f7cda889"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10fa650c0b0174af23a89cd44527b126"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a10fa650c0b0174af23a89cd44527b126">evbuffer_chains_all_empty</a> (struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *chain)</td></tr>
<tr class="separator:a10fa650c0b0174af23a89cd44527b126"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0b9aab1a4a4fb3d9e446b03d1ad2743"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#aa0b9aab1a4a4fb3d9e446b03d1ad2743">evbuffer_free_trailing_empty_chains</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf)</td></tr>
<tr class="separator:aa0b9aab1a4a4fb3d9e446b03d1ad2743"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb1ffdb88a9aa9e2b114d98832dfda16"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#abb1ffdb88a9aa9e2b114d98832dfda16">evbuffer_chain_insert</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *chain)</td></tr>
<tr class="separator:abb1ffdb88a9aa9e2b114d98832dfda16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a186d6472c870a6eeeba14c90aa13ed75"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a186d6472c870a6eeeba14c90aa13ed75">evbuffer_chain_insert_new</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, size_t datlen)</td></tr>
<tr class="separator:a186d6472c870a6eeeba14c90aa13ed75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe0cf08c219c3f30a28929846277b90b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#afe0cf08c219c3f30a28929846277b90b">evbuffer_chain_pin_</a> (struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *chain, unsigned flag)</td></tr>
<tr class="separator:afe0cf08c219c3f30a28929846277b90b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac949f855421b4afd676f3293b4d8706e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ac949f855421b4afd676f3293b4d8706e">evbuffer_chain_unpin_</a> (struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *chain, unsigned flag)</td></tr>
<tr class="separator:ac949f855421b4afd676f3293b4d8706e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a968e69551bc692f3383d1874a70bc867"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a968e69551bc692f3383d1874a70bc867">evbuffer_new</a> (void)</td></tr>
<tr class="separator:a968e69551bc692f3383d1874a70bc867"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7ca62b72232b4029288e4c3a06f1c6c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ae7ca62b72232b4029288e4c3a06f1c6c">evbuffer_set_flags</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, ev_uint64_t flags)</td></tr>
<tr class="separator:ae7ca62b72232b4029288e4c3a06f1c6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a732701957705ae6abe7c28effeb4aa39"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a732701957705ae6abe7c28effeb4aa39">evbuffer_clear_flags</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, ev_uint64_t flags)</td></tr>
<tr class="separator:a732701957705ae6abe7c28effeb4aa39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28d71fa071cae93e6b7a64314283e921"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a28d71fa071cae93e6b7a64314283e921">evbuffer_incref_</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf)</td></tr>
<tr class="separator:a28d71fa071cae93e6b7a64314283e921"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae58a14e3a6a2bc7e1ffc02b71d78daec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ae58a14e3a6a2bc7e1ffc02b71d78daec">evbuffer_incref_and_lock_</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf)</td></tr>
<tr class="separator:ae58a14e3a6a2bc7e1ffc02b71d78daec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c99c484430a81e641a783a273435074"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a1c99c484430a81e641a783a273435074">evbuffer_defer_callbacks</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, struct <a class="el" href="structevent__base.html">event_base</a> *base)</td></tr>
<tr class="separator:a1c99c484430a81e641a783a273435074"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bf21d715f288541eb670c5f159f2264"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a1bf21d715f288541eb670c5f159f2264">evbuffer_enable_locking</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, void *lock)</td></tr>
<tr class="separator:a1bf21d715f288541eb670c5f159f2264"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dbc008d184dacd1d3d97ed9fabad435"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a2dbc008d184dacd1d3d97ed9fabad435">evbuffer_set_parent_</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, struct bufferevent *bev)</td></tr>
<tr class="separator:a2dbc008d184dacd1d3d97ed9fabad435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9498833b7740ef5ea694a18ad9bf4c07"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a9498833b7740ef5ea694a18ad9bf4c07">evbuffer_run_callbacks</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, int running_deferred)</td></tr>
<tr class="separator:a9498833b7740ef5ea694a18ad9bf4c07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19e27adc7ac1c3b2c8303586c39e912e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>)</td></tr>
<tr class="separator:a19e27adc7ac1c3b2c8303586c39e912e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8baa73c3690e47a1e2b5af4e069c3f68"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a8baa73c3690e47a1e2b5af4e069c3f68">evbuffer_remove_all_callbacks</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>)</td></tr>
<tr class="separator:a8baa73c3690e47a1e2b5af4e069c3f68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ac07b1be4b6fe0b2aa6a1677b060a80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a3ac07b1be4b6fe0b2aa6a1677b060a80">evbuffer_decref_and_unlock_</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>)</td></tr>
<tr class="separator:a3ac07b1be4b6fe0b2aa6a1677b060a80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab27f081c089aebd2536296c13d53f735"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ab27f081c089aebd2536296c13d53f735">evbuffer_free</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>)</td></tr>
<tr class="separator:ab27f081c089aebd2536296c13d53f735"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9542ca1ac381708c9b1450d91d168ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#af9542ca1ac381708c9b1450d91d168ec">evbuffer_lock</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf)</td></tr>
<tr class="separator:af9542ca1ac381708c9b1450d91d168ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a538b62549df58369e10fd5703cafe92b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a538b62549df58369e10fd5703cafe92b">evbuffer_unlock</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf)</td></tr>
<tr class="separator:a538b62549df58369e10fd5703cafe92b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c1b3464e6a40ab2ae6398d214779a93"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a1c1b3464e6a40ab2ae6398d214779a93">evbuffer_get_length</a> (const struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>)</td></tr>
<tr class="separator:a1c1b3464e6a40ab2ae6398d214779a93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd3d8507991609637a501e835e450331"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#acd3d8507991609637a501e835e450331">evbuffer_get_contiguous_space</a> (const struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf)</td></tr>
<tr class="separator:acd3d8507991609637a501e835e450331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7d5b8ba706e3cc164987617c655fae8"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ab7d5b8ba706e3cc164987617c655fae8">evbuffer_add_iovec</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, struct evbuffer_iovec *vec, int n_vec)</td></tr>
<tr class="separator:ab7d5b8ba706e3cc164987617c655fae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7de48b30ac1112dd7d421fa23ddf529"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ae7de48b30ac1112dd7d421fa23ddf529">evbuffer_reserve_space</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, ev_ssize_t size, struct evbuffer_iovec *vec, int n_vecs)</td></tr>
<tr class="separator:ae7de48b30ac1112dd7d421fa23ddf529"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77d24636f0fc7b5e7de020ad37633aad"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a77d24636f0fc7b5e7de020ad37633aad">advance_last_with_data</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf)</td></tr>
<tr class="separator:a77d24636f0fc7b5e7de020ad37633aad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a13a10fd1eb75cccf0ca29a05c5ba8a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a7a13a10fd1eb75cccf0ca29a05c5ba8a">evbuffer_commit_space</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, struct evbuffer_iovec *vec, int n_vecs)</td></tr>
<tr class="separator:a7a13a10fd1eb75cccf0ca29a05c5ba8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1791544d9552594ef60983b83b13f3a8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a1791544d9552594ef60983b83b13f3a8">HAS_PINNED_R</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf)</td></tr>
<tr class="separator:a1791544d9552594ef60983b83b13f3a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11161d984ed671f309bb410de5acff51"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a11161d984ed671f309bb410de5acff51">ZERO_CHAIN</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *dst)</td></tr>
<tr class="separator:a11161d984ed671f309bb410de5acff51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac60199252b9aeb1951f7928fb8fcf489"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ac60199252b9aeb1951f7928fb8fcf489">PRESERVE_PINNED</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *src, struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> **first, struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> **last)</td></tr>
<tr class="separator:ac60199252b9aeb1951f7928fb8fcf489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e2fe7a3afa03f1b336cc62ef0317bbc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a1e2fe7a3afa03f1b336cc62ef0317bbc">RESTORE_PINNED</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *src, struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *pinned, struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *last)</td></tr>
<tr class="separator:a1e2fe7a3afa03f1b336cc62ef0317bbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10fda8507ae305fc30d946d344cc7abb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a10fda8507ae305fc30d946d344cc7abb">COPY_CHAIN</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *dst, struct <a class="el" href="structevbuffer.html">evbuffer</a> *src)</td></tr>
<tr class="separator:a10fda8507ae305fc30d946d344cc7abb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1713518c73318a1df1b514547b97263"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#aa1713518c73318a1df1b514547b97263">APPEND_CHAIN</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *dst, struct <a class="el" href="structevbuffer.html">evbuffer</a> *src)</td></tr>
<tr class="separator:aa1713518c73318a1df1b514547b97263"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a237f9efdb8c464740ca8f628167d4bcd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a237f9efdb8c464740ca8f628167d4bcd">APPEND_CHAIN_MULTICAST</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *dst, struct <a class="el" href="structevbuffer.html">evbuffer</a> *src)</td></tr>
<tr class="separator:a237f9efdb8c464740ca8f628167d4bcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a130b2fd82cc34ea9a10afb27cf160f6a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a130b2fd82cc34ea9a10afb27cf160f6a">PREPEND_CHAIN</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *dst, struct <a class="el" href="structevbuffer.html">evbuffer</a> *src)</td></tr>
<tr class="separator:a130b2fd82cc34ea9a10afb27cf160f6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d2edd536246d70c50678a3865305414"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a9d2edd536246d70c50678a3865305414">evbuffer_add_buffer</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *outbuf, struct <a class="el" href="structevbuffer.html">evbuffer</a> *inbuf)</td></tr>
<tr class="separator:a9d2edd536246d70c50678a3865305414"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aa7eddbf98d5a4acf023afe38792fcc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a1aa7eddbf98d5a4acf023afe38792fcc">evbuffer_add_buffer_reference</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *outbuf, struct <a class="el" href="structevbuffer.html">evbuffer</a> *inbuf)</td></tr>
<tr class="separator:a1aa7eddbf98d5a4acf023afe38792fcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d10d5d94c31c2f081bcc7068992d3f3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a4d10d5d94c31c2f081bcc7068992d3f3">evbuffer_prepend_buffer</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *outbuf, struct <a class="el" href="structevbuffer.html">evbuffer</a> *inbuf)</td></tr>
<tr class="separator:a4d10d5d94c31c2f081bcc7068992d3f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c24f3bfbc941d693bf59b5d77d2c37f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a5c24f3bfbc941d693bf59b5d77d2c37f">evbuffer_drain</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, size_t len)</td></tr>
<tr class="separator:a5c24f3bfbc941d693bf59b5d77d2c37f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5a341004cb2b4fb591fe11544b3228d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#af5a341004cb2b4fb591fe11544b3228d">evbuffer_remove</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, void *data_out, size_t datlen)</td></tr>
<tr class="separator:af5a341004cb2b4fb591fe11544b3228d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fa753475570f6529691ef8484cacc1b"><td class="memItemLeft" align="right" valign="top">ev_ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a8fa753475570f6529691ef8484cacc1b">evbuffer_copyout</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, void *data_out, size_t datlen)</td></tr>
<tr class="separator:a8fa753475570f6529691ef8484cacc1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac88bba444ce768f5e3e4cf38e48381ab"><td class="memItemLeft" align="right" valign="top">ev_ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ac88bba444ce768f5e3e4cf38e48381ab">evbuffer_copyout_from</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, const struct evbuffer_ptr *pos, void *data_out, size_t datlen)</td></tr>
<tr class="separator:ac88bba444ce768f5e3e4cf38e48381ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bdef97f6a142425b271b329a90de869"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a0bdef97f6a142425b271b329a90de869">evbuffer_remove_buffer</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *src, struct <a class="el" href="structevbuffer.html">evbuffer</a> *dst, size_t datlen)</td></tr>
<tr class="separator:a0bdef97f6a142425b271b329a90de869"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a832cd3d902a61b8ed503c1b1ae804058"><td class="memItemLeft" align="right" valign="top">unsigned char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a832cd3d902a61b8ed503c1b1ae804058">evbuffer_pullup</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, ev_ssize_t size)</td></tr>
<tr class="separator:a832cd3d902a61b8ed503c1b1ae804058"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8608c1eb1f6e86a006f1e9fcfb9f31d"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ae8608c1eb1f6e86a006f1e9fcfb9f31d">evbuffer_readline</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>)</td></tr>
<tr class="separator:ae8608c1eb1f6e86a006f1e9fcfb9f31d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bbd0d5c6cb68c7e17471acedb254ff3"><td class="memItemLeft" align="right" valign="top">static ev_ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a7bbd0d5c6cb68c7e17471acedb254ff3">evbuffer_strchr</a> (struct evbuffer_ptr *it, const char chr)</td></tr>
<tr class="separator:a7bbd0d5c6cb68c7e17471acedb254ff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73da90a05a87e6f5e0df8a2a3f253e71"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a73da90a05a87e6f5e0df8a2a3f253e71">find_eol_char</a> (char *s, size_t len)</td></tr>
<tr class="separator:a73da90a05a87e6f5e0df8a2a3f253e71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dfe0e3fa9c89d6ef86d46f91bec1407"><td class="memItemLeft" align="right" valign="top">static ev_ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a6dfe0e3fa9c89d6ef86d46f91bec1407">evbuffer_find_eol_char</a> (struct evbuffer_ptr *it)</td></tr>
<tr class="separator:a6dfe0e3fa9c89d6ef86d46f91bec1407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec4e48cd2e9b7feaa8d928f1d29b4599"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#aec4e48cd2e9b7feaa8d928f1d29b4599">evbuffer_strspn</a> (struct evbuffer_ptr *ptr, const char *chrset)</td></tr>
<tr class="separator:aec4e48cd2e9b7feaa8d928f1d29b4599"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5777ea043f5871f05333dfb95360c306"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a5777ea043f5871f05333dfb95360c306">evbuffer_getchr</a> (struct evbuffer_ptr *it)</td></tr>
<tr class="separator:a5777ea043f5871f05333dfb95360c306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa54aca588fa272157513191a9628d457"><td class="memItemLeft" align="right" valign="top">struct evbuffer_ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#aa54aca588fa272157513191a9628d457">evbuffer_search_eol</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, struct evbuffer_ptr *start, size_t *eol_len_out, enum evbuffer_eol_style eol_style)</td></tr>
<tr class="separator:aa54aca588fa272157513191a9628d457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a145454dc7f26b678aa6b724aaf8742e7"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a145454dc7f26b678aa6b724aaf8742e7">evbuffer_readln</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, size_t *n_read_out, enum evbuffer_eol_style eol_style)</td></tr>
<tr class="separator:a145454dc7f26b678aa6b724aaf8742e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bcbab1212ab067b8faa767febc347ef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a8bcbab1212ab067b8faa767febc347ef">evbuffer_add</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, const void *data_in, size_t datlen)</td></tr>
<tr class="separator:a8bcbab1212ab067b8faa767febc347ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f0516632bac58c07e081f8fcb794530"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a0f0516632bac58c07e081f8fcb794530">evbuffer_prepend</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, const void *data, size_t datlen)</td></tr>
<tr class="separator:a0f0516632bac58c07e081f8fcb794530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0169295592d02008ef6229de9ba8a79b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a0169295592d02008ef6229de9ba8a79b">evbuffer_expand_fast_</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, size_t datlen, int n)</td></tr>
<tr class="separator:a0169295592d02008ef6229de9ba8a79b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a305caf7b9bfb8713e6ef383d61791f95"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a305caf7b9bfb8713e6ef383d61791f95">evbuffer_expand</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, size_t datlen)</td></tr>
<tr class="separator:a305caf7b9bfb8713e6ef383d61791f95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c28b535591bbd5a33a3e5e00ba9b1c7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a2c28b535591bbd5a33a3e5e00ba9b1c7">evbuffer_read_setup_vecs_</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, ev_ssize_t howmuch, struct evbuffer_iovec *vecs, int n_vecs_avail, struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> ***chainp, int exact)</td></tr>
<tr class="separator:a2c28b535591bbd5a33a3e5e00ba9b1c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa62a364d82e2d2146c09541026650104"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#aa62a364d82e2d2146c09541026650104">get_n_bytes_readable_on_socket</a> (evutil_socket_t fd)</td></tr>
<tr class="separator:aa62a364d82e2d2146c09541026650104"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e067ea6a72b62bd075571b421ac7e04"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a4e067ea6a72b62bd075571b421ac7e04">evbuffer_read</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, evutil_socket_t fd, int howmuch)</td></tr>
<tr class="separator:a4e067ea6a72b62bd075571b421ac7e04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0bea512e82177762be7cf0a28a9b03b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#aa0bea512e82177762be7cf0a28a9b03b">evbuffer_write_atmost</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, evutil_socket_t fd, ev_ssize_t howmuch)</td></tr>
<tr class="separator:aa0bea512e82177762be7cf0a28a9b03b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1207167bb14d5333326225f41477e910"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a1207167bb14d5333326225f41477e910">evbuffer_write</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, evutil_socket_t fd)</td></tr>
<tr class="separator:a1207167bb14d5333326225f41477e910"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca6902f271f4bf046f07292154b64639"><td class="memItemLeft" align="right" valign="top">unsigned char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#aca6902f271f4bf046f07292154b64639">evbuffer_find</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, const unsigned char *what, size_t len)</td></tr>
<tr class="separator:aca6902f271f4bf046f07292154b64639"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6caaf43634822bb6940d96045ff4266"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ab6caaf43634822bb6940d96045ff4266">evbuffer_ptr_set</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, struct evbuffer_ptr *pos, size_t position, enum evbuffer_ptr_how how)</td></tr>
<tr class="separator:ab6caaf43634822bb6940d96045ff4266"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61e15e2a355409587464c476d2481105"><td class="memItemLeft" align="right" valign="top">struct evbuffer_ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a61e15e2a355409587464c476d2481105">evbuffer_search</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, const char *what, size_t len, const struct evbuffer_ptr *start)</td></tr>
<tr class="separator:a61e15e2a355409587464c476d2481105"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a532ded8162d838b306e18839e9ab04af"><td class="memItemLeft" align="right" valign="top">struct evbuffer_ptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a532ded8162d838b306e18839e9ab04af">evbuffer_search_range</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, const char *what, size_t len, const struct evbuffer_ptr *start, const struct evbuffer_ptr *end)</td></tr>
<tr class="separator:a532ded8162d838b306e18839e9ab04af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a280bc4f4750607f02cad494c45bc5769"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a280bc4f4750607f02cad494c45bc5769">evbuffer_peek</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, ev_ssize_t len, struct evbuffer_ptr *start_at, struct evbuffer_iovec *vec, int n_vec)</td></tr>
<tr class="separator:a280bc4f4750607f02cad494c45bc5769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc385568d5129d4af10486b641b98f81"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#acc385568d5129d4af10486b641b98f81">evbuffer_add_vprintf</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, const char *fmt, va_list ap)</td></tr>
<tr class="separator:acc385568d5129d4af10486b641b98f81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeb9457f344ddaf459726dbe348ac3db"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#adeb9457f344ddaf459726dbe348ac3db">evbuffer_add_printf</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, const char *fmt,...)</td></tr>
<tr class="separator:adeb9457f344ddaf459726dbe348ac3db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a310e8dcd2651ae5ff84690485837aa3d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a310e8dcd2651ae5ff84690485837aa3d">evbuffer_add_reference</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *outbuf, const void *data, size_t datlen, evbuffer_ref_cleanup_cb cleanupfn, void *extra)</td></tr>
<tr class="separator:a310e8dcd2651ae5ff84690485837aa3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cce429d8eb7100a190e7dc820243c92"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structevbuffer__file__segment.html">evbuffer_file_segment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a1cce429d8eb7100a190e7dc820243c92">evbuffer_file_segment_new</a> (int fd, ev_off_t offset, ev_off_t length, unsigned flags)</td></tr>
<tr class="separator:a1cce429d8eb7100a190e7dc820243c92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1f242cbd02068bdccddfff86916934f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#af1f242cbd02068bdccddfff86916934f">evbuffer_file_segment_add_cleanup_cb</a> (struct <a class="el" href="structevbuffer__file__segment.html">evbuffer_file_segment</a> *seg, evbuffer_file_segment_cleanup_cb cb, void *arg)</td></tr>
<tr class="separator:af1f242cbd02068bdccddfff86916934f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac3d2c0437effd46a755f131fe9239d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#aac3d2c0437effd46a755f131fe9239d2">evbuffer_file_segment_free</a> (struct <a class="el" href="structevbuffer__file__segment.html">evbuffer_file_segment</a> *seg)</td></tr>
<tr class="separator:aac3d2c0437effd46a755f131fe9239d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fe992b94b160431e7c1bbd039653e78"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a9fe992b94b160431e7c1bbd039653e78">evbuffer_add_file_segment</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, struct <a class="el" href="structevbuffer__file__segment.html">evbuffer_file_segment</a> *seg, ev_off_t offset, ev_off_t length)</td></tr>
<tr class="separator:a9fe992b94b160431e7c1bbd039653e78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabbab9806ece6c2a7fa34dceda3bd775"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#aabbab9806ece6c2a7fa34dceda3bd775">evbuffer_add_file</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *buf, int fd, ev_off_t offset, ev_off_t length)</td></tr>
<tr class="separator:aabbab9806ece6c2a7fa34dceda3bd775"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeadc5a2edfe385d9fa182c659d7d9b37"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#aeadc5a2edfe385d9fa182c659d7d9b37">evbuffer_setcb</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, evbuffer_cb cb, void *cbarg)</td></tr>
<tr class="separator:aeadc5a2edfe385d9fa182c659d7d9b37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f74a931a40fed1f64496cce05e4f140"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structevbuffer__cb__entry.html">evbuffer_cb_entry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a7f74a931a40fed1f64496cce05e4f140">evbuffer_add_cb</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, evbuffer_cb_func cb, void *cbarg)</td></tr>
<tr class="separator:a7f74a931a40fed1f64496cce05e4f140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd1e51be92170b17178949a639dfa8ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#afd1e51be92170b17178949a639dfa8ab">evbuffer_remove_cb_entry</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, struct <a class="el" href="structevbuffer__cb__entry.html">evbuffer_cb_entry</a> *ent)</td></tr>
<tr class="separator:afd1e51be92170b17178949a639dfa8ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d7c75045267863306d37043d3f0809a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a4d7c75045267863306d37043d3f0809a">evbuffer_remove_cb</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, evbuffer_cb_func cb, void *cbarg)</td></tr>
<tr class="separator:a4d7c75045267863306d37043d3f0809a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ba44d01484f19fbfe7c18d2a175dc3b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a4ba44d01484f19fbfe7c18d2a175dc3b">evbuffer_cb_set_flags</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, struct <a class="el" href="structevbuffer__cb__entry.html">evbuffer_cb_entry</a> *cb, ev_uint32_t flags)</td></tr>
<tr class="separator:a4ba44d01484f19fbfe7c18d2a175dc3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acda56baecd4b512f4e9f54a21e39177f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#acda56baecd4b512f4e9f54a21e39177f">evbuffer_cb_clear_flags</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, struct <a class="el" href="structevbuffer__cb__entry.html">evbuffer_cb_entry</a> *cb, ev_uint32_t flags)</td></tr>
<tr class="separator:acda56baecd4b512f4e9f54a21e39177f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab20a3648e696af4de0f4f183eaf190f4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ab20a3648e696af4de0f4f183eaf190f4">evbuffer_freeze</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, int start)</td></tr>
<tr class="separator:ab20a3648e696af4de0f4f183eaf190f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1aa94b12221a02fcacc2f5dbf0f28b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#ae1aa94b12221a02fcacc2f5dbf0f28b5">evbuffer_unfreeze</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, int start)</td></tr>
<tr class="separator:ae1aa94b12221a02fcacc2f5dbf0f28b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44fba9707bdfca27ce64ab9b3af5bbf8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libevent_2buffer_8c.html#a44fba9707bdfca27ce64ab9b3af5bbf8">evbuffer_get_callbacks_</a> (struct <a class="el" href="structevbuffer.html">evbuffer</a> *<a class="el" href="structbuffer.html">buffer</a>, struct event_callback **cbs, int max_cbs)</td></tr>
<tr class="separator:a44fba9707bdfca27ce64ab9b3af5bbf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a6c587915f15eb124dc0c69d768093319" name="a6c587915f15eb124dc0c69d768093319"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c587915f15eb124dc0c69d768093319">&#9670;&nbsp;</a></span>CHAIN_PINNED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHAIN_PINNED</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ch</td><td>)</td>
          <td>&#160;&#160;&#160;(((ch)-&gt;flags &amp; <a class="el" href="evbuffer-internal_8h.html#a2ddf04d9ba9e2d6f56c67250acdf6e8e">EVBUFFER_MEM_PINNED_ANY</a>) != 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00133">133</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>

</div>
</div>
<a id="ae415a92292709e1ae7eac7ebcebce494" name="ae415a92292709e1ae7eac7ebcebce494"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae415a92292709e1ae7eac7ebcebce494">&#9670;&nbsp;</a></span>CHAIN_PINNED_R</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHAIN_PINNED_R</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ch</td><td>)</td>
          <td>&#160;&#160;&#160;(((ch)-&gt;flags &amp; <a class="el" href="evbuffer-internal_8h.html#a07f97541f1b57f6ab70af2c555749161">EVBUFFER_MEM_PINNED_R</a>) != 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00134">134</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>

</div>
</div>
<a id="a1381150c8f2120296bd2726cf00f3284" name="a1381150c8f2120296bd2726cf00f3284"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1381150c8f2120296bd2726cf00f3284">&#9670;&nbsp;</a></span>CHAIN_SPACE_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHAIN_SPACE_LEN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ch</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        ((ch)-&gt;flags &amp; <a class="code hl_define" href="evbuffer-internal_8h.html#a93af71b521a359f90fce52d1cf9f49c5">EVBUFFER_IMMUTABLE</a> ? \</div>
<div class="line">        0 : (ch)-&gt;buffer_len - ((ch)-&gt;misalign + (ch)-&gt;off))</div>
<div class="ttc" id="aevbuffer-internal_8h_html_a93af71b521a359f90fce52d1cf9f49c5"><div class="ttname"><a href="evbuffer-internal_8h.html#a93af71b521a359f90fce52d1cf9f49c5">EVBUFFER_IMMUTABLE</a></div><div class="ttdeci">#define EVBUFFER_IMMUTABLE</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00192">evbuffer-internal.h:192</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00130">130</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>

</div>
</div>
<a id="a17846db51ec6b10c559ec8af1b30e379" name="a17846db51ec6b10c559ec8af1b30e379"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17846db51ec6b10c559ec8af1b30e379">&#9670;&nbsp;</a></span>CHAIN_SPACE_PTR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHAIN_SPACE_PTR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ch</td><td>)</td>
          <td>&#160;&#160;&#160;((ch)-&gt;<a class="el" href="structbuffer.html">buffer</a> + (ch)-&gt;misalign + (ch)-&gt;off)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00129">129</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>

</div>
</div>
<a id="a29a60cb0a04a05e4e0b3e88ddd312c79" name="a29a60cb0a04a05e4e0b3e88ddd312c79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29a60cb0a04a05e4e0b3e88ddd312c79">&#9670;&nbsp;</a></span>CHUNK_SZ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHUNK_SZ&#160;&#160;&#160;128</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad8785f45e257923c1355076285681760" name="ad8785f45e257923c1355076285681760"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8785f45e257923c1355076285681760">&#9670;&nbsp;</a></span>EVBUFFER_CB_INTERNAL_FLAGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EVBUFFER_CB_INTERNAL_FLAGS&#160;&#160;&#160;0xffff0000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00123">123</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>

</div>
</div>
<a id="a01e8c8d803941dfdaae3c2308603437c" name="a01e8c8d803941dfdaae3c2308603437c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01e8c8d803941dfdaae3c2308603437c">&#9670;&nbsp;</a></span>EVBUFFER_CB_OBSOLETE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EVBUFFER_CB_OBSOLETE&#160;&#160;&#160;0x00040000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00126">126</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>

</div>
</div>
<a id="a5ac58b211f7dbca3d3d265ceeea5e84c" name="a5ac58b211f7dbca3d3d265ceeea5e84c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ac58b211f7dbca3d3d265ceeea5e84c">&#9670;&nbsp;</a></span>EVBUFFER_CB_USER_FLAGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EVBUFFER_CB_USER_FLAGS&#160;&#160;&#160;0xffff</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00121">121</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>

</div>
</div>
<a id="a2d41c8b45ee1b03021a2bafa1935f2d4" name="a2d41c8b45ee1b03021a2bafa1935f2d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d41c8b45ee1b03021a2bafa1935f2d4">&#9670;&nbsp;</a></span>EVBUFFER_CHAIN_MAX_AUTO_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EVBUFFER_CHAIN_MAX_AUTO_SIZE&#160;&#160;&#160;4096</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01725">1725</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>

</div>
</div>
<a id="af22cda87cfe7fa6b9a07c4c645bcb754" name="af22cda87cfe7fa6b9a07c4c645bcb754"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af22cda87cfe7fa6b9a07c4c645bcb754">&#9670;&nbsp;</a></span>EVBUFFER_MAX_READ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EVBUFFER_MAX_READ&#160;&#160;&#160;4096</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02209">2209</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>

</div>
</div>
<a id="a8523dcf952f6ff059a3bed717e4f1296" name="a8523dcf952f6ff059a3bed717e4f1296"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8523dcf952f6ff059a3bed717e4f1296">&#9670;&nbsp;</a></span>MAP_FAILED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAP_FAILED&#160;&#160;&#160;((void *)-1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00102">102</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>

</div>
</div>
<a id="a390a7600d2b1cf434e95976de7176593" name="a390a7600d2b1cf434e95976de7176593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a390a7600d2b1cf434e95976de7176593">&#9670;&nbsp;</a></span>MAX_TO_COPY_IN_EXPAND</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_TO_COPY_IN_EXPAND&#160;&#160;&#160;4096</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01922">1922</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>

</div>
</div>
<a id="aec949b6b2128a73deab65d152d378167" name="aec949b6b2128a73deab65d152d378167"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec949b6b2128a73deab65d152d378167">&#9670;&nbsp;</a></span>MAX_TO_REALIGN_IN_EXPAND</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_TO_REALIGN_IN_EXPAND&#160;&#160;&#160;2048</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01923">1923</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>

</div>
</div>
<a id="a8d7d34f52e59cad4a53c7afb41b3ce1b" name="a8d7d34f52e59cad4a53c7afb41b3ce1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d7d34f52e59cad4a53c7afb41b3ce1b">&#9670;&nbsp;</a></span>NUM_READ_IOVEC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_READ_IOVEC&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02207">2207</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>

</div>
</div>
<a id="a85a672d3751a1c49b2374d439cc7bf55" name="a85a672d3751a1c49b2374d439cc7bf55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85a672d3751a1c49b2374d439cc7bf55">&#9670;&nbsp;</a></span>PTR_NOT_FOUND</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PTR_NOT_FOUND</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptr</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <span class="keywordflow">do</span> {            \</div>
<div class="line">    (ptr)-&gt;pos = -1;                    \</div>
<div class="line">    (ptr)-&gt;internal_.chain = NULL;      \</div>
<div class="line">    (ptr)-&gt;internal_.pos_in_chain = 0;  \</div>
<div class="line">} <span class="keywordflow">while</span> (0)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00137">137</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>

</div>
</div>
<a id="ad36243a66d6b30f74fd72dd0f78d7264" name="ad36243a66d6b30f74fd72dd0f78d7264"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad36243a66d6b30f74fd72dd0f78d7264">&#9670;&nbsp;</a></span>va_copy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define va_copy</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dst, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">src&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;memcpy(&amp;(dst), &amp;(src), sizeof(va_list))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a77d24636f0fc7b5e7de020ad37633aad" name="a77d24636f0fc7b5e7de020ad37633aad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77d24636f0fc7b5e7de020ad37633aad">&#9670;&nbsp;</a></span>advance_last_with_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int advance_last_with_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00704">704</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  705</span>{</div>
<div class="line"><span class="lineno">  706</span>    <span class="keywordtype">int</span> n = 0;</div>
<div class="line"><span class="lineno">  707</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> **chainp = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>;</div>
<div class="line"><span class="lineno">  708</span> </div>
<div class="line"><span class="lineno">  709</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(buf);</div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span>    <span class="keywordflow">if</span> (!*chainp)</div>
<div class="line"><span class="lineno">  712</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  713</span> </div>
<div class="line"><span class="lineno">  714</span>    <span class="keywordflow">while</span> ((*chainp)-&gt;next) {</div>
<div class="line"><span class="lineno">  715</span>        chainp = &amp;(*chainp)-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno">  716</span>        <span class="keywordflow">if</span> ((*chainp)-&gt;off)</div>
<div class="line"><span class="lineno">  717</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = chainp;</div>
<div class="line"><span class="lineno">  718</span>        ++n;</div>
<div class="line"><span class="lineno">  719</span>    }</div>
<div class="line"><span class="lineno">  720</span>    <span class="keywordflow">return</span> n;</div>
<div class="line"><span class="lineno">  721</span>}</div>
<div class="ttc" id="aevbuffer-internal_8h_html_abfee4993b153dd7fe271db7669e6d647"><div class="ttname"><a href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a></div><div class="ttdeci">#define ASSERT_EVBUFFER_LOCKED(buffer)</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00282">evbuffer-internal.h:282</a></div></div>
<div class="ttc" id="astructevbuffer__chain_html"><div class="ttname"><a href="structevbuffer__chain.html">evbuffer_chain</a></div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00171">evbuffer-internal.h:171</a></div></div>
<div class="ttc" id="astructevbuffer__chain_html_a302eea17a6aacc55c33f119ad788ddb5"><div class="ttname"><a href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">evbuffer_chain::next</a></div><div class="ttdeci">struct evbuffer_chain * next</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00173">evbuffer-internal.h:173</a></div></div>
<div class="ttc" id="astructevbuffer_html_aa89b72c7086750d7b6c91902e2f1bf21"><div class="ttname"><a href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">evbuffer::last_with_datap</a></div><div class="ttdeci">struct evbuffer_chain ** last_with_datap</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00099">evbuffer-internal.h:99</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00282">ASSERT_EVBUFFER_LOCKED</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l02844">evbuffer_add_vprintf()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00724">evbuffer_commit_space()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02284">evbuffer_read()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l01260">evbuffer_remove_buffer()</a>.</p>

</div>
</div>
<a id="aa1713518c73318a1df1b514547b97263" name="aa1713518c73318a1df1b514547b97263"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1713518c73318a1df1b514547b97263">&#9670;&nbsp;</a></span>APPEND_CHAIN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void APPEND_CHAIN </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00889">889</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  890</span>{</div>
<div class="line"><span class="lineno">  891</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> **chp;</div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(dst);</div>
<div class="line"><span class="lineno">  894</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(src);</div>
<div class="line"><span class="lineno">  895</span> </div>
<div class="line"><span class="lineno">  896</span>    chp = <a class="code hl_function" href="libevent_2buffer_8c.html#aa0b9aab1a4a4fb3d9e446b03d1ad2743">evbuffer_free_trailing_empty_chains</a>(dst);</div>
<div class="line"><span class="lineno">  897</span>    *chp = src-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno">  898</span> </div>
<div class="line"><span class="lineno">  899</span>    <span class="keywordflow">if</span> (src-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> == &amp;src-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>)</div>
<div class="line"><span class="lineno">  900</span>        dst-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = chp;</div>
<div class="line"><span class="lineno">  901</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  902</span>        dst-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = src-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>;</div>
<div class="line"><span class="lineno">  903</span>    dst-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> = src-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a>;</div>
<div class="line"><span class="lineno">  904</span>    dst-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> += src-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>;</div>
<div class="line"><span class="lineno">  905</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_aa0b9aab1a4a4fb3d9e446b03d1ad2743"><div class="ttname"><a href="libevent_2buffer_8c.html#aa0b9aab1a4a4fb3d9e446b03d1ad2743">evbuffer_free_trailing_empty_chains</a></div><div class="ttdeci">static struct evbuffer_chain ** evbuffer_free_trailing_empty_chains(struct evbuffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00291">buffer.c:291</a></div></div>
<div class="ttc" id="astructevbuffer_html_a590cd5dc76dfecc57b45262d65fa1106"><div class="ttname"><a href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">evbuffer::first</a></div><div class="ttdeci">struct evbuffer_chain * first</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00082">evbuffer-internal.h:82</a></div></div>
<div class="ttc" id="astructevbuffer_html_aada4ae960b5f60ac937cd8488dafc849"><div class="ttname"><a href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">evbuffer::last</a></div><div class="ttdeci">struct evbuffer_chain * last</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00084">evbuffer-internal.h:84</a></div></div>
<div class="ttc" id="astructevbuffer_html_af432b67ab2e1b3dd8b96e314a0785116"><div class="ttname"><a href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">evbuffer::total_len</a></div><div class="ttdeci">size_t total_len</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00102">evbuffer-internal.h:102</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00282">ASSERT_EVBUFFER_LOCKED</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00291">evbuffer_free_trailing_empty_chains()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00084">evbuffer::last</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00966">evbuffer_add_buffer()</a>.</p>

</div>
</div>
<a id="a237f9efdb8c464740ca8f628167d4bcd" name="a237f9efdb8c464740ca8f628167d4bcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a237f9efdb8c464740ca8f628167d4bcd">&#9670;&nbsp;</a></span>APPEND_CHAIN_MULTICAST()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void APPEND_CHAIN_MULTICAST </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00908">908</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  909</span>{</div>
<div class="line"><span class="lineno">  910</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *tmp;</div>
<div class="line"><span class="lineno">  911</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain = src-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno">  912</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__multicast__parent.html">evbuffer_multicast_parent</a> *extra;</div>
<div class="line"><span class="lineno">  913</span> </div>
<div class="line"><span class="lineno">  914</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(dst);</div>
<div class="line"><span class="lineno">  915</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(src);</div>
<div class="line"><span class="lineno">  916</span> </div>
<div class="line"><span class="lineno">  917</span>    <span class="keywordflow">for</span> (; chain; chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>) {</div>
<div class="line"><span class="lineno">  918</span>        <span class="keywordflow">if</span> (!chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> || chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp; <a class="code hl_define" href="evbuffer-internal_8h.html#ab79fb1d80416f15da34e29d7acd3da00">EVBUFFER_DANGLING</a>) {</div>
<div class="line"><span class="lineno">  919</span>            <span class="comment">/* skip empty chains */</span></div>
<div class="line"><span class="lineno">  920</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  921</span>        }</div>
<div class="line"><span class="lineno">  922</span> </div>
<div class="line"><span class="lineno">  923</span>        tmp = <a class="code hl_function" href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="structevbuffer__multicast__parent.html">evbuffer_multicast_parent</a>));</div>
<div class="line"><span class="lineno">  924</span>        <span class="keywordflow">if</span> (!tmp) {</div>
<div class="line"><span class="lineno">  925</span>            <a class="code hl_function" href="log-internal_8h.html#a266362bd8989fd1dacd0e1fc25b904f3">event_warn</a>(<span class="stringliteral">&quot;%s: out of memory&quot;</span>, <a class="code hl_define" href="util-internal_8h.html#a7d6e1cf1a8d53f38471e9e9db3faf740">__func__</a>);</div>
<div class="line"><span class="lineno">  926</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  927</span>        }</div>
<div class="line"><span class="lineno">  928</span>        extra = <a class="code hl_define" href="evbuffer-internal_8h.html#a1307b3b5932a9d17776089a56f65ff99">EVBUFFER_CHAIN_EXTRA</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structevbuffer__multicast__parent.html">evbuffer_multicast_parent</a>, tmp);</div>
<div class="line"><span class="lineno">  929</span>        <span class="comment">/* reference evbuffer containing source chain so it</span></div>
<div class="line"><span class="lineno">  930</span><span class="comment">         * doesn&#39;t get released while the chain is still</span></div>
<div class="line"><span class="lineno">  931</span><span class="comment">         * being referenced to */</span></div>
<div class="line"><span class="lineno">  932</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a28d71fa071cae93e6b7a64314283e921">evbuffer_incref_</a>(src);</div>
<div class="line"><span class="lineno">  933</span>        extra-&gt;<a class="code hl_variable" href="structevbuffer__multicast__parent.html#a5145f0ea2efe2dad48d5dbf9ab31cb2e">source</a> = src;</div>
<div class="line"><span class="lineno">  934</span>        <span class="comment">/* reference source chain which now becomes immutable */</span></div>
<div class="line"><span class="lineno">  935</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a8f7dba1c74e9de8db292c2308e70b462">evbuffer_chain_incref</a>(chain);</div>
<div class="line"><span class="lineno">  936</span>        extra-&gt;<a class="code hl_variable" href="structevbuffer__multicast__parent.html#a83b725eeccfb0c881d2a1e420b262906">parent</a> = chain;</div>
<div class="line"><span class="lineno">  937</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> |= <a class="code hl_define" href="evbuffer-internal_8h.html#a93af71b521a359f90fce52d1cf9f49c5">EVBUFFER_IMMUTABLE</a>;</div>
<div class="line"><span class="lineno">  938</span>        tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a>;</div>
<div class="line"><span class="lineno">  939</span>        tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>;</div>
<div class="line"><span class="lineno">  940</span>        tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno">  941</span>        tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> |= <a class="code hl_define" href="evbuffer-internal_8h.html#aff250d93bc4ed3bf372587b8f528e930">EVBUFFER_MULTICAST</a>|<a class="code hl_define" href="evbuffer-internal_8h.html#a93af71b521a359f90fce52d1cf9f49c5">EVBUFFER_IMMUTABLE</a>;</div>
<div class="line"><span class="lineno">  942</span>        tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a>;</div>
<div class="line"><span class="lineno">  943</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#abb1ffdb88a9aa9e2b114d98832dfda16">evbuffer_chain_insert</a>(dst, tmp);</div>
<div class="line"><span class="lineno">  944</span>    }</div>
<div class="line"><span class="lineno">  945</span>}</div>
<div class="ttc" id="aevbuffer-internal_8h_html_a1307b3b5932a9d17776089a56f65ff99"><div class="ttname"><a href="evbuffer-internal_8h.html#a1307b3b5932a9d17776089a56f65ff99">EVBUFFER_CHAIN_EXTRA</a></div><div class="ttdeci">#define EVBUFFER_CHAIN_EXTRA(t, c)</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00279">evbuffer-internal.h:279</a></div></div>
<div class="ttc" id="aevbuffer-internal_8h_html_ab79fb1d80416f15da34e29d7acd3da00"><div class="ttname"><a href="evbuffer-internal_8h.html#ab79fb1d80416f15da34e29d7acd3da00">EVBUFFER_DANGLING</a></div><div class="ttdeci">#define EVBUFFER_DANGLING</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00200">evbuffer-internal.h:200</a></div></div>
<div class="ttc" id="aevbuffer-internal_8h_html_aff250d93bc4ed3bf372587b8f528e930"><div class="ttname"><a href="evbuffer-internal_8h.html#aff250d93bc4ed3bf372587b8f528e930">EVBUFFER_MULTICAST</a></div><div class="ttdeci">#define EVBUFFER_MULTICAST</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00202">evbuffer-internal.h:202</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a28d71fa071cae93e6b7a64314283e921"><div class="ttname"><a href="libevent_2buffer_8c.html#a28d71fa071cae93e6b7a64314283e921">evbuffer_incref_</a></div><div class="ttdeci">void evbuffer_incref_(struct evbuffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00396">buffer.c:396</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a8f7dba1c74e9de8db292c2308e70b462"><div class="ttname"><a href="libevent_2buffer_8c.html#a8f7dba1c74e9de8db292c2308e70b462">evbuffer_chain_incref</a></div><div class="ttdeci">static void evbuffer_chain_incref(struct evbuffer_chain *chain)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00356">buffer.c:356</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_ab8a73fb51f7ddbe1641be56eaa45a00f"><div class="ttname"><a href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a></div><div class="ttdeci">static struct evbuffer_chain * evbuffer_chain_new(size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00157">buffer.c:157</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_abb1ffdb88a9aa9e2b114d98832dfda16"><div class="ttname"><a href="libevent_2buffer_8c.html#abb1ffdb88a9aa9e2b114d98832dfda16">evbuffer_chain_insert</a></div><div class="ttdeci">static void evbuffer_chain_insert(struct evbuffer *buf, struct evbuffer_chain *chain)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00309">buffer.c:309</a></div></div>
<div class="ttc" id="alog-internal_8h_html_a266362bd8989fd1dacd0e1fc25b904f3"><div class="ttname"><a href="log-internal_8h.html#a266362bd8989fd1dacd0e1fc25b904f3">event_warn</a></div><div class="ttdeci">EVENT2_EXPORT_SYMBOL void event_warn(const char *fmt,...) EV_CHECK_FMT(1</div></div>
<div class="ttc" id="astructevbuffer__chain_html_a4a11d168256c989272d4d2ecea5b16f3"><div class="ttname"><a href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">evbuffer_chain::misalign</a></div><div class="ttdeci">ev_misalign_t misalign</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00180">evbuffer-internal.h:180</a></div></div>
<div class="ttc" id="astructevbuffer__chain_html_a584b2b319d71fad5848c5f3a1a971c11"><div class="ttname"><a href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">evbuffer_chain::buffer_len</a></div><div class="ttdeci">size_t buffer_len</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00176">evbuffer-internal.h:176</a></div></div>
<div class="ttc" id="astructevbuffer__chain_html_a5f5fd17d81d5c58ccb4113857115130f"><div class="ttname"><a href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">evbuffer_chain::flags</a></div><div class="ttdeci">unsigned flags</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00188">evbuffer-internal.h:188</a></div></div>
<div class="ttc" id="astructevbuffer__chain_html_a9374df4f7d07f1e4580c617da0b38ec7"><div class="ttname"><a href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">evbuffer_chain::buffer</a></div><div class="ttdeci">unsigned char * buffer</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00213">evbuffer-internal.h:213</a></div></div>
<div class="ttc" id="astructevbuffer__chain_html_a974dfb5dd49914c64eb413ddac81fc26"><div class="ttname"><a href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">evbuffer_chain::off</a></div><div class="ttdeci">size_t off</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00185">evbuffer-internal.h:185</a></div></div>
<div class="ttc" id="astructevbuffer__multicast__parent_html"><div class="ttname"><a href="structevbuffer__multicast__parent.html">evbuffer_multicast_parent</a></div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00270">evbuffer-internal.h:270</a></div></div>
<div class="ttc" id="astructevbuffer__multicast__parent_html_a5145f0ea2efe2dad48d5dbf9ab31cb2e"><div class="ttname"><a href="structevbuffer__multicast__parent.html#a5145f0ea2efe2dad48d5dbf9ab31cb2e">evbuffer_multicast_parent::source</a></div><div class="ttdeci">struct evbuffer * source</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00272">evbuffer-internal.h:272</a></div></div>
<div class="ttc" id="astructevbuffer__multicast__parent_html_a83b725eeccfb0c881d2a1e420b262906"><div class="ttname"><a href="structevbuffer__multicast__parent.html#a83b725eeccfb0c881d2a1e420b262906">evbuffer_multicast_parent::parent</a></div><div class="ttdeci">struct evbuffer_chain * parent</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00274">evbuffer-internal.h:274</a></div></div>
<div class="ttc" id="autil-internal_8h_html_a7d6e1cf1a8d53f38471e9e9db3faf740"><div class="ttname"><a href="util-internal_8h.html#a7d6e1cf1a8d53f38471e9e9db3faf740">__func__</a></div><div class="ttdeci">#define __func__</div><div class="ttdef"><b>Definition:</b> <a href="util-internal_8h_source.html#l00086">util-internal.h:86</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="util-internal_8h_source.html#l00086">__func__</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00282">ASSERT_EVBUFFER_LOCKED</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00176">evbuffer_chain::buffer_len</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00279">EVBUFFER_CHAIN_EXTRA</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00356">evbuffer_chain_incref()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00309">evbuffer_chain_insert()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00157">evbuffer_chain_new()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00200">EVBUFFER_DANGLING</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00192">EVBUFFER_IMMUTABLE</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00396">evbuffer_incref_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00202">EVBUFFER_MULTICAST</a>, <a class="el" href="log-internal_8h.html#a266362bd8989fd1dacd0e1fc25b904f3">event_warn()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00188">evbuffer_chain::flags</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00274">evbuffer_multicast_parent::parent</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00272">evbuffer_multicast_parent::source</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01012">evbuffer_add_buffer_reference()</a>.</p>

</div>
</div>
<a id="a10fda8507ae305fc30d946d344cc7abb" name="a10fda8507ae305fc30d946d344cc7abb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10fda8507ae305fc30d946d344cc7abb">&#9670;&nbsp;</a></span>COPY_CHAIN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void COPY_CHAIN </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00875">875</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  876</span>{</div>
<div class="line"><span class="lineno">  877</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(dst);</div>
<div class="line"><span class="lineno">  878</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(src);</div>
<div class="line"><span class="lineno">  879</span>    dst-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a> = src-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno">  880</span>    <span class="keywordflow">if</span> (src-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> == &amp;src-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>)</div>
<div class="line"><span class="lineno">  881</span>        dst-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = &amp;dst-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno">  882</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  883</span>        dst-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = src-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>;</div>
<div class="line"><span class="lineno">  884</span>    dst-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> = src-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a>;</div>
<div class="line"><span class="lineno">  885</span>    dst-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> = src-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>;</div>
<div class="line"><span class="lineno">  886</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00282">ASSERT_EVBUFFER_LOCKED</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00084">evbuffer::last</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00966">evbuffer_add_buffer()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l01055">evbuffer_prepend_buffer()</a>.</p>

</div>
</div>
<a id="a8bcbab1212ab067b8faa767febc347ef" name="a8bcbab1212ab067b8faa767febc347ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bcbab1212ab067b8faa767febc347ef">&#9670;&nbsp;</a></span>evbuffer_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01730">1730</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1731</span>{</div>
<div class="line"><span class="lineno"> 1732</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain, *tmp;</div>
<div class="line"><span class="lineno"> 1733</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *data = data_in;</div>
<div class="line"><span class="lineno"> 1734</span>    <span class="keywordtype">size_t</span> remain, to_alloc;</div>
<div class="line"><span class="lineno"> 1735</span>    <span class="keywordtype">int</span> result = -1;</div>
<div class="line"><span class="lineno"> 1736</span> </div>
<div class="line"><span class="lineno"> 1737</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 1738</span> </div>
<div class="line"><span class="lineno"> 1739</span>    <span class="keywordflow">if</span> (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a6bed33d6f3074d83a5c39a21b3acbaf1">freeze_end</a>) {</div>
<div class="line"><span class="lineno"> 1740</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1741</span>    }</div>
<div class="line"><span class="lineno"> 1742</span>    <span class="comment">/* Prevent buf-&gt;total_len overflow */</span></div>
<div class="line"><span class="lineno"> 1743</span>    <span class="keywordflow">if</span> (datlen &gt; EV_SIZE_MAX - buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>) {</div>
<div class="line"><span class="lineno"> 1744</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1745</span>    }</div>
<div class="line"><span class="lineno"> 1746</span> </div>
<div class="line"><span class="lineno"> 1747</span>    <span class="keywordflow">if</span> (*buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1748</span>        chain = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a>;</div>
<div class="line"><span class="lineno"> 1749</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1750</span>        chain = *buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>;</div>
<div class="line"><span class="lineno"> 1751</span>    }</div>
<div class="line"><span class="lineno"> 1752</span> </div>
<div class="line"><span class="lineno"> 1753</span>    <span class="comment">/* If there are no chains allocated for this buffer, allocate one</span></div>
<div class="line"><span class="lineno"> 1754</span><span class="comment">     * big enough to hold all the data. */</span></div>
<div class="line"><span class="lineno"> 1755</span>    <span class="keywordflow">if</span> (chain == NULL) {</div>
<div class="line"><span class="lineno"> 1756</span>        chain = <a class="code hl_function" href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a>(datlen);</div>
<div class="line"><span class="lineno"> 1757</span>        <span class="keywordflow">if</span> (!chain)</div>
<div class="line"><span class="lineno"> 1758</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1759</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#abb1ffdb88a9aa9e2b114d98832dfda16">evbuffer_chain_insert</a>(buf, chain);</div>
<div class="line"><span class="lineno"> 1760</span>    }</div>
<div class="line"><span class="lineno"> 1761</span> </div>
<div class="line"><span class="lineno"> 1762</span>    <span class="keywordflow">if</span> ((chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp; <a class="code hl_define" href="evbuffer-internal_8h.html#a93af71b521a359f90fce52d1cf9f49c5">EVBUFFER_IMMUTABLE</a>) == 0) {</div>
<div class="line"><span class="lineno"> 1763</span>        <span class="comment">/* Always true for mutable buffers */</span></div>
<div class="line"><span class="lineno"> 1764</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> &gt;= 0 &amp;&amp;</div>
<div class="line"><span class="lineno"> 1765</span>            (ev_uint64_t)chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> &lt;= <a class="code hl_define" href="evbuffer-internal_8h.html#a6fc2d164d40c2e7fba6014619f968b16">EVBUFFER_CHAIN_MAX</a>);</div>
<div class="line"><span class="lineno"> 1766</span>        remain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a> - (size_t)chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> - chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 1767</span>        if (remain &gt;= datlen) {</div>
<div class="line"><span class="lineno"> 1768</span>            <span class="comment">/* there&#39;s enough space to hold all the data in the</span></div>
<div class="line"><span class="lineno"> 1769</span><span class="comment">             * current last chain */</span></div>
<div class="line"><span class="lineno"> 1770</span>            memcpy(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>,</div>
<div class="line"><span class="lineno"> 1771</span>                data, datlen);</div>
<div class="line"><span class="lineno"> 1772</span>            chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> += datlen;</div>
<div class="line"><span class="lineno"> 1773</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> += datlen;</div>
<div class="line"><span class="lineno"> 1774</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += datlen;</div>
<div class="line"><span class="lineno"> 1775</span>            <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno"> 1776</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="libevent_2buffer_8c.html#a6c587915f15eb124dc0c69d768093319">CHAIN_PINNED</a>(chain) &amp;&amp;</div>
<div class="line"><span class="lineno"> 1777</span>            <a class="code hl_function" href="libevent_2buffer_8c.html#abf7d52654d190f4a196f0e2e58ff0bb1">evbuffer_chain_should_realign</a>(chain, datlen)) {</div>
<div class="line"><span class="lineno"> 1778</span>            <span class="comment">/* we can fit the data into the misalignment */</span></div>
<div class="line"><span class="lineno"> 1779</span>            <a class="code hl_function" href="libevent_2buffer_8c.html#af9aadddcff964430df6ae27bb8c03fa9">evbuffer_chain_align</a>(chain);</div>
<div class="line"><span class="lineno"> 1780</span> </div>
<div class="line"><span class="lineno"> 1781</span>            memcpy(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>, data, datlen);</div>
<div class="line"><span class="lineno"> 1782</span>            chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> += datlen;</div>
<div class="line"><span class="lineno"> 1783</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> += datlen;</div>
<div class="line"><span class="lineno"> 1784</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += datlen;</div>
<div class="line"><span class="lineno"> 1785</span>            <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno"> 1786</span>        }</div>
<div class="line"><span class="lineno"> 1787</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1788</span>        <span class="comment">/* we cannot write any data to the last chain */</span></div>
<div class="line"><span class="lineno"> 1789</span>        remain = 0;</div>
<div class="line"><span class="lineno"> 1790</span>    }</div>
<div class="line"><span class="lineno"> 1791</span> </div>
<div class="line"><span class="lineno"> 1792</span>    <span class="comment">/* we need to add another chain */</span></div>
<div class="line"><span class="lineno"> 1793</span>    to_alloc = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a>;</div>
<div class="line"><span class="lineno"> 1794</span>    <span class="keywordflow">if</span> (to_alloc &lt;= <a class="code hl_define" href="libevent_2buffer_8c.html#a2d41c8b45ee1b03021a2bafa1935f2d4">EVBUFFER_CHAIN_MAX_AUTO_SIZE</a>/2)</div>
<div class="line"><span class="lineno"> 1795</span>        to_alloc &lt;&lt;= 1;</div>
<div class="line"><span class="lineno"> 1796</span>    <span class="keywordflow">if</span> (datlen &gt; to_alloc)</div>
<div class="line"><span class="lineno"> 1797</span>        to_alloc = datlen;</div>
<div class="line"><span class="lineno"> 1798</span>    tmp = <a class="code hl_function" href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a>(to_alloc);</div>
<div class="line"><span class="lineno"> 1799</span>    <span class="keywordflow">if</span> (tmp == NULL)</div>
<div class="line"><span class="lineno"> 1800</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1801</span> </div>
<div class="line"><span class="lineno"> 1802</span>    <span class="keywordflow">if</span> (remain) {</div>
<div class="line"><span class="lineno"> 1803</span>        memcpy(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>,</div>
<div class="line"><span class="lineno"> 1804</span>            data, remain);</div>
<div class="line"><span class="lineno"> 1805</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> += remain;</div>
<div class="line"><span class="lineno"> 1806</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> += remain;</div>
<div class="line"><span class="lineno"> 1807</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += remain;</div>
<div class="line"><span class="lineno"> 1808</span>    }</div>
<div class="line"><span class="lineno"> 1809</span> </div>
<div class="line"><span class="lineno"> 1810</span>    data += remain;</div>
<div class="line"><span class="lineno"> 1811</span>    datlen -= remain;</div>
<div class="line"><span class="lineno"> 1812</span> </div>
<div class="line"><span class="lineno"> 1813</span>    memcpy(tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a>, data, datlen);</div>
<div class="line"><span class="lineno"> 1814</span>    tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = datlen;</div>
<div class="line"><span class="lineno"> 1815</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#abb1ffdb88a9aa9e2b114d98832dfda16">evbuffer_chain_insert</a>(buf, tmp);</div>
<div class="line"><span class="lineno"> 1816</span>    buf-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += datlen;</div>
<div class="line"><span class="lineno"> 1817</span> </div>
<div class="line"><span class="lineno"> 1818</span>out:</div>
<div class="line"><span class="lineno"> 1819</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a>(buf);</div>
<div class="line"><span class="lineno"> 1820</span>    result = 0;</div>
<div class="line"><span class="lineno"> 1821</span>done:</div>
<div class="line"><span class="lineno"> 1822</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 1823</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 1824</span>}</div>
<div class="ttc" id="aevbuffer-internal_8h_html_a2db7168a100510b09c26d9d9896991e0"><div class="ttname"><a href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a></div><div class="ttdeci">#define EVBUFFER_LOCK(buffer)</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00285">evbuffer-internal.h:285</a></div></div>
<div class="ttc" id="aevbuffer-internal_8h_html_a6fc2d164d40c2e7fba6014619f968b16"><div class="ttname"><a href="evbuffer-internal_8h.html#a6fc2d164d40c2e7fba6014619f968b16">EVBUFFER_CHAIN_MAX</a></div><div class="ttdeci">#define EVBUFFER_CHAIN_MAX</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00166">evbuffer-internal.h:166</a></div></div>
<div class="ttc" id="aevbuffer-internal_8h_html_a7d4b06a7e3d8b4e945cd3234328e39d7"><div class="ttname"><a href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a></div><div class="ttdeci">#define EVBUFFER_UNLOCK(buffer)</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00289">evbuffer-internal.h:289</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a19e27adc7ac1c3b2c8303586c39e912e"><div class="ttname"><a href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a></div><div class="ttdeci">void evbuffer_invoke_callbacks_(struct evbuffer *buffer)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00514">buffer.c:514</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a2d41c8b45ee1b03021a2bafa1935f2d4"><div class="ttname"><a href="libevent_2buffer_8c.html#a2d41c8b45ee1b03021a2bafa1935f2d4">EVBUFFER_CHAIN_MAX_AUTO_SIZE</a></div><div class="ttdeci">#define EVBUFFER_CHAIN_MAX_AUTO_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01725">buffer.c:1725</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a6c587915f15eb124dc0c69d768093319"><div class="ttname"><a href="libevent_2buffer_8c.html#a6c587915f15eb124dc0c69d768093319">CHAIN_PINNED</a></div><div class="ttdeci">#define CHAIN_PINNED(ch)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00133">buffer.c:133</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_abf7d52654d190f4a196f0e2e58ff0bb1"><div class="ttname"><a href="libevent_2buffer_8c.html#abf7d52654d190f4a196f0e2e58ff0bb1">evbuffer_chain_should_realign</a></div><div class="ttdeci">static int evbuffer_chain_should_realign(struct evbuffer_chain *chain, size_t datalen)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01928">buffer.c:1928</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_af9aadddcff964430df6ae27bb8c03fa9"><div class="ttname"><a href="libevent_2buffer_8c.html#af9aadddcff964430df6ae27bb8c03fa9">evbuffer_chain_align</a></div><div class="ttdeci">static void evbuffer_chain_align(struct evbuffer_chain *chain)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01914">buffer.c:1914</a></div></div>
<div class="ttc" id="astructevbuffer_html_a6bed33d6f3074d83a5c39a21b3acbaf1"><div class="ttname"><a href="structevbuffer.html#a6bed33d6f3074d83a5c39a21b3acbaf1">evbuffer::freeze_end</a></div><div class="ttdeci">unsigned freeze_end</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00123">evbuffer-internal.h:123</a></div></div>
<div class="ttc" id="astructevbuffer_html_ab2953dce6411c80514f7c787b311725c"><div class="ttname"><a href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">evbuffer::n_add_for_cb</a></div><div class="ttdeci">size_t n_add_for_cb</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00106">evbuffer-internal.h:106</a></div></div>
<div class="ttc" id="autil-internal_8h_html_a7365930d8b30f4c1ab3cef31a8622731"><div class="ttname"><a href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a></div><div class="ttdeci">#define EVUTIL_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="util-internal_8h_source.html#l00363">util-internal.h:363</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00176">evbuffer_chain::buffer_len</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00133">CHAIN_PINNED</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01914">evbuffer_chain_align()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00309">evbuffer_chain_insert()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00166">EVBUFFER_CHAIN_MAX</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01725">EVBUFFER_CHAIN_MAX_AUTO_SIZE</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00157">evbuffer_chain_new()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01928">evbuffer_chain_should_realign()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00192">EVBUFFER_IMMUTABLE</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00514">evbuffer_invoke_callbacks_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00188">evbuffer_chain::flags</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00123">evbuffer::freeze_end</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00084">evbuffer::last</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00106">evbuffer::n_add_for_cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__openssl_8c_source.html#l00159">bio_bufferevent_write()</a>, <a class="el" href="bufferevent_8c_source.html#l00452">bufferevent_write()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00635">evbuffer_add_iovec()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01260">evbuffer_remove_buffer()</a>, <a class="el" href="http_8c_source.html#l00606">evhttp_make_header()</a>, <a class="el" href="http_8c_source.html#l02894">evhttp_send_reply_chunk_with_cb()</a>, <a class="el" href="http_8c_source.html#l02926">evhttp_send_reply_end()</a>, <a class="el" href="http_8c_source.html#l04948">evhttp_uri_join()</a>, <a class="el" href="http_8c_source.html#l03110">evhttp_uriencode()</a>, <a class="el" href="event__tagging_8c_source.html#l00157">evtag_encode_int()</a>, <a class="el" href="event__tagging_8c_source.html#l00165">evtag_encode_int64()</a>, <a class="el" href="event__tagging_8c_source.html#l00178">evtag_encode_tag()</a>, <a class="el" href="event__tagging_8c_source.html#l00261">evtag_marshal()</a>, <a class="el" href="event__tagging_8c_source.html#l00281">evtag_marshal_int()</a>, <a class="el" href="event__tagging_8c_source.html#l00292">evtag_marshal_int64()</a>, and <a class="el" href="event__tagging_8c_source.html#l00471">evtag_unmarshal()</a>.</p>

</div>
</div>
<a id="a9d2edd536246d70c50678a3865305414" name="a9d2edd536246d70c50678a3865305414"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d2edd536246d70c50678a3865305414">&#9670;&nbsp;</a></span>evbuffer_add_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_add_buffer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>outbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>inbuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00966">966</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  967</span>{</div>
<div class="line"><span class="lineno">  968</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *pinned, *last;</div>
<div class="line"><span class="lineno">  969</span>    <span class="keywordtype">size_t</span> in_total_len, out_total_len;</div>
<div class="line"><span class="lineno">  970</span>    <span class="keywordtype">int</span> result = 0;</div>
<div class="line"><span class="lineno">  971</span> </div>
<div class="line"><span class="lineno">  972</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a9eaca177b89c10b76bf6f8228aace3ba">EVBUFFER_LOCK2</a>(inbuf, outbuf);</div>
<div class="line"><span class="lineno">  973</span>    in_total_len = inbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>;</div>
<div class="line"><span class="lineno">  974</span>    out_total_len = outbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>;</div>
<div class="line"><span class="lineno">  975</span> </div>
<div class="line"><span class="lineno">  976</span>    <span class="keywordflow">if</span> (in_total_len == 0 || outbuf == inbuf)</div>
<div class="line"><span class="lineno">  977</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  978</span> </div>
<div class="line"><span class="lineno">  979</span>    <span class="keywordflow">if</span> (outbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#a6bed33d6f3074d83a5c39a21b3acbaf1">freeze_end</a> || inbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#a082d569d992120cf9ff28ddb0f5da313">freeze_start</a>) {</div>
<div class="line"><span class="lineno">  980</span>        result = -1;</div>
<div class="line"><span class="lineno">  981</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  982</span>    }</div>
<div class="line"><span class="lineno">  983</span> </div>
<div class="line"><span class="lineno">  984</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#ac60199252b9aeb1951f7928fb8fcf489">PRESERVE_PINNED</a>(inbuf, &amp;pinned, &amp;last) &lt; 0) {</div>
<div class="line"><span class="lineno">  985</span>        result = -1;</div>
<div class="line"><span class="lineno">  986</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  987</span>    }</div>
<div class="line"><span class="lineno">  988</span> </div>
<div class="line"><span class="lineno">  989</span>    <span class="keywordflow">if</span> (out_total_len == 0) {</div>
<div class="line"><span class="lineno">  990</span>        <span class="comment">/* There might be an empty chain at the start of outbuf; free</span></div>
<div class="line"><span class="lineno">  991</span><span class="comment">         * it. */</span></div>
<div class="line"><span class="lineno">  992</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a853df8a453a607c6dfe27b18f7cda889">evbuffer_free_all_chains</a>(outbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>);</div>
<div class="line"><span class="lineno">  993</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a10fda8507ae305fc30d946d344cc7abb">COPY_CHAIN</a>(outbuf, inbuf);</div>
<div class="line"><span class="lineno">  994</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  995</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#aa1713518c73318a1df1b514547b97263">APPEND_CHAIN</a>(outbuf, inbuf);</div>
<div class="line"><span class="lineno">  996</span>    }</div>
<div class="line"><span class="lineno">  997</span> </div>
<div class="line"><span class="lineno">  998</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a1e2fe7a3afa03f1b336cc62ef0317bbc">RESTORE_PINNED</a>(inbuf, pinned, last);</div>
<div class="line"><span class="lineno">  999</span> </div>
<div class="line"><span class="lineno"> 1000</span>    inbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#a5f4fd4011a0461e5fbee4e417031a960">n_del_for_cb</a> += in_total_len;</div>
<div class="line"><span class="lineno"> 1001</span>    outbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += in_total_len;</div>
<div class="line"><span class="lineno"> 1002</span> </div>
<div class="line"><span class="lineno"> 1003</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a>(inbuf);</div>
<div class="line"><span class="lineno"> 1004</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a>(outbuf);</div>
<div class="line"><span class="lineno"> 1005</span> </div>
<div class="line"><span class="lineno"> 1006</span>done:</div>
<div class="line"><span class="lineno"> 1007</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2c063b555017c0dfceede8560a711aed">EVBUFFER_UNLOCK2</a>(inbuf, outbuf);</div>
<div class="line"><span class="lineno"> 1008</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 1009</span>}</div>
<div class="ttc" id="aevbuffer-internal_8h_html_a2c063b555017c0dfceede8560a711aed"><div class="ttname"><a href="evbuffer-internal_8h.html#a2c063b555017c0dfceede8560a711aed">EVBUFFER_UNLOCK2</a></div><div class="ttdeci">#define EVBUFFER_UNLOCK2(buffer1, buffer2)</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00297">evbuffer-internal.h:297</a></div></div>
<div class="ttc" id="aevbuffer-internal_8h_html_a9eaca177b89c10b76bf6f8228aace3ba"><div class="ttname"><a href="evbuffer-internal_8h.html#a9eaca177b89c10b76bf6f8228aace3ba">EVBUFFER_LOCK2</a></div><div class="ttdeci">#define EVBUFFER_LOCK2(buffer1, buffer2)</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00293">evbuffer-internal.h:293</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a10fda8507ae305fc30d946d344cc7abb"><div class="ttname"><a href="libevent_2buffer_8c.html#a10fda8507ae305fc30d946d344cc7abb">COPY_CHAIN</a></div><div class="ttdeci">static void COPY_CHAIN(struct evbuffer *dst, struct evbuffer *src)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00875">buffer.c:875</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a1e2fe7a3afa03f1b336cc62ef0317bbc"><div class="ttname"><a href="libevent_2buffer_8c.html#a1e2fe7a3afa03f1b336cc62ef0317bbc">RESTORE_PINNED</a></div><div class="ttdeci">static void RESTORE_PINNED(struct evbuffer *src, struct evbuffer_chain *pinned, struct evbuffer_chain *last)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00858">buffer.c:858</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a853df8a453a607c6dfe27b18f7cda889"><div class="ttname"><a href="libevent_2buffer_8c.html#a853df8a453a607c6dfe27b18f7cda889">evbuffer_free_all_chains</a></div><div class="ttdeci">static void evbuffer_free_all_chains(struct evbuffer_chain *chain)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00256">buffer.c:256</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_aa1713518c73318a1df1b514547b97263"><div class="ttname"><a href="libevent_2buffer_8c.html#aa1713518c73318a1df1b514547b97263">APPEND_CHAIN</a></div><div class="ttdeci">static void APPEND_CHAIN(struct evbuffer *dst, struct evbuffer *src)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00889">buffer.c:889</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_ac60199252b9aeb1951f7928fb8fcf489"><div class="ttname"><a href="libevent_2buffer_8c.html#ac60199252b9aeb1951f7928fb8fcf489">PRESERVE_PINNED</a></div><div class="ttdeci">static int PRESERVE_PINNED(struct evbuffer *src, struct evbuffer_chain **first, struct evbuffer_chain **last)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00814">buffer.c:814</a></div></div>
<div class="ttc" id="astructevbuffer_html_a082d569d992120cf9ff28ddb0f5da313"><div class="ttname"><a href="structevbuffer.html#a082d569d992120cf9ff28ddb0f5da313">evbuffer::freeze_start</a></div><div class="ttdeci">unsigned freeze_start</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00120">evbuffer-internal.h:120</a></div></div>
<div class="ttc" id="astructevbuffer_html_a5f4fd4011a0461e5fbee4e417031a960"><div class="ttname"><a href="structevbuffer.html#a5f4fd4011a0461e5fbee4e417031a960">evbuffer::n_del_for_cb</a></div><div class="ttdeci">size_t n_del_for_cb</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00109">evbuffer-internal.h:109</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00889">APPEND_CHAIN()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00875">COPY_CHAIN()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00256">evbuffer_free_all_chains()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00514">evbuffer_invoke_callbacks_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00293">EVBUFFER_LOCK2</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00297">EVBUFFER_UNLOCK2</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00123">evbuffer::freeze_end</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00120">evbuffer::freeze_start</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00106">evbuffer::n_add_for_cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00109">evbuffer::n_del_for_cb</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00814">PRESERVE_PINNED()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00858">RESTORE_PINNED()</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__pair_8c_source.html#l00153">be_pair_transfer()</a>, <a class="el" href="bufferevent_8c_source.html#l00476">bufferevent_read_buffer()</a>, <a class="el" href="bufferevent_8c_source.html#l00461">bufferevent_write_buffer()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01260">evbuffer_remove_buffer()</a>, <a class="el" href="http_8c_source.html#l00606">evhttp_make_header()</a>, <a class="el" href="http_8c_source.html#l01047">evhttp_read_body()</a>, <a class="el" href="http_8c_source.html#l02296">evhttp_read_header()</a>, <a class="el" href="http_8c_source.html#l02833">evhttp_send()</a>, <a class="el" href="http_8c_source.html#l02894">evhttp_send_reply_chunk_with_cb()</a>, and <a class="el" href="event__tagging_8c_source.html#l00270">evtag_marshal_buffer()</a>.</p>

</div>
</div>
<a id="a1aa7eddbf98d5a4acf023afe38792fcc" name="a1aa7eddbf98d5a4acf023afe38792fcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aa7eddbf98d5a4acf023afe38792fcc">&#9670;&nbsp;</a></span>evbuffer_add_buffer_reference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_add_buffer_reference </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>outbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>inbuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01012">1012</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1013</span>{</div>
<div class="line"><span class="lineno"> 1014</span>    <span class="keywordtype">size_t</span> in_total_len, out_total_len;</div>
<div class="line"><span class="lineno"> 1015</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain;</div>
<div class="line"><span class="lineno"> 1016</span>    <span class="keywordtype">int</span> result = 0;</div>
<div class="line"><span class="lineno"> 1017</span> </div>
<div class="line"><span class="lineno"> 1018</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a9eaca177b89c10b76bf6f8228aace3ba">EVBUFFER_LOCK2</a>(inbuf, outbuf);</div>
<div class="line"><span class="lineno"> 1019</span>    in_total_len = inbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>;</div>
<div class="line"><span class="lineno"> 1020</span>    out_total_len = outbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>;</div>
<div class="line"><span class="lineno"> 1021</span>    chain = inbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno"> 1022</span> </div>
<div class="line"><span class="lineno"> 1023</span>    <span class="keywordflow">if</span> (in_total_len == 0)</div>
<div class="line"><span class="lineno"> 1024</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1025</span> </div>
<div class="line"><span class="lineno"> 1026</span>    <span class="keywordflow">if</span> (outbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#a6bed33d6f3074d83a5c39a21b3acbaf1">freeze_end</a> || outbuf == inbuf) {</div>
<div class="line"><span class="lineno"> 1027</span>        result = -1;</div>
<div class="line"><span class="lineno"> 1028</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1029</span>    }</div>
<div class="line"><span class="lineno"> 1030</span> </div>
<div class="line"><span class="lineno"> 1031</span>    <span class="keywordflow">for</span> (; chain; chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>) {</div>
<div class="line"><span class="lineno"> 1032</span>        <span class="keywordflow">if</span> ((chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp; (<a class="code hl_define" href="evbuffer-internal_8h.html#a20e49580e8b5047ba90eeba99631e9b1">EVBUFFER_FILESEGMENT</a>|<a class="code hl_define" href="evbuffer-internal_8h.html#af16ec197b2b0ede3e2e6de9e9ccb430b">EVBUFFER_SENDFILE</a>|<a class="code hl_define" href="evbuffer-internal_8h.html#aff250d93bc4ed3bf372587b8f528e930">EVBUFFER_MULTICAST</a>)) != 0) {</div>
<div class="line"><span class="lineno"> 1033</span>            <span class="comment">/* chain type can not be referenced */</span></div>
<div class="line"><span class="lineno"> 1034</span>            result = -1;</div>
<div class="line"><span class="lineno"> 1035</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1036</span>        }</div>
<div class="line"><span class="lineno"> 1037</span>    }</div>
<div class="line"><span class="lineno"> 1038</span> </div>
<div class="line"><span class="lineno"> 1039</span>    <span class="keywordflow">if</span> (out_total_len == 0) {</div>
<div class="line"><span class="lineno"> 1040</span>        <span class="comment">/* There might be an empty chain at the start of outbuf; free</span></div>
<div class="line"><span class="lineno"> 1041</span><span class="comment">         * it. */</span></div>
<div class="line"><span class="lineno"> 1042</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a853df8a453a607c6dfe27b18f7cda889">evbuffer_free_all_chains</a>(outbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>);</div>
<div class="line"><span class="lineno"> 1043</span>    }</div>
<div class="line"><span class="lineno"> 1044</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a237f9efdb8c464740ca8f628167d4bcd">APPEND_CHAIN_MULTICAST</a>(outbuf, inbuf);</div>
<div class="line"><span class="lineno"> 1045</span> </div>
<div class="line"><span class="lineno"> 1046</span>    outbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += in_total_len;</div>
<div class="line"><span class="lineno"> 1047</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a>(outbuf);</div>
<div class="line"><span class="lineno"> 1048</span> </div>
<div class="line"><span class="lineno"> 1049</span>done:</div>
<div class="line"><span class="lineno"> 1050</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2c063b555017c0dfceede8560a711aed">EVBUFFER_UNLOCK2</a>(inbuf, outbuf);</div>
<div class="line"><span class="lineno"> 1051</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 1052</span>}</div>
<div class="ttc" id="aevbuffer-internal_8h_html_a20e49580e8b5047ba90eeba99631e9b1"><div class="ttname"><a href="evbuffer-internal_8h.html#a20e49580e8b5047ba90eeba99631e9b1">EVBUFFER_FILESEGMENT</a></div><div class="ttdeci">#define EVBUFFER_FILESEGMENT</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00189">evbuffer-internal.h:189</a></div></div>
<div class="ttc" id="aevbuffer-internal_8h_html_af16ec197b2b0ede3e2e6de9e9ccb430b"><div class="ttname"><a href="evbuffer-internal_8h.html#af16ec197b2b0ede3e2e6de9e9ccb430b">EVBUFFER_SENDFILE</a></div><div class="ttdeci">#define EVBUFFER_SENDFILE</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00190">evbuffer-internal.h:190</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a237f9efdb8c464740ca8f628167d4bcd"><div class="ttname"><a href="libevent_2buffer_8c.html#a237f9efdb8c464740ca8f628167d4bcd">APPEND_CHAIN_MULTICAST</a></div><div class="ttdeci">static void APPEND_CHAIN_MULTICAST(struct evbuffer *dst, struct evbuffer *src)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00908">buffer.c:908</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00908">APPEND_CHAIN_MULTICAST()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00189">EVBUFFER_FILESEGMENT</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00256">evbuffer_free_all_chains()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00514">evbuffer_invoke_callbacks_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00293">EVBUFFER_LOCK2</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00202">EVBUFFER_MULTICAST</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00190">EVBUFFER_SENDFILE</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00297">EVBUFFER_UNLOCK2</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00188">evbuffer_chain::flags</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00123">evbuffer::freeze_end</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00106">evbuffer::n_add_for_cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>.</p>

</div>
</div>
<a id="a7f74a931a40fed1f64496cce05e4f140" name="a7f74a931a40fed1f64496cce05e4f140"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f74a931a40fed1f64496cce05e4f140">&#9670;&nbsp;</a></span>evbuffer_add_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structevbuffer__cb__entry.html">evbuffer_cb_entry</a> * evbuffer_add_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">evbuffer_cb_func&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cbarg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l03334">3334</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3335</span>{</div>
<div class="line"><span class="lineno"> 3336</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__cb__entry.html">evbuffer_cb_entry</a> *e;</div>
<div class="line"><span class="lineno"> 3337</span>    <span class="keywordflow">if</span> (! (e = <a class="code hl_define" href="mm-internal_8h.html#a0c64a2a6527ed776255e0e4e380593dc">mm_calloc</a>(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="structevbuffer__cb__entry.html">evbuffer_cb_entry</a>))))</div>
<div class="line"><span class="lineno"> 3338</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 3339</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3340</span>    e-&gt;<a class="code hl_variable" href="structevbuffer__cb__entry.html#abb6fdf4fa07371ac05bc5114893abc5c">cb</a>.<a class="code hl_variable" href="structevbuffer__cb__entry.html#a7be341470ee9df41c27b9fa68b1311a3">cb_func</a> = <a class="code hl_variable" href="structevbuffer__cb__entry.html#abb6fdf4fa07371ac05bc5114893abc5c">cb</a>;</div>
<div class="line"><span class="lineno"> 3341</span>    e-&gt;<a class="code hl_variable" href="structevbuffer__cb__entry.html#ab12730928647120b4f8039eb20501c9f">cbarg</a> = <a class="code hl_variable" href="structevbuffer__cb__entry.html#ab12730928647120b4f8039eb20501c9f">cbarg</a>;</div>
<div class="line"><span class="lineno"> 3342</span>    e-&gt;<a class="code hl_variable" href="structevbuffer__cb__entry.html#a616160bb4a571f1fba4a9c0679932d03">flags</a> = EVBUFFER_CB_ENABLED;</div>
<div class="line"><span class="lineno"> 3343</span>    LIST_INSERT_HEAD(&amp;<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;callbacks, e, next);</div>
<div class="line"><span class="lineno"> 3344</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3345</span>    <span class="keywordflow">return</span> e;</div>
<div class="line"><span class="lineno"> 3346</span>}</div>
<div class="ttc" id="amm-internal_8h_html_a0c64a2a6527ed776255e0e4e380593dc"><div class="ttname"><a href="mm-internal_8h.html#a0c64a2a6527ed776255e0e4e380593dc">mm_calloc</a></div><div class="ttdeci">#define mm_calloc(count, size)</div><div class="ttdef"><b>Definition:</b> <a href="mm-internal_8h_source.html#l00076">mm-internal.h:76</a></div></div>
<div class="ttc" id="astructbuffer_html"><div class="ttname"><a href="structbuffer.html">buffer</a></div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00037">buffer.h:37</a></div></div>
<div class="ttc" id="astructevbuffer__cb__entry_html"><div class="ttname"><a href="structevbuffer__cb__entry.html">evbuffer_cb_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00062">evbuffer-internal.h:62</a></div></div>
<div class="ttc" id="astructevbuffer__cb__entry_html_a616160bb4a571f1fba4a9c0679932d03"><div class="ttname"><a href="structevbuffer__cb__entry.html#a616160bb4a571f1fba4a9c0679932d03">evbuffer_cb_entry::flags</a></div><div class="ttdeci">ev_uint32_t flags</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00075">evbuffer-internal.h:75</a></div></div>
<div class="ttc" id="astructevbuffer__cb__entry_html_a7be341470ee9df41c27b9fa68b1311a3"><div class="ttname"><a href="structevbuffer__cb__entry.html#a7be341470ee9df41c27b9fa68b1311a3">evbuffer_cb_entry::cb_func</a></div><div class="ttdeci">evbuffer_cb_func cb_func</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00069">evbuffer-internal.h:69</a></div></div>
<div class="ttc" id="astructevbuffer__cb__entry_html_ab12730928647120b4f8039eb20501c9f"><div class="ttname"><a href="structevbuffer__cb__entry.html#ab12730928647120b4f8039eb20501c9f">evbuffer_cb_entry::cbarg</a></div><div class="ttdeci">void * cbarg</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00073">evbuffer-internal.h:73</a></div></div>
<div class="ttc" id="astructevbuffer__cb__entry_html_abb6fdf4fa07371ac05bc5114893abc5c"><div class="ttname"><a href="structevbuffer__cb__entry.html#abb6fdf4fa07371ac05bc5114893abc5c">evbuffer_cb_entry::cb</a></div><div class="ttdeci">union evbuffer_cb_entry::@2 cb</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structevbuffer__cb__entry.html#abb6fdf4fa07371ac05bc5114893abc5c">evbuffer_cb_entry::cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00069">evbuffer_cb_entry::cb_func</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00073">evbuffer_cb_entry::cbarg</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00075">evbuffer_cb_entry::flags</a>, and <a class="el" href="mm-internal_8h_source.html#l00076">mm_calloc</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__async_8c_source.html#l00543">bufferevent_async_new_()</a>, <a class="el" href="bufferevent__filter_8c_source.html#l00170">bufferevent_filter_new()</a>, <a class="el" href="bufferevent__openssl_8c_source.html#l01343">bufferevent_openssl_new_impl()</a>, <a class="el" href="bufferevent__pair_8c_source.html#l00093">bufferevent_pair_elt_new()</a>, <a class="el" href="bufferevent_8c_source.html#l00594">bufferevent_setwatermark()</a>, <a class="el" href="bufferevent__sock_8c_source.html#l00344">bufferevent_socket_new()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l03312">evbuffer_setcb()</a>.</p>

</div>
</div>
<a id="aabbab9806ece6c2a7fa34dceda3bd775" name="aabbab9806ece6c2a7fa34dceda3bd775"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabbab9806ece6c2a7fa34dceda3bd775">&#9670;&nbsp;</a></span>evbuffer_add_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_add_file </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev_off_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev_off_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l03296">3296</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3297</span>{</div>
<div class="line"><span class="lineno"> 3298</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__file__segment.html">evbuffer_file_segment</a> *seg;</div>
<div class="line"><span class="lineno"> 3299</span>    <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="structevbuffer__file__segment.html#aa717f7205602a119d2276f05d59e8ee7">flags</a> = EVBUF_FS_CLOSE_ON_FREE;</div>
<div class="line"><span class="lineno"> 3300</span>    <span class="keywordtype">int</span> r;</div>
<div class="line"><span class="lineno"> 3301</span> </div>
<div class="line"><span class="lineno"> 3302</span>    seg = <a class="code hl_function" href="libevent_2buffer_8c.html#a1cce429d8eb7100a190e7dc820243c92">evbuffer_file_segment_new</a>(<a class="code hl_variable" href="structevbuffer__file__segment.html#ac35986e5757fd7b1f84daafc4124f369">fd</a>, offset, <a class="code hl_variable" href="structevbuffer__file__segment.html#a9a96fbc05e3c4f25942f1362075d6244">length</a>, <a class="code hl_variable" href="structevbuffer__file__segment.html#aa717f7205602a119d2276f05d59e8ee7">flags</a>);</div>
<div class="line"><span class="lineno"> 3303</span>    <span class="keywordflow">if</span> (!seg)</div>
<div class="line"><span class="lineno"> 3304</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 3305</span>    r = <a class="code hl_function" href="libevent_2buffer_8c.html#a9fe992b94b160431e7c1bbd039653e78">evbuffer_add_file_segment</a>(buf, seg, 0, <a class="code hl_variable" href="structevbuffer__file__segment.html#a9a96fbc05e3c4f25942f1362075d6244">length</a>);</div>
<div class="line"><span class="lineno"> 3306</span>    <span class="keywordflow">if</span> (r == 0)</div>
<div class="line"><span class="lineno"> 3307</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#aac3d2c0437effd46a755f131fe9239d2">evbuffer_file_segment_free</a>(seg);</div>
<div class="line"><span class="lineno"> 3308</span>    <span class="keywordflow">return</span> r;</div>
<div class="line"><span class="lineno"> 3309</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a1cce429d8eb7100a190e7dc820243c92"><div class="ttname"><a href="libevent_2buffer_8c.html#a1cce429d8eb7100a190e7dc820243c92">evbuffer_file_segment_new</a></div><div class="ttdeci">struct evbuffer_file_segment * evbuffer_file_segment_new(int fd, ev_off_t offset, ev_off_t length, unsigned flags)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l02964">buffer.c:2964</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a9fe992b94b160431e7c1bbd039653e78"><div class="ttname"><a href="libevent_2buffer_8c.html#a9fe992b94b160431e7c1bbd039653e78">evbuffer_add_file_segment</a></div><div class="ttdeci">int evbuffer_add_file_segment(struct evbuffer *buf, struct evbuffer_file_segment *seg, ev_off_t offset, ev_off_t length)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l03194">buffer.c:3194</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_aac3d2c0437effd46a755f131fe9239d2"><div class="ttname"><a href="libevent_2buffer_8c.html#aac3d2c0437effd46a755f131fe9239d2">evbuffer_file_segment_free</a></div><div class="ttdeci">void evbuffer_file_segment_free(struct evbuffer_file_segment *seg)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l03155">buffer.c:3155</a></div></div>
<div class="ttc" id="astructevbuffer__file__segment_html"><div class="ttname"><a href="structevbuffer__file__segment.html">evbuffer_file_segment</a></div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00235">evbuffer-internal.h:235</a></div></div>
<div class="ttc" id="astructevbuffer__file__segment_html_a9a96fbc05e3c4f25942f1362075d6244"><div class="ttname"><a href="structevbuffer__file__segment.html#a9a96fbc05e3c4f25942f1362075d6244">evbuffer_file_segment::length</a></div><div class="ttdeci">ev_off_t length</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00261">evbuffer-internal.h:261</a></div></div>
<div class="ttc" id="astructevbuffer__file__segment_html_aa717f7205602a119d2276f05d59e8ee7"><div class="ttname"><a href="structevbuffer__file__segment.html#aa717f7205602a119d2276f05d59e8ee7">evbuffer_file_segment::flags</a></div><div class="ttdeci">unsigned flags</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00238">evbuffer-internal.h:238</a></div></div>
<div class="ttc" id="astructevbuffer__file__segment_html_ac35986e5757fd7b1f84daafc4124f369"><div class="ttname"><a href="structevbuffer__file__segment.html#ac35986e5757fd7b1f84daafc4124f369">evbuffer_file_segment::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00245">evbuffer-internal.h:245</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l03194">evbuffer_add_file_segment()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l03155">evbuffer_file_segment_free()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02964">evbuffer_file_segment_new()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00245">evbuffer_file_segment::fd</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00238">evbuffer_file_segment::flags</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00261">evbuffer_file_segment::length</a>.</p>

</div>
</div>
<a id="a9fe992b94b160431e7c1bbd039653e78" name="a9fe992b94b160431e7c1bbd039653e78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fe992b94b160431e7c1bbd039653e78">&#9670;&nbsp;</a></span>evbuffer_add_file_segment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_add_file_segment </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__file__segment.html">evbuffer_file_segment</a> *&#160;</td>
          <td class="paramname"><em>seg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev_off_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev_off_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l03194">3194</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3196</span>{</div>
<div class="line"><span class="lineno"> 3197</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain;</div>
<div class="line"><span class="lineno"> 3198</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain__file__segment.html">evbuffer_chain_file_segment</a> *extra;</div>
<div class="line"><span class="lineno"> 3199</span>    <span class="keywordtype">int</span> can_use_sendfile = 0;</div>
<div class="line"><span class="lineno"> 3200</span> </div>
<div class="line"><span class="lineno"> 3201</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 3202</span>    <a class="code hl_define" href="evthread-internal_8h.html#a85fdca55341e3703cd380dae6e90297d">EVLOCK_LOCK</a>(seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a542b6cf490c3faad72536c6da1dbd453">lock</a>, 0);</div>
<div class="line"><span class="lineno"> 3203</span>    <span class="keywordflow">if</span> (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a48cb697057298efe9c66dd6398415a58">flags</a> &amp; EVBUFFER_FLAG_DRAINS_TO_FD) {</div>
<div class="line"><span class="lineno"> 3204</span>        can_use_sendfile = 1;</div>
<div class="line"><span class="lineno"> 3205</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3206</span>        <span class="keywordflow">if</span> (!seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#aea6768e84af96f867e452df2feac4947">contents</a>) {</div>
<div class="line"><span class="lineno"> 3207</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#afc653891dd5d75823201026646b53c20">evbuffer_file_segment_materialize</a>(seg)&lt;0) {</div>
<div class="line"><span class="lineno"> 3208</span>                <a class="code hl_define" href="evthread-internal_8h.html#a56adca0a6ba562d39552d187063a0ba7">EVLOCK_UNLOCK</a>(seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a542b6cf490c3faad72536c6da1dbd453">lock</a>, 0);</div>
<div class="line"><span class="lineno"> 3209</span>                <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 3210</span>                <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 3211</span>            }</div>
<div class="line"><span class="lineno"> 3212</span>        }</div>
<div class="line"><span class="lineno"> 3213</span>    }</div>
<div class="line"><span class="lineno"> 3214</span>    <a class="code hl_define" href="evthread-internal_8h.html#a56adca0a6ba562d39552d187063a0ba7">EVLOCK_UNLOCK</a>(seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a542b6cf490c3faad72536c6da1dbd453">lock</a>, 0);</div>
<div class="line"><span class="lineno"> 3215</span> </div>
<div class="line"><span class="lineno"> 3216</span>    <span class="keywordflow">if</span> (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a6bed33d6f3074d83a5c39a21b3acbaf1">freeze_end</a>)</div>
<div class="line"><span class="lineno"> 3217</span>        <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 3218</span> </div>
<div class="line"><span class="lineno"> 3219</span>    <span class="keywordflow">if</span> (length &lt; 0) {</div>
<div class="line"><span class="lineno"> 3220</span>        <span class="keywordflow">if</span> (offset &gt; seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a9a96fbc05e3c4f25942f1362075d6244">length</a>)</div>
<div class="line"><span class="lineno"> 3221</span>            <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 3222</span>        length = seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a9a96fbc05e3c4f25942f1362075d6244">length</a> - offset;</div>
<div class="line"><span class="lineno"> 3223</span>    }</div>
<div class="line"><span class="lineno"> 3224</span> </div>
<div class="line"><span class="lineno"> 3225</span>    <span class="comment">/* Can we actually add this? */</span></div>
<div class="line"><span class="lineno"> 3226</span>    <span class="keywordflow">if</span> (offset+length &gt; seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a9a96fbc05e3c4f25942f1362075d6244">length</a>)</div>
<div class="line"><span class="lineno"> 3227</span>        <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 3228</span> </div>
<div class="line"><span class="lineno"> 3229</span>    chain = <a class="code hl_function" href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="structevbuffer__chain__file__segment.html">evbuffer_chain_file_segment</a>));</div>
<div class="line"><span class="lineno"> 3230</span>    <span class="keywordflow">if</span> (!chain)</div>
<div class="line"><span class="lineno"> 3231</span>        <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 3232</span>    extra = <a class="code hl_define" href="evbuffer-internal_8h.html#a1307b3b5932a9d17776089a56f65ff99">EVBUFFER_CHAIN_EXTRA</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structevbuffer__chain__file__segment.html">evbuffer_chain_file_segment</a>, chain);</div>
<div class="line"><span class="lineno"> 3233</span> </div>
<div class="line"><span class="lineno"> 3234</span>    chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> |= <a class="code hl_define" href="evbuffer-internal_8h.html#a93af71b521a359f90fce52d1cf9f49c5">EVBUFFER_IMMUTABLE</a>|<a class="code hl_define" href="evbuffer-internal_8h.html#a20e49580e8b5047ba90eeba99631e9b1">EVBUFFER_FILESEGMENT</a>;</div>
<div class="line"><span class="lineno"> 3235</span>    <span class="keywordflow">if</span> (can_use_sendfile &amp;&amp; seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a0256b45c64d65b4557ed1af6c7e4de5c">can_sendfile</a>) {</div>
<div class="line"><span class="lineno"> 3236</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> |= <a class="code hl_define" href="evbuffer-internal_8h.html#af16ec197b2b0ede3e2e6de9e9ccb430b">EVBUFFER_SENDFILE</a>;</div>
<div class="line"><span class="lineno"> 3237</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> = seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#ace172362e8b9807ab9ed56a8ee688f63">file_offset</a> + offset;</div>
<div class="line"><span class="lineno"> 3238</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = length;</div>
<div class="line"><span class="lineno"> 3239</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> + length;</div>
<div class="line"><span class="lineno"> 3240</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a06a2333b0cb01b58d0fa07b51c691791">is_mapping</a>) {</div>
<div class="line"><span class="lineno"> 3241</span><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="lineno"> 3242</span>        ev_uint64_t total_offset = seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a7bf0ab82f19cd2277842562380e5b08c">mmap_offset</a>+offset;</div>
<div class="line"><span class="lineno"> 3243</span>        ev_uint64_t offset_rounded=0, offset_remaining=0;</div>
<div class="line"><span class="lineno"> 3244</span>        LPVOID data;</div>
<div class="line"><span class="lineno"> 3245</span>        <span class="keywordflow">if</span> (total_offset) {</div>
<div class="line"><span class="lineno"> 3246</span>            SYSTEM_INFO si;</div>
<div class="line"><span class="lineno"> 3247</span>            memset(&amp;si, 0, <span class="keyword">sizeof</span>(si)); <span class="comment">/* cargo cult */</span></div>
<div class="line"><span class="lineno"> 3248</span>            GetSystemInfo(&amp;si);</div>
<div class="line"><span class="lineno"> 3249</span>            offset_remaining = total_offset % si.dwAllocationGranularity;</div>
<div class="line"><span class="lineno"> 3250</span>            offset_rounded = total_offset - offset_remaining;</div>
<div class="line"><span class="lineno"> 3251</span>        }</div>
<div class="line"><span class="lineno"> 3252</span>        data = MapViewOfFile(</div>
<div class="line"><span class="lineno"> 3253</span>            seg-&gt;mapping_handle,</div>
<div class="line"><span class="lineno"> 3254</span>            FILE_MAP_READ,</div>
<div class="line"><span class="lineno"> 3255</span>            offset_rounded &gt;&gt; 32,</div>
<div class="line"><span class="lineno"> 3256</span>            offset_rounded &amp; 0xfffffffful,</div>
<div class="line"><span class="lineno"> 3257</span>            length + offset_remaining);</div>
<div class="line"><span class="lineno"> 3258</span>        <span class="keywordflow">if</span> (data == NULL) {</div>
<div class="line"><span class="lineno"> 3259</span>            <a class="code hl_define" href="mm-internal_8h.html#af7d87798652aaa8398bb9c0504256f16">mm_free</a>(chain);</div>
<div class="line"><span class="lineno"> 3260</span>            <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 3261</span>        }</div>
<div class="line"><span class="lineno"> 3262</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) data;</div>
<div class="line"><span class="lineno"> 3263</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a> = length+offset_remaining;</div>
<div class="line"><span class="lineno"> 3264</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> = offset_remaining;</div>
<div class="line"><span class="lineno"> 3265</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = length;</div>
<div class="line"><span class="lineno"> 3266</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 3267</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)(seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#aea6768e84af96f867e452df2feac4947">contents</a> + offset);</div>
<div class="line"><span class="lineno"> 3268</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a> = length;</div>
<div class="line"><span class="lineno"> 3269</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = length;</div>
<div class="line"><span class="lineno"> 3270</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3271</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3272</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)(seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#aea6768e84af96f867e452df2feac4947">contents</a> + offset);</div>
<div class="line"><span class="lineno"> 3273</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a> = length;</div>
<div class="line"><span class="lineno"> 3274</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = length;</div>
<div class="line"><span class="lineno"> 3275</span>    }</div>
<div class="line"><span class="lineno"> 3276</span> </div>
<div class="line"><span class="lineno"> 3277</span>    <a class="code hl_define" href="evthread-internal_8h.html#a85fdca55341e3703cd380dae6e90297d">EVLOCK_LOCK</a>(seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a542b6cf490c3faad72536c6da1dbd453">lock</a>, 0);</div>
<div class="line"><span class="lineno"> 3278</span>    ++seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a042d2e97a05831bf15208072eae7b1c7">refcnt</a>;</div>
<div class="line"><span class="lineno"> 3279</span>    <a class="code hl_define" href="evthread-internal_8h.html#a56adca0a6ba562d39552d187063a0ba7">EVLOCK_UNLOCK</a>(seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a542b6cf490c3faad72536c6da1dbd453">lock</a>, 0);</div>
<div class="line"><span class="lineno"> 3280</span>    extra-&gt;<a class="code hl_variable" href="structevbuffer__chain__file__segment.html#afe3b029852ec15100aeba26ee982004d">segment</a> = seg;</div>
<div class="line"><span class="lineno"> 3281</span>    buf-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += length;</div>
<div class="line"><span class="lineno"> 3282</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#abb1ffdb88a9aa9e2b114d98832dfda16">evbuffer_chain_insert</a>(buf, chain);</div>
<div class="line"><span class="lineno"> 3283</span> </div>
<div class="line"><span class="lineno"> 3284</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a>(buf);</div>
<div class="line"><span class="lineno"> 3285</span> </div>
<div class="line"><span class="lineno"> 3286</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 3287</span> </div>
<div class="line"><span class="lineno"> 3288</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 3289</span>err:</div>
<div class="line"><span class="lineno"> 3290</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 3291</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#aac3d2c0437effd46a755f131fe9239d2">evbuffer_file_segment_free</a>(seg); <span class="comment">/* Lowers the refcount */</span></div>
<div class="line"><span class="lineno"> 3292</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 3293</span>}</div>
<div class="ttc" id="aevthread-internal_8h_html_a56adca0a6ba562d39552d187063a0ba7"><div class="ttname"><a href="evthread-internal_8h.html#a56adca0a6ba562d39552d187063a0ba7">EVLOCK_UNLOCK</a></div><div class="ttdeci">#define EVLOCK_UNLOCK(lockvar, mode)</div><div class="ttdef"><b>Definition:</b> <a href="evthread-internal_8h_source.html#l00100">evthread-internal.h:100</a></div></div>
<div class="ttc" id="aevthread-internal_8h_html_a85fdca55341e3703cd380dae6e90297d"><div class="ttname"><a href="evthread-internal_8h.html#a85fdca55341e3703cd380dae6e90297d">EVLOCK_LOCK</a></div><div class="ttdeci">#define EVLOCK_LOCK(lockvar, mode)</div><div class="ttdef"><b>Definition:</b> <a href="evthread-internal_8h_source.html#l00093">evthread-internal.h:93</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_afc653891dd5d75823201026646b53c20"><div class="ttname"><a href="libevent_2buffer_8c.html#afc653891dd5d75823201026646b53c20">evbuffer_file_segment_materialize</a></div><div class="ttdeci">static int evbuffer_file_segment_materialize(struct evbuffer_file_segment *seg)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l03040">buffer.c:3040</a></div></div>
<div class="ttc" id="amm-internal_8h_html_af7d87798652aaa8398bb9c0504256f16"><div class="ttname"><a href="mm-internal_8h.html#af7d87798652aaa8398bb9c0504256f16">mm_free</a></div><div class="ttdeci">#define mm_free(p)</div><div class="ttdef"><b>Definition:</b> <a href="mm-internal_8h_source.html#l00079">mm-internal.h:79</a></div></div>
<div class="ttc" id="astructevbuffer__chain__file__segment_html"><div class="ttname"><a href="structevbuffer__chain__file__segment.html">evbuffer_chain_file_segment</a></div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00226">evbuffer-internal.h:226</a></div></div>
<div class="ttc" id="astructevbuffer__chain__file__segment_html_afe3b029852ec15100aeba26ee982004d"><div class="ttname"><a href="structevbuffer__chain__file__segment.html#afe3b029852ec15100aeba26ee982004d">evbuffer_chain_file_segment::segment</a></div><div class="ttdeci">struct evbuffer_file_segment * segment</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00227">evbuffer-internal.h:227</a></div></div>
<div class="ttc" id="astructevbuffer__file__segment_html_a0256b45c64d65b4557ed1af6c7e4de5c"><div class="ttname"><a href="structevbuffer__file__segment.html#a0256b45c64d65b4557ed1af6c7e4de5c">evbuffer_file_segment::can_sendfile</a></div><div class="ttdeci">unsigned can_sendfile</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00241">evbuffer-internal.h:241</a></div></div>
<div class="ttc" id="astructevbuffer__file__segment_html_a042d2e97a05831bf15208072eae7b1c7"><div class="ttname"><a href="structevbuffer__file__segment.html#a042d2e97a05831bf15208072eae7b1c7">evbuffer_file_segment::refcnt</a></div><div class="ttdeci">int refcnt</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00237">evbuffer-internal.h:237</a></div></div>
<div class="ttc" id="astructevbuffer__file__segment_html_a06a2333b0cb01b58d0fa07b51c691791"><div class="ttname"><a href="structevbuffer__file__segment.html#a06a2333b0cb01b58d0fa07b51c691791">evbuffer_file_segment::is_mapping</a></div><div class="ttdeci">unsigned is_mapping</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00242">evbuffer-internal.h:242</a></div></div>
<div class="ttc" id="astructevbuffer__file__segment_html_a542b6cf490c3faad72536c6da1dbd453"><div class="ttname"><a href="structevbuffer__file__segment.html#a542b6cf490c3faad72536c6da1dbd453">evbuffer_file_segment::lock</a></div><div class="ttdeci">void * lock</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00236">evbuffer-internal.h:236</a></div></div>
<div class="ttc" id="astructevbuffer__file__segment_html_a7bf0ab82f19cd2277842562380e5b08c"><div class="ttname"><a href="structevbuffer__file__segment.html#a7bf0ab82f19cd2277842562380e5b08c">evbuffer_file_segment::mmap_offset</a></div><div class="ttdeci">ev_off_t mmap_offset</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00259">evbuffer-internal.h:259</a></div></div>
<div class="ttc" id="astructevbuffer__file__segment_html_ace172362e8b9807ab9ed56a8ee688f63"><div class="ttname"><a href="structevbuffer__file__segment.html#ace172362e8b9807ab9ed56a8ee688f63">evbuffer_file_segment::file_offset</a></div><div class="ttdeci">ev_off_t file_offset</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00256">evbuffer-internal.h:256</a></div></div>
<div class="ttc" id="astructevbuffer__file__segment_html_aea6768e84af96f867e452df2feac4947"><div class="ttname"><a href="structevbuffer__file__segment.html#aea6768e84af96f867e452df2feac4947">evbuffer_file_segment::contents</a></div><div class="ttdeci">char * contents</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00254">evbuffer-internal.h:254</a></div></div>
<div class="ttc" id="astructevbuffer_html_a48cb697057298efe9c66dd6398415a58"><div class="ttname"><a href="structevbuffer.html#a48cb697057298efe9c66dd6398415a58">evbuffer::flags</a></div><div class="ttdeci">ev_uint32_t flags</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00135">evbuffer-internal.h:135</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00176">evbuffer_chain::buffer_len</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00241">evbuffer_file_segment::can_sendfile</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00254">evbuffer_file_segment::contents</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00279">EVBUFFER_CHAIN_EXTRA</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00309">evbuffer_chain_insert()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00157">evbuffer_chain_new()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l03155">evbuffer_file_segment_free()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l03040">evbuffer_file_segment_materialize()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00189">EVBUFFER_FILESEGMENT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00192">EVBUFFER_IMMUTABLE</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00514">evbuffer_invoke_callbacks_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00190">EVBUFFER_SENDFILE</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="evthread-internal_8h_source.html#l00093">EVLOCK_LOCK</a>, <a class="el" href="evthread-internal_8h_source.html#l00100">EVLOCK_UNLOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00256">evbuffer_file_segment::file_offset</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00135">evbuffer::flags</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00188">evbuffer_chain::flags</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00123">evbuffer::freeze_end</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00242">evbuffer_file_segment::is_mapping</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00261">evbuffer_file_segment::length</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00236">evbuffer_file_segment::lock</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="mm-internal_8h_source.html#l00079">mm_free</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00259">evbuffer_file_segment::mmap_offset</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00106">evbuffer::n_add_for_cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00237">evbuffer_file_segment::refcnt</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00227">evbuffer_chain_file_segment::segment</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l03296">evbuffer_add_file()</a>.</p>

</div>
</div>
<a id="ab7d5b8ba706e3cc164987617c655fae8" name="ab7d5b8ba706e3cc164987617c655fae8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7d5b8ba706e3cc164987617c655fae8">&#9670;&nbsp;</a></span>evbuffer_add_iovec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t evbuffer_add_iovec </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct evbuffer_iovec *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00635">635</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  635</span>                                                                                  {</div>
<div class="line"><span class="lineno">  636</span>    <span class="keywordtype">int</span> n;</div>
<div class="line"><span class="lineno">  637</span>    <span class="keywordtype">size_t</span> res;</div>
<div class="line"><span class="lineno">  638</span>    <span class="keywordtype">size_t</span> to_alloc;</div>
<div class="line"><span class="lineno">  639</span> </div>
<div class="line"><span class="lineno">  640</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>    res = to_alloc = 0;</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>    <span class="keywordflow">for</span> (n = 0; n &lt; n_vec; n++) {</div>
<div class="line"><span class="lineno">  645</span>        to_alloc += vec[n].iov_len;</div>
<div class="line"><span class="lineno">  646</span>    }</div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#a0169295592d02008ef6229de9ba8a79b">evbuffer_expand_fast_</a>(buf, to_alloc, 2) &lt; 0) {</div>
<div class="line"><span class="lineno">  649</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  650</span>    }</div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span>    <span class="keywordflow">for</span> (n = 0; n &lt; n_vec; n++) {</div>
<div class="line"><span class="lineno">  653</span>        <span class="comment">/* XXX each &#39;add&#39; call here does a bunch of setup that&#39;s</span></div>
<div class="line"><span class="lineno">  654</span><span class="comment">         * obviated by evbuffer_expand_fast_, and some cleanup that we</span></div>
<div class="line"><span class="lineno">  655</span><span class="comment">         * would like to do only once.  Instead we should just extract</span></div>
<div class="line"><span class="lineno">  656</span><span class="comment">         * the part of the code that&#39;s needed. */</span></div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#a8bcbab1212ab067b8faa767febc347ef">evbuffer_add</a>(buf, vec[n].iov_base, vec[n].iov_len) &lt; 0) {</div>
<div class="line"><span class="lineno">  659</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  660</span>        }</div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span>        res += vec[n].iov_len;</div>
<div class="line"><span class="lineno">  663</span>    }</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>done:</div>
<div class="line"><span class="lineno">  666</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno">  667</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">  668</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a0169295592d02008ef6229de9ba8a79b"><div class="ttname"><a href="libevent_2buffer_8c.html#a0169295592d02008ef6229de9ba8a79b">evbuffer_expand_fast_</a></div><div class="ttdeci">int evbuffer_expand_fast_(struct evbuffer *buf, size_t datlen, int n)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l02051">buffer.c:2051</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a8bcbab1212ab067b8faa767febc347ef"><div class="ttname"><a href="libevent_2buffer_8c.html#a8bcbab1212ab067b8faa767febc347ef">evbuffer_add</a></div><div class="ttdeci">int evbuffer_add(struct evbuffer *buf, const void *data_in, size_t datlen)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01730">buffer.c:1730</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l01730">evbuffer_add()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02051">evbuffer_expand_fast_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>.</p>

</div>
</div>
<a id="adeb9457f344ddaf459726dbe348ac3db" name="adeb9457f344ddaf459726dbe348ac3db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeb9457f344ddaf459726dbe348ac3db">&#9670;&nbsp;</a></span>evbuffer_add_printf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_add_printf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02908">2908</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2909</span>{</div>
<div class="line"><span class="lineno"> 2910</span>    <span class="keywordtype">int</span> res = -1;</div>
<div class="line"><span class="lineno"> 2911</span>    va_list ap;</div>
<div class="line"><span class="lineno"> 2912</span> </div>
<div class="line"><span class="lineno"> 2913</span>    va_start(ap, fmt);</div>
<div class="line"><span class="lineno"> 2914</span>    res = <a class="code hl_function" href="libevent_2buffer_8c.html#acc385568d5129d4af10486b641b98f81">evbuffer_add_vprintf</a>(buf, fmt, ap);</div>
<div class="line"><span class="lineno"> 2915</span>    va_end(ap);</div>
<div class="line"><span class="lineno"> 2916</span> </div>
<div class="line"><span class="lineno"> 2917</span>    <span class="keywordflow">return</span> (res);</div>
<div class="line"><span class="lineno"> 2918</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_acc385568d5129d4af10486b641b98f81"><div class="ttname"><a href="libevent_2buffer_8c.html#acc385568d5129d4af10486b641b98f81">evbuffer_add_vprintf</a></div><div class="ttdeci">int evbuffer_add_vprintf(struct evbuffer *buf, const char *fmt, va_list ap)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l02844">buffer.c:2844</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l02844">evbuffer_add_vprintf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="http_8c_source.html#l03465">evhttp_handle_request()</a>, <a class="el" href="http_8c_source.html#l00606">evhttp_make_header()</a>, <a class="el" href="http_8c_source.html#l00438">evhttp_make_header_request()</a>, <a class="el" href="http_8c_source.html#l00531">evhttp_make_header_response()</a>, <a class="el" href="http_8c_source.html#l00398">evhttp_send_continue()</a>, <a class="el" href="http_8c_source.html#l02801">evhttp_send_error()</a>, <a class="el" href="http_8c_source.html#l02894">evhttp_send_reply_chunk_with_cb()</a>, <a class="el" href="http_8c_source.html#l04948">evhttp_uri_join()</a>, and <a class="el" href="http_8c_source.html#l03110">evhttp_uriencode()</a>.</p>

</div>
</div>
<a id="a310e8dcd2651ae5ff84690485837aa3d" name="a310e8dcd2651ae5ff84690485837aa3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a310e8dcd2651ae5ff84690485837aa3d">&#9670;&nbsp;</a></span>evbuffer_add_reference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_add_reference </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>outbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">evbuffer_ref_cleanup_cb&#160;</td>
          <td class="paramname"><em>cleanupfn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>extra</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02921">2921</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2924</span>{</div>
<div class="line"><span class="lineno"> 2925</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain;</div>
<div class="line"><span class="lineno"> 2926</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain__reference.html">evbuffer_chain_reference</a> *info;</div>
<div class="line"><span class="lineno"> 2927</span>    <span class="keywordtype">int</span> result = -1;</div>
<div class="line"><span class="lineno"> 2928</span> </div>
<div class="line"><span class="lineno"> 2929</span>    chain = <a class="code hl_function" href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="structevbuffer__chain__reference.html">evbuffer_chain_reference</a>));</div>
<div class="line"><span class="lineno"> 2930</span>    <span class="keywordflow">if</span> (!chain)</div>
<div class="line"><span class="lineno"> 2931</span>        <span class="keywordflow">return</span> (-1);</div>
<div class="line"><span class="lineno"> 2932</span>    chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> |= <a class="code hl_define" href="evbuffer-internal_8h.html#a7d108b84d3fb3a5f0c5c1d2f9c3cb920">EVBUFFER_REFERENCE</a> | <a class="code hl_define" href="evbuffer-internal_8h.html#a93af71b521a359f90fce52d1cf9f49c5">EVBUFFER_IMMUTABLE</a>;</div>
<div class="line"><span class="lineno"> 2933</span>    chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data;</div>
<div class="line"><span class="lineno"> 2934</span>    chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a> = datlen;</div>
<div class="line"><span class="lineno"> 2935</span>    chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = datlen;</div>
<div class="line"><span class="lineno"> 2936</span> </div>
<div class="line"><span class="lineno"> 2937</span>    info = <a class="code hl_define" href="evbuffer-internal_8h.html#a1307b3b5932a9d17776089a56f65ff99">EVBUFFER_CHAIN_EXTRA</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structevbuffer__chain__reference.html">evbuffer_chain_reference</a>, chain);</div>
<div class="line"><span class="lineno"> 2938</span>    info-&gt;<a class="code hl_variable" href="structevbuffer__chain__reference.html#a28cdfad3cc16f4a7c7a1846d5f675c3f">cleanupfn</a> = <a class="code hl_variable" href="structevbuffer__chain__reference.html#a28cdfad3cc16f4a7c7a1846d5f675c3f">cleanupfn</a>;</div>
<div class="line"><span class="lineno"> 2939</span>    info-&gt;<a class="code hl_variable" href="structevbuffer__chain__reference.html#a145127673226da7753ac8008a0cd8da4">extra</a> = <a class="code hl_variable" href="structevbuffer__chain__reference.html#a145127673226da7753ac8008a0cd8da4">extra</a>;</div>
<div class="line"><span class="lineno"> 2940</span> </div>
<div class="line"><span class="lineno"> 2941</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(outbuf);</div>
<div class="line"><span class="lineno"> 2942</span>    <span class="keywordflow">if</span> (outbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#a6bed33d6f3074d83a5c39a21b3acbaf1">freeze_end</a>) {</div>
<div class="line"><span class="lineno"> 2943</span>        <span class="comment">/* don&#39;t call chain_free; we do not want to actually invoke</span></div>
<div class="line"><span class="lineno"> 2944</span><span class="comment">         * the cleanup function */</span></div>
<div class="line"><span class="lineno"> 2945</span>        <a class="code hl_define" href="mm-internal_8h.html#af7d87798652aaa8398bb9c0504256f16">mm_free</a>(chain);</div>
<div class="line"><span class="lineno"> 2946</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 2947</span>    }</div>
<div class="line"><span class="lineno"> 2948</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#abb1ffdb88a9aa9e2b114d98832dfda16">evbuffer_chain_insert</a>(outbuf, chain);</div>
<div class="line"><span class="lineno"> 2949</span>    outbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += datlen;</div>
<div class="line"><span class="lineno"> 2950</span> </div>
<div class="line"><span class="lineno"> 2951</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a>(outbuf);</div>
<div class="line"><span class="lineno"> 2952</span> </div>
<div class="line"><span class="lineno"> 2953</span>    result = 0;</div>
<div class="line"><span class="lineno"> 2954</span>done:</div>
<div class="line"><span class="lineno"> 2955</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(outbuf);</div>
<div class="line"><span class="lineno"> 2956</span> </div>
<div class="line"><span class="lineno"> 2957</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 2958</span>}</div>
<div class="ttc" id="aevbuffer-internal_8h_html_a7d108b84d3fb3a5f0c5c1d2f9c3cb920"><div class="ttname"><a href="evbuffer-internal_8h.html#a7d108b84d3fb3a5f0c5c1d2f9c3cb920">EVBUFFER_REFERENCE</a></div><div class="ttdeci">#define EVBUFFER_REFERENCE</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00191">evbuffer-internal.h:191</a></div></div>
<div class="ttc" id="astructevbuffer__chain__reference_html"><div class="ttname"><a href="structevbuffer__chain__reference.html">evbuffer_chain_reference</a></div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00219">evbuffer-internal.h:219</a></div></div>
<div class="ttc" id="astructevbuffer__chain__reference_html_a145127673226da7753ac8008a0cd8da4"><div class="ttname"><a href="structevbuffer__chain__reference.html#a145127673226da7753ac8008a0cd8da4">evbuffer_chain_reference::extra</a></div><div class="ttdeci">void * extra</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00221">evbuffer-internal.h:221</a></div></div>
<div class="ttc" id="astructevbuffer__chain__reference_html_a28cdfad3cc16f4a7c7a1846d5f675c3f"><div class="ttname"><a href="structevbuffer__chain__reference.html#a28cdfad3cc16f4a7c7a1846d5f675c3f">evbuffer_chain_reference::cleanupfn</a></div><div class="ttdeci">evbuffer_ref_cleanup_cb cleanupfn</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00220">evbuffer-internal.h:220</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00176">evbuffer_chain::buffer_len</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00220">evbuffer_chain_reference::cleanupfn</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00279">EVBUFFER_CHAIN_EXTRA</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00309">evbuffer_chain_insert()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00157">evbuffer_chain_new()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00192">EVBUFFER_IMMUTABLE</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00514">evbuffer_invoke_callbacks_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00191">EVBUFFER_REFERENCE</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00221">evbuffer_chain_reference::extra</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00188">evbuffer_chain::flags</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00123">evbuffer::freeze_end</a>, <a class="el" href="mm-internal_8h_source.html#l00079">mm_free</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00106">evbuffer::n_add_for_cb</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>.</p>

</div>
</div>
<a id="acc385568d5129d4af10486b641b98f81" name="acc385568d5129d4af10486b641b98f81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc385568d5129d4af10486b641b98f81">&#9670;&nbsp;</a></span>evbuffer_add_vprintf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_add_vprintf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">va_list&#160;</td>
          <td class="paramname"><em>ap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02844">2844</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2845</span>{</div>
<div class="line"><span class="lineno"> 2846</span>    <span class="keywordtype">char</span> *<a class="code hl_struct" href="structbuffer.html">buffer</a>;</div>
<div class="line"><span class="lineno"> 2847</span>    <span class="keywordtype">size_t</span> space;</div>
<div class="line"><span class="lineno"> 2848</span>    <span class="keywordtype">int</span> sz, result = -1;</div>
<div class="line"><span class="lineno"> 2849</span>    va_list aq;</div>
<div class="line"><span class="lineno"> 2850</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain;</div>
<div class="line"><span class="lineno"> 2851</span> </div>
<div class="line"><span class="lineno"> 2852</span> </div>
<div class="line"><span class="lineno"> 2853</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 2854</span> </div>
<div class="line"><span class="lineno"> 2855</span>    <span class="keywordflow">if</span> (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a6bed33d6f3074d83a5c39a21b3acbaf1">freeze_end</a>) {</div>
<div class="line"><span class="lineno"> 2856</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 2857</span>    }</div>
<div class="line"><span class="lineno"> 2858</span> </div>
<div class="line"><span class="lineno"> 2859</span>    <span class="comment">/* make sure that at least some space is available */</span></div>
<div class="line"><span class="lineno"> 2860</span>    <span class="keywordflow">if</span> ((chain = <a class="code hl_function" href="libevent_2buffer_8c.html#af29382773b8c1cbe484de86282e6fb87">evbuffer_expand_singlechain</a>(buf, 64)) == NULL)</div>
<div class="line"><span class="lineno"> 2861</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 2862</span> </div>
<div class="line"><span class="lineno"> 2863</span>    <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><span class="lineno"> 2864</span><span class="preprocessor">#if 0</span></div>
<div class="line"><span class="lineno"> 2865</span>        <span class="keywordtype">size_t</span> used = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 2866</span>        <a class="code hl_struct" href="structbuffer.html">buffer</a> = (<span class="keywordtype">char</span> *)chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 2867</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a> &gt;= used);</div>
<div class="line"><span class="lineno"> 2868</span>        space = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a> - used;</div>
<div class="line"><span class="lineno"> 2869</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2870</span>        <a class="code hl_struct" href="structbuffer.html">buffer</a> = (<span class="keywordtype">char</span>*) <a class="code hl_define" href="libevent_2buffer_8c.html#a17846db51ec6b10c559ec8af1b30e379">CHAIN_SPACE_PTR</a>(chain);</div>
<div class="line"><span class="lineno"> 2871</span>        space = (size_t) <a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(chain);</div>
<div class="line"><span class="lineno"> 2872</span> </div>
<div class="line"><span class="lineno"> 2873</span><span class="preprocessor">#ifndef va_copy</span></div>
<div class="line"><span class="lineno"> 2874</span><span class="preprocessor">#define va_copy(dst, src)   memcpy(&amp;(dst), &amp;(src), sizeof(va_list))</span></div>
<div class="line"><span class="lineno"> 2875</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2876</span>        <a class="code hl_define" href="libevent_2buffer_8c.html#ad36243a66d6b30f74fd72dd0f78d7264">va_copy</a>(aq, ap);</div>
<div class="line"><span class="lineno"> 2877</span> </div>
<div class="line"><span class="lineno"> 2878</span>        sz = <a class="code hl_function" href="evutil_8c.html#a80bb0d174aa64218ce077b0c79df3e0f">evutil_vsnprintf</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, space, fmt, aq);</div>
<div class="line"><span class="lineno"> 2879</span> </div>
<div class="line"><span class="lineno"> 2880</span>        va_end(aq);</div>
<div class="line"><span class="lineno"> 2881</span> </div>
<div class="line"><span class="lineno"> 2882</span>        <span class="keywordflow">if</span> (sz &lt; 0)</div>
<div class="line"><span class="lineno"> 2883</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 2884</span>        <span class="keywordflow">if</span> (INT_MAX &gt;= <a class="code hl_define" href="evbuffer-internal_8h.html#a6fc2d164d40c2e7fba6014619f968b16">EVBUFFER_CHAIN_MAX</a> &amp;&amp;</div>
<div class="line"><span class="lineno"> 2885</span>            (<span class="keywordtype">size_t</span>)sz &gt;= <a class="code hl_define" href="evbuffer-internal_8h.html#a6fc2d164d40c2e7fba6014619f968b16">EVBUFFER_CHAIN_MAX</a>)</div>
<div class="line"><span class="lineno"> 2886</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 2887</span>        <span class="keywordflow">if</span> ((<span class="keywordtype">size_t</span>)sz &lt; space) {</div>
<div class="line"><span class="lineno"> 2888</span>            chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> += sz;</div>
<div class="line"><span class="lineno"> 2889</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> += sz;</div>
<div class="line"><span class="lineno"> 2890</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += sz;</div>
<div class="line"><span class="lineno"> 2891</span> </div>
<div class="line"><span class="lineno"> 2892</span>            <a class="code hl_function" href="libevent_2buffer_8c.html#a77d24636f0fc7b5e7de020ad37633aad">advance_last_with_data</a>(buf);</div>
<div class="line"><span class="lineno"> 2893</span>            <a class="code hl_function" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a>(buf);</div>
<div class="line"><span class="lineno"> 2894</span>            result = sz;</div>
<div class="line"><span class="lineno"> 2895</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 2896</span>        }</div>
<div class="line"><span class="lineno"> 2897</span>        <span class="keywordflow">if</span> ((chain = <a class="code hl_function" href="libevent_2buffer_8c.html#af29382773b8c1cbe484de86282e6fb87">evbuffer_expand_singlechain</a>(buf, sz + 1)) == NULL)</div>
<div class="line"><span class="lineno"> 2898</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 2899</span>    }</div>
<div class="line"><span class="lineno"> 2900</span>    <span class="comment">/* NOTREACHED */</span></div>
<div class="line"><span class="lineno"> 2901</span> </div>
<div class="line"><span class="lineno"> 2902</span>done:</div>
<div class="line"><span class="lineno"> 2903</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 2904</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 2905</span>}</div>
<div class="ttc" id="aevutil_8c_html_a80bb0d174aa64218ce077b0c79df3e0f"><div class="ttname"><a href="evutil_8c.html#a80bb0d174aa64218ce077b0c79df3e0f">evutil_vsnprintf</a></div><div class="ttdeci">int evutil_vsnprintf(char *buf, size_t buflen, const char *format, va_list ap)</div><div class="ttdef"><b>Definition:</b> <a href="evutil_8c_source.html#l01869">evutil.c:1869</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a1381150c8f2120296bd2726cf00f3284"><div class="ttname"><a href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a></div><div class="ttdeci">#define CHAIN_SPACE_LEN(ch)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00130">buffer.c:130</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a17846db51ec6b10c559ec8af1b30e379"><div class="ttname"><a href="libevent_2buffer_8c.html#a17846db51ec6b10c559ec8af1b30e379">CHAIN_SPACE_PTR</a></div><div class="ttdeci">#define CHAIN_SPACE_PTR(ch)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00129">buffer.c:129</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a77d24636f0fc7b5e7de020ad37633aad"><div class="ttname"><a href="libevent_2buffer_8c.html#a77d24636f0fc7b5e7de020ad37633aad">advance_last_with_data</a></div><div class="ttdeci">static int advance_last_with_data(struct evbuffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00704">buffer.c:704</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_ad36243a66d6b30f74fd72dd0f78d7264"><div class="ttname"><a href="libevent_2buffer_8c.html#ad36243a66d6b30f74fd72dd0f78d7264">va_copy</a></div><div class="ttdeci">#define va_copy(dst, src)</div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_af29382773b8c1cbe484de86282e6fb87"><div class="ttname"><a href="libevent_2buffer_8c.html#af29382773b8c1cbe484de86282e6fb87">evbuffer_expand_singlechain</a></div><div class="ttdeci">static struct evbuffer_chain * evbuffer_expand_singlechain(struct evbuffer *buf, size_t datlen)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01939">buffer.c:1939</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00704">advance_last_with_data()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00176">evbuffer_chain::buffer_len</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00130">CHAIN_SPACE_LEN</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00129">CHAIN_SPACE_PTR</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00166">EVBUFFER_CHAIN_MAX</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01939">evbuffer_expand_singlechain()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00514">evbuffer_invoke_callbacks_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evutil_8c_source.html#l01869">evutil_vsnprintf()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00123">evbuffer::freeze_end</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00106">evbuffer::n_add_for_cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>, and <a class="el" href="libevent_2buffer_8c.html#ad36243a66d6b30f74fd72dd0f78d7264">va_copy</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l02908">evbuffer_add_printf()</a>.</p>

</div>
</div>
<a id="acda56baecd4b512f4e9f54a21e39177f" name="acda56baecd4b512f4e9f54a21e39177f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acda56baecd4b512f4e9f54a21e39177f">&#9670;&nbsp;</a></span>evbuffer_cb_clear_flags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_cb_clear_flags </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__cb__entry.html">evbuffer_cb_entry</a> *&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev_uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l03389">3389</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3391</span>{</div>
<div class="line"><span class="lineno"> 3392</span>    <span class="comment">/* the user isn&#39;t allowed to mess with these. */</span></div>
<div class="line"><span class="lineno"> 3393</span>    flags &amp;= ~EVBUFFER_CB_INTERNAL_FLAGS;</div>
<div class="line"><span class="lineno"> 3394</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3395</span>    cb-&gt;<a class="code hl_variable" href="structevbuffer__cb__entry.html#a616160bb4a571f1fba4a9c0679932d03">flags</a> &amp;= ~flags;</div>
<div class="line"><span class="lineno"> 3396</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3397</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 3398</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structevbuffer__cb__entry.html#abb6fdf4fa07371ac05bc5114893abc5c">evbuffer_cb_entry::cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00075">evbuffer_cb_entry::flags</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__filter_8c_source.html#l00341">be_filter_process_output()</a>, <a class="el" href="bufferevent__filter_8c_source.html#l00170">bufferevent_filter_new()</a>, <a class="el" href="bufferevent__filter_8c_source.html#l00483">bufferevent_filtered_inbuf_cb()</a>, and <a class="el" href="bufferevent_8c_source.html#l00594">bufferevent_setwatermark()</a>.</p>

</div>
</div>
<a id="a4ba44d01484f19fbfe7c18d2a175dc3b" name="a4ba44d01484f19fbfe7c18d2a175dc3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ba44d01484f19fbfe7c18d2a175dc3b">&#9670;&nbsp;</a></span>evbuffer_cb_set_flags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_cb_set_flags </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__cb__entry.html">evbuffer_cb_entry</a> *&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev_uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l03377">3377</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3379</span>{</div>
<div class="line"><span class="lineno"> 3380</span>    <span class="comment">/* the user isn&#39;t allowed to mess with these. */</span></div>
<div class="line"><span class="lineno"> 3381</span>    flags &amp;= ~EVBUFFER_CB_INTERNAL_FLAGS;</div>
<div class="line"><span class="lineno"> 3382</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3383</span>    cb-&gt;<a class="code hl_variable" href="structevbuffer__cb__entry.html#a616160bb4a571f1fba4a9c0679932d03">flags</a> |= flags;</div>
<div class="line"><span class="lineno"> 3384</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3385</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 3386</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structevbuffer__cb__entry.html#abb6fdf4fa07371ac05bc5114893abc5c">evbuffer_cb_entry::cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00075">evbuffer_cb_entry::flags</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__filter_8c_source.html#l00341">be_filter_process_output()</a>, <a class="el" href="bufferevent__filter_8c_source.html#l00438">be_filter_read_nolock_()</a>, and <a class="el" href="bufferevent_8c_source.html#l00594">bufferevent_setwatermark()</a>.</p>

</div>
</div>
<a id="af9aadddcff964430df6ae27bb8c03fa9" name="af9aadddcff964430df6ae27bb8c03fa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9aadddcff964430df6ae27bb8c03fa9">&#9670;&nbsp;</a></span>evbuffer_chain_align()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void evbuffer_chain_align </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *&#160;</td>
          <td class="paramname"><em>chain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Helper: realigns the memory in chain-&gt;buffer so that misalign is 0. </p>

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01914">1914</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1915</span>{</div>
<div class="line"><span class="lineno"> 1916</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(!(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp; <a class="code hl_define" href="evbuffer-internal_8h.html#a93af71b521a359f90fce52d1cf9f49c5">EVBUFFER_IMMUTABLE</a>));</div>
<div class="line"><span class="lineno"> 1917</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(!(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp; <a class="code hl_define" href="evbuffer-internal_8h.html#a2ddf04d9ba9e2d6f56c67250acdf6e8e">EVBUFFER_MEM_PINNED_ANY</a>));</div>
<div class="line"><span class="lineno"> 1918</span>    memmove(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a>, chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>, chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>);</div>
<div class="line"><span class="lineno"> 1919</span>    chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> = 0;</div>
<div class="line"><span class="lineno"> 1920</span>}</div>
<div class="ttc" id="aevbuffer-internal_8h_html_a2ddf04d9ba9e2d6f56c67250acdf6e8e"><div class="ttname"><a href="evbuffer-internal_8h.html#a2ddf04d9ba9e2d6f56c67250acdf6e8e">EVBUFFER_MEM_PINNED_ANY</a></div><div class="ttdeci">#define EVBUFFER_MEM_PINNED_ANY</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00197">evbuffer-internal.h:197</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00192">EVBUFFER_IMMUTABLE</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00197">EVBUFFER_MEM_PINNED_ANY</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00188">evbuffer_chain::flags</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01730">evbuffer_add()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l01939">evbuffer_expand_singlechain()</a>.</p>

</div>
</div>
<a id="a7acdd31f1b39fc7c74f58103b23b6b0a" name="a7acdd31f1b39fc7c74f58103b23b6b0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7acdd31f1b39fc7c74f58103b23b6b0a">&#9670;&nbsp;</a></span>evbuffer_chain_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void evbuffer_chain_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *&#160;</td>
          <td class="paramname"><em>chain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00196">196</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  197</span>{</div>
<div class="line"><span class="lineno">  198</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#aa5e064975fd93f637c081153a6928dd6">refcnt</a> &gt; 0);</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">if</span> (--chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#aa5e064975fd93f637c081153a6928dd6">refcnt</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  200</span>        <span class="comment">/* chain is still referenced by other chains */</span></div>
<div class="line"><span class="lineno">  201</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  202</span>    }</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="libevent_2buffer_8c.html#a6c587915f15eb124dc0c69d768093319">CHAIN_PINNED</a>(chain)) {</div>
<div class="line"><span class="lineno">  205</span>        <span class="comment">/* will get freed once no longer dangling */</span></div>
<div class="line"><span class="lineno">  206</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#aa5e064975fd93f637c081153a6928dd6">refcnt</a>++;</div>
<div class="line"><span class="lineno">  207</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> |= <a class="code hl_define" href="evbuffer-internal_8h.html#ab79fb1d80416f15da34e29d7acd3da00">EVBUFFER_DANGLING</a>;</div>
<div class="line"><span class="lineno">  208</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  209</span>    }</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>    <span class="comment">/* safe to release chain, it&#39;s either a referencing</span></div>
<div class="line"><span class="lineno">  212</span><span class="comment">     * chain or all references to it have been freed */</span></div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordflow">if</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp; <a class="code hl_define" href="evbuffer-internal_8h.html#a7d108b84d3fb3a5f0c5c1d2f9c3cb920">EVBUFFER_REFERENCE</a>) {</div>
<div class="line"><span class="lineno">  214</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain__reference.html">evbuffer_chain_reference</a> *info =</div>
<div class="line"><span class="lineno">  215</span>            <a class="code hl_define" href="evbuffer-internal_8h.html#a1307b3b5932a9d17776089a56f65ff99">EVBUFFER_CHAIN_EXTRA</a>(</div>
<div class="line"><span class="lineno">  216</span>                <span class="keyword">struct</span> <a class="code hl_struct" href="structevbuffer__chain__reference.html">evbuffer_chain_reference</a>,</div>
<div class="line"><span class="lineno">  217</span>                chain);</div>
<div class="line"><span class="lineno">  218</span>        <span class="keywordflow">if</span> (info-&gt;<a class="code hl_variable" href="structevbuffer__chain__reference.html#a28cdfad3cc16f4a7c7a1846d5f675c3f">cleanupfn</a>)</div>
<div class="line"><span class="lineno">  219</span>            (*info-&gt;<a class="code hl_variable" href="structevbuffer__chain__reference.html#a28cdfad3cc16f4a7c7a1846d5f675c3f">cleanupfn</a>)(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a>,</div>
<div class="line"><span class="lineno">  220</span>                chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a>,</div>
<div class="line"><span class="lineno">  221</span>                info-&gt;<a class="code hl_variable" href="structevbuffer__chain__reference.html#a145127673226da7753ac8008a0cd8da4">extra</a>);</div>
<div class="line"><span class="lineno">  222</span>    }</div>
<div class="line"><span class="lineno">  223</span>    <span class="keywordflow">if</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp; <a class="code hl_define" href="evbuffer-internal_8h.html#a20e49580e8b5047ba90eeba99631e9b1">EVBUFFER_FILESEGMENT</a>) {</div>
<div class="line"><span class="lineno">  224</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain__file__segment.html">evbuffer_chain_file_segment</a> *info =</div>
<div class="line"><span class="lineno">  225</span>            <a class="code hl_define" href="evbuffer-internal_8h.html#a1307b3b5932a9d17776089a56f65ff99">EVBUFFER_CHAIN_EXTRA</a>(</div>
<div class="line"><span class="lineno">  226</span>                <span class="keyword">struct</span> <a class="code hl_struct" href="structevbuffer__chain__file__segment.html">evbuffer_chain_file_segment</a>,</div>
<div class="line"><span class="lineno">  227</span>                chain);</div>
<div class="line"><span class="lineno">  228</span>        <span class="keywordflow">if</span> (info-&gt;<a class="code hl_variable" href="structevbuffer__chain__file__segment.html#afe3b029852ec15100aeba26ee982004d">segment</a>) {</div>
<div class="line"><span class="lineno">  229</span><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="lineno">  230</span>            <span class="keywordflow">if</span> (info-&gt;<a class="code hl_variable" href="structevbuffer__chain__file__segment.html#afe3b029852ec15100aeba26ee982004d">segment</a>-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a06a2333b0cb01b58d0fa07b51c691791">is_mapping</a>)</div>
<div class="line"><span class="lineno">  231</span>                UnmapViewOfFile(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a>);</div>
<div class="line"><span class="lineno">  232</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  233</span>            <a class="code hl_function" href="libevent_2buffer_8c.html#aac3d2c0437effd46a755f131fe9239d2">evbuffer_file_segment_free</a>(info-&gt;<a class="code hl_variable" href="structevbuffer__chain__file__segment.html#afe3b029852ec15100aeba26ee982004d">segment</a>);</div>
<div class="line"><span class="lineno">  234</span>        }</div>
<div class="line"><span class="lineno">  235</span>    }</div>
<div class="line"><span class="lineno">  236</span>    <span class="keywordflow">if</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp; <a class="code hl_define" href="evbuffer-internal_8h.html#aff250d93bc4ed3bf372587b8f528e930">EVBUFFER_MULTICAST</a>) {</div>
<div class="line"><span class="lineno">  237</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__multicast__parent.html">evbuffer_multicast_parent</a> *info =</div>
<div class="line"><span class="lineno">  238</span>            <a class="code hl_define" href="evbuffer-internal_8h.html#a1307b3b5932a9d17776089a56f65ff99">EVBUFFER_CHAIN_EXTRA</a>(</div>
<div class="line"><span class="lineno">  239</span>                <span class="keyword">struct</span> <a class="code hl_struct" href="structevbuffer__multicast__parent.html">evbuffer_multicast_parent</a>,</div>
<div class="line"><span class="lineno">  240</span>                chain);</div>
<div class="line"><span class="lineno">  241</span>        <span class="comment">/* referencing chain is being freed, decrease</span></div>
<div class="line"><span class="lineno">  242</span><span class="comment">         * refcounts of source chain and associated</span></div>
<div class="line"><span class="lineno">  243</span><span class="comment">         * evbuffer (which get freed once both reach</span></div>
<div class="line"><span class="lineno">  244</span><span class="comment">         * zero) */</span></div>
<div class="line"><span class="lineno">  245</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(info-&gt;<a class="code hl_variable" href="structevbuffer__multicast__parent.html#a5145f0ea2efe2dad48d5dbf9ab31cb2e">source</a> != NULL);</div>
<div class="line"><span class="lineno">  246</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(info-&gt;<a class="code hl_variable" href="structevbuffer__multicast__parent.html#a83b725eeccfb0c881d2a1e420b262906">parent</a> != NULL);</div>
<div class="line"><span class="lineno">  247</span>        <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(info-&gt;<a class="code hl_variable" href="structevbuffer__multicast__parent.html#a5145f0ea2efe2dad48d5dbf9ab31cb2e">source</a>);</div>
<div class="line"><span class="lineno">  248</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a7acdd31f1b39fc7c74f58103b23b6b0a">evbuffer_chain_free</a>(info-&gt;<a class="code hl_variable" href="structevbuffer__multicast__parent.html#a83b725eeccfb0c881d2a1e420b262906">parent</a>);</div>
<div class="line"><span class="lineno">  249</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a3ac07b1be4b6fe0b2aa6a1677b060a80">evbuffer_decref_and_unlock_</a>(info-&gt;<a class="code hl_variable" href="structevbuffer__multicast__parent.html#a5145f0ea2efe2dad48d5dbf9ab31cb2e">source</a>);</div>
<div class="line"><span class="lineno">  250</span>    }</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>    <a class="code hl_define" href="mm-internal_8h.html#af7d87798652aaa8398bb9c0504256f16">mm_free</a>(chain);</div>
<div class="line"><span class="lineno">  253</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a3ac07b1be4b6fe0b2aa6a1677b060a80"><div class="ttname"><a href="libevent_2buffer_8c.html#a3ac07b1be4b6fe0b2aa6a1677b060a80">evbuffer_decref_and_unlock_</a></div><div class="ttdeci">void evbuffer_decref_and_unlock_(struct evbuffer *buffer)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00561">buffer.c:561</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a7acdd31f1b39fc7c74f58103b23b6b0a"><div class="ttname"><a href="libevent_2buffer_8c.html#a7acdd31f1b39fc7c74f58103b23b6b0a">evbuffer_chain_free</a></div><div class="ttdeci">static void evbuffer_chain_free(struct evbuffer_chain *chain)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00196">buffer.c:196</a></div></div>
<div class="ttc" id="astructevbuffer__chain_html_aa5e064975fd93f637c081153a6928dd6"><div class="ttname"><a href="structevbuffer__chain.html#aa5e064975fd93f637c081153a6928dd6">evbuffer_chain::refcnt</a></div><div class="ttdeci">int refcnt</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00205">evbuffer-internal.h:205</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00176">evbuffer_chain::buffer_len</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00133">CHAIN_PINNED</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00220">evbuffer_chain_reference::cleanupfn</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00279">EVBUFFER_CHAIN_EXTRA</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00196">evbuffer_chain_free()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00200">EVBUFFER_DANGLING</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00561">evbuffer_decref_and_unlock_()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l03155">evbuffer_file_segment_free()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00189">EVBUFFER_FILESEGMENT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00202">EVBUFFER_MULTICAST</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00191">EVBUFFER_REFERENCE</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00221">evbuffer_chain_reference::extra</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00188">evbuffer_chain::flags</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00242">evbuffer_file_segment::is_mapping</a>, <a class="el" href="mm-internal_8h_source.html#l00079">mm_free</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00274">evbuffer_multicast_parent::parent</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00205">evbuffer_chain::refcnt</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00227">evbuffer_chain_file_segment::segment</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00272">evbuffer_multicast_parent::source</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00196">evbuffer_chain_free()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00347">evbuffer_chain_unpin_()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00561">evbuffer_decref_and_unlock_()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01101">evbuffer_drain()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02051">evbuffer_expand_fast_()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01939">evbuffer_expand_singlechain()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00256">evbuffer_free_all_chains()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l01350">evbuffer_pullup()</a>.</p>

</div>
</div>
<a id="a8f7dba1c74e9de8db292c2308e70b462" name="a8f7dba1c74e9de8db292c2308e70b462"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f7dba1c74e9de8db292c2308e70b462">&#9670;&nbsp;</a></span>evbuffer_chain_incref()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void evbuffer_chain_incref </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *&#160;</td>
          <td class="paramname"><em>chain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00356">356</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  357</span>{</div>
<div class="line"><span class="lineno">  358</span>    ++chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#aa5e064975fd93f637c081153a6928dd6">refcnt</a>;</div>
<div class="line"><span class="lineno">  359</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00205">evbuffer_chain::refcnt</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00908">APPEND_CHAIN_MULTICAST()</a>.</p>

</div>
</div>
<a id="abb1ffdb88a9aa9e2b114d98832dfda16" name="abb1ffdb88a9aa9e2b114d98832dfda16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb1ffdb88a9aa9e2b114d98832dfda16">&#9670;&nbsp;</a></span>evbuffer_chain_insert()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void evbuffer_chain_insert </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *&#160;</td>
          <td class="paramname"><em>chain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00309">309</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  311</span>{</div>
<div class="line"><span class="lineno">  312</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(buf);</div>
<div class="line"><span class="lineno">  313</span>    <span class="keywordflow">if</span> (*buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> == NULL) {</div>
<div class="line"><span class="lineno">  314</span>        <span class="comment">/* There are no chains data on the buffer at all. */</span></div>
<div class="line"><span class="lineno">  315</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> == &amp;buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>);</div>
<div class="line"><span class="lineno">  316</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a> == NULL);</div>
<div class="line"><span class="lineno">  317</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a> = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> = chain;</div>
<div class="line"><span class="lineno">  318</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  319</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> **chp;</div>
<div class="line"><span class="lineno">  320</span>        chp = <a class="code hl_function" href="libevent_2buffer_8c.html#aa0b9aab1a4a4fb3d9e446b03d1ad2743">evbuffer_free_trailing_empty_chains</a>(buf);</div>
<div class="line"><span class="lineno">  321</span>        *chp = chain;</div>
<div class="line"><span class="lineno">  322</span>        <span class="keywordflow">if</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>)</div>
<div class="line"><span class="lineno">  323</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = chp;</div>
<div class="line"><span class="lineno">  324</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> = chain;</div>
<div class="line"><span class="lineno">  325</span>    }</div>
<div class="line"><span class="lineno">  326</span>    buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> += chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno">  327</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00282">ASSERT_EVBUFFER_LOCKED</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00291">evbuffer_free_trailing_empty_chains()</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00084">evbuffer::last</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00908">APPEND_CHAIN_MULTICAST()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01730">evbuffer_add()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l03194">evbuffer_add_file_segment()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02921">evbuffer_add_reference()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00330">evbuffer_chain_insert_new()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02051">evbuffer_expand_fast_()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l01827">evbuffer_prepend()</a>.</p>

</div>
</div>
<a id="a186d6472c870a6eeeba14c90aa13ed75" name="a186d6472c870a6eeeba14c90aa13ed75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a186d6472c870a6eeeba14c90aa13ed75">&#9670;&nbsp;</a></span>evbuffer_chain_insert_new()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> * evbuffer_chain_insert_new </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00330">330</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  331</span>{</div>
<div class="line"><span class="lineno">  332</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain;</div>
<div class="line"><span class="lineno">  333</span>    <span class="keywordflow">if</span> ((chain = <a class="code hl_function" href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a>(datlen)) == NULL)</div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  335</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#abb1ffdb88a9aa9e2b114d98832dfda16">evbuffer_chain_insert</a>(buf, chain);</div>
<div class="line"><span class="lineno">  336</span>    <span class="keywordflow">return</span> chain;</div>
<div class="line"><span class="lineno">  337</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00309">evbuffer_chain_insert()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00157">evbuffer_chain_new()</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01939">evbuffer_expand_singlechain()</a>.</p>

</div>
</div>
<a id="ab8a73fb51f7ddbe1641be56eaa45a00f" name="ab8a73fb51f7ddbe1641be56eaa45a00f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8a73fb51f7ddbe1641be56eaa45a00f">&#9670;&nbsp;</a></span>evbuffer_chain_new()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> * evbuffer_chain_new </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00157">157</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  158</span>{</div>
<div class="line"><span class="lineno">  159</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain;</div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordtype">size_t</span> to_alloc;</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordflow">if</span> (size &gt; <a class="code hl_define" href="evbuffer-internal_8h.html#a6fc2d164d40c2e7fba6014619f968b16">EVBUFFER_CHAIN_MAX</a> - <a class="code hl_define" href="evbuffer-internal_8h.html#ac495c63ebf0c5e35241d45528d4f359d">EVBUFFER_CHAIN_SIZE</a>)</div>
<div class="line"><span class="lineno">  163</span>        <span class="keywordflow">return</span> (NULL);</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>    size += <a class="code hl_define" href="evbuffer-internal_8h.html#ac495c63ebf0c5e35241d45528d4f359d">EVBUFFER_CHAIN_SIZE</a>;</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <span class="comment">/* get the next largest memory that can hold the buffer */</span></div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">if</span> (size &lt; <a class="code hl_define" href="evbuffer-internal_8h.html#a6fc2d164d40c2e7fba6014619f968b16">EVBUFFER_CHAIN_MAX</a> / 2) {</div>
<div class="line"><span class="lineno">  169</span>        to_alloc = <a class="code hl_define" href="evbuffer-internal_8h.html#a01464ed9cb0292540d7e0fb3d16d3844">MIN_BUFFER_SIZE</a>;</div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">while</span> (to_alloc &lt; size) {</div>
<div class="line"><span class="lineno">  171</span>            to_alloc &lt;&lt;= 1;</div>
<div class="line"><span class="lineno">  172</span>        }</div>
<div class="line"><span class="lineno">  173</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  174</span>        to_alloc = size;</div>
<div class="line"><span class="lineno">  175</span>    }</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    <span class="comment">/* we get everything in one chunk */</span></div>
<div class="line"><span class="lineno">  178</span>    <span class="keywordflow">if</span> ((chain = <a class="code hl_define" href="mm-internal_8h.html#a7c27fb60329839e84d16185cda4734d5">mm_malloc</a>(to_alloc)) == NULL)</div>
<div class="line"><span class="lineno">  179</span>        <span class="keywordflow">return</span> (NULL);</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>    memset(chain, 0, <a class="code hl_define" href="evbuffer-internal_8h.html#ac495c63ebf0c5e35241d45528d4f359d">EVBUFFER_CHAIN_SIZE</a>);</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>    chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a> = to_alloc - <a class="code hl_define" href="evbuffer-internal_8h.html#ac495c63ebf0c5e35241d45528d4f359d">EVBUFFER_CHAIN_SIZE</a>;</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>    <span class="comment">/* this way we can manipulate the buffer to different addresses,</span></div>
<div class="line"><span class="lineno">  186</span><span class="comment">     * which is required for mmap for example.</span></div>
<div class="line"><span class="lineno">  187</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  188</span>    chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> = <a class="code hl_define" href="evbuffer-internal_8h.html#a1307b3b5932a9d17776089a56f65ff99">EVBUFFER_CHAIN_EXTRA</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>, chain);</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>    chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#aa5e064975fd93f637c081153a6928dd6">refcnt</a> = 1;</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>    <span class="keywordflow">return</span> (chain);</div>
<div class="line"><span class="lineno">  193</span>}</div>
<div class="ttc" id="aevbuffer-internal_8h_html_a01464ed9cb0292540d7e0fb3d16d3844"><div class="ttname"><a href="evbuffer-internal_8h.html#a01464ed9cb0292540d7e0fb3d16d3844">MIN_BUFFER_SIZE</a></div><div class="ttdeci">#define MIN_BUFFER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00055">evbuffer-internal.h:55</a></div></div>
<div class="ttc" id="aevbuffer-internal_8h_html_ac495c63ebf0c5e35241d45528d4f359d"><div class="ttname"><a href="evbuffer-internal_8h.html#ac495c63ebf0c5e35241d45528d4f359d">EVBUFFER_CHAIN_SIZE</a></div><div class="ttdeci">#define EVBUFFER_CHAIN_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00277">evbuffer-internal.h:277</a></div></div>
<div class="ttc" id="amm-internal_8h_html_a7c27fb60329839e84d16185cda4734d5"><div class="ttname"><a href="mm-internal_8h.html#a7c27fb60329839e84d16185cda4734d5">mm_malloc</a></div><div class="ttdeci">#define mm_malloc(sz)</div><div class="ttdef"><b>Definition:</b> <a href="mm-internal_8h_source.html#l00075">mm-internal.h:75</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00176">evbuffer_chain::buffer_len</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00279">EVBUFFER_CHAIN_EXTRA</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00166">EVBUFFER_CHAIN_MAX</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00277">EVBUFFER_CHAIN_SIZE</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00055">MIN_BUFFER_SIZE</a>, <a class="el" href="mm-internal_8h_source.html#l00075">mm_malloc</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00205">evbuffer_chain::refcnt</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00908">APPEND_CHAIN_MULTICAST()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01730">evbuffer_add()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l03194">evbuffer_add_file_segment()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02921">evbuffer_add_reference()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00330">evbuffer_chain_insert_new()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02051">evbuffer_expand_fast_()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01939">evbuffer_expand_singlechain()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01827">evbuffer_prepend()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01350">evbuffer_pullup()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00814">PRESERVE_PINNED()</a>.</p>

</div>
</div>
<a id="afe0cf08c219c3f30a28929846277b90b" name="afe0cf08c219c3f30a28929846277b90b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe0cf08c219c3f30a28929846277b90b">&#9670;&nbsp;</a></span>evbuffer_chain_pin_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evbuffer_chain_pin_ </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *&#160;</td>
          <td class="paramname"><em>chain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Pin a single buffer chain using a given flag. A pinned chunk may not be moved or freed until it is unpinned. </p>

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00340">340</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  341</span>{</div>
<div class="line"><span class="lineno">  342</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>((chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp; flag) == 0);</div>
<div class="line"><span class="lineno">  343</span>    chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> |= flag;</div>
<div class="line"><span class="lineno">  344</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00188">evbuffer_chain::flags</a>.</p>

<p class="reference">Referenced by <a class="el" href="buffer__iocp_8c_source.html#l00246">evbuffer_launch_read_()</a>, and <a class="el" href="buffer__iocp_8c_source.html#l00172">evbuffer_launch_write_()</a>.</p>

</div>
</div>
<a id="abf7d52654d190f4a196f0e2e58ff0bb1" name="abf7d52654d190f4a196f0e2e58ff0bb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf7d52654d190f4a196f0e2e58ff0bb1">&#9670;&nbsp;</a></span>evbuffer_chain_should_realign()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int evbuffer_chain_should_realign </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *&#160;</td>
          <td class="paramname"><em>chain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Helper: return true iff we should realign chain to fit datalen bytes of data in it. </p>

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01928">1928</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1930</span>{</div>
<div class="line"><span class="lineno"> 1931</span>    <span class="keywordflow">return</span> chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a> - chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> &gt;= datlen &amp;&amp;</div>
<div class="line"><span class="lineno"> 1932</span>        (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> &lt; chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a> / 2) &amp;&amp;</div>
<div class="line"><span class="lineno"> 1933</span>        (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> &lt;= <a class="code hl_define" href="libevent_2buffer_8c.html#aec949b6b2128a73deab65d152d378167">MAX_TO_REALIGN_IN_EXPAND</a>);</div>
<div class="line"><span class="lineno"> 1934</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_aec949b6b2128a73deab65d152d378167"><div class="ttname"><a href="libevent_2buffer_8c.html#aec949b6b2128a73deab65d152d378167">MAX_TO_REALIGN_IN_EXPAND</a></div><div class="ttdeci">#define MAX_TO_REALIGN_IN_EXPAND</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01923">buffer.c:1923</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00176">evbuffer_chain::buffer_len</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01923">MAX_TO_REALIGN_IN_EXPAND</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01730">evbuffer_add()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l01939">evbuffer_expand_singlechain()</a>.</p>

</div>
</div>
<a id="ac949f855421b4afd676f3293b4d8706e" name="ac949f855421b4afd676f3293b4d8706e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac949f855421b4afd676f3293b4d8706e">&#9670;&nbsp;</a></span>evbuffer_chain_unpin_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evbuffer_chain_unpin_ </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *&#160;</td>
          <td class="paramname"><em>chain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Unpin a single buffer chain using a given flag. </p>

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00347">347</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  348</span>{</div>
<div class="line"><span class="lineno">  349</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>((chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp; flag) != 0);</div>
<div class="line"><span class="lineno">  350</span>    chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp;= ~flag;</div>
<div class="line"><span class="lineno">  351</span>    <span class="keywordflow">if</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp; <a class="code hl_define" href="evbuffer-internal_8h.html#ab79fb1d80416f15da34e29d7acd3da00">EVBUFFER_DANGLING</a>)</div>
<div class="line"><span class="lineno">  352</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a7acdd31f1b39fc7c74f58103b23b6b0a">evbuffer_chain_free</a>(chain);</div>
<div class="line"><span class="lineno">  353</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00196">evbuffer_chain_free()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00200">EVBUFFER_DANGLING</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00188">evbuffer_chain::flags</a>.</p>

<p class="reference">Referenced by <a class="el" href="buffer__iocp_8c_source.html#l00084">pin_release()</a>.</p>

</div>
</div>
<a id="a10fa650c0b0174af23a89cd44527b126" name="a10fa650c0b0174af23a89cd44527b126"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10fa650c0b0174af23a89cd44527b126">&#9670;&nbsp;</a></span>evbuffer_chains_all_empty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int evbuffer_chains_all_empty </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *&#160;</td>
          <td class="paramname"><em>chain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00267">267</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  268</span>{</div>
<div class="line"><span class="lineno">  269</span>    <span class="keywordflow">for</span> (; chain; chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>) {</div>
<div class="line"><span class="lineno">  270</span>        <span class="keywordflow">if</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>)</div>
<div class="line"><span class="lineno">  271</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  272</span>    }</div>
<div class="line"><span class="lineno">  273</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  274</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00291">evbuffer_free_trailing_empty_chains()</a>.</p>

</div>
</div>
<a id="a732701957705ae6abe7c28effeb4aa39" name="a732701957705ae6abe7c28effeb4aa39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a732701957705ae6abe7c28effeb4aa39">&#9670;&nbsp;</a></span>evbuffer_clear_flags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_clear_flags </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev_uint64_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00387">387</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  388</span>{</div>
<div class="line"><span class="lineno">  389</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno">  390</span>    buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a48cb697057298efe9c66dd6398415a58">flags</a> &amp;= ~(ev_uint32_t)flags;</div>
<div class="line"><span class="lineno">  391</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno">  392</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  393</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00135">evbuffer::flags</a>.</p>

</div>
</div>
<a id="a7a13a10fd1eb75cccf0ca29a05c5ba8a" name="a7a13a10fd1eb75cccf0ca29a05c5ba8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a13a10fd1eb75cccf0ca29a05c5ba8a">&#9670;&nbsp;</a></span>evbuffer_commit_space()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_commit_space </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct evbuffer_iovec *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_vecs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00724">724</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  726</span>{</div>
<div class="line"><span class="lineno">  727</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain, **firstchainp, **chainp;</div>
<div class="line"><span class="lineno">  728</span>    <span class="keywordtype">int</span> result = -1;</div>
<div class="line"><span class="lineno">  729</span>    <span class="keywordtype">size_t</span> added = 0;</div>
<div class="line"><span class="lineno">  730</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span>    <span class="keywordflow">if</span> (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a6bed33d6f3074d83a5c39a21b3acbaf1">freeze_end</a>)</div>
<div class="line"><span class="lineno">  735</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  736</span>    <span class="keywordflow">if</span> (n_vecs == 0) {</div>
<div class="line"><span class="lineno">  737</span>        result = 0;</div>
<div class="line"><span class="lineno">  738</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  739</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n_vecs == 1 &amp;&amp;</div>
<div class="line"><span class="lineno">  740</span>        (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> &amp;&amp; vec[0].iov_base == (<span class="keywordtype">void</span> *)<a class="code hl_define" href="libevent_2buffer_8c.html#a17846db51ec6b10c559ec8af1b30e379">CHAIN_SPACE_PTR</a>(buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a>))) {</div>
<div class="line"><span class="lineno">  741</span>        <span class="comment">/* The user only got or used one chain; it might not</span></div>
<div class="line"><span class="lineno">  742</span><span class="comment">         * be the first one with space in it. */</span></div>
<div class="line"><span class="lineno">  743</span>        <span class="keywordflow">if</span> ((<span class="keywordtype">size_t</span>)vec[0].iov_len &gt; (<span class="keywordtype">size_t</span>)<a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a>))</div>
<div class="line"><span class="lineno">  744</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  745</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a>-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> += vec[0].iov_len;</div>
<div class="line"><span class="lineno">  746</span>        added = vec[0].iov_len;</div>
<div class="line"><span class="lineno">  747</span>        <span class="keywordflow">if</span> (added)</div>
<div class="line"><span class="lineno">  748</span>            <a class="code hl_function" href="libevent_2buffer_8c.html#a77d24636f0fc7b5e7de020ad37633aad">advance_last_with_data</a>(buf);</div>
<div class="line"><span class="lineno">  749</span>        <span class="keywordflow">goto</span> okay;</div>
<div class="line"><span class="lineno">  750</span>    }</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>    <span class="comment">/* Advance &#39;firstchain&#39; to the first chain with space in it. */</span></div>
<div class="line"><span class="lineno">  753</span>    firstchainp = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>;</div>
<div class="line"><span class="lineno">  754</span>    <span class="keywordflow">if</span> (!*firstchainp)</div>
<div class="line"><span class="lineno">  755</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  756</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(*firstchainp) == 0) {</div>
<div class="line"><span class="lineno">  757</span>        firstchainp = &amp;(*firstchainp)-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno">  758</span>    }</div>
<div class="line"><span class="lineno">  759</span> </div>
<div class="line"><span class="lineno">  760</span>    chain = *firstchainp;</div>
<div class="line"><span class="lineno">  761</span>    <span class="comment">/* pass 1: make sure that the pointers and lengths of vecs[] are in</span></div>
<div class="line"><span class="lineno">  762</span><span class="comment">     * bounds before we try to commit anything. */</span></div>
<div class="line"><span class="lineno">  763</span>    <span class="keywordflow">for</span> (i=0; i&lt;n_vecs; ++i) {</div>
<div class="line"><span class="lineno">  764</span>        <span class="keywordflow">if</span> (!chain)</div>
<div class="line"><span class="lineno">  765</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  766</span>        <span class="keywordflow">if</span> (vec[i].iov_base != (<span class="keywordtype">void</span> *)<a class="code hl_define" href="libevent_2buffer_8c.html#a17846db51ec6b10c559ec8af1b30e379">CHAIN_SPACE_PTR</a>(chain) ||</div>
<div class="line"><span class="lineno">  767</span>            (<span class="keywordtype">size_t</span>)vec[i].iov_len &gt; <a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(chain))</div>
<div class="line"><span class="lineno">  768</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  769</span>        chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno">  770</span>    }</div>
<div class="line"><span class="lineno">  771</span>    <span class="comment">/* pass 2: actually adjust all the chains. */</span></div>
<div class="line"><span class="lineno">  772</span>    chainp = firstchainp;</div>
<div class="line"><span class="lineno">  773</span>    <span class="keywordflow">for</span> (i=0; i&lt;n_vecs; ++i) {</div>
<div class="line"><span class="lineno">  774</span>        (*chainp)-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> += vec[i].iov_len;</div>
<div class="line"><span class="lineno">  775</span>        added += vec[i].iov_len;</div>
<div class="line"><span class="lineno">  776</span>        <span class="keywordflow">if</span> (vec[i].iov_len) {</div>
<div class="line"><span class="lineno">  777</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = chainp;</div>
<div class="line"><span class="lineno">  778</span>        }</div>
<div class="line"><span class="lineno">  779</span>        chainp = &amp;(*chainp)-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno">  780</span>    }</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span>okay:</div>
<div class="line"><span class="lineno">  783</span>    buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> += added;</div>
<div class="line"><span class="lineno">  784</span>    buf-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += added;</div>
<div class="line"><span class="lineno">  785</span>    result = 0;</div>
<div class="line"><span class="lineno">  786</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a>(buf);</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  788</span>done:</div>
<div class="line"><span class="lineno">  789</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno">  790</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  791</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00704">advance_last_with_data()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00130">CHAIN_SPACE_LEN</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00129">CHAIN_SPACE_PTR</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00514">evbuffer_invoke_callbacks_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00123">evbuffer::freeze_end</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00084">evbuffer::last</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00106">evbuffer::n_add_for_cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__openssl_8c_source.html#l00584">do_read()</a>.</p>

</div>
</div>
<a id="a8fa753475570f6529691ef8484cacc1b" name="a8fa753475570f6529691ef8484cacc1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fa753475570f6529691ef8484cacc1b">&#9670;&nbsp;</a></span>evbuffer_copyout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ev_ssize_t evbuffer_copyout </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01184">1184</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1185</span>{</div>
<div class="line"><span class="lineno"> 1186</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="libevent_2buffer_8c.html#ac88bba444ce768f5e3e4cf38e48381ab">evbuffer_copyout_from</a>(buf, NULL, data_out, datlen);</div>
<div class="line"><span class="lineno"> 1187</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_ac88bba444ce768f5e3e4cf38e48381ab"><div class="ttname"><a href="libevent_2buffer_8c.html#ac88bba444ce768f5e3e4cf38e48381ab">evbuffer_copyout_from</a></div><div class="ttdeci">ev_ssize_t evbuffer_copyout_from(struct evbuffer *buf, const struct evbuffer_ptr *pos, void *data_out, size_t datlen)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01190">buffer.c:1190</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l01190">evbuffer_copyout_from()</a>.</p>

<p class="reference">Referenced by <a class="el" href="net_8c_source.html#l00120">read_cb()</a>.</p>

</div>
</div>
<a id="ac88bba444ce768f5e3e4cf38e48381ab" name="ac88bba444ce768f5e3e4cf38e48381ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac88bba444ce768f5e3e4cf38e48381ab">&#9670;&nbsp;</a></span>evbuffer_copyout_from()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ev_ssize_t evbuffer_copyout_from </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct evbuffer_ptr *&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01190">1190</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1192</span>{</div>
<div class="line"><span class="lineno"> 1193</span>    <span class="comment">/*XXX fails badly on sendfile case. */</span></div>
<div class="line"><span class="lineno"> 1194</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain;</div>
<div class="line"><span class="lineno"> 1195</span>    <span class="keywordtype">char</span> *data = data_out;</div>
<div class="line"><span class="lineno"> 1196</span>    <span class="keywordtype">size_t</span> nread;</div>
<div class="line"><span class="lineno"> 1197</span>    ev_ssize_t result = 0;</div>
<div class="line"><span class="lineno"> 1198</span>    <span class="keywordtype">size_t</span> pos_in_chain;</div>
<div class="line"><span class="lineno"> 1199</span> </div>
<div class="line"><span class="lineno"> 1200</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 1201</span> </div>
<div class="line"><span class="lineno"> 1202</span>    <span class="keywordflow">if</span> (pos) {</div>
<div class="line"><span class="lineno"> 1203</span>        <span class="keywordflow">if</span> (datlen &gt; (<span class="keywordtype">size_t</span>)(EV_SSIZE_MAX - pos-&gt;pos)) {</div>
<div class="line"><span class="lineno"> 1204</span>            result = -1;</div>
<div class="line"><span class="lineno"> 1205</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1206</span>        }</div>
<div class="line"><span class="lineno"> 1207</span>        chain = pos-&gt;internal_.chain;</div>
<div class="line"><span class="lineno"> 1208</span>        pos_in_chain = pos-&gt;internal_.pos_in_chain;</div>
<div class="line"><span class="lineno"> 1209</span>        <span class="keywordflow">if</span> (datlen + pos-&gt;pos &gt; buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>)</div>
<div class="line"><span class="lineno"> 1210</span>            datlen = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> - pos-&gt;pos;</div>
<div class="line"><span class="lineno"> 1211</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1212</span>        chain = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno"> 1213</span>        pos_in_chain = 0;</div>
<div class="line"><span class="lineno"> 1214</span>        <span class="keywordflow">if</span> (datlen &gt; buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>)</div>
<div class="line"><span class="lineno"> 1215</span>            datlen = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>;</div>
<div class="line"><span class="lineno"> 1216</span>    }</div>
<div class="line"><span class="lineno"> 1217</span> </div>
<div class="line"><span class="lineno"> 1218</span> </div>
<div class="line"><span class="lineno"> 1219</span>    <span class="keywordflow">if</span> (datlen == 0)</div>
<div class="line"><span class="lineno"> 1220</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1221</span> </div>
<div class="line"><span class="lineno"> 1222</span>    <span class="keywordflow">if</span> (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a082d569d992120cf9ff28ddb0f5da313">freeze_start</a>) {</div>
<div class="line"><span class="lineno"> 1223</span>        result = -1;</div>
<div class="line"><span class="lineno"> 1224</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1225</span>    }</div>
<div class="line"><span class="lineno"> 1226</span> </div>
<div class="line"><span class="lineno"> 1227</span>    nread = datlen;</div>
<div class="line"><span class="lineno"> 1228</span> </div>
<div class="line"><span class="lineno"> 1229</span>    <span class="keywordflow">while</span> (datlen &amp;&amp; datlen &gt;= chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> - pos_in_chain) {</div>
<div class="line"><span class="lineno"> 1230</span>        <span class="keywordtype">size_t</span> copylen = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> - pos_in_chain;</div>
<div class="line"><span class="lineno"> 1231</span>        memcpy(data,</div>
<div class="line"><span class="lineno"> 1232</span>            chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> + pos_in_chain,</div>
<div class="line"><span class="lineno"> 1233</span>            copylen);</div>
<div class="line"><span class="lineno"> 1234</span>        data += copylen;</div>
<div class="line"><span class="lineno"> 1235</span>        datlen -= copylen;</div>
<div class="line"><span class="lineno"> 1236</span> </div>
<div class="line"><span class="lineno"> 1237</span>        chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 1238</span>        pos_in_chain = 0;</div>
<div class="line"><span class="lineno"> 1239</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(chain || datlen==0);</div>
<div class="line"><span class="lineno"> 1240</span>    }</div>
<div class="line"><span class="lineno"> 1241</span> </div>
<div class="line"><span class="lineno"> 1242</span>    <span class="keywordflow">if</span> (datlen) {</div>
<div class="line"><span class="lineno"> 1243</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(chain);</div>
<div class="line"><span class="lineno"> 1244</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(datlen+pos_in_chain &lt;= chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>);</div>
<div class="line"><span class="lineno"> 1245</span> </div>
<div class="line"><span class="lineno"> 1246</span>        memcpy(data, chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> + pos_in_chain,</div>
<div class="line"><span class="lineno"> 1247</span>            datlen);</div>
<div class="line"><span class="lineno"> 1248</span>    }</div>
<div class="line"><span class="lineno"> 1249</span> </div>
<div class="line"><span class="lineno"> 1250</span>    result = nread;</div>
<div class="line"><span class="lineno"> 1251</span>done:</div>
<div class="line"><span class="lineno"> 1252</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 1253</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 1254</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00120">evbuffer::freeze_start</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01184">evbuffer_copyout()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l01170">evbuffer_remove()</a>.</p>

</div>
</div>
<a id="a3ac07b1be4b6fe0b2aa6a1677b060a80" name="a3ac07b1be4b6fe0b2aa6a1677b060a80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ac07b1be4b6fe0b2aa6a1677b060a80">&#9670;&nbsp;</a></span>evbuffer_decref_and_unlock_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evbuffer_decref_and_unlock_ </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >As evbuffer_free, but requires that we hold a lock on the buffer, and releases the lock before freeing it and the buffer. </p>

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00561">561</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  562</span>{</div>
<div class="line"><span class="lineno">  563</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain, *<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno">  564</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;refcnt &gt; 0);</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>    <span class="keywordflow">if</span> (--<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;refcnt &gt; 0) {</div>
<div class="line"><span class="lineno">  569</span>        <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  570</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  571</span>    }</div>
<div class="line"><span class="lineno">  572</span> </div>
<div class="line"><span class="lineno">  573</span>    <span class="keywordflow">for</span> (chain = <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;first; chain != NULL; chain = <a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>) {</div>
<div class="line"><span class="lineno">  574</span>        <a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno">  575</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a7acdd31f1b39fc7c74f58103b23b6b0a">evbuffer_chain_free</a>(chain);</div>
<div class="line"><span class="lineno">  576</span>    }</div>
<div class="line"><span class="lineno">  577</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a8baa73c3690e47a1e2b5af4e069c3f68">evbuffer_remove_all_callbacks</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  578</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;deferred_cbs)</div>
<div class="line"><span class="lineno">  579</span>        <a class="code hl_function" href="defer-internal_8h.html#aae154198179f3170689c8d80ff6dc549">event_deferred_cb_cancel_</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;cb_queue, &amp;<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;deferred);</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  582</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;own_lock)</div>
<div class="line"><span class="lineno">  583</span>        <a class="code hl_define" href="evthread-internal_8h.html#a56d74d4600adf793a2411f26db03ca71">EVTHREAD_FREE_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;lock, EVTHREAD_LOCKTYPE_RECURSIVE);</div>
<div class="line"><span class="lineno">  584</span>    <a class="code hl_define" href="mm-internal_8h.html#af7d87798652aaa8398bb9c0504256f16">mm_free</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  585</span>}</div>
<div class="ttc" id="adefer-internal_8h_html_aae154198179f3170689c8d80ff6dc549"><div class="ttname"><a href="defer-internal_8h.html#aae154198179f3170689c8d80ff6dc549">event_deferred_cb_cancel_</a></div><div class="ttdeci">EVENT2_EXPORT_SYMBOL void event_deferred_cb_cancel_(struct event_base *, struct event_callback *)</div><div class="ttdef"><b>Definition:</b> <a href="event_8c_source.html#l03115">event.c:3115</a></div></div>
<div class="ttc" id="aevthread-internal_8h_html_a56d74d4600adf793a2411f26db03ca71"><div class="ttname"><a href="evthread-internal_8h.html#a56d74d4600adf793a2411f26db03ca71">EVTHREAD_FREE_LOCK</a></div><div class="ttdeci">#define EVTHREAD_FREE_LOCK(lockvar, locktype)</div><div class="ttdef"><b>Definition:</b> <a href="evthread-internal_8h_source.html#l00085">evthread-internal.h:85</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a8baa73c3690e47a1e2b5af4e069c3f68"><div class="ttname"><a href="libevent_2buffer_8c.html#a8baa73c3690e47a1e2b5af4e069c3f68">evbuffer_remove_all_callbacks</a></div><div class="ttdeci">static void evbuffer_remove_all_callbacks(struct evbuffer *buffer)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00550">buffer.c:550</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00282">ASSERT_EVBUFFER_LOCKED</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00196">evbuffer_chain_free()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00550">evbuffer_remove_all_callbacks()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="event_8c_source.html#l03115">event_deferred_cb_cancel_()</a>, <a class="el" href="evthread-internal_8h_source.html#l00085">EVTHREAD_FREE_LOCK</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="mm-internal_8h_source.html#l00079">mm_free</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00196">evbuffer_chain_free()</a>, <a class="el" href="buffer__iocp_8c_source.html#l00098">evbuffer_commit_read_()</a>, <a class="el" href="buffer__iocp_8c_source.html#l00139">evbuffer_commit_write_()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00534">evbuffer_deferred_callback()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00588">evbuffer_free()</a>.</p>

</div>
</div>
<a id="a1c99c484430a81e641a783a273435074" name="a1c99c484430a81e641a783a273435074"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c99c484430a81e641a783a273435074">&#9670;&nbsp;</a></span>evbuffer_defer_callbacks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_defer_callbacks </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevent__base.html">event_base</a> *&#160;</td>
          <td class="paramname"><em>base</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00411">411</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  412</span>{</div>
<div class="line"><span class="lineno">  413</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  414</span>    <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;cb_queue = base;</div>
<div class="line"><span class="lineno">  415</span>    <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;deferred_cbs = 1;</div>
<div class="line"><span class="lineno">  416</span>    <a class="code hl_function" href="defer-internal_8h.html#a05493e0a054f59adb06d4d3f7b152ba3">event_deferred_cb_init_</a>(&amp;<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;deferred,</div>
<div class="line"><span class="lineno">  417</span>        <a class="code hl_function" href="event_8c.html#a69fcc6b3b1ed8435f0e500aee8ef2fb7">event_base_get_npriorities</a>(base) / 2,</div>
<div class="line"><span class="lineno">  418</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a69bf3e1c3d322c805036c31cf2b81e41">evbuffer_deferred_callback</a>, <a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  419</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  420</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  421</span>}</div>
<div class="ttc" id="adefer-internal_8h_html_a05493e0a054f59adb06d4d3f7b152ba3"><div class="ttname"><a href="defer-internal_8h.html#a05493e0a054f59adb06d4d3f7b152ba3">event_deferred_cb_init_</a></div><div class="ttdeci">EVENT2_EXPORT_SYMBOL void event_deferred_cb_init_(struct event_callback *, ev_uint8_t, deferred_cb_fn, void *)</div><div class="ttdef"><b>Definition:</b> <a href="event_8c_source.html#l03099">event.c:3099</a></div></div>
<div class="ttc" id="aevent_8c_html_a69fcc6b3b1ed8435f0e500aee8ef2fb7"><div class="ttname"><a href="event_8c.html#a69fcc6b3b1ed8435f0e500aee8ef2fb7">event_base_get_npriorities</a></div><div class="ttdeci">int event_base_get_npriorities(struct event_base *base)</div><div class="ttdef"><b>Definition:</b> <a href="event_8c_source.html#l01280">event.c:1280</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a69bf3e1c3d322c805036c31cf2b81e41"><div class="ttname"><a href="libevent_2buffer_8c.html#a69bf3e1c3d322c805036c31cf2b81e41">evbuffer_deferred_callback</a></div><div class="ttdeci">static void evbuffer_deferred_callback(struct event_callback *cb, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00534">buffer.c:534</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00534">evbuffer_deferred_callback()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="event_8c_source.html#l01280">event_base_get_npriorities()</a>, and <a class="el" href="event_8c_source.html#l03099">event_deferred_cb_init_()</a>.</p>

</div>
</div>
<a id="a69bf3e1c3d322c805036c31cf2b81e41" name="a69bf3e1c3d322c805036c31cf2b81e41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69bf3e1c3d322c805036c31cf2b81e41">&#9670;&nbsp;</a></span>evbuffer_deferred_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void evbuffer_deferred_callback </td>
          <td>(</td>
          <td class="paramtype">struct event_callback *&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00534">534</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  535</span>{</div>
<div class="line"><span class="lineno">  536</span>    <span class="keyword">struct </span>bufferevent *parent = NULL;</div>
<div class="line"><span class="lineno">  537</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer.html">evbuffer</a> *<a class="code hl_struct" href="structbuffer.html">buffer</a> = arg;</div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span>    <span class="comment">/* XXXX It would be better to run these callbacks without holding the</span></div>
<div class="line"><span class="lineno">  540</span><span class="comment">     * lock */</span></div>
<div class="line"><span class="lineno">  541</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  542</span>    <a class="code hl_variable" href="structevbuffer.html#acc2fc2823057650c10b7133a8282d153">parent</a> = <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;parent;</div>
<div class="line"><span class="lineno">  543</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a9498833b7740ef5ea694a18ad9bf4c07">evbuffer_run_callbacks</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, 1);</div>
<div class="line"><span class="lineno">  544</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a3ac07b1be4b6fe0b2aa6a1677b060a80">evbuffer_decref_and_unlock_</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  545</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structevbuffer.html#acc2fc2823057650c10b7133a8282d153">parent</a>)</div>
<div class="line"><span class="lineno">  546</span>        <a class="code hl_define" href="bufferevent-internal_8h.html#a5e7a671d0202af28d615f047da82ad67">bufferevent_decref_</a>(<a class="code hl_variable" href="structevbuffer.html#acc2fc2823057650c10b7133a8282d153">parent</a>);</div>
<div class="line"><span class="lineno">  547</span>}</div>
<div class="ttc" id="abufferevent-internal_8h_html_a5e7a671d0202af28d615f047da82ad67"><div class="ttname"><a href="bufferevent-internal_8h.html#a5e7a671d0202af28d615f047da82ad67">bufferevent_decref_</a></div><div class="ttdeci">#define bufferevent_decref_(bufev)</div><div class="ttdef"><b>Definition:</b> <a href="bufferevent-internal_8h_source.html#l00377">bufferevent-internal.h:377</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a9498833b7740ef5ea694a18ad9bf4c07"><div class="ttname"><a href="libevent_2buffer_8c.html#a9498833b7740ef5ea694a18ad9bf4c07">evbuffer_run_callbacks</a></div><div class="ttdeci">static void evbuffer_run_callbacks(struct evbuffer *buffer, int running_deferred)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00456">buffer.c:456</a></div></div>
<div class="ttc" id="astructevbuffer_html"><div class="ttname"><a href="structevbuffer.html">evbuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00080">evbuffer-internal.h:80</a></div></div>
<div class="ttc" id="astructevbuffer_html_acc2fc2823057650c10b7133a8282d153"><div class="ttname"><a href="structevbuffer.html#acc2fc2823057650c10b7133a8282d153">evbuffer::parent</a></div><div class="ttdeci">struct bufferevent * parent</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00155">evbuffer-internal.h:155</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="bufferevent-internal_8h_source.html#l00377">bufferevent_decref_</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00561">evbuffer_decref_and_unlock_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00456">evbuffer_run_callbacks()</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00155">evbuffer::parent</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00411">evbuffer_defer_callbacks()</a>.</p>

</div>
</div>
<a id="a5c24f3bfbc941d693bf59b5d77d2c37f" name="a5c24f3bfbc941d693bf59b5d77d2c37f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c24f3bfbc941d693bf59b5d77d2c37f">&#9670;&nbsp;</a></span>evbuffer_drain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_drain </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01101">1101</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1102</span>{</div>
<div class="line"><span class="lineno"> 1103</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain, *<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 1104</span>    <span class="keywordtype">size_t</span> remaining, old_len;</div>
<div class="line"><span class="lineno"> 1105</span>    <span class="keywordtype">int</span> result = 0;</div>
<div class="line"><span class="lineno"> 1106</span> </div>
<div class="line"><span class="lineno"> 1107</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 1108</span>    old_len = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>;</div>
<div class="line"><span class="lineno"> 1109</span> </div>
<div class="line"><span class="lineno"> 1110</span>    <span class="keywordflow">if</span> (old_len == 0)</div>
<div class="line"><span class="lineno"> 1111</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span>    <span class="keywordflow">if</span> (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a082d569d992120cf9ff28ddb0f5da313">freeze_start</a>) {</div>
<div class="line"><span class="lineno"> 1114</span>        result = -1;</div>
<div class="line"><span class="lineno"> 1115</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1116</span>    }</div>
<div class="line"><span class="lineno"> 1117</span> </div>
<div class="line"><span class="lineno"> 1118</span>    <span class="keywordflow">if</span> (len &gt;= old_len &amp;&amp; !<a class="code hl_function" href="libevent_2buffer_8c.html#a1791544d9552594ef60983b83b13f3a8">HAS_PINNED_R</a>(buf)) {</div>
<div class="line"><span class="lineno"> 1119</span>        len = old_len;</div>
<div class="line"><span class="lineno"> 1120</span>        <span class="keywordflow">for</span> (chain = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>; chain != NULL; chain = <a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>) {</div>
<div class="line"><span class="lineno"> 1121</span>            <a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 1122</span>            <a class="code hl_function" href="libevent_2buffer_8c.html#a7acdd31f1b39fc7c74f58103b23b6b0a">evbuffer_chain_free</a>(chain);</div>
<div class="line"><span class="lineno"> 1123</span>        }</div>
<div class="line"><span class="lineno"> 1124</span> </div>
<div class="line"><span class="lineno"> 1125</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a11161d984ed671f309bb410de5acff51">ZERO_CHAIN</a>(buf);</div>
<div class="line"><span class="lineno"> 1126</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1127</span>        <span class="keywordflow">if</span> (len &gt;= old_len)</div>
<div class="line"><span class="lineno"> 1128</span>            len = old_len;</div>
<div class="line"><span class="lineno"> 1129</span> </div>
<div class="line"><span class="lineno"> 1130</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> -= len;</div>
<div class="line"><span class="lineno"> 1131</span>        remaining = len;</div>
<div class="line"><span class="lineno"> 1132</span>        <span class="keywordflow">for</span> (chain = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno"> 1133</span>             remaining &gt;= chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 1134</span>             chain = <a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>) {</div>
<div class="line"><span class="lineno"> 1135</span>            <a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 1136</span>            remaining -= chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span>            <span class="keywordflow">if</span> (chain == *buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>) {</div>
<div class="line"><span class="lineno"> 1139</span>                buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = &amp;buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno"> 1140</span>            }</div>
<div class="line"><span class="lineno"> 1141</span>            <span class="keywordflow">if</span> (&amp;chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> == buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>)</div>
<div class="line"><span class="lineno"> 1142</span>                buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = &amp;buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno"> 1143</span> </div>
<div class="line"><span class="lineno"> 1144</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="libevent_2buffer_8c.html#ae415a92292709e1ae7eac7ebcebce494">CHAIN_PINNED_R</a>(chain)) {</div>
<div class="line"><span class="lineno"> 1145</span>                <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(remaining == 0);</div>
<div class="line"><span class="lineno"> 1146</span>                chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> += chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 1147</span>                chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = 0;</div>
<div class="line"><span class="lineno"> 1148</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1149</span>            } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1150</span>                <a class="code hl_function" href="libevent_2buffer_8c.html#a7acdd31f1b39fc7c74f58103b23b6b0a">evbuffer_chain_free</a>(chain);</div>
<div class="line"><span class="lineno"> 1151</span>        }</div>
<div class="line"><span class="lineno"> 1152</span> </div>
<div class="line"><span class="lineno"> 1153</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a> = chain;</div>
<div class="line"><span class="lineno"> 1154</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(remaining &lt;= chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>);</div>
<div class="line"><span class="lineno"> 1155</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> += remaining;</div>
<div class="line"><span class="lineno"> 1156</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> -= remaining;</div>
<div class="line"><span class="lineno"> 1157</span>    }</div>
<div class="line"><span class="lineno"> 1158</span> </div>
<div class="line"><span class="lineno"> 1159</span>    buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a5f4fd4011a0461e5fbee4e417031a960">n_del_for_cb</a> += len;</div>
<div class="line"><span class="lineno"> 1160</span>    <span class="comment">/* Tell someone about changes in this buffer */</span></div>
<div class="line"><span class="lineno"> 1161</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a>(buf);</div>
<div class="line"><span class="lineno"> 1162</span> </div>
<div class="line"><span class="lineno"> 1163</span>done:</div>
<div class="line"><span class="lineno"> 1164</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 1165</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 1166</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a11161d984ed671f309bb410de5acff51"><div class="ttname"><a href="libevent_2buffer_8c.html#a11161d984ed671f309bb410de5acff51">ZERO_CHAIN</a></div><div class="ttdeci">static void ZERO_CHAIN(struct evbuffer *dst)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00800">buffer.c:800</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a1791544d9552594ef60983b83b13f3a8"><div class="ttname"><a href="libevent_2buffer_8c.html#a1791544d9552594ef60983b83b13f3a8">HAS_PINNED_R</a></div><div class="ttdeci">static int HAS_PINNED_R(struct evbuffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00794">buffer.c:794</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_ae415a92292709e1ae7eac7ebcebce494"><div class="ttname"><a href="libevent_2buffer_8c.html#ae415a92292709e1ae7eac7ebcebce494">CHAIN_PINNED_R</a></div><div class="ttdeci">#define CHAIN_PINNED_R(ch)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00134">buffer.c:134</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00134">CHAIN_PINNED_R</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00196">evbuffer_chain_free()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00514">evbuffer_invoke_callbacks_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00120">evbuffer::freeze_start</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00794">HAS_PINNED_R()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00109">evbuffer::n_del_for_cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00800">ZERO_CHAIN()</a>.</p>

<p class="reference">Referenced by <a class="el" href="event__tagging_8c_source.html#l00201">decode_tag_internal()</a>, <a class="el" href="bufferevent__openssl_8c_source.html#l00654">do_write()</a>, <a class="el" href="buffer__iocp_8c_source.html#l00139">evbuffer_commit_write_()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01687">evbuffer_readln()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01170">evbuffer_remove()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02524">evbuffer_write_atmost()</a>, <a class="el" href="http_8c_source.html#l01455">evhttp_connection_read_on_write_error()</a>, <a class="el" href="http_8c_source.html#l01330">evhttp_connection_reset_()</a>, <a class="el" href="http_8c_source.html#l00906">evhttp_handle_chunked_read()</a>, <a class="el" href="http_8c_source.html#l01018">evhttp_lingering_close()</a>, <a class="el" href="http_8c_source.html#l01047">evhttp_read_body()</a>, <a class="el" href="event__tagging_8c_source.html#l00458">evtag_consume()</a>, <a class="el" href="event__tagging_8c_source.html#l00380">evtag_decode_int()</a>, <a class="el" href="event__tagging_8c_source.html#l00390">evtag_decode_int64()</a>, <a class="el" href="event__tagging_8c_source.html#l00471">evtag_unmarshal()</a>, <a class="el" href="event__tagging_8c_source.html#l00489">evtag_unmarshal_int()</a>, <a class="el" href="event__tagging_8c_source.html#l00515">evtag_unmarshal_int64()</a>, <a class="el" href="event__tagging_8c_source.html#l00584">evtag_unmarshal_timeval()</a>, and <a class="el" href="net_8c_source.html#l00120">read_cb()</a>.</p>

</div>
</div>
<a id="a1bf21d715f288541eb670c5f159f2264" name="a1bf21d715f288541eb670c5f159f2264"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bf21d715f288541eb670c5f159f2264">&#9670;&nbsp;</a></span>evbuffer_enable_locking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_enable_locking </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>lock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00424">424</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  425</span>{</div>
<div class="line"><span class="lineno">  426</span><span class="preprocessor">#ifdef EVENT__DISABLE_THREAD_SUPPORT</span></div>
<div class="line"><span class="lineno">  427</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  428</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  429</span>    <span class="keywordflow">if</span> (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a23672b71d57713bae7652e4109dc9e73">lock</a>)</div>
<div class="line"><span class="lineno">  430</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>    <span class="keywordflow">if</span> (!lock) {</div>
<div class="line"><span class="lineno">  433</span>        <a class="code hl_define" href="evthread-internal_8h.html#a69a6ff948a58db53633b42d071682635">EVTHREAD_ALLOC_LOCK</a>(lock, EVTHREAD_LOCKTYPE_RECURSIVE);</div>
<div class="line"><span class="lineno">  434</span>        <span class="keywordflow">if</span> (!lock)</div>
<div class="line"><span class="lineno">  435</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  436</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a23672b71d57713bae7652e4109dc9e73">lock</a> = lock;</div>
<div class="line"><span class="lineno">  437</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a188a8ed665c96f3c318d752a06870cdb">own_lock</a> = 1;</div>
<div class="line"><span class="lineno">  438</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  439</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a23672b71d57713bae7652e4109dc9e73">lock</a> = lock;</div>
<div class="line"><span class="lineno">  440</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a188a8ed665c96f3c318d752a06870cdb">own_lock</a> = 0;</div>
<div class="line"><span class="lineno">  441</span>    }</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  444</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  445</span>}</div>
<div class="ttc" id="aevthread-internal_8h_html_a69a6ff948a58db53633b42d071682635"><div class="ttname"><a href="evthread-internal_8h.html#a69a6ff948a58db53633b42d071682635">EVTHREAD_ALLOC_LOCK</a></div><div class="ttdeci">#define EVTHREAD_ALLOC_LOCK(lockvar, locktype)</div><div class="ttdef"><b>Definition:</b> <a href="evthread-internal_8h_source.html#l00080">evthread-internal.h:80</a></div></div>
<div class="ttc" id="astructevbuffer_html_a188a8ed665c96f3c318d752a06870cdb"><div class="ttname"><a href="structevbuffer.html#a188a8ed665c96f3c318d752a06870cdb">evbuffer::own_lock</a></div><div class="ttdeci">unsigned own_lock</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00117">evbuffer-internal.h:117</a></div></div>
<div class="ttc" id="astructevbuffer_html_a23672b71d57713bae7652e4109dc9e73"><div class="ttname"><a href="structevbuffer.html#a23672b71d57713bae7652e4109dc9e73">evbuffer::lock</a></div><div class="ttdeci">void * lock</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00113">evbuffer-internal.h:113</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evthread-internal_8h_source.html#l00080">EVTHREAD_ALLOC_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00113">evbuffer::lock</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00117">evbuffer::own_lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent_8c_source.html#l00829">bufferevent_enable_locking_()</a>.</p>

</div>
</div>
<a id="a305caf7b9bfb8713e6ef383d61791f95" name="a305caf7b9bfb8713e6ef383d61791f95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a305caf7b9bfb8713e6ef383d61791f95">&#9670;&nbsp;</a></span>evbuffer_expand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_expand </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02161">2161</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2162</span>{</div>
<div class="line"><span class="lineno"> 2163</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain;</div>
<div class="line"><span class="lineno"> 2164</span> </div>
<div class="line"><span class="lineno"> 2165</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 2166</span>    chain = <a class="code hl_function" href="libevent_2buffer_8c.html#af29382773b8c1cbe484de86282e6fb87">evbuffer_expand_singlechain</a>(buf, datlen);</div>
<div class="line"><span class="lineno"> 2167</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 2168</span>    <span class="keywordflow">return</span> chain ? 0 : -1;</div>
<div class="line"><span class="lineno"> 2169</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l01939">evbuffer_expand_singlechain()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>.</p>

</div>
</div>
<a id="a0169295592d02008ef6229de9ba8a79b" name="a0169295592d02008ef6229de9ba8a79b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0169295592d02008ef6229de9ba8a79b">&#9670;&nbsp;</a></span>evbuffer_expand_fast_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_expand_fast_ </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >As evbuffer_expand, but does not guarantee that the newly allocated memory is contiguous. Instead, it may be split across two or more chunks. </p>

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02051">2051</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2052</span>{</div>
<div class="line"><span class="lineno"> 2053</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a>, *tmp, *<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 2054</span>    <span class="keywordtype">size_t</span> avail;</div>
<div class="line"><span class="lineno"> 2055</span>    <span class="keywordtype">int</span> used;</div>
<div class="line"><span class="lineno"> 2056</span> </div>
<div class="line"><span class="lineno"> 2057</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(buf);</div>
<div class="line"><span class="lineno"> 2058</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(n &gt;= 2);</div>
<div class="line"><span class="lineno"> 2059</span> </div>
<div class="line"><span class="lineno"> 2060</span>    <span class="keywordflow">if</span> (chain == NULL || (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp; <a class="code hl_define" href="evbuffer-internal_8h.html#a93af71b521a359f90fce52d1cf9f49c5">EVBUFFER_IMMUTABLE</a>)) {</div>
<div class="line"><span class="lineno"> 2061</span>        <span class="comment">/* There is no last chunk, or we can&#39;t touch the last chunk.</span></div>
<div class="line"><span class="lineno"> 2062</span><span class="comment">         * Just add a new chunk. */</span></div>
<div class="line"><span class="lineno"> 2063</span>        chain = <a class="code hl_function" href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a>(datlen);</div>
<div class="line"><span class="lineno"> 2064</span>        <span class="keywordflow">if</span> (chain == NULL)</div>
<div class="line"><span class="lineno"> 2065</span>            <span class="keywordflow">return</span> (-1);</div>
<div class="line"><span class="lineno"> 2066</span> </div>
<div class="line"><span class="lineno"> 2067</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#abb1ffdb88a9aa9e2b114d98832dfda16">evbuffer_chain_insert</a>(buf, chain);</div>
<div class="line"><span class="lineno"> 2068</span>        <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno"> 2069</span>    }</div>
<div class="line"><span class="lineno"> 2070</span> </div>
<div class="line"><span class="lineno"> 2071</span>    used = 0; <span class="comment">/* number of chains we&#39;re using space in. */</span></div>
<div class="line"><span class="lineno"> 2072</span>    avail = 0; <span class="comment">/* how much space they have. */</span></div>
<div class="line"><span class="lineno"> 2073</span>    <span class="comment">/* How many bytes can we stick at the end of buffer as it is?  Iterate</span></div>
<div class="line"><span class="lineno"> 2074</span><span class="comment">     * over the chains at the end of the buffer, tring to see how much</span></div>
<div class="line"><span class="lineno"> 2075</span><span class="comment">     * space we have in the first n. */</span></div>
<div class="line"><span class="lineno"> 2076</span>    <span class="keywordflow">for</span> (chain = *buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>; chain; chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>) {</div>
<div class="line"><span class="lineno"> 2077</span>        <span class="keywordflow">if</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>) {</div>
<div class="line"><span class="lineno"> 2078</span>            <span class="keywordtype">size_t</span> space = (size_t) <a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(chain);</div>
<div class="line"><span class="lineno"> 2079</span>            <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(chain == *buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>);</div>
<div class="line"><span class="lineno"> 2080</span>            <span class="keywordflow">if</span> (space) {</div>
<div class="line"><span class="lineno"> 2081</span>                avail += space;</div>
<div class="line"><span class="lineno"> 2082</span>                ++used;</div>
<div class="line"><span class="lineno"> 2083</span>            }</div>
<div class="line"><span class="lineno"> 2084</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2085</span>            <span class="comment">/* No data in chain; realign it. */</span></div>
<div class="line"><span class="lineno"> 2086</span>            chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> = 0;</div>
<div class="line"><span class="lineno"> 2087</span>            avail += chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a>;</div>
<div class="line"><span class="lineno"> 2088</span>            ++used;</div>
<div class="line"><span class="lineno"> 2089</span>        }</div>
<div class="line"><span class="lineno"> 2090</span>        <span class="keywordflow">if</span> (avail &gt;= datlen) {</div>
<div class="line"><span class="lineno"> 2091</span>            <span class="comment">/* There is already enough space.  Just return */</span></div>
<div class="line"><span class="lineno"> 2092</span>            <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno"> 2093</span>        }</div>
<div class="line"><span class="lineno"> 2094</span>        <span class="keywordflow">if</span> (used == n)</div>
<div class="line"><span class="lineno"> 2095</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2096</span>    }</div>
<div class="line"><span class="lineno"> 2097</span> </div>
<div class="line"><span class="lineno"> 2098</span>    <span class="comment">/* There wasn&#39;t enough space in the first n chains with space in</span></div>
<div class="line"><span class="lineno"> 2099</span><span class="comment">     * them. Either add a new chain with enough space, or replace all</span></div>
<div class="line"><span class="lineno"> 2100</span><span class="comment">     * empty chains with one that has enough space, depending on n. */</span></div>
<div class="line"><span class="lineno"> 2101</span>    <span class="keywordflow">if</span> (used &lt; n) {</div>
<div class="line"><span class="lineno"> 2102</span>        <span class="comment">/* The loop ran off the end of the chains before it hit n</span></div>
<div class="line"><span class="lineno"> 2103</span><span class="comment">         * chains; we can add another. */</span></div>
<div class="line"><span class="lineno"> 2104</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(chain == NULL);</div>
<div class="line"><span class="lineno"> 2105</span> </div>
<div class="line"><span class="lineno"> 2106</span>        tmp = <a class="code hl_function" href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a>(datlen - avail);</div>
<div class="line"><span class="lineno"> 2107</span>        <span class="keywordflow">if</span> (tmp == NULL)</div>
<div class="line"><span class="lineno"> 2108</span>            <span class="keywordflow">return</span> (-1);</div>
<div class="line"><span class="lineno"> 2109</span> </div>
<div class="line"><span class="lineno"> 2110</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a>-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> = tmp;</div>
<div class="line"><span class="lineno"> 2111</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> = tmp;</div>
<div class="line"><span class="lineno"> 2112</span>        <span class="comment">/* (we would only set last_with_data if we added the first</span></div>
<div class="line"><span class="lineno"> 2113</span><span class="comment">         * chain. But if the buffer had no chains, we would have</span></div>
<div class="line"><span class="lineno"> 2114</span><span class="comment">         * just allocated a new chain earlier) */</span></div>
<div class="line"><span class="lineno"> 2115</span>        <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno"> 2116</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2117</span>        <span class="comment">/* Nuke _all_ the empty chains. */</span></div>
<div class="line"><span class="lineno"> 2118</span>        <span class="keywordtype">int</span> rmv_all = 0; <span class="comment">/* True iff we removed last_with_data. */</span></div>
<div class="line"><span class="lineno"> 2119</span>        chain = *buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>;</div>
<div class="line"><span class="lineno"> 2120</span>        <span class="keywordflow">if</span> (!chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>) {</div>
<div class="line"><span class="lineno"> 2121</span>            <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(chain == buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>);</div>
<div class="line"><span class="lineno"> 2122</span>            rmv_all = 1;</div>
<div class="line"><span class="lineno"> 2123</span>            avail = 0;</div>
<div class="line"><span class="lineno"> 2124</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2125</span>            <span class="comment">/* can&#39;t overflow, since only mutable chains have</span></div>
<div class="line"><span class="lineno"> 2126</span><span class="comment">             * huge misaligns. */</span></div>
<div class="line"><span class="lineno"> 2127</span>            avail = (size_t) <a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(chain);</div>
<div class="line"><span class="lineno"> 2128</span>            chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 2129</span>        }</div>
<div class="line"><span class="lineno"> 2130</span> </div>
<div class="line"><span class="lineno"> 2131</span> </div>
<div class="line"><span class="lineno"> 2132</span>        <span class="keywordflow">for</span> (; chain; chain = <a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>) {</div>
<div class="line"><span class="lineno"> 2133</span>            <a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 2134</span>            <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> == 0);</div>
<div class="line"><span class="lineno"> 2135</span>            <a class="code hl_function" href="libevent_2buffer_8c.html#a7acdd31f1b39fc7c74f58103b23b6b0a">evbuffer_chain_free</a>(chain);</div>
<div class="line"><span class="lineno"> 2136</span>        }</div>
<div class="line"><span class="lineno"> 2137</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(datlen &gt;= avail);</div>
<div class="line"><span class="lineno"> 2138</span>        tmp = <a class="code hl_function" href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a>(datlen - avail);</div>
<div class="line"><span class="lineno"> 2139</span>        <span class="keywordflow">if</span> (tmp == NULL) {</div>
<div class="line"><span class="lineno"> 2140</span>            <span class="keywordflow">if</span> (rmv_all) {</div>
<div class="line"><span class="lineno"> 2141</span>                <a class="code hl_function" href="libevent_2buffer_8c.html#a11161d984ed671f309bb410de5acff51">ZERO_CHAIN</a>(buf);</div>
<div class="line"><span class="lineno"> 2142</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2143</span>                buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> = *buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>;</div>
<div class="line"><span class="lineno"> 2144</span>                (*buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>)-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> = NULL;</div>
<div class="line"><span class="lineno"> 2145</span>            }</div>
<div class="line"><span class="lineno"> 2146</span>            <span class="keywordflow">return</span> (-1);</div>
<div class="line"><span class="lineno"> 2147</span>        }</div>
<div class="line"><span class="lineno"> 2148</span> </div>
<div class="line"><span class="lineno"> 2149</span>        <span class="keywordflow">if</span> (rmv_all) {</div>
<div class="line"><span class="lineno"> 2150</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a> = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> = tmp;</div>
<div class="line"><span class="lineno"> 2151</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = &amp;buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno"> 2152</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2153</span>            (*buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>)-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> = tmp;</div>
<div class="line"><span class="lineno"> 2154</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> = tmp;</div>
<div class="line"><span class="lineno"> 2155</span>        }</div>
<div class="line"><span class="lineno"> 2156</span>        <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno"> 2157</span>    }</div>
<div class="line"><span class="lineno"> 2158</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00282">ASSERT_EVBUFFER_LOCKED</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00176">evbuffer_chain::buffer_len</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00130">CHAIN_SPACE_LEN</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00196">evbuffer_chain_free()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00309">evbuffer_chain_insert()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00157">evbuffer_chain_new()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00192">EVBUFFER_IMMUTABLE</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00188">evbuffer_chain::flags</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00084">evbuffer::last</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00800">ZERO_CHAIN()</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00635">evbuffer_add_iovec()</a>, <a class="el" href="buffer__iocp_8c_source.html#l00246">evbuffer_launch_read_()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02284">evbuffer_read()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00671">evbuffer_reserve_space()</a>.</p>

</div>
</div>
<a id="af29382773b8c1cbe484de86282e6fb87" name="af29382773b8c1cbe484de86282e6fb87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af29382773b8c1cbe484de86282e6fb87">&#9670;&nbsp;</a></span>evbuffer_expand_singlechain()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> * evbuffer_expand_singlechain </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01939">1939</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1940</span>{</div>
<div class="line"><span class="lineno"> 1941</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain, **chainp;</div>
<div class="line"><span class="lineno"> 1942</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *result = NULL;</div>
<div class="line"><span class="lineno"> 1943</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(buf);</div>
<div class="line"><span class="lineno"> 1944</span> </div>
<div class="line"><span class="lineno"> 1945</span>    chainp = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>;</div>
<div class="line"><span class="lineno"> 1946</span> </div>
<div class="line"><span class="lineno"> 1947</span>    <span class="comment">/* XXX If *chainp is no longer writeable, but has enough space in its</span></div>
<div class="line"><span class="lineno"> 1948</span><span class="comment">     * misalign, this might be a bad idea: we could still use *chainp, not</span></div>
<div class="line"><span class="lineno"> 1949</span><span class="comment">     * (*chainp)-&gt;next. */</span></div>
<div class="line"><span class="lineno"> 1950</span>    <span class="keywordflow">if</span> (*chainp &amp;&amp; <a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(*chainp) == 0)</div>
<div class="line"><span class="lineno"> 1951</span>        chainp = &amp;(*chainp)-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 1952</span> </div>
<div class="line"><span class="lineno"> 1953</span>    <span class="comment">/* &#39;chain&#39; now points to the first chain with writable space (if any)</span></div>
<div class="line"><span class="lineno"> 1954</span><span class="comment">     * We will either use it, realign it, replace it, or resize it. */</span></div>
<div class="line"><span class="lineno"> 1955</span>    chain = *chainp;</div>
<div class="line"><span class="lineno"> 1956</span> </div>
<div class="line"><span class="lineno"> 1957</span>    <span class="keywordflow">if</span> (chain == NULL ||</div>
<div class="line"><span class="lineno"> 1958</span>        (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp; (<a class="code hl_define" href="evbuffer-internal_8h.html#a93af71b521a359f90fce52d1cf9f49c5">EVBUFFER_IMMUTABLE</a>|<a class="code hl_define" href="evbuffer-internal_8h.html#a2ddf04d9ba9e2d6f56c67250acdf6e8e">EVBUFFER_MEM_PINNED_ANY</a>))) {</div>
<div class="line"><span class="lineno"> 1959</span>        <span class="comment">/* We can&#39;t use the last_with_data chain at all.  Just add a</span></div>
<div class="line"><span class="lineno"> 1960</span><span class="comment">         * new one that&#39;s big enough. */</span></div>
<div class="line"><span class="lineno"> 1961</span>        <span class="keywordflow">goto</span> insert_new;</div>
<div class="line"><span class="lineno"> 1962</span>    }</div>
<div class="line"><span class="lineno"> 1963</span> </div>
<div class="line"><span class="lineno"> 1964</span>    <span class="comment">/* If we can fit all the data, then we don&#39;t have to do anything */</span></div>
<div class="line"><span class="lineno"> 1965</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(chain) &gt;= datlen) {</div>
<div class="line"><span class="lineno"> 1966</span>        result = chain;</div>
<div class="line"><span class="lineno"> 1967</span>        <span class="keywordflow">goto</span> ok;</div>
<div class="line"><span class="lineno"> 1968</span>    }</div>
<div class="line"><span class="lineno"> 1969</span> </div>
<div class="line"><span class="lineno"> 1970</span>    <span class="comment">/* If the chain is completely empty, just replace it by adding a new</span></div>
<div class="line"><span class="lineno"> 1971</span><span class="comment">     * empty chain. */</span></div>
<div class="line"><span class="lineno"> 1972</span>    <span class="keywordflow">if</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> == 0) {</div>
<div class="line"><span class="lineno"> 1973</span>        <span class="keywordflow">goto</span> insert_new;</div>
<div class="line"><span class="lineno"> 1974</span>    }</div>
<div class="line"><span class="lineno"> 1975</span> </div>
<div class="line"><span class="lineno"> 1976</span>    <span class="comment">/* If the misalignment plus the remaining space fulfills our data</span></div>
<div class="line"><span class="lineno"> 1977</span><span class="comment">     * needs, we could just force an alignment to happen.  Afterwards, we</span></div>
<div class="line"><span class="lineno"> 1978</span><span class="comment">     * have enough space.  But only do this if we&#39;re saving a lot of space</span></div>
<div class="line"><span class="lineno"> 1979</span><span class="comment">     * and not moving too much data.  Otherwise the space savings are</span></div>
<div class="line"><span class="lineno"> 1980</span><span class="comment">     * probably offset by the time lost in copying.</span></div>
<div class="line"><span class="lineno"> 1981</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1982</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#abf7d52654d190f4a196f0e2e58ff0bb1">evbuffer_chain_should_realign</a>(chain, datlen)) {</div>
<div class="line"><span class="lineno"> 1983</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#af9aadddcff964430df6ae27bb8c03fa9">evbuffer_chain_align</a>(chain);</div>
<div class="line"><span class="lineno"> 1984</span>        result = chain;</div>
<div class="line"><span class="lineno"> 1985</span>        <span class="keywordflow">goto</span> ok;</div>
<div class="line"><span class="lineno"> 1986</span>    }</div>
<div class="line"><span class="lineno"> 1987</span> </div>
<div class="line"><span class="lineno"> 1988</span>    <span class="comment">/* At this point, we can either resize the last chunk with space in</span></div>
<div class="line"><span class="lineno"> 1989</span><span class="comment">     * it, use the next chunk after it, or   If we add a new chunk, we waste</span></div>
<div class="line"><span class="lineno"> 1990</span><span class="comment">     * CHAIN_SPACE_LEN(chain) bytes in the former last chunk.  If we</span></div>
<div class="line"><span class="lineno"> 1991</span><span class="comment">     * resize, we have to copy chain-&gt;off bytes.</span></div>
<div class="line"><span class="lineno"> 1992</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1993</span> </div>
<div class="line"><span class="lineno"> 1994</span>    <span class="comment">/* Would expanding this chunk be affordable and worthwhile? */</span></div>
<div class="line"><span class="lineno"> 1995</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(chain) &lt; chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a> / 8 ||</div>
<div class="line"><span class="lineno"> 1996</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> &gt; <a class="code hl_define" href="libevent_2buffer_8c.html#a390a7600d2b1cf434e95976de7176593">MAX_TO_COPY_IN_EXPAND</a> ||</div>
<div class="line"><span class="lineno"> 1997</span>        datlen &gt;= (<a class="code hl_define" href="evbuffer-internal_8h.html#a6fc2d164d40c2e7fba6014619f968b16">EVBUFFER_CHAIN_MAX</a> - chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>)) {</div>
<div class="line"><span class="lineno"> 1998</span>        <span class="comment">/* It&#39;s not worth resizing this chain. Can the next one be</span></div>
<div class="line"><span class="lineno"> 1999</span><span class="comment">         * used? */</span></div>
<div class="line"><span class="lineno"> 2000</span>        <span class="keywordflow">if</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> &amp;&amp; <a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>) &gt;= datlen) {</div>
<div class="line"><span class="lineno"> 2001</span>            <span class="comment">/* Yes, we can just use the next chain (which should</span></div>
<div class="line"><span class="lineno"> 2002</span><span class="comment">             * be empty. */</span></div>
<div class="line"><span class="lineno"> 2003</span>            result = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 2004</span>            <span class="keywordflow">goto</span> ok;</div>
<div class="line"><span class="lineno"> 2005</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2006</span>            <span class="comment">/* No; append a new chain (which will free all</span></div>
<div class="line"><span class="lineno"> 2007</span><span class="comment">             * terminal empty chains.) */</span></div>
<div class="line"><span class="lineno"> 2008</span>            <span class="keywordflow">goto</span> insert_new;</div>
<div class="line"><span class="lineno"> 2009</span>        }</div>
<div class="line"><span class="lineno"> 2010</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2011</span>        <span class="comment">/* Okay, we&#39;re going to try to resize this chain: Not doing so</span></div>
<div class="line"><span class="lineno"> 2012</span><span class="comment">         * would waste at least 1/8 of its current allocation, and we</span></div>
<div class="line"><span class="lineno"> 2013</span><span class="comment">         * can do so without having to copy more than</span></div>
<div class="line"><span class="lineno"> 2014</span><span class="comment">         * MAX_TO_COPY_IN_EXPAND bytes. */</span></div>
<div class="line"><span class="lineno"> 2015</span>        <span class="comment">/* figure out how much space we need */</span></div>
<div class="line"><span class="lineno"> 2016</span>        <span class="keywordtype">size_t</span> length = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> + datlen;</div>
<div class="line"><span class="lineno"> 2017</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *tmp = <a class="code hl_function" href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a>(length);</div>
<div class="line"><span class="lineno"> 2018</span>        <span class="keywordflow">if</span> (tmp == NULL)</div>
<div class="line"><span class="lineno"> 2019</span>            <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 2020</span> </div>
<div class="line"><span class="lineno"> 2021</span>        <span class="comment">/* copy the data over that we had so far */</span></div>
<div class="line"><span class="lineno"> 2022</span>        tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 2023</span>        memcpy(tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a>, chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>,</div>
<div class="line"><span class="lineno"> 2024</span>            chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>);</div>
<div class="line"><span class="lineno"> 2025</span>        <span class="comment">/* fix up the list */</span></div>
<div class="line"><span class="lineno"> 2026</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(*chainp == chain);</div>
<div class="line"><span class="lineno"> 2027</span>        result = *chainp = tmp;</div>
<div class="line"><span class="lineno"> 2028</span> </div>
<div class="line"><span class="lineno"> 2029</span>        <span class="keywordflow">if</span> (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> == chain)</div>
<div class="line"><span class="lineno"> 2030</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> = tmp;</div>
<div class="line"><span class="lineno"> 2031</span> </div>
<div class="line"><span class="lineno"> 2032</span>        tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 2033</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a7acdd31f1b39fc7c74f58103b23b6b0a">evbuffer_chain_free</a>(chain);</div>
<div class="line"><span class="lineno"> 2034</span>        <span class="keywordflow">goto</span> ok;</div>
<div class="line"><span class="lineno"> 2035</span>    }</div>
<div class="line"><span class="lineno"> 2036</span> </div>
<div class="line"><span class="lineno"> 2037</span>insert_new:</div>
<div class="line"><span class="lineno"> 2038</span>    result = <a class="code hl_function" href="libevent_2buffer_8c.html#a186d6472c870a6eeeba14c90aa13ed75">evbuffer_chain_insert_new</a>(buf, datlen);</div>
<div class="line"><span class="lineno"> 2039</span>    <span class="keywordflow">if</span> (!result)</div>
<div class="line"><span class="lineno"> 2040</span>        <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 2041</span>ok:</div>
<div class="line"><span class="lineno"> 2042</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(result);</div>
<div class="line"><span class="lineno"> 2043</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(<a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(result) &gt;= datlen);</div>
<div class="line"><span class="lineno"> 2044</span>err:</div>
<div class="line"><span class="lineno"> 2045</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 2046</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a186d6472c870a6eeeba14c90aa13ed75"><div class="ttname"><a href="libevent_2buffer_8c.html#a186d6472c870a6eeeba14c90aa13ed75">evbuffer_chain_insert_new</a></div><div class="ttdeci">static struct evbuffer_chain * evbuffer_chain_insert_new(struct evbuffer *buf, size_t datlen)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00330">buffer.c:330</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a390a7600d2b1cf434e95976de7176593"><div class="ttname"><a href="libevent_2buffer_8c.html#a390a7600d2b1cf434e95976de7176593">MAX_TO_COPY_IN_EXPAND</a></div><div class="ttdeci">#define MAX_TO_COPY_IN_EXPAND</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01922">buffer.c:1922</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00282">ASSERT_EVBUFFER_LOCKED</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00176">evbuffer_chain::buffer_len</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00130">CHAIN_SPACE_LEN</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01914">evbuffer_chain_align()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00196">evbuffer_chain_free()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00330">evbuffer_chain_insert_new()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00166">EVBUFFER_CHAIN_MAX</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00157">evbuffer_chain_new()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01928">evbuffer_chain_should_realign()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00192">EVBUFFER_IMMUTABLE</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00197">EVBUFFER_MEM_PINNED_ANY</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00188">evbuffer_chain::flags</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00084">evbuffer::last</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01922">MAX_TO_COPY_IN_EXPAND</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l02844">evbuffer_add_vprintf()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02161">evbuffer_expand()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02284">evbuffer_read()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00671">evbuffer_reserve_space()</a>.</p>

</div>
</div>
<a id="af1f242cbd02068bdccddfff86916934f" name="af1f242cbd02068bdccddfff86916934f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1f242cbd02068bdccddfff86916934f">&#9670;&nbsp;</a></span>evbuffer_file_segment_add_cleanup_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evbuffer_file_segment_add_cleanup_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__file__segment.html">evbuffer_file_segment</a> *&#160;</td>
          <td class="paramname"><em>seg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">evbuffer_file_segment_cleanup_cb&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l03146">3146</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3148</span>{</div>
<div class="line"><span class="lineno"> 3149</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a042d2e97a05831bf15208072eae7b1c7">refcnt</a> &gt; 0);</div>
<div class="line"><span class="lineno"> 3150</span>    seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a04e0c5cf4f94dbb3516a983edd913bb8">cleanup_cb</a> = cb;</div>
<div class="line"><span class="lineno"> 3151</span>    seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#ae7971791df06e8224cf77826ff68f3e4">cleanup_cb_arg</a> = arg;</div>
<div class="line"><span class="lineno"> 3152</span>}</div>
<div class="ttc" id="astructevbuffer__file__segment_html_a04e0c5cf4f94dbb3516a983edd913bb8"><div class="ttname"><a href="structevbuffer__file__segment.html#a04e0c5cf4f94dbb3516a983edd913bb8">evbuffer_file_segment::cleanup_cb</a></div><div class="ttdeci">evbuffer_file_segment_cleanup_cb cleanup_cb</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00263">evbuffer-internal.h:263</a></div></div>
<div class="ttc" id="astructevbuffer__file__segment_html_ae7971791df06e8224cf77826ff68f3e4"><div class="ttname"><a href="structevbuffer__file__segment.html#ae7971791df06e8224cf77826ff68f3e4">evbuffer_file_segment::cleanup_cb_arg</a></div><div class="ttdeci">void * cleanup_cb_arg</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00265">evbuffer-internal.h:265</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00263">evbuffer_file_segment::cleanup_cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00265">evbuffer_file_segment::cleanup_cb_arg</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00237">evbuffer_file_segment::refcnt</a>.</p>

</div>
</div>
<a id="aac3d2c0437effd46a755f131fe9239d2" name="aac3d2c0437effd46a755f131fe9239d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac3d2c0437effd46a755f131fe9239d2">&#9670;&nbsp;</a></span>evbuffer_file_segment_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evbuffer_file_segment_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__file__segment.html">evbuffer_file_segment</a> *&#160;</td>
          <td class="paramname"><em>seg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l03155">3155</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3156</span>{</div>
<div class="line"><span class="lineno"> 3157</span>    <span class="keywordtype">int</span> refcnt;</div>
<div class="line"><span class="lineno"> 3158</span>    <a class="code hl_define" href="evthread-internal_8h.html#a85fdca55341e3703cd380dae6e90297d">EVLOCK_LOCK</a>(seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a542b6cf490c3faad72536c6da1dbd453">lock</a>, 0);</div>
<div class="line"><span class="lineno"> 3159</span>    refcnt = --seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a042d2e97a05831bf15208072eae7b1c7">refcnt</a>;</div>
<div class="line"><span class="lineno"> 3160</span>    <a class="code hl_define" href="evthread-internal_8h.html#a56adca0a6ba562d39552d187063a0ba7">EVLOCK_UNLOCK</a>(seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a542b6cf490c3faad72536c6da1dbd453">lock</a>, 0);</div>
<div class="line"><span class="lineno"> 3161</span>    <span class="keywordflow">if</span> (refcnt &gt; 0)</div>
<div class="line"><span class="lineno"> 3162</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3163</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(refcnt == 0);</div>
<div class="line"><span class="lineno"> 3164</span> </div>
<div class="line"><span class="lineno"> 3165</span>    <span class="keywordflow">if</span> (seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a06a2333b0cb01b58d0fa07b51c691791">is_mapping</a>) {</div>
<div class="line"><span class="lineno"> 3166</span><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="lineno"> 3167</span>        CloseHandle(seg-&gt;mapping_handle);</div>
<div class="line"><span class="lineno"> 3168</span><span class="preprocessor">#elif defined (EVENT__HAVE_MMAP)</span></div>
<div class="line"><span class="lineno"> 3169</span>        off_t offset_leftover;</div>
<div class="line"><span class="lineno"> 3170</span>        offset_leftover = seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#ace172362e8b9807ab9ed56a8ee688f63">file_offset</a> % get_page_size();</div>
<div class="line"><span class="lineno"> 3171</span>        <span class="keywordflow">if</span> (munmap(seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#abb06d0aa43c539b1aade91b576992128">mapping</a>, seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a9a96fbc05e3c4f25942f1362075d6244">length</a> + offset_leftover) == -1)</div>
<div class="line"><span class="lineno"> 3172</span>            <a class="code hl_function" href="log-internal_8h.html#a266362bd8989fd1dacd0e1fc25b904f3">event_warn</a>(<span class="stringliteral">&quot;%s: munmap failed&quot;</span>, <a class="code hl_define" href="util-internal_8h.html#a7d6e1cf1a8d53f38471e9e9db3faf740">__func__</a>);</div>
<div class="line"><span class="lineno"> 3173</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3174</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#aea6768e84af96f867e452df2feac4947">contents</a>) {</div>
<div class="line"><span class="lineno"> 3175</span>        <a class="code hl_define" href="mm-internal_8h.html#af7d87798652aaa8398bb9c0504256f16">mm_free</a>(seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#aea6768e84af96f867e452df2feac4947">contents</a>);</div>
<div class="line"><span class="lineno"> 3176</span>    }</div>
<div class="line"><span class="lineno"> 3177</span> </div>
<div class="line"><span class="lineno"> 3178</span>    <span class="keywordflow">if</span> ((seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#aa717f7205602a119d2276f05d59e8ee7">flags</a> &amp; EVBUF_FS_CLOSE_ON_FREE) &amp;&amp; seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#ac35986e5757fd7b1f84daafc4124f369">fd</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 3179</span>        close(seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#ac35986e5757fd7b1f84daafc4124f369">fd</a>);</div>
<div class="line"><span class="lineno"> 3180</span>    }</div>
<div class="line"><span class="lineno"> 3181</span>    </div>
<div class="line"><span class="lineno"> 3182</span>    <span class="keywordflow">if</span> (seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a04e0c5cf4f94dbb3516a983edd913bb8">cleanup_cb</a>) {</div>
<div class="line"><span class="lineno"> 3183</span>        (*seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a04e0c5cf4f94dbb3516a983edd913bb8">cleanup_cb</a>)((<span class="keyword">struct</span> <a class="code hl_struct" href="structevbuffer__file__segment.html">evbuffer_file_segment</a> <span class="keyword">const</span>*)seg, </div>
<div class="line"><span class="lineno"> 3184</span>            seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#aa717f7205602a119d2276f05d59e8ee7">flags</a>, seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#ae7971791df06e8224cf77826ff68f3e4">cleanup_cb_arg</a>);</div>
<div class="line"><span class="lineno"> 3185</span>        seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a04e0c5cf4f94dbb3516a983edd913bb8">cleanup_cb</a> = NULL;</div>
<div class="line"><span class="lineno"> 3186</span>        seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#ae7971791df06e8224cf77826ff68f3e4">cleanup_cb_arg</a> = NULL;</div>
<div class="line"><span class="lineno"> 3187</span>    }</div>
<div class="line"><span class="lineno"> 3188</span> </div>
<div class="line"><span class="lineno"> 3189</span>    <a class="code hl_define" href="evthread-internal_8h.html#a56d74d4600adf793a2411f26db03ca71">EVTHREAD_FREE_LOCK</a>(seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a542b6cf490c3faad72536c6da1dbd453">lock</a>, 0);</div>
<div class="line"><span class="lineno"> 3190</span>    <a class="code hl_define" href="mm-internal_8h.html#af7d87798652aaa8398bb9c0504256f16">mm_free</a>(seg);</div>
<div class="line"><span class="lineno"> 3191</span>}</div>
<div class="ttc" id="astructevbuffer__file__segment_html_abb06d0aa43c539b1aade91b576992128"><div class="ttname"><a href="structevbuffer__file__segment.html#abb06d0aa43c539b1aade91b576992128">evbuffer_file_segment::mapping</a></div><div class="ttdeci">void * mapping</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00247">evbuffer-internal.h:247</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="util-internal_8h_source.html#l00086">__func__</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00263">evbuffer_file_segment::cleanup_cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00265">evbuffer_file_segment::cleanup_cb_arg</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00254">evbuffer_file_segment::contents</a>, <a class="el" href="log-internal_8h.html#a266362bd8989fd1dacd0e1fc25b904f3">event_warn()</a>, <a class="el" href="evthread-internal_8h_source.html#l00093">EVLOCK_LOCK</a>, <a class="el" href="evthread-internal_8h_source.html#l00100">EVLOCK_UNLOCK</a>, <a class="el" href="evthread-internal_8h_source.html#l00085">EVTHREAD_FREE_LOCK</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00245">evbuffer_file_segment::fd</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00256">evbuffer_file_segment::file_offset</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00238">evbuffer_file_segment::flags</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00242">evbuffer_file_segment::is_mapping</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00261">evbuffer_file_segment::length</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00236">evbuffer_file_segment::lock</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00247">evbuffer_file_segment::mapping</a>, <a class="el" href="mm-internal_8h_source.html#l00079">mm_free</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00237">evbuffer_file_segment::refcnt</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l03296">evbuffer_add_file()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l03194">evbuffer_add_file_segment()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00196">evbuffer_chain_free()</a>.</p>

</div>
</div>
<a id="afc653891dd5d75823201026646b53c20" name="afc653891dd5d75823201026646b53c20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc653891dd5d75823201026646b53c20">&#9670;&nbsp;</a></span>evbuffer_file_segment_materialize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int evbuffer_file_segment_materialize </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__file__segment.html">evbuffer_file_segment</a> *&#160;</td>
          <td class="paramname"><em>seg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l03040">3040</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3041</span>{</div>
<div class="line"><span class="lineno"> 3042</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> flags = seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#aa717f7205602a119d2276f05d59e8ee7">flags</a>;</div>
<div class="line"><span class="lineno"> 3043</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> fd = seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#ac35986e5757fd7b1f84daafc4124f369">fd</a>;</div>
<div class="line"><span class="lineno"> 3044</span>    <span class="keyword">const</span> ev_off_t length = seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a9a96fbc05e3c4f25942f1362075d6244">length</a>;</div>
<div class="line"><span class="lineno"> 3045</span>    <span class="keyword">const</span> ev_off_t offset = seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#ace172362e8b9807ab9ed56a8ee688f63">file_offset</a>;</div>
<div class="line"><span class="lineno"> 3046</span> </div>
<div class="line"><span class="lineno"> 3047</span>    <span class="keywordflow">if</span> (seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#aea6768e84af96f867e452df2feac4947">contents</a>)</div>
<div class="line"><span class="lineno"> 3048</span>        <span class="keywordflow">return</span> 0; <span class="comment">/* already materialized */</span></div>
<div class="line"><span class="lineno"> 3049</span> </div>
<div class="line"><span class="lineno"> 3050</span><span class="preprocessor">#if defined(EVENT__HAVE_MMAP)</span></div>
<div class="line"><span class="lineno"> 3051</span>    <span class="keywordflow">if</span> (!(flags &amp; EVBUF_FS_DISABLE_MMAP)) {</div>
<div class="line"><span class="lineno"> 3052</span>        off_t offset_rounded = 0, offset_leftover = 0;</div>
<div class="line"><span class="lineno"> 3053</span>        <span class="keywordtype">void</span> *mapped;</div>
<div class="line"><span class="lineno"> 3054</span>        <span class="keywordflow">if</span> (offset) {</div>
<div class="line"><span class="lineno"> 3055</span>            <span class="comment">/* mmap implementations don&#39;t generally like us</span></div>
<div class="line"><span class="lineno"> 3056</span><span class="comment">             * to have an offset that isn&#39;t a round  */</span></div>
<div class="line"><span class="lineno"> 3057</span>            <span class="keywordtype">long</span> page_size = get_page_size();</div>
<div class="line"><span class="lineno"> 3058</span>            <span class="keywordflow">if</span> (page_size == -1)</div>
<div class="line"><span class="lineno"> 3059</span>                <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 3060</span>            offset_leftover = offset % page_size;</div>
<div class="line"><span class="lineno"> 3061</span>            offset_rounded = offset - offset_leftover;</div>
<div class="line"><span class="lineno"> 3062</span>        }</div>
<div class="line"><span class="lineno"> 3063</span>        mapped = mmap(NULL, length + offset_leftover,</div>
<div class="line"><span class="lineno"> 3064</span>            PROT_READ,</div>
<div class="line"><span class="lineno"> 3065</span>#ifdef MAP_NOCACHE</div>
<div class="line"><span class="lineno"> 3066</span>            MAP_NOCACHE | <span class="comment">/* ??? */</span></div>
<div class="line"><span class="lineno"> 3067</span>#endif</div>
<div class="line"><span class="lineno"> 3068</span>#ifdef MAP_FILE</div>
<div class="line"><span class="lineno"> 3069</span>            MAP_FILE |</div>
<div class="line"><span class="lineno"> 3070</span>#endif</div>
<div class="line"><span class="lineno"> 3071</span>            MAP_PRIVATE,</div>
<div class="line"><span class="lineno"> 3072</span>            fd, offset_rounded);</div>
<div class="line"><span class="lineno"> 3073</span>        <span class="keywordflow">if</span> (mapped == <a class="code hl_define" href="libevent_2buffer_8c.html#a8523dcf952f6ff059a3bed717e4f1296">MAP_FAILED</a>) {</div>
<div class="line"><span class="lineno"> 3074</span>            <a class="code hl_function" href="log-internal_8h.html#a266362bd8989fd1dacd0e1fc25b904f3">event_warn</a>(<span class="stringliteral">&quot;%s: mmap(%d, %d, %zu) failed&quot;</span>,</div>
<div class="line"><span class="lineno"> 3075</span>                <a class="code hl_define" href="util-internal_8h.html#a7d6e1cf1a8d53f38471e9e9db3faf740">__func__</a>, fd, 0, (<span class="keywordtype">size_t</span>)(offset + length));</div>
<div class="line"><span class="lineno"> 3076</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3077</span>            seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#abb06d0aa43c539b1aade91b576992128">mapping</a> = mapped;</div>
<div class="line"><span class="lineno"> 3078</span>            seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#aea6768e84af96f867e452df2feac4947">contents</a> = (<span class="keywordtype">char</span>*)mapped+offset_leftover;</div>
<div class="line"><span class="lineno"> 3079</span>            seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a7bf0ab82f19cd2277842562380e5b08c">mmap_offset</a> = 0;</div>
<div class="line"><span class="lineno"> 3080</span>            seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a06a2333b0cb01b58d0fa07b51c691791">is_mapping</a> = 1;</div>
<div class="line"><span class="lineno"> 3081</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 3082</span>        }</div>
<div class="line"><span class="lineno"> 3083</span>    }</div>
<div class="line"><span class="lineno"> 3084</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3085</span><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="lineno"> 3086</span>    <span class="keywordflow">if</span> (!(flags &amp; EVBUF_FS_DISABLE_MMAP)) {</div>
<div class="line"><span class="lineno"> 3087</span>        intptr_t h = _get_osfhandle(fd);</div>
<div class="line"><span class="lineno"> 3088</span>        HANDLE m;</div>
<div class="line"><span class="lineno"> 3089</span>        ev_uint64_t total_size = length+offset;</div>
<div class="line"><span class="lineno"> 3090</span>        <span class="keywordflow">if</span> ((HANDLE)h == INVALID_HANDLE_VALUE)</div>
<div class="line"><span class="lineno"> 3091</span>            <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 3092</span>        m = CreateFileMapping((HANDLE)h, NULL, PAGE_READONLY,</div>
<div class="line"><span class="lineno"> 3093</span>            (total_size &gt;&gt; 32), total_size &amp; 0xfffffffful,</div>
<div class="line"><span class="lineno"> 3094</span>            NULL);</div>
<div class="line"><span class="lineno"> 3095</span>        <span class="keywordflow">if</span> (m != INVALID_HANDLE_VALUE) { <span class="comment">/* Does h leak? */</span></div>
<div class="line"><span class="lineno"> 3096</span>            seg-&gt;mapping_handle = m;</div>
<div class="line"><span class="lineno"> 3097</span>            seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a7bf0ab82f19cd2277842562380e5b08c">mmap_offset</a> = offset;</div>
<div class="line"><span class="lineno"> 3098</span>            seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a06a2333b0cb01b58d0fa07b51c691791">is_mapping</a> = 1;</div>
<div class="line"><span class="lineno"> 3099</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 3100</span>        }</div>
<div class="line"><span class="lineno"> 3101</span>    }</div>
<div class="line"><span class="lineno"> 3102</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3103</span>    {</div>
<div class="line"><span class="lineno"> 3104</span>        ev_off_t start_pos = <a class="code hl_define" href="winunistd_8h.html#a160e48b6f44d4559f0859360a340cf23">lseek</a>(fd, 0, SEEK_CUR), pos;</div>
<div class="line"><span class="lineno"> 3105</span>        ev_off_t read_so_far = 0;</div>
<div class="line"><span class="lineno"> 3106</span>        <span class="keywordtype">char</span> *mem;</div>
<div class="line"><span class="lineno"> 3107</span>        <span class="keywordtype">int</span> e;</div>
<div class="line"><span class="lineno"> 3108</span>        ev_ssize_t n = 0;</div>
<div class="line"><span class="lineno"> 3109</span>        <span class="keywordflow">if</span> (!(mem = <a class="code hl_define" href="mm-internal_8h.html#a7c27fb60329839e84d16185cda4734d5">mm_malloc</a>(length)))</div>
<div class="line"><span class="lineno"> 3110</span>            <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 3111</span>        <span class="keywordflow">if</span> (start_pos &lt; 0) {</div>
<div class="line"><span class="lineno"> 3112</span>            <a class="code hl_define" href="mm-internal_8h.html#af7d87798652aaa8398bb9c0504256f16">mm_free</a>(mem);</div>
<div class="line"><span class="lineno"> 3113</span>            <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 3114</span>        }</div>
<div class="line"><span class="lineno"> 3115</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="winunistd_8h.html#a160e48b6f44d4559f0859360a340cf23">lseek</a>(fd, offset, SEEK_SET) &lt; 0) {</div>
<div class="line"><span class="lineno"> 3116</span>            <a class="code hl_define" href="mm-internal_8h.html#af7d87798652aaa8398bb9c0504256f16">mm_free</a>(mem);</div>
<div class="line"><span class="lineno"> 3117</span>            <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 3118</span>        }</div>
<div class="line"><span class="lineno"> 3119</span>        <span class="keywordflow">while</span> (read_so_far &lt; length) {</div>
<div class="line"><span class="lineno"> 3120</span>            n = read(fd, mem+read_so_far, length-read_so_far);</div>
<div class="line"><span class="lineno"> 3121</span>            <span class="keywordflow">if</span> (n &lt;= 0)</div>
<div class="line"><span class="lineno"> 3122</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3123</span>            read_so_far += n;</div>
<div class="line"><span class="lineno"> 3124</span>        }</div>
<div class="line"><span class="lineno"> 3125</span> </div>
<div class="line"><span class="lineno"> 3126</span>        e = errno;</div>
<div class="line"><span class="lineno"> 3127</span>        pos = <a class="code hl_define" href="winunistd_8h.html#a160e48b6f44d4559f0859360a340cf23">lseek</a>(fd, start_pos, SEEK_SET);</div>
<div class="line"><span class="lineno"> 3128</span>        <span class="keywordflow">if</span> (n &lt; 0 || (n == 0 &amp;&amp; length &gt; read_so_far)) {</div>
<div class="line"><span class="lineno"> 3129</span>            <a class="code hl_define" href="mm-internal_8h.html#af7d87798652aaa8398bb9c0504256f16">mm_free</a>(mem);</div>
<div class="line"><span class="lineno"> 3130</span>            errno = e;</div>
<div class="line"><span class="lineno"> 3131</span>            <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 3132</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pos &lt; 0) {</div>
<div class="line"><span class="lineno"> 3133</span>            <a class="code hl_define" href="mm-internal_8h.html#af7d87798652aaa8398bb9c0504256f16">mm_free</a>(mem);</div>
<div class="line"><span class="lineno"> 3134</span>            <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 3135</span>        }</div>
<div class="line"><span class="lineno"> 3136</span> </div>
<div class="line"><span class="lineno"> 3137</span>        seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#aea6768e84af96f867e452df2feac4947">contents</a> = mem;</div>
<div class="line"><span class="lineno"> 3138</span>    }</div>
<div class="line"><span class="lineno"> 3139</span> </div>
<div class="line"><span class="lineno"> 3140</span>done:</div>
<div class="line"><span class="lineno"> 3141</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 3142</span>err:</div>
<div class="line"><span class="lineno"> 3143</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 3144</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a8523dcf952f6ff059a3bed717e4f1296"><div class="ttname"><a href="libevent_2buffer_8c.html#a8523dcf952f6ff059a3bed717e4f1296">MAP_FAILED</a></div><div class="ttdeci">#define MAP_FAILED</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00102">buffer.c:102</a></div></div>
<div class="ttc" id="awinunistd_8h_html_a160e48b6f44d4559f0859360a340cf23"><div class="ttname"><a href="winunistd_8h.html#a160e48b6f44d4559f0859360a340cf23">lseek</a></div><div class="ttdeci">#define lseek</div><div class="ttdef"><b>Definition:</b> <a href="winunistd_8h_source.html#l00035">winunistd.h:35</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="util-internal_8h_source.html#l00086">__func__</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00254">evbuffer_file_segment::contents</a>, <a class="el" href="log-internal_8h.html#a266362bd8989fd1dacd0e1fc25b904f3">event_warn()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00245">evbuffer_file_segment::fd</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00256">evbuffer_file_segment::file_offset</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00238">evbuffer_file_segment::flags</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00242">evbuffer_file_segment::is_mapping</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00261">evbuffer_file_segment::length</a>, <a class="el" href="winunistd_8h_source.html#l00035">lseek</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00102">MAP_FAILED</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00247">evbuffer_file_segment::mapping</a>, <a class="el" href="mm-internal_8h_source.html#l00079">mm_free</a>, <a class="el" href="mm-internal_8h_source.html#l00075">mm_malloc</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00259">evbuffer_file_segment::mmap_offset</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l03194">evbuffer_add_file_segment()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l02964">evbuffer_file_segment_new()</a>.</p>

</div>
</div>
<a id="a1cce429d8eb7100a190e7dc820243c92" name="a1cce429d8eb7100a190e7dc820243c92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cce429d8eb7100a190e7dc820243c92">&#9670;&nbsp;</a></span>evbuffer_file_segment_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structevbuffer__file__segment.html">evbuffer_file_segment</a> * evbuffer_file_segment_new </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev_off_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev_off_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02964">2964</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2966</span>{</div>
<div class="line"><span class="lineno"> 2967</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__file__segment.html">evbuffer_file_segment</a> *seg =</div>
<div class="line"><span class="lineno"> 2968</span>        <a class="code hl_define" href="mm-internal_8h.html#a0c64a2a6527ed776255e0e4e380593dc">mm_calloc</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="structevbuffer__file__segment.html">evbuffer_file_segment</a>), 1);</div>
<div class="line"><span class="lineno"> 2969</span>    <span class="keywordflow">if</span> (!seg)</div>
<div class="line"><span class="lineno"> 2970</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 2971</span>    seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a042d2e97a05831bf15208072eae7b1c7">refcnt</a> = 1;</div>
<div class="line"><span class="lineno"> 2972</span>    seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#ac35986e5757fd7b1f84daafc4124f369">fd</a> = <a class="code hl_variable" href="structevbuffer__file__segment.html#ac35986e5757fd7b1f84daafc4124f369">fd</a>;</div>
<div class="line"><span class="lineno"> 2973</span>    seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#aa717f7205602a119d2276f05d59e8ee7">flags</a> = <a class="code hl_variable" href="structevbuffer__file__segment.html#aa717f7205602a119d2276f05d59e8ee7">flags</a>;</div>
<div class="line"><span class="lineno"> 2974</span>    seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#ace172362e8b9807ab9ed56a8ee688f63">file_offset</a> = offset;</div>
<div class="line"><span class="lineno"> 2975</span>    seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a04e0c5cf4f94dbb3516a983edd913bb8">cleanup_cb</a> = NULL;</div>
<div class="line"><span class="lineno"> 2976</span>    seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#ae7971791df06e8224cf77826ff68f3e4">cleanup_cb_arg</a> = NULL;</div>
<div class="line"><span class="lineno"> 2977</span><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="lineno"> 2978</span><span class="preprocessor">#ifndef lseek</span></div>
<div class="line"><span class="lineno"> 2979</span><span class="preprocessor">#define lseek _lseeki64</span></div>
<div class="line"><span class="lineno"> 2980</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2981</span><span class="preprocessor">#ifndef fstat</span></div>
<div class="line"><span class="lineno"> 2982</span><span class="preprocessor">#define fstat _fstat</span></div>
<div class="line"><span class="lineno"> 2983</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2984</span><span class="preprocessor">#ifndef stat</span></div>
<div class="line"><span class="lineno"> 2985</span><span class="preprocessor">#define stat _stat</span></div>
<div class="line"><span class="lineno"> 2986</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2987</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2988</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structevbuffer__file__segment.html#a9a96fbc05e3c4f25942f1362075d6244">length</a> == -1) {</div>
<div class="line"><span class="lineno"> 2989</span>        <span class="keyword">struct </span>stat st;</div>
<div class="line"><span class="lineno"> 2990</span>        <span class="keywordflow">if</span> (fstat(fd, &amp;st) &lt; 0)</div>
<div class="line"><span class="lineno"> 2991</span>            <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 2992</span>        length = st.st_size;</div>
<div class="line"><span class="lineno"> 2993</span>    }</div>
<div class="line"><span class="lineno"> 2994</span>    seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a9a96fbc05e3c4f25942f1362075d6244">length</a> = length;</div>
<div class="line"><span class="lineno"> 2995</span> </div>
<div class="line"><span class="lineno"> 2996</span>    <span class="keywordflow">if</span> (offset &lt; 0 || length &lt; 0 ||</div>
<div class="line"><span class="lineno"> 2997</span>        ((ev_uint64_t)length &gt; <a class="code hl_define" href="evbuffer-internal_8h.html#a6fc2d164d40c2e7fba6014619f968b16">EVBUFFER_CHAIN_MAX</a>) ||</div>
<div class="line"><span class="lineno"> 2998</span>        (ev_uint64_t)offset &gt; (ev_uint64_t)(<a class="code hl_define" href="evbuffer-internal_8h.html#a6fc2d164d40c2e7fba6014619f968b16">EVBUFFER_CHAIN_MAX</a> - length))</div>
<div class="line"><span class="lineno"> 2999</span>        <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 3000</span> </div>
<div class="line"><span class="lineno"> 3001</span><span class="preprocessor">#if defined(USE_SENDFILE)</span></div>
<div class="line"><span class="lineno"> 3002</span>    <span class="keywordflow">if</span> (!(flags &amp; EVBUF_FS_DISABLE_SENDFILE)) {</div>
<div class="line"><span class="lineno"> 3003</span>        seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a0256b45c64d65b4557ed1af6c7e4de5c">can_sendfile</a> = 1;</div>
<div class="line"><span class="lineno"> 3004</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 3005</span>    }</div>
<div class="line"><span class="lineno"> 3006</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3007</span> </div>
<div class="line"><span class="lineno"> 3008</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#afc653891dd5d75823201026646b53c20">evbuffer_file_segment_materialize</a>(seg)&lt;0)</div>
<div class="line"><span class="lineno"> 3009</span>        <span class="keywordflow">goto</span> err;</div>
<div class="line"><span class="lineno"> 3010</span> </div>
<div class="line"><span class="lineno"> 3011</span><span class="preprocessor">#if defined(USE_SENDFILE)</span></div>
<div class="line"><span class="lineno"> 3012</span>done:</div>
<div class="line"><span class="lineno"> 3013</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3014</span>    <span class="keywordflow">if</span> (!(flags &amp; EVBUF_FS_DISABLE_LOCKING)) {</div>
<div class="line"><span class="lineno"> 3015</span>        <a class="code hl_define" href="evthread-internal_8h.html#a69a6ff948a58db53633b42d071682635">EVTHREAD_ALLOC_LOCK</a>(seg-&gt;<a class="code hl_variable" href="structevbuffer__file__segment.html#a542b6cf490c3faad72536c6da1dbd453">lock</a>, 0);</div>
<div class="line"><span class="lineno"> 3016</span>    }</div>
<div class="line"><span class="lineno"> 3017</span>    <span class="keywordflow">return</span> seg;</div>
<div class="line"><span class="lineno"> 3018</span>err:</div>
<div class="line"><span class="lineno"> 3019</span>    <a class="code hl_define" href="mm-internal_8h.html#af7d87798652aaa8398bb9c0504256f16">mm_free</a>(seg);</div>
<div class="line"><span class="lineno"> 3020</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 3021</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00241">evbuffer_file_segment::can_sendfile</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00263">evbuffer_file_segment::cleanup_cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00265">evbuffer_file_segment::cleanup_cb_arg</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00166">EVBUFFER_CHAIN_MAX</a>, <a class="el" href="libevent_2buffer_8c_source.html#l03040">evbuffer_file_segment_materialize()</a>, <a class="el" href="evthread-internal_8h_source.html#l00080">EVTHREAD_ALLOC_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00245">evbuffer_file_segment::fd</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00256">evbuffer_file_segment::file_offset</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00238">evbuffer_file_segment::flags</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00261">evbuffer_file_segment::length</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00236">evbuffer_file_segment::lock</a>, <a class="el" href="mm-internal_8h_source.html#l00076">mm_calloc</a>, <a class="el" href="mm-internal_8h_source.html#l00079">mm_free</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00237">evbuffer_file_segment::refcnt</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l03296">evbuffer_add_file()</a>.</p>

</div>
</div>
<a id="aca6902f271f4bf046f07292154b64639" name="aca6902f271f4bf046f07292154b64639"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca6902f271f4bf046f07292154b64639">&#9670;&nbsp;</a></span>evbuffer_find()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char * evbuffer_find </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>what</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02578">2578</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2579</span>{</div>
<div class="line"><span class="lineno"> 2580</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *search;</div>
<div class="line"><span class="lineno"> 2581</span>    <span class="keyword">struct </span>evbuffer_ptr ptr;</div>
<div class="line"><span class="lineno"> 2582</span> </div>
<div class="line"><span class="lineno"> 2583</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 2584</span> </div>
<div class="line"><span class="lineno"> 2585</span>    ptr = <a class="code hl_function" href="libevent_2buffer_8c.html#a61e15e2a355409587464c476d2481105">evbuffer_search</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, (<span class="keyword">const</span> <span class="keywordtype">char</span> *)what, len, NULL);</div>
<div class="line"><span class="lineno"> 2586</span>    <span class="keywordflow">if</span> (ptr.pos &lt; 0) {</div>
<div class="line"><span class="lineno"> 2587</span>        search = NULL;</div>
<div class="line"><span class="lineno"> 2588</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2589</span>        search = <a class="code hl_function" href="libevent_2buffer_8c.html#a832cd3d902a61b8ed503c1b1ae804058">evbuffer_pullup</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, ptr.pos + len);</div>
<div class="line"><span class="lineno"> 2590</span>        <span class="keywordflow">if</span> (search)</div>
<div class="line"><span class="lineno"> 2591</span>            search += ptr.pos;</div>
<div class="line"><span class="lineno"> 2592</span>    }</div>
<div class="line"><span class="lineno"> 2593</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 2594</span>    <span class="keywordflow">return</span> search;</div>
<div class="line"><span class="lineno"> 2595</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a61e15e2a355409587464c476d2481105"><div class="ttname"><a href="libevent_2buffer_8c.html#a61e15e2a355409587464c476d2481105">evbuffer_search</a></div><div class="ttdeci">struct evbuffer_ptr evbuffer_search(struct evbuffer *buffer, const char *what, size_t len, const struct evbuffer_ptr *start)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l02715">buffer.c:2715</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a832cd3d902a61b8ed503c1b1ae804058"><div class="ttname"><a href="libevent_2buffer_8c.html#a832cd3d902a61b8ed503c1b1ae804058">evbuffer_pullup</a></div><div class="ttdeci">unsigned char * evbuffer_pullup(struct evbuffer *buf, ev_ssize_t size)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01350">buffer.c:1350</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01350">evbuffer_pullup()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02715">evbuffer_search()</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>.</p>

</div>
</div>
<a id="a6dfe0e3fa9c89d6ef86d46f91bec1407" name="a6dfe0e3fa9c89d6ef86d46f91bec1407"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dfe0e3fa9c89d6ef86d46f91bec1407">&#9670;&nbsp;</a></span>evbuffer_find_eol_char()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static ev_ssize_t evbuffer_find_eol_char </td>
          <td>(</td>
          <td class="paramtype">struct evbuffer_ptr *&#160;</td>
          <td class="paramname"><em>it</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01523">1523</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1524</span>{</div>
<div class="line"><span class="lineno"> 1525</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain = it-&gt;internal_.chain;</div>
<div class="line"><span class="lineno"> 1526</span>    <span class="keywordtype">size_t</span> i = it-&gt;internal_.pos_in_chain;</div>
<div class="line"><span class="lineno"> 1527</span>    <span class="keywordflow">while</span> (chain != NULL) {</div>
<div class="line"><span class="lineno"> 1528</span>        <span class="keywordtype">char</span> *<a class="code hl_struct" href="structbuffer.html">buffer</a> = (<span class="keywordtype">char</span> *)chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>;</div>
<div class="line"><span class="lineno"> 1529</span>        <span class="keywordtype">char</span> *cp = <a class="code hl_function" href="libevent_2buffer_8c.html#a73da90a05a87e6f5e0df8a2a3f253e71">find_eol_char</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>+i, chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>-i);</div>
<div class="line"><span class="lineno"> 1530</span>        <span class="keywordflow">if</span> (cp) {</div>
<div class="line"><span class="lineno"> 1531</span>            it-&gt;internal_.chain = chain;</div>
<div class="line"><span class="lineno"> 1532</span>            it-&gt;internal_.pos_in_chain = cp - <a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a>;</div>
<div class="line"><span class="lineno"> 1533</span>            it-&gt;pos += (cp - <a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a>) - i;</div>
<div class="line"><span class="lineno"> 1534</span>            <span class="keywordflow">return</span> it-&gt;pos;</div>
<div class="line"><span class="lineno"> 1535</span>        }</div>
<div class="line"><span class="lineno"> 1536</span>        it-&gt;pos += chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> - i;</div>
<div class="line"><span class="lineno"> 1537</span>        i = 0;</div>
<div class="line"><span class="lineno"> 1538</span>        chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 1539</span>    }</div>
<div class="line"><span class="lineno"> 1540</span> </div>
<div class="line"><span class="lineno"> 1541</span>    <span class="keywordflow">return</span> (-1);</div>
<div class="line"><span class="lineno"> 1542</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a73da90a05a87e6f5e0df8a2a3f253e71"><div class="ttname"><a href="libevent_2buffer_8c.html#a73da90a05a87e6f5e0df8a2a3f253e71">find_eol_char</a></div><div class="ttdeci">static char * find_eol_char(char *s, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01496">buffer.c:1496</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01496">find_eol_char()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01597">evbuffer_search_eol()</a>.</p>

</div>
</div>
<a id="ab27f081c089aebd2536296c13d53f735" name="ab27f081c089aebd2536296c13d53f735"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab27f081c089aebd2536296c13d53f735">&#9670;&nbsp;</a></span>evbuffer_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evbuffer_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00588">588</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  589</span>{</div>
<div class="line"><span class="lineno">  590</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  591</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a3ac07b1be4b6fe0b2aa6a1677b060a80">evbuffer_decref_and_unlock_</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  592</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00561">evbuffer_decref_and_unlock_()</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__async_8c_source.html#l00543">bufferevent_async_new_()</a>, <a class="el" href="bufferevent_8c_source.html#l00747">bufferevent_finalize_cb_()</a>, <a class="el" href="bufferevent_8c_source.html#l00309">bufferevent_init_common_()</a>, <a class="el" href="buffer__iocp_8c_source.html#l00246">evbuffer_launch_read_()</a>, <a class="el" href="buffer__iocp_8c_source.html#l00172">evbuffer_launch_write_()</a>, <a class="el" href="http_8c_source.html#l03465">evhttp_handle_request()</a>, <a class="el" href="http_8c_source.html#l04033">evhttp_request_free()</a>, <a class="el" href="http_8c_source.html#l02801">evhttp_send_error()</a>, <a class="el" href="http_8c_source.html#l04948">evhttp_uri_join()</a>, <a class="el" href="http_8c_source.html#l03110">evhttp_uriencode()</a>, and <a class="el" href="evrpc_8c_source.html#l00382">evrpc_reqstate_free_()</a>.</p>

</div>
</div>
<a id="a853df8a453a607c6dfe27b18f7cda889" name="a853df8a453a607c6dfe27b18f7cda889"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a853df8a453a607c6dfe27b18f7cda889">&#9670;&nbsp;</a></span>evbuffer_free_all_chains()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void evbuffer_free_all_chains </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *&#160;</td>
          <td class="paramname"><em>chain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00256">256</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  257</span>{</div>
<div class="line"><span class="lineno">  258</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno">  259</span>    <span class="keywordflow">for</span> (; chain; chain = <a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>) {</div>
<div class="line"><span class="lineno">  260</span>        <a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno">  261</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a7acdd31f1b39fc7c74f58103b23b6b0a">evbuffer_chain_free</a>(chain);</div>
<div class="line"><span class="lineno">  262</span>    }</div>
<div class="line"><span class="lineno">  263</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00196">evbuffer_chain_free()</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00966">evbuffer_add_buffer()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01012">evbuffer_add_buffer_reference()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00291">evbuffer_free_trailing_empty_chains()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l01055">evbuffer_prepend_buffer()</a>.</p>

</div>
</div>
<a id="aa0b9aab1a4a4fb3d9e446b03d1ad2743" name="aa0b9aab1a4a4fb3d9e446b03d1ad2743"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0b9aab1a4a4fb3d9e446b03d1ad2743">&#9670;&nbsp;</a></span>evbuffer_free_trailing_empty_chains()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> ** evbuffer_free_trailing_empty_chains </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00291">291</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  292</span>{</div>
<div class="line"><span class="lineno">  293</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> **ch = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>;</div>
<div class="line"><span class="lineno">  294</span>    <span class="comment">/* Find the first victim chain.  It might be *last_with_datap */</span></div>
<div class="line"><span class="lineno">  295</span>    <span class="keywordflow">while</span> ((*ch) &amp;&amp; ((*ch)-&gt;off != 0 || <a class="code hl_define" href="libevent_2buffer_8c.html#a6c587915f15eb124dc0c69d768093319">CHAIN_PINNED</a>(*ch)))</div>
<div class="line"><span class="lineno">  296</span>        ch = &amp;(*ch)-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno">  297</span>    <span class="keywordflow">if</span> (*ch) {</div>
<div class="line"><span class="lineno">  298</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(<a class="code hl_function" href="libevent_2buffer_8c.html#a10fa650c0b0174af23a89cd44527b126">evbuffer_chains_all_empty</a>(*ch));</div>
<div class="line"><span class="lineno">  299</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a853df8a453a607c6dfe27b18f7cda889">evbuffer_free_all_chains</a>(*ch);</div>
<div class="line"><span class="lineno">  300</span>        *ch = NULL;</div>
<div class="line"><span class="lineno">  301</span>    }</div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordflow">return</span> ch;</div>
<div class="line"><span class="lineno">  303</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a10fa650c0b0174af23a89cd44527b126"><div class="ttname"><a href="libevent_2buffer_8c.html#a10fa650c0b0174af23a89cd44527b126">evbuffer_chains_all_empty</a></div><div class="ttdeci">static int evbuffer_chains_all_empty(struct evbuffer_chain *chain)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00267">buffer.c:267</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00133">CHAIN_PINNED</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00267">evbuffer_chains_all_empty()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00256">evbuffer_free_all_chains()</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00889">APPEND_CHAIN()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00309">evbuffer_chain_insert()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l01260">evbuffer_remove_buffer()</a>.</p>

</div>
</div>
<a id="ab20a3648e696af4de0f4f183eaf190f4" name="ab20a3648e696af4de0f4f183eaf190f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab20a3648e696af4de0f4f183eaf190f4">&#9670;&nbsp;</a></span>evbuffer_freeze()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_freeze </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l03401">3401</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3402</span>{</div>
<div class="line"><span class="lineno"> 3403</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3404</span>    <span class="keywordflow">if</span> (start)</div>
<div class="line"><span class="lineno"> 3405</span>        <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;freeze_start = 1;</div>
<div class="line"><span class="lineno"> 3406</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3407</span>        <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;freeze_end = 1;</div>
<div class="line"><span class="lineno"> 3408</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3409</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 3410</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__pair_8c_source.html#l00153">be_pair_transfer()</a>, <a class="el" href="bufferevent__pair_8c_source.html#l00115">bufferevent_pair_new()</a>, <a class="el" href="bufferevent__sock_8c_source.html#l00149">bufferevent_readcb()</a>, <a class="el" href="bufferevent__sock_8c_source.html#l00344">bufferevent_socket_new()</a>, <a class="el" href="bufferevent__sock_8c_source.html#l00230">bufferevent_writecb()</a>, <a class="el" href="buffer__iocp_8c_source.html#l00246">evbuffer_launch_read_()</a>, <a class="el" href="buffer__iocp_8c_source.html#l00172">evbuffer_launch_write_()</a>, and <a class="el" href="http_8c_source.html#l01455">evhttp_connection_read_on_write_error()</a>.</p>

</div>
</div>
<a id="a44fba9707bdfca27ce64ab9b3af5bbf8" name="a44fba9707bdfca27ce64ab9b3af5bbf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44fba9707bdfca27ce64ab9b3af5bbf8">&#9670;&nbsp;</a></span>evbuffer_get_callbacks_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_get_callbacks_ </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct event_callback **&#160;</td>
          <td class="paramname"><em>cbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_cbs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l03451">3451</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3453</span>{</div>
<div class="line"><span class="lineno"> 3454</span>    <span class="keywordtype">int</span> r = 0;</div>
<div class="line"><span class="lineno"> 3455</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3456</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;deferred_cbs) {</div>
<div class="line"><span class="lineno"> 3457</span>        <span class="keywordflow">if</span> (max_cbs &lt; 1) {</div>
<div class="line"><span class="lineno"> 3458</span>            r = -1;</div>
<div class="line"><span class="lineno"> 3459</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 3460</span>        }</div>
<div class="line"><span class="lineno"> 3461</span>        cbs[0] = &amp;<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;deferred;</div>
<div class="line"><span class="lineno"> 3462</span>        r = 1;</div>
<div class="line"><span class="lineno"> 3463</span>    }</div>
<div class="line"><span class="lineno"> 3464</span>done:</div>
<div class="line"><span class="lineno"> 3465</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3466</span>    <span class="keywordflow">return</span> r;</div>
<div class="line"><span class="lineno"> 3467</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent_8c_source.html#l00706">bufferevent_decref_and_unlock_()</a>.</p>

</div>
</div>
<a id="acd3d8507991609637a501e835e450331" name="acd3d8507991609637a501e835e450331"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd3d8507991609637a501e835e450331">&#9670;&nbsp;</a></span>evbuffer_get_contiguous_space()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t evbuffer_get_contiguous_space </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00621">621</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  622</span>{</div>
<div class="line"><span class="lineno">  623</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain;</div>
<div class="line"><span class="lineno">  624</span>    <span class="keywordtype">size_t</span> result;</div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno">  627</span>    chain = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno">  628</span>    result = (chain != NULL ? chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> : 0);</div>
<div class="line"><span class="lineno">  629</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  632</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>.</p>

</div>
</div>
<a id="a1c1b3464e6a40ab2ae6398d214779a93" name="a1c1b3464e6a40ab2ae6398d214779a93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c1b3464e6a40ab2ae6398d214779a93">&#9670;&nbsp;</a></span>evbuffer_get_length()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t evbuffer_get_length </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00607">607</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  608</span>{</div>
<div class="line"><span class="lineno">  609</span>    <span class="keywordtype">size_t</span> result;</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>    result = (<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;total_len);</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  616</span> </div>
<div class="line"><span class="lineno">  617</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  618</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__filter_8c_source.html#l00302">be_filter_process_input()</a>, <a class="el" href="bufferevent__filter_8c_source.html#l00341">be_filter_process_output()</a>, <a class="el" href="bufferevent__filter_8c_source.html#l00438">be_filter_read_nolock_()</a>, <a class="el" href="bufferevent__pair_8c_source.html#l00225">be_pair_enable()</a>, <a class="el" href="bufferevent__pair_8c_source.html#l00153">be_pair_transfer()</a>, <a class="el" href="bufferevent__pair_8c_source.html#l00195">be_pair_wants_to_talk()</a>, <a class="el" href="bufferevent__filter_8c_source.html#l00147">be_readbuf_full()</a>, <a class="el" href="bufferevent__filter_8c_source.html#l00135">be_underlying_writebuf_full()</a>, <a class="el" href="bufferevent__async_8c_source.html#l00251">bev_async_consider_reading()</a>, <a class="el" href="bufferevent__async_8c_source.html#l00207">bev_async_consider_writing()</a>, <a class="el" href="bufferevent__openssl_8c_source.html#l00191">bio_bufferevent_ctrl()</a>, <a class="el" href="bufferevent__openssl_8c_source.html#l00133">bio_bufferevent_read()</a>, <a class="el" href="bufferevent__openssl_8c_source.html#l00159">bio_bufferevent_write()</a>, <a class="el" href="bufferevent__filter_8c_source.html#l00483">bufferevent_filtered_inbuf_cb()</a>, <a class="el" href="bufferevent_8c_source.html#l00970">bufferevent_generic_adj_timeouts_()</a>, <a class="el" href="bufferevent_8c_source.html#l00136">bufferevent_inbuf_wm_cb()</a>, <a class="el" href="bufferevent_8c_source.html#l00121">bufferevent_inbuf_wm_check()</a>, <a class="el" href="bufferevent__sock_8c_source.html#l00149">bufferevent_readcb()</a>, <a class="el" href="bufferevent_8c_source.html#l00594">bufferevent_setwatermark()</a>, <a class="el" href="bufferevent-internal_8h_source.html#l00407">bufferevent_trigger_nolock_()</a>, <a class="el" href="bufferevent__sock_8c_source.html#l00230">bufferevent_writecb()</a>, <a class="el" href="bufferevent__openssl_8c_source.html#l00739">bytes_to_read()</a>, <a class="el" href="bufferevent__openssl_8c_source.html#l00855">consider_writing()</a>, <a class="el" href="event__tagging_8c_source.html#l00201">decode_tag_internal()</a>, <a class="el" href="http_8c_source.html#l01455">evhttp_connection_read_on_write_error()</a>, <a class="el" href="http_8c_source.html#l01479">evhttp_error_cb()</a>, <a class="el" href="http_8c_source.html#l02215">evhttp_get_body()</a>, <a class="el" href="http_8c_source.html#l02159">evhttp_get_body_length()</a>, <a class="el" href="http_8c_source.html#l00906">evhttp_handle_chunked_read()</a>, <a class="el" href="http_8c_source.html#l01018">evhttp_lingering_close()</a>, <a class="el" href="http_8c_source.html#l00606">evhttp_make_header()</a>, <a class="el" href="http_8c_source.html#l00438">evhttp_make_header_request()</a>, <a class="el" href="http_8c_source.html#l00531">evhttp_make_header_response()</a>, <a class="el" href="http_8c_source.html#l02025">evhttp_parse_firstline_()</a>, <a class="el" href="http_8c_source.html#l02096">evhttp_parse_headers_()</a>, <a class="el" href="http_8c_source.html#l01047">evhttp_read_body()</a>, <a class="el" href="http_8c_source.html#l01132">evhttp_read_cb()</a>, <a class="el" href="http_8c_source.html#l02894">evhttp_send_reply_chunk_with_cb()</a>, <a class="el" href="http_8c_source.html#l02926">evhttp_send_reply_end()</a>, <a class="el" href="http_8c_source.html#l02735">evhttp_start_read_()</a>, <a class="el" href="http_8c_source.html#l04948">evhttp_uri_join()</a>, <a class="el" href="http_8c_source.html#l03110">evhttp_uriencode()</a>, <a class="el" href="http_8c_source.html#l01196">evhttp_write_connectioncb()</a>, <a class="el" href="evrpc_8c_source.html#l00285">evrpc_request_cb()</a>, <a class="el" href="event__tagging_8c_source.html#l00270">evtag_marshal_buffer()</a>, <a class="el" href="event__tagging_8c_source.html#l00442">evtag_unmarshal_header()</a>, <a class="el" href="event__tagging_8c_source.html#l00489">evtag_unmarshal_int()</a>, <a class="el" href="event__tagging_8c_source.html#l00515">evtag_unmarshal_int64()</a>, and <a class="el" href="net_8c_source.html#l00120">read_cb()</a>.</p>

</div>
</div>
<a id="a5777ea043f5871f05333dfb95360c306" name="a5777ea043f5871f05333dfb95360c306"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5777ea043f5871f05333dfb95360c306">&#9670;&nbsp;</a></span>evbuffer_getchr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int evbuffer_getchr </td>
          <td>(</td>
          <td class="paramtype">struct evbuffer_ptr *&#160;</td>
          <td class="paramname"><em>it</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01585">1585</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1586</span>{</div>
<div class="line"><span class="lineno"> 1587</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain = it-&gt;internal_.chain;</div>
<div class="line"><span class="lineno"> 1588</span>    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = it-&gt;internal_.pos_in_chain;</div>
<div class="line"><span class="lineno"> 1589</span> </div>
<div class="line"><span class="lineno"> 1590</span>    <span class="keywordflow">if</span> (chain == NULL)</div>
<div class="line"><span class="lineno"> 1591</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1592</span> </div>
<div class="line"><span class="lineno"> 1593</span>    <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a>[chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> + <a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>];</div>
<div class="line"><span class="lineno"> 1594</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01597">evbuffer_search_eol()</a>.</p>

</div>
</div>
<a id="a28d71fa071cae93e6b7a64314283e921" name="a28d71fa071cae93e6b7a64314283e921"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28d71fa071cae93e6b7a64314283e921">&#9670;&nbsp;</a></span>evbuffer_incref_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evbuffer_incref_ </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Increase the reference count of buf by one. </p>

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00396">396</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  397</span>{</div>
<div class="line"><span class="lineno">  398</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno">  399</span>    ++buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a84f258913691bdcc10456cfe78fe9440">refcnt</a>;</div>
<div class="line"><span class="lineno">  400</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno">  401</span>}</div>
<div class="ttc" id="astructevbuffer_html_a84f258913691bdcc10456cfe78fe9440"><div class="ttname"><a href="structevbuffer.html#a84f258913691bdcc10456cfe78fe9440">evbuffer::refcnt</a></div><div class="ttdeci">int refcnt</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00144">evbuffer-internal.h:144</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00144">evbuffer::refcnt</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00908">APPEND_CHAIN_MULTICAST()</a>, <a class="el" href="buffer__iocp_8c_source.html#l00246">evbuffer_launch_read_()</a>, and <a class="el" href="buffer__iocp_8c_source.html#l00172">evbuffer_launch_write_()</a>.</p>

</div>
</div>
<a id="ae58a14e3a6a2bc7e1ffc02b71d78daec" name="ae58a14e3a6a2bc7e1ffc02b71d78daec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae58a14e3a6a2bc7e1ffc02b71d78daec">&#9670;&nbsp;</a></span>evbuffer_incref_and_lock_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evbuffer_incref_and_lock_ </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Increase the reference count of buf by one and acquire the lock. </p>

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00404">404</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  405</span>{</div>
<div class="line"><span class="lineno">  406</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno">  407</span>    ++buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a84f258913691bdcc10456cfe78fe9440">refcnt</a>;</div>
<div class="line"><span class="lineno">  408</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00144">evbuffer::refcnt</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00514">evbuffer_invoke_callbacks_()</a>.</p>

</div>
</div>
<a id="a19e27adc7ac1c3b2c8303586c39e912e" name="a19e27adc7ac1c3b2c8303586c39e912e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19e27adc7ac1c3b2c8303586c39e912e">&#9670;&nbsp;</a></span>evbuffer_invoke_callbacks_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evbuffer_invoke_callbacks_ </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00514">514</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  515</span>{</div>
<div class="line"><span class="lineno">  516</span>    <span class="keywordflow">if</span> (LIST_EMPTY(&amp;<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;callbacks)) {</div>
<div class="line"><span class="lineno">  517</span>        <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;n_add_for_cb = <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;n_del_for_cb = 0;</div>
<div class="line"><span class="lineno">  518</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  519</span>    }</div>
<div class="line"><span class="lineno">  520</span> </div>
<div class="line"><span class="lineno">  521</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;deferred_cbs) {</div>
<div class="line"><span class="lineno">  522</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="defer-internal_8h.html#a24707370a90c5bb18a23743420290ef1">event_deferred_cb_schedule_</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;cb_queue, &amp;<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;deferred)) {</div>
<div class="line"><span class="lineno">  523</span>            <a class="code hl_function" href="libevent_2buffer_8c.html#ae58a14e3a6a2bc7e1ffc02b71d78daec">evbuffer_incref_and_lock_</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  524</span>            <span class="keywordflow">if</span> (<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;parent)</div>
<div class="line"><span class="lineno">  525</span>                <a class="code hl_define" href="bufferevent-internal_8h.html#afcc12755372ba0aad29f5618cf7e60e9">bufferevent_incref_</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;parent);</div>
<div class="line"><span class="lineno">  526</span>            <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  527</span>        }</div>
<div class="line"><span class="lineno">  528</span>    }</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a9498833b7740ef5ea694a18ad9bf4c07">evbuffer_run_callbacks</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, 0);</div>
<div class="line"><span class="lineno">  531</span>}</div>
<div class="ttc" id="abufferevent-internal_8h_html_afcc12755372ba0aad29f5618cf7e60e9"><div class="ttname"><a href="bufferevent-internal_8h.html#afcc12755372ba0aad29f5618cf7e60e9">bufferevent_incref_</a></div><div class="ttdeci">#define bufferevent_incref_(bufev)</div><div class="ttdef"><b>Definition:</b> <a href="bufferevent-internal_8h_source.html#l00369">bufferevent-internal.h:369</a></div></div>
<div class="ttc" id="adefer-internal_8h_html_a24707370a90c5bb18a23743420290ef1"><div class="ttname"><a href="defer-internal_8h.html#a24707370a90c5bb18a23743420290ef1">event_deferred_cb_schedule_</a></div><div class="ttdeci">EVENT2_EXPORT_SYMBOL int event_deferred_cb_schedule_(struct event_base *, struct event_callback *)</div><div class="ttdef"><b>Definition:</b> <a href="event_8c_source.html#l03124">event.c:3124</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_ae58a14e3a6a2bc7e1ffc02b71d78daec"><div class="ttname"><a href="libevent_2buffer_8c.html#ae58a14e3a6a2bc7e1ffc02b71d78daec">evbuffer_incref_and_lock_</a></div><div class="ttdeci">void evbuffer_incref_and_lock_(struct evbuffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00404">buffer.c:404</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="bufferevent-internal_8h_source.html#l00369">bufferevent_incref_</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00404">evbuffer_incref_and_lock_()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00456">evbuffer_run_callbacks()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, and <a class="el" href="event_8c_source.html#l03124">event_deferred_cb_schedule_()</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01730">evbuffer_add()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00966">evbuffer_add_buffer()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01012">evbuffer_add_buffer_reference()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l03194">evbuffer_add_file_segment()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02921">evbuffer_add_reference()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02844">evbuffer_add_vprintf()</a>, <a class="el" href="buffer__iocp_8c_source.html#l00098">evbuffer_commit_read_()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00724">evbuffer_commit_space()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01101">evbuffer_drain()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01827">evbuffer_prepend()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01055">evbuffer_prepend_buffer()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02284">evbuffer_read()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l01260">evbuffer_remove_buffer()</a>.</p>

</div>
</div>
<a id="af9542ca1ac381708c9b1450d91d168ec" name="af9542ca1ac381708c9b1450d91d168ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9542ca1ac381708c9b1450d91d168ec">&#9670;&nbsp;</a></span>evbuffer_lock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evbuffer_lock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00595">595</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  596</span>{</div>
<div class="line"><span class="lineno">  597</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno">  598</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>.</p>

</div>
</div>
<a id="a968e69551bc692f3383d1874a70bc867" name="a968e69551bc692f3383d1874a70bc867"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a968e69551bc692f3383d1874a70bc867">&#9670;&nbsp;</a></span>evbuffer_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structevbuffer.html">evbuffer</a> * evbuffer_new </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00362">362</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  363</span>{</div>
<div class="line"><span class="lineno">  364</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer.html">evbuffer</a> *<a class="code hl_struct" href="structbuffer.html">buffer</a>;</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>    <a class="code hl_struct" href="structbuffer.html">buffer</a> = <a class="code hl_define" href="mm-internal_8h.html#a0c64a2a6527ed776255e0e4e380593dc">mm_calloc</a>(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="structevbuffer.html">evbuffer</a>));</div>
<div class="line"><span class="lineno">  367</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structbuffer.html">buffer</a> == NULL)</div>
<div class="line"><span class="lineno">  368</span>        <span class="keywordflow">return</span> (NULL);</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>    LIST_INIT(&amp;<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;callbacks);</div>
<div class="line"><span class="lineno">  371</span>    <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;refcnt = 1;</div>
<div class="line"><span class="lineno">  372</span>    <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;last_with_datap = &amp;<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;first;</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>    <span class="keywordflow">return</span> (<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  375</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mm-internal_8h_source.html#l00076">mm_calloc</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent_8c_source.html#l00309">bufferevent_init_common_()</a>, <a class="el" href="http_8c_source.html#l03465">evhttp_handle_request()</a>, <a class="el" href="http_8c_source.html#l03983">evhttp_request_new()</a>, <a class="el" href="http_8c_source.html#l02801">evhttp_send_error()</a>, <a class="el" href="http_8c_source.html#l04948">evhttp_uri_join()</a>, <a class="el" href="http_8c_source.html#l03110">evhttp_uriencode()</a>, and <a class="el" href="evrpc_8c_source.html#l00404">evrpc_request_done()</a>.</p>

</div>
</div>
<a id="a280bc4f4750607f02cad494c45bc5769" name="a280bc4f4750607f02cad494c45bc5769"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a280bc4f4750607f02cad494c45bc5769">&#9670;&nbsp;</a></span>evbuffer_peek()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_peek </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev_ssize_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct evbuffer_ptr *&#160;</td>
          <td class="paramname"><em>start_at</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct evbuffer_iovec *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02785">2785</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2788</span>{</div>
<div class="line"><span class="lineno"> 2789</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain;</div>
<div class="line"><span class="lineno"> 2790</span>    <span class="keywordtype">int</span> idx = 0;</div>
<div class="line"><span class="lineno"> 2791</span>    ev_ssize_t len_so_far = 0;</div>
<div class="line"><span class="lineno"> 2792</span> </div>
<div class="line"><span class="lineno"> 2793</span>    <span class="comment">/* Avoid locking in trivial edge cases */</span></div>
<div class="line"><span class="lineno"> 2794</span>    <span class="keywordflow">if</span> (start_at &amp;&amp; start_at-&gt;internal_.chain == NULL)</div>
<div class="line"><span class="lineno"> 2795</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2796</span> </div>
<div class="line"><span class="lineno"> 2797</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 2798</span> </div>
<div class="line"><span class="lineno"> 2799</span>    <span class="keywordflow">if</span> (start_at) {</div>
<div class="line"><span class="lineno"> 2800</span>        chain = start_at-&gt;internal_.chain;</div>
<div class="line"><span class="lineno"> 2801</span>        len_so_far = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a></div>
<div class="line"><span class="lineno"> 2802</span>            - start_at-&gt;internal_.pos_in_chain;</div>
<div class="line"><span class="lineno"> 2803</span>        idx = 1;</div>
<div class="line"><span class="lineno"> 2804</span>        <span class="keywordflow">if</span> (n_vec &gt; 0) {</div>
<div class="line"><span class="lineno"> 2805</span>            vec[0].iov_base = (<span class="keywordtype">void</span> *)(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a></div>
<div class="line"><span class="lineno"> 2806</span>                + start_at-&gt;internal_.pos_in_chain);</div>
<div class="line"><span class="lineno"> 2807</span>            vec[0].iov_len = len_so_far;</div>
<div class="line"><span class="lineno"> 2808</span>        }</div>
<div class="line"><span class="lineno"> 2809</span>        chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 2810</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2811</span>        chain = <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;first;</div>
<div class="line"><span class="lineno"> 2812</span>    }</div>
<div class="line"><span class="lineno"> 2813</span> </div>
<div class="line"><span class="lineno"> 2814</span>    <span class="keywordflow">if</span> (n_vec == 0 &amp;&amp; len &lt; 0) {</div>
<div class="line"><span class="lineno"> 2815</span>        <span class="comment">/* If no vectors are provided and they asked for &quot;everything&quot;,</span></div>
<div class="line"><span class="lineno"> 2816</span><span class="comment">         * pretend they asked for the actual available amount. */</span></div>
<div class="line"><span class="lineno"> 2817</span>        len = <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;total_len;</div>
<div class="line"><span class="lineno"> 2818</span>        <span class="keywordflow">if</span> (start_at) {</div>
<div class="line"><span class="lineno"> 2819</span>            len -= start_at-&gt;pos;</div>
<div class="line"><span class="lineno"> 2820</span>        }</div>
<div class="line"><span class="lineno"> 2821</span>    }</div>
<div class="line"><span class="lineno"> 2822</span> </div>
<div class="line"><span class="lineno"> 2823</span>    <span class="keywordflow">while</span> (chain) {</div>
<div class="line"><span class="lineno"> 2824</span>        <span class="keywordflow">if</span> (len &gt;= 0 &amp;&amp; len_so_far &gt;= len)</div>
<div class="line"><span class="lineno"> 2825</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2826</span>        <span class="keywordflow">if</span> (idx&lt;n_vec) {</div>
<div class="line"><span class="lineno"> 2827</span>            vec[idx].iov_base = (<span class="keywordtype">void</span> *)(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>);</div>
<div class="line"><span class="lineno"> 2828</span>            vec[idx].iov_len = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 2829</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (len&lt;0) {</div>
<div class="line"><span class="lineno"> 2830</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2831</span>        }</div>
<div class="line"><span class="lineno"> 2832</span>        ++idx;</div>
<div class="line"><span class="lineno"> 2833</span>        len_so_far += chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 2834</span>        chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 2835</span>    }</div>
<div class="line"><span class="lineno"> 2836</span> </div>
<div class="line"><span class="lineno"> 2837</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 2838</span> </div>
<div class="line"><span class="lineno"> 2839</span>    <span class="keywordflow">return</span> idx;</div>
<div class="line"><span class="lineno"> 2840</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__openssl_8c_source.html#l00654">do_write()</a>.</p>

</div>
</div>
<a id="a0f0516632bac58c07e081f8fcb794530" name="a0f0516632bac58c07e081f8fcb794530"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f0516632bac58c07e081f8fcb794530">&#9670;&nbsp;</a></span>evbuffer_prepend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_prepend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01827">1827</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1828</span>{</div>
<div class="line"><span class="lineno"> 1829</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain, *tmp;</div>
<div class="line"><span class="lineno"> 1830</span>    <span class="keywordtype">int</span> result = -1;</div>
<div class="line"><span class="lineno"> 1831</span> </div>
<div class="line"><span class="lineno"> 1832</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 1833</span> </div>
<div class="line"><span class="lineno"> 1834</span>    <span class="keywordflow">if</span> (datlen == 0) {</div>
<div class="line"><span class="lineno"> 1835</span>        result = 0;</div>
<div class="line"><span class="lineno"> 1836</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1837</span>    }</div>
<div class="line"><span class="lineno"> 1838</span>    <span class="keywordflow">if</span> (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a082d569d992120cf9ff28ddb0f5da313">freeze_start</a>) {</div>
<div class="line"><span class="lineno"> 1839</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1840</span>    }</div>
<div class="line"><span class="lineno"> 1841</span>    <span class="keywordflow">if</span> (datlen &gt; EV_SIZE_MAX - buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>) {</div>
<div class="line"><span class="lineno"> 1842</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1843</span>    }</div>
<div class="line"><span class="lineno"> 1844</span> </div>
<div class="line"><span class="lineno"> 1845</span>    chain = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno"> 1846</span> </div>
<div class="line"><span class="lineno"> 1847</span>    <span class="keywordflow">if</span> (chain == NULL) {</div>
<div class="line"><span class="lineno"> 1848</span>        chain = <a class="code hl_function" href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a>(datlen);</div>
<div class="line"><span class="lineno"> 1849</span>        <span class="keywordflow">if</span> (!chain)</div>
<div class="line"><span class="lineno"> 1850</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1851</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#abb1ffdb88a9aa9e2b114d98832dfda16">evbuffer_chain_insert</a>(buf, chain);</div>
<div class="line"><span class="lineno"> 1852</span>    }</div>
<div class="line"><span class="lineno"> 1853</span> </div>
<div class="line"><span class="lineno"> 1854</span>    <span class="comment">/* we cannot touch immutable buffers */</span></div>
<div class="line"><span class="lineno"> 1855</span>    <span class="keywordflow">if</span> ((chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp; <a class="code hl_define" href="evbuffer-internal_8h.html#a93af71b521a359f90fce52d1cf9f49c5">EVBUFFER_IMMUTABLE</a>) == 0) {</div>
<div class="line"><span class="lineno"> 1856</span>        <span class="comment">/* Always true for mutable buffers */</span></div>
<div class="line"><span class="lineno"> 1857</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> &gt;= 0 &amp;&amp;</div>
<div class="line"><span class="lineno"> 1858</span>            (ev_uint64_t)chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> &lt;= <a class="code hl_define" href="evbuffer-internal_8h.html#a6fc2d164d40c2e7fba6014619f968b16">EVBUFFER_CHAIN_MAX</a>);</div>
<div class="line"><span class="lineno"> 1859</span> </div>
<div class="line"><span class="lineno"> 1860</span>        <span class="comment">/* If this chain is empty, we can treat it as</span></div>
<div class="line"><span class="lineno"> 1861</span><span class="comment">         * &#39;empty at the beginning&#39; rather than &#39;empty at the end&#39; */</span></div>
<div class="line"><span class="lineno"> 1862</span>        <span class="keywordflow">if</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> == 0)</div>
<div class="line"><span class="lineno"> 1863</span>            chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a>;</div>
<div class="line"><span class="lineno"> 1864</span> </div>
<div class="line"><span class="lineno"> 1865</span>        <span class="keywordflow">if</span> ((<span class="keywordtype">size_t</span>)chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> &gt;= datlen) {</div>
<div class="line"><span class="lineno"> 1866</span>            <span class="comment">/* we have enough space to fit everything */</span></div>
<div class="line"><span class="lineno"> 1867</span>            memcpy(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> - datlen,</div>
<div class="line"><span class="lineno"> 1868</span>                data, datlen);</div>
<div class="line"><span class="lineno"> 1869</span>            chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> += datlen;</div>
<div class="line"><span class="lineno"> 1870</span>            chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> -= datlen;</div>
<div class="line"><span class="lineno"> 1871</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> += datlen;</div>
<div class="line"><span class="lineno"> 1872</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += datlen;</div>
<div class="line"><span class="lineno"> 1873</span>            <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno"> 1874</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>) {</div>
<div class="line"><span class="lineno"> 1875</span>            <span class="comment">/* we can only fit some of the data. */</span></div>
<div class="line"><span class="lineno"> 1876</span>            memcpy(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a>,</div>
<div class="line"><span class="lineno"> 1877</span>                (<span class="keywordtype">char</span>*)data + datlen - chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>,</div>
<div class="line"><span class="lineno"> 1878</span>                (<span class="keywordtype">size_t</span>)chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>);</div>
<div class="line"><span class="lineno"> 1879</span>            chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> += (size_t)chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>;</div>
<div class="line"><span class="lineno"> 1880</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> += (<span class="keywordtype">size_t</span>)chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>;</div>
<div class="line"><span class="lineno"> 1881</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += (size_t)chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>;</div>
<div class="line"><span class="lineno"> 1882</span>            datlen -= (<span class="keywordtype">size_t</span>)chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>;</div>
<div class="line"><span class="lineno"> 1883</span>            chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> = 0;</div>
<div class="line"><span class="lineno"> 1884</span>        }</div>
<div class="line"><span class="lineno"> 1885</span>    }</div>
<div class="line"><span class="lineno"> 1886</span> </div>
<div class="line"><span class="lineno"> 1887</span>    <span class="comment">/* we need to add another chain */</span></div>
<div class="line"><span class="lineno"> 1888</span>    <span class="keywordflow">if</span> ((tmp = <a class="code hl_function" href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a>(datlen)) == NULL)</div>
<div class="line"><span class="lineno"> 1889</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1890</span>    buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a> = tmp;</div>
<div class="line"><span class="lineno"> 1891</span>    <span class="keywordflow">if</span> (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> == &amp;buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a> &amp;&amp; chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>)</div>
<div class="line"><span class="lineno"> 1892</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = &amp;tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 1893</span> </div>
<div class="line"><span class="lineno"> 1894</span>    tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> = chain;</div>
<div class="line"><span class="lineno"> 1895</span> </div>
<div class="line"><span class="lineno"> 1896</span>    tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = datlen;</div>
<div class="line"><span class="lineno"> 1897</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(datlen &lt;= tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a>);</div>
<div class="line"><span class="lineno"> 1898</span>    tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> = tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a> - datlen;</div>
<div class="line"><span class="lineno"> 1899</span> </div>
<div class="line"><span class="lineno"> 1900</span>    memcpy(tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>, data, datlen);</div>
<div class="line"><span class="lineno"> 1901</span>    buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> += datlen;</div>
<div class="line"><span class="lineno"> 1902</span>    buf-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += datlen;</div>
<div class="line"><span class="lineno"> 1903</span> </div>
<div class="line"><span class="lineno"> 1904</span>out:</div>
<div class="line"><span class="lineno"> 1905</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a>(buf);</div>
<div class="line"><span class="lineno"> 1906</span>    result = 0;</div>
<div class="line"><span class="lineno"> 1907</span>done:</div>
<div class="line"><span class="lineno"> 1908</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 1909</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 1910</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00176">evbuffer_chain::buffer_len</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00309">evbuffer_chain_insert()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00166">EVBUFFER_CHAIN_MAX</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00157">evbuffer_chain_new()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00192">EVBUFFER_IMMUTABLE</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00514">evbuffer_invoke_callbacks_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00188">evbuffer_chain::flags</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00120">evbuffer::freeze_start</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00106">evbuffer::n_add_for_cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>.</p>

</div>
</div>
<a id="a4d10d5d94c31c2f081bcc7068992d3f3" name="a4d10d5d94c31c2f081bcc7068992d3f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d10d5d94c31c2f081bcc7068992d3f3">&#9670;&nbsp;</a></span>evbuffer_prepend_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_prepend_buffer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>outbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>inbuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01055">1055</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1056</span>{</div>
<div class="line"><span class="lineno"> 1057</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *pinned, *last;</div>
<div class="line"><span class="lineno"> 1058</span>    <span class="keywordtype">size_t</span> in_total_len, out_total_len;</div>
<div class="line"><span class="lineno"> 1059</span>    <span class="keywordtype">int</span> result = 0;</div>
<div class="line"><span class="lineno"> 1060</span> </div>
<div class="line"><span class="lineno"> 1061</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a9eaca177b89c10b76bf6f8228aace3ba">EVBUFFER_LOCK2</a>(inbuf, outbuf);</div>
<div class="line"><span class="lineno"> 1062</span> </div>
<div class="line"><span class="lineno"> 1063</span>    in_total_len = inbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>;</div>
<div class="line"><span class="lineno"> 1064</span>    out_total_len = outbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>;</div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>    <span class="keywordflow">if</span> (!in_total_len || inbuf == outbuf)</div>
<div class="line"><span class="lineno"> 1067</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1068</span> </div>
<div class="line"><span class="lineno"> 1069</span>    <span class="keywordflow">if</span> (outbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#a082d569d992120cf9ff28ddb0f5da313">freeze_start</a> || inbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#a082d569d992120cf9ff28ddb0f5da313">freeze_start</a>) {</div>
<div class="line"><span class="lineno"> 1070</span>        result = -1;</div>
<div class="line"><span class="lineno"> 1071</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1072</span>    }</div>
<div class="line"><span class="lineno"> 1073</span> </div>
<div class="line"><span class="lineno"> 1074</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#ac60199252b9aeb1951f7928fb8fcf489">PRESERVE_PINNED</a>(inbuf, &amp;pinned, &amp;last) &lt; 0) {</div>
<div class="line"><span class="lineno"> 1075</span>        result = -1;</div>
<div class="line"><span class="lineno"> 1076</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1077</span>    }</div>
<div class="line"><span class="lineno"> 1078</span> </div>
<div class="line"><span class="lineno"> 1079</span>    <span class="keywordflow">if</span> (out_total_len == 0) {</div>
<div class="line"><span class="lineno"> 1080</span>        <span class="comment">/* There might be an empty chain at the start of outbuf; free</span></div>
<div class="line"><span class="lineno"> 1081</span><span class="comment">         * it. */</span></div>
<div class="line"><span class="lineno"> 1082</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a853df8a453a607c6dfe27b18f7cda889">evbuffer_free_all_chains</a>(outbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>);</div>
<div class="line"><span class="lineno"> 1083</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a10fda8507ae305fc30d946d344cc7abb">COPY_CHAIN</a>(outbuf, inbuf);</div>
<div class="line"><span class="lineno"> 1084</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1085</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a130b2fd82cc34ea9a10afb27cf160f6a">PREPEND_CHAIN</a>(outbuf, inbuf);</div>
<div class="line"><span class="lineno"> 1086</span>    }</div>
<div class="line"><span class="lineno"> 1087</span> </div>
<div class="line"><span class="lineno"> 1088</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a1e2fe7a3afa03f1b336cc62ef0317bbc">RESTORE_PINNED</a>(inbuf, pinned, last);</div>
<div class="line"><span class="lineno"> 1089</span> </div>
<div class="line"><span class="lineno"> 1090</span>    inbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#a5f4fd4011a0461e5fbee4e417031a960">n_del_for_cb</a> += in_total_len;</div>
<div class="line"><span class="lineno"> 1091</span>    outbuf-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += in_total_len;</div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a>(inbuf);</div>
<div class="line"><span class="lineno"> 1094</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a>(outbuf);</div>
<div class="line"><span class="lineno"> 1095</span>done:</div>
<div class="line"><span class="lineno"> 1096</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2c063b555017c0dfceede8560a711aed">EVBUFFER_UNLOCK2</a>(inbuf, outbuf);</div>
<div class="line"><span class="lineno"> 1097</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 1098</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a130b2fd82cc34ea9a10afb27cf160f6a"><div class="ttname"><a href="libevent_2buffer_8c.html#a130b2fd82cc34ea9a10afb27cf160f6a">PREPEND_CHAIN</a></div><div class="ttdeci">static void PREPEND_CHAIN(struct evbuffer *dst, struct evbuffer *src)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00948">buffer.c:948</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00875">COPY_CHAIN()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00256">evbuffer_free_all_chains()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00514">evbuffer_invoke_callbacks_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00293">EVBUFFER_LOCK2</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00297">EVBUFFER_UNLOCK2</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00120">evbuffer::freeze_start</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00106">evbuffer::n_add_for_cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00109">evbuffer::n_del_for_cb</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00948">PREPEND_CHAIN()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00814">PRESERVE_PINNED()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00858">RESTORE_PINNED()</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>.</p>

</div>
</div>
<a id="a31a6529210bd5b3285d926cc9f8f304b" name="a31a6529210bd5b3285d926cc9f8f304b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31a6529210bd5b3285d926cc9f8f304b">&#9670;&nbsp;</a></span>evbuffer_ptr_memcmp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int evbuffer_ptr_memcmp </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct evbuffer_ptr *&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>mem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Compare the bytes in buf at position pos to the len bytes in mem. Return less than 0, 0, or greater than 0 as memcmp. </p>

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02679">2679</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2681</span>{</div>
<div class="line"><span class="lineno"> 2682</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain;</div>
<div class="line"><span class="lineno"> 2683</span>    <span class="keywordtype">size_t</span> position;</div>
<div class="line"><span class="lineno"> 2684</span>    <span class="keywordtype">int</span> r;</div>
<div class="line"><span class="lineno"> 2685</span> </div>
<div class="line"><span class="lineno"> 2686</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(buf);</div>
<div class="line"><span class="lineno"> 2687</span> </div>
<div class="line"><span class="lineno"> 2688</span>    <span class="keywordflow">if</span> (pos-&gt;pos &lt; 0 ||</div>
<div class="line"><span class="lineno"> 2689</span>        EV_SIZE_MAX - len &lt; (<span class="keywordtype">size_t</span>)pos-&gt;pos ||</div>
<div class="line"><span class="lineno"> 2690</span>        pos-&gt;pos + len &gt; buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>)</div>
<div class="line"><span class="lineno"> 2691</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2692</span> </div>
<div class="line"><span class="lineno"> 2693</span>    chain = pos-&gt;internal_.chain;</div>
<div class="line"><span class="lineno"> 2694</span>    position = pos-&gt;internal_.pos_in_chain;</div>
<div class="line"><span class="lineno"> 2695</span>    <span class="keywordflow">while</span> (len &amp;&amp; chain) {</div>
<div class="line"><span class="lineno"> 2696</span>        <span class="keywordtype">size_t</span> n_comparable;</div>
<div class="line"><span class="lineno"> 2697</span>        <span class="keywordflow">if</span> (len + position &gt; chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>)</div>
<div class="line"><span class="lineno"> 2698</span>            n_comparable = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> - position;</div>
<div class="line"><span class="lineno"> 2699</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2700</span>            n_comparable = len;</div>
<div class="line"><span class="lineno"> 2701</span>        r = memcmp(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> + position, mem,</div>
<div class="line"><span class="lineno"> 2702</span>            n_comparable);</div>
<div class="line"><span class="lineno"> 2703</span>        <span class="keywordflow">if</span> (r)</div>
<div class="line"><span class="lineno"> 2704</span>            <span class="keywordflow">return</span> r;</div>
<div class="line"><span class="lineno"> 2705</span>        mem += n_comparable;</div>
<div class="line"><span class="lineno"> 2706</span>        len -= n_comparable;</div>
<div class="line"><span class="lineno"> 2707</span>        position = 0;</div>
<div class="line"><span class="lineno"> 2708</span>        chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 2709</span>    }</div>
<div class="line"><span class="lineno"> 2710</span> </div>
<div class="line"><span class="lineno"> 2711</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2712</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00282">ASSERT_EVBUFFER_LOCKED</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l02721">evbuffer_search_range()</a>.</p>

</div>
</div>
<a id="ab6caaf43634822bb6940d96045ff4266" name="ab6caaf43634822bb6940d96045ff4266"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6caaf43634822bb6940d96045ff4266">&#9670;&nbsp;</a></span>evbuffer_ptr_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_ptr_set </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct evbuffer_ptr *&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum evbuffer_ptr_how&#160;</td>
          <td class="paramname"><em>how</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02623">2623</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2625</span>{</div>
<div class="line"><span class="lineno"> 2626</span>    <span class="keywordtype">size_t</span> left = position;</div>
<div class="line"><span class="lineno"> 2627</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain = NULL;</div>
<div class="line"><span class="lineno"> 2628</span>    <span class="keywordtype">int</span> result = 0;</div>
<div class="line"><span class="lineno"> 2629</span> </div>
<div class="line"><span class="lineno"> 2630</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 2631</span> </div>
<div class="line"><span class="lineno"> 2632</span>    <span class="keywordflow">switch</span> (how) {</div>
<div class="line"><span class="lineno"> 2633</span>    <span class="keywordflow">case</span> EVBUFFER_PTR_SET:</div>
<div class="line"><span class="lineno"> 2634</span>        chain = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno"> 2635</span>        pos-&gt;pos = position;</div>
<div class="line"><span class="lineno"> 2636</span>        position = 0;</div>
<div class="line"><span class="lineno"> 2637</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2638</span>    <span class="keywordflow">case</span> EVBUFFER_PTR_ADD:</div>
<div class="line"><span class="lineno"> 2639</span>        <span class="comment">/* this avoids iterating over all previous chains if</span></div>
<div class="line"><span class="lineno"> 2640</span><span class="comment">           we just want to advance the position */</span></div>
<div class="line"><span class="lineno"> 2641</span>        <span class="keywordflow">if</span> (pos-&gt;pos &lt; 0 || EV_SIZE_MAX - position &lt; (<span class="keywordtype">size_t</span>)pos-&gt;pos) {</div>
<div class="line"><span class="lineno"> 2642</span>            <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 2643</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2644</span>        }</div>
<div class="line"><span class="lineno"> 2645</span>        chain = pos-&gt;internal_.chain;</div>
<div class="line"><span class="lineno"> 2646</span>        pos-&gt;pos += position;</div>
<div class="line"><span class="lineno"> 2647</span>        position = pos-&gt;internal_.pos_in_chain;</div>
<div class="line"><span class="lineno"> 2648</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2649</span>    }</div>
<div class="line"><span class="lineno"> 2650</span> </div>
<div class="line"><span class="lineno"> 2651</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(EV_SIZE_MAX - left &gt;= position);</div>
<div class="line"><span class="lineno"> 2652</span>    <span class="keywordflow">while</span> (chain &amp;&amp; position + left &gt;= chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>) {</div>
<div class="line"><span class="lineno"> 2653</span>        left -= chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> - position;</div>
<div class="line"><span class="lineno"> 2654</span>        chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 2655</span>        position = 0;</div>
<div class="line"><span class="lineno"> 2656</span>    }</div>
<div class="line"><span class="lineno"> 2657</span>    <span class="keywordflow">if</span> (chain) {</div>
<div class="line"><span class="lineno"> 2658</span>        pos-&gt;internal_.chain = chain;</div>
<div class="line"><span class="lineno"> 2659</span>        pos-&gt;internal_.pos_in_chain = position + left;</div>
<div class="line"><span class="lineno"> 2660</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (left == 0) {</div>
<div class="line"><span class="lineno"> 2661</span>        <span class="comment">/* The first byte in the (nonexistent) chain after the last chain */</span></div>
<div class="line"><span class="lineno"> 2662</span>        pos-&gt;internal_.chain = NULL;</div>
<div class="line"><span class="lineno"> 2663</span>        pos-&gt;internal_.pos_in_chain = 0;</div>
<div class="line"><span class="lineno"> 2664</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2665</span>        <a class="code hl_define" href="libevent_2buffer_8c.html#a85a672d3751a1c49b2374d439cc7bf55">PTR_NOT_FOUND</a>(pos);</div>
<div class="line"><span class="lineno"> 2666</span>        result = -1;</div>
<div class="line"><span class="lineno"> 2667</span>    }</div>
<div class="line"><span class="lineno"> 2668</span> </div>
<div class="line"><span class="lineno"> 2669</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 2670</span> </div>
<div class="line"><span class="lineno"> 2671</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 2672</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a85a672d3751a1c49b2374d439cc7bf55"><div class="ttname"><a href="libevent_2buffer_8c.html#a85a672d3751a1c49b2374d439cc7bf55">PTR_NOT_FOUND</a></div><div class="ttdeci">#define PTR_NOT_FOUND(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00137">buffer.c:137</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00137">PTR_NOT_FOUND</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l02603">evbuffer_ptr_subtract()</a>.</p>

</div>
</div>
<a id="a773c9681d248f1a77895f70f4fb34c0e" name="a773c9681d248f1a77895f70f4fb34c0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a773c9681d248f1a77895f70f4fb34c0e">&#9670;&nbsp;</a></span>evbuffer_ptr_subtract()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int evbuffer_ptr_subtract </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct evbuffer_ptr *&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>howfar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02603">2603</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2605</span>{</div>
<div class="line"><span class="lineno"> 2606</span>    <span class="keywordflow">if</span> (pos-&gt;pos &lt; 0)</div>
<div class="line"><span class="lineno"> 2607</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2608</span>    <span class="keywordflow">if</span> (howfar &gt; (<span class="keywordtype">size_t</span>)pos-&gt;pos)</div>
<div class="line"><span class="lineno"> 2609</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2610</span>    <span class="keywordflow">if</span> (pos-&gt;internal_.chain &amp;&amp; howfar &lt;= pos-&gt;internal_.pos_in_chain) {</div>
<div class="line"><span class="lineno"> 2611</span>        pos-&gt;internal_.pos_in_chain -= howfar;</div>
<div class="line"><span class="lineno"> 2612</span>        pos-&gt;pos -= howfar;</div>
<div class="line"><span class="lineno"> 2613</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2614</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2615</span>        <span class="keyword">const</span> <span class="keywordtype">size_t</span> newpos = pos-&gt;pos - howfar;</div>
<div class="line"><span class="lineno"> 2616</span>        <span class="comment">/* Here&#39;s the inefficient part: it walks over the</span></div>
<div class="line"><span class="lineno"> 2617</span><span class="comment">         * chains until we hit newpos. */</span></div>
<div class="line"><span class="lineno"> 2618</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="libevent_2buffer_8c.html#ab6caaf43634822bb6940d96045ff4266">evbuffer_ptr_set</a>(buf, pos, newpos, EVBUFFER_PTR_SET);</div>
<div class="line"><span class="lineno"> 2619</span>    }</div>
<div class="line"><span class="lineno"> 2620</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_ab6caaf43634822bb6940d96045ff4266"><div class="ttname"><a href="libevent_2buffer_8c.html#ab6caaf43634822bb6940d96045ff4266">evbuffer_ptr_set</a></div><div class="ttdeci">int evbuffer_ptr_set(struct evbuffer *buf, struct evbuffer_ptr *pos, size_t position, enum evbuffer_ptr_how how)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l02623">buffer.c:2623</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l02623">evbuffer_ptr_set()</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01597">evbuffer_search_eol()</a>.</p>

</div>
</div>
<a id="a832cd3d902a61b8ed503c1b1ae804058" name="a832cd3d902a61b8ed503c1b1ae804058"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a832cd3d902a61b8ed503c1b1ae804058">&#9670;&nbsp;</a></span>evbuffer_pullup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char * evbuffer_pullup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev_ssize_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01350">1350</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1351</span>{</div>
<div class="line"><span class="lineno"> 1352</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain, *<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>, *tmp, *last_with_data;</div>
<div class="line"><span class="lineno"> 1353</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a>, *result = NULL;</div>
<div class="line"><span class="lineno"> 1354</span>    ev_ssize_t remaining;</div>
<div class="line"><span class="lineno"> 1355</span>    <span class="keywordtype">int</span> removed_last_with_data = 0;</div>
<div class="line"><span class="lineno"> 1356</span>    <span class="keywordtype">int</span> removed_last_with_datap = 0;</div>
<div class="line"><span class="lineno"> 1357</span> </div>
<div class="line"><span class="lineno"> 1358</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 1359</span> </div>
<div class="line"><span class="lineno"> 1360</span>    chain = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno"> 1361</span> </div>
<div class="line"><span class="lineno"> 1362</span>    <span class="keywordflow">if</span> (size &lt; 0)</div>
<div class="line"><span class="lineno"> 1363</span>        size = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>;</div>
<div class="line"><span class="lineno"> 1364</span>    <span class="comment">/* if size &gt; buf-&gt;total_len, we cannot guarantee to the user that she</span></div>
<div class="line"><span class="lineno"> 1365</span><span class="comment">     * is going to have a long enough buffer afterwards; so we return</span></div>
<div class="line"><span class="lineno"> 1366</span><span class="comment">     * NULL */</span></div>
<div class="line"><span class="lineno"> 1367</span>    <span class="keywordflow">if</span> (size == 0 || (<span class="keywordtype">size_t</span>)size &gt; buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>)</div>
<div class="line"><span class="lineno"> 1368</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1369</span> </div>
<div class="line"><span class="lineno"> 1370</span>    <span class="comment">/* No need to pull up anything; the first size bytes are</span></div>
<div class="line"><span class="lineno"> 1371</span><span class="comment">     * already here. */</span></div>
<div class="line"><span class="lineno"> 1372</span>    <span class="keywordflow">if</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> &gt;= (<span class="keywordtype">size_t</span>)size) {</div>
<div class="line"><span class="lineno"> 1373</span>        result = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>;</div>
<div class="line"><span class="lineno"> 1374</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1375</span>    }</div>
<div class="line"><span class="lineno"> 1376</span> </div>
<div class="line"><span class="lineno"> 1377</span>    <span class="comment">/* Make sure that none of the chains we need to copy from is pinned. */</span></div>
<div class="line"><span class="lineno"> 1378</span>    remaining = size - chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 1379</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(remaining &gt;= 0);</div>
<div class="line"><span class="lineno"> 1380</span>    <span class="keywordflow">for</span> (tmp=chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>; tmp; tmp=tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>) {</div>
<div class="line"><span class="lineno"> 1381</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="libevent_2buffer_8c.html#a6c587915f15eb124dc0c69d768093319">CHAIN_PINNED</a>(tmp))</div>
<div class="line"><span class="lineno"> 1382</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1383</span>        <span class="keywordflow">if</span> (tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> &gt;= (<span class="keywordtype">size_t</span>)remaining)</div>
<div class="line"><span class="lineno"> 1384</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1385</span>        remaining -= tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 1386</span>    }</div>
<div class="line"><span class="lineno"> 1387</span> </div>
<div class="line"><span class="lineno"> 1388</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="libevent_2buffer_8c.html#a6c587915f15eb124dc0c69d768093319">CHAIN_PINNED</a>(chain)) {</div>
<div class="line"><span class="lineno"> 1389</span>        <span class="keywordtype">size_t</span> old_off = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 1390</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(chain) &lt; size - chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>) {</div>
<div class="line"><span class="lineno"> 1391</span>            <span class="comment">/* not enough room at end of chunk. */</span></div>
<div class="line"><span class="lineno"> 1392</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1393</span>        }</div>
<div class="line"><span class="lineno"> 1394</span>        <a class="code hl_struct" href="structbuffer.html">buffer</a> = <a class="code hl_define" href="libevent_2buffer_8c.html#a17846db51ec6b10c559ec8af1b30e379">CHAIN_SPACE_PTR</a>(chain);</div>
<div class="line"><span class="lineno"> 1395</span>        tmp = chain;</div>
<div class="line"><span class="lineno"> 1396</span>        tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = size;</div>
<div class="line"><span class="lineno"> 1397</span>        size -= old_off;</div>
<div class="line"><span class="lineno"> 1398</span>        chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 1399</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a584b2b319d71fad5848c5f3a1a971c11">buffer_len</a> - chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> &gt;= (<span class="keywordtype">size_t</span>)size) {</div>
<div class="line"><span class="lineno"> 1400</span>        <span class="comment">/* already have enough space in the first chain */</span></div>
<div class="line"><span class="lineno"> 1401</span>        <span class="keywordtype">size_t</span> old_off = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 1402</span>        <a class="code hl_struct" href="structbuffer.html">buffer</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 1403</span>        tmp = chain;</div>
<div class="line"><span class="lineno"> 1404</span>        tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = size;</div>
<div class="line"><span class="lineno"> 1405</span>        size -= old_off;</div>
<div class="line"><span class="lineno"> 1406</span>        chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 1407</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1408</span>        <span class="keywordflow">if</span> ((tmp = <a class="code hl_function" href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a>(size)) == NULL) {</div>
<div class="line"><span class="lineno"> 1409</span>            <a class="code hl_function" href="log-internal_8h.html#a266362bd8989fd1dacd0e1fc25b904f3">event_warn</a>(<span class="stringliteral">&quot;%s: out of memory&quot;</span>, <a class="code hl_define" href="util-internal_8h.html#a7d6e1cf1a8d53f38471e9e9db3faf740">__func__</a>);</div>
<div class="line"><span class="lineno"> 1410</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1411</span>        }</div>
<div class="line"><span class="lineno"> 1412</span>        <a class="code hl_struct" href="structbuffer.html">buffer</a> = tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a>;</div>
<div class="line"><span class="lineno"> 1413</span>        tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = size;</div>
<div class="line"><span class="lineno"> 1414</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a> = tmp;</div>
<div class="line"><span class="lineno"> 1415</span>    }</div>
<div class="line"><span class="lineno"> 1416</span> </div>
<div class="line"><span class="lineno"> 1417</span>    <span class="comment">/* TODO(niels): deal with buffers that point to NULL like sendfile */</span></div>
<div class="line"><span class="lineno"> 1418</span> </div>
<div class="line"><span class="lineno"> 1419</span>    <span class="comment">/* Copy and free every chunk that will be entirely pulled into tmp */</span></div>
<div class="line"><span class="lineno"> 1420</span>    last_with_data = *buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>;</div>
<div class="line"><span class="lineno"> 1421</span>    <span class="keywordflow">for</span> (; chain != NULL &amp;&amp; (size_t)size &gt;= chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>; chain = <a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>) {</div>
<div class="line"><span class="lineno"> 1422</span>        <a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 1423</span> </div>
<div class="line"><span class="lineno"> 1424</span>        <span class="keywordflow">if</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a>) {</div>
<div class="line"><span class="lineno"> 1425</span>            memcpy(<a class="code hl_struct" href="structbuffer.html">buffer</a>, chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>, chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>);</div>
<div class="line"><span class="lineno"> 1426</span>            size -= chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 1427</span>            <a class="code hl_struct" href="structbuffer.html">buffer</a> += chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 1428</span>        }</div>
<div class="line"><span class="lineno"> 1429</span>        <span class="keywordflow">if</span> (chain == last_with_data)</div>
<div class="line"><span class="lineno"> 1430</span>            removed_last_with_data = 1;</div>
<div class="line"><span class="lineno"> 1431</span>        <span class="keywordflow">if</span> (&amp;chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> == buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>)</div>
<div class="line"><span class="lineno"> 1432</span>            removed_last_with_datap = 1;</div>
<div class="line"><span class="lineno"> 1433</span> </div>
<div class="line"><span class="lineno"> 1434</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a7acdd31f1b39fc7c74f58103b23b6b0a">evbuffer_chain_free</a>(chain);</div>
<div class="line"><span class="lineno"> 1435</span>    }</div>
<div class="line"><span class="lineno"> 1436</span> </div>
<div class="line"><span class="lineno"> 1437</span>    <span class="keywordflow">if</span> (chain != NULL) {</div>
<div class="line"><span class="lineno"> 1438</span>        memcpy(<a class="code hl_struct" href="structbuffer.html">buffer</a>, chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>, size);</div>
<div class="line"><span class="lineno"> 1439</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> += size;</div>
<div class="line"><span class="lineno"> 1440</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> -= size;</div>
<div class="line"><span class="lineno"> 1441</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1442</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> = tmp;</div>
<div class="line"><span class="lineno"> 1443</span>    }</div>
<div class="line"><span class="lineno"> 1444</span> </div>
<div class="line"><span class="lineno"> 1445</span>    tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> = chain;</div>
<div class="line"><span class="lineno"> 1446</span> </div>
<div class="line"><span class="lineno"> 1447</span>    <span class="keywordflow">if</span> (removed_last_with_data) {</div>
<div class="line"><span class="lineno"> 1448</span>        buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = &amp;buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno"> 1449</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (removed_last_with_datap) {</div>
<div class="line"><span class="lineno"> 1450</span>        <span class="keywordflow">if</span> (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> &amp;&amp; buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>)</div>
<div class="line"><span class="lineno"> 1451</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = &amp;buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 1452</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1453</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = &amp;buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno"> 1454</span>    }</div>
<div class="line"><span class="lineno"> 1455</span> </div>
<div class="line"><span class="lineno"> 1456</span>    result = (tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>);</div>
<div class="line"><span class="lineno"> 1457</span> </div>
<div class="line"><span class="lineno"> 1458</span>done:</div>
<div class="line"><span class="lineno"> 1459</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 1460</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 1461</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="util-internal_8h_source.html#l00086">__func__</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00176">evbuffer_chain::buffer_len</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00133">CHAIN_PINNED</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00130">CHAIN_SPACE_LEN</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00129">CHAIN_SPACE_PTR</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00196">evbuffer_chain_free()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00157">evbuffer_chain_new()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="log-internal_8h.html#a266362bd8989fd1dacd0e1fc25b904f3">event_warn()</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00084">evbuffer::last</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>.</p>

<p class="reference">Referenced by <a class="el" href="event__tagging_8c_source.html#l00201">decode_tag_internal()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02578">evbuffer_find()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02524">evbuffer_write_atmost()</a>, and <a class="el" href="event__tagging_8c_source.html#l00471">evtag_unmarshal()</a>.</p>

</div>
</div>
<a id="a4e067ea6a72b62bd075571b421ac7e04" name="a4e067ea6a72b62bd075571b421ac7e04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e067ea6a72b62bd075571b421ac7e04">&#9670;&nbsp;</a></span>evbuffer_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">evutil_socket_t&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>howmuch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >USE_IOVEC_IMPL</p>

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02284">2284</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2285</span>{</div>
<div class="line"><span class="lineno"> 2286</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> **chainp;</div>
<div class="line"><span class="lineno"> 2287</span>    <span class="keywordtype">int</span> n;</div>
<div class="line"><span class="lineno"> 2288</span>    <span class="keywordtype">int</span> result;</div>
<div class="line"><span class="lineno"> 2289</span> </div>
<div class="line"><span class="lineno"> 2290</span><span class="preprocessor">#ifdef USE_IOVEC_IMPL</span></div>
<div class="line"><span class="lineno"> 2291</span>    <span class="keywordtype">int</span> nvecs, i, remaining;</div>
<div class="line"><span class="lineno"> 2292</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 2293</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain;</div>
<div class="line"><span class="lineno"> 2294</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p;</div>
<div class="line"><span class="lineno"> 2295</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2296</span> </div>
<div class="line"><span class="lineno"> 2297</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 2298</span> </div>
<div class="line"><span class="lineno"> 2299</span>    <span class="keywordflow">if</span> (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a6bed33d6f3074d83a5c39a21b3acbaf1">freeze_end</a>) {</div>
<div class="line"><span class="lineno"> 2300</span>        result = -1;</div>
<div class="line"><span class="lineno"> 2301</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 2302</span>    }</div>
<div class="line"><span class="lineno"> 2303</span> </div>
<div class="line"><span class="lineno"> 2304</span>    n = <a class="code hl_function" href="libevent_2buffer_8c.html#aa62a364d82e2d2146c09541026650104">get_n_bytes_readable_on_socket</a>(fd);</div>
<div class="line"><span class="lineno"> 2305</span>    <span class="keywordflow">if</span> (n &lt;= 0 || n &gt; <a class="code hl_define" href="libevent_2buffer_8c.html#af22cda87cfe7fa6b9a07c4c645bcb754">EVBUFFER_MAX_READ</a>)</div>
<div class="line"><span class="lineno"> 2306</span>        n = <a class="code hl_define" href="libevent_2buffer_8c.html#af22cda87cfe7fa6b9a07c4c645bcb754">EVBUFFER_MAX_READ</a>;</div>
<div class="line"><span class="lineno"> 2307</span>    <span class="keywordflow">if</span> (howmuch &lt; 0 || howmuch &gt; n)</div>
<div class="line"><span class="lineno"> 2308</span>        howmuch = n;</div>
<div class="line"><span class="lineno"> 2309</span> </div>
<div class="line"><span class="lineno"> 2310</span><span class="preprocessor">#ifdef USE_IOVEC_IMPL</span></div>
<div class="line"><span class="lineno"> 2311</span>    <span class="comment">/* Since we can use iovecs, we&#39;re willing to use the last</span></div>
<div class="line"><span class="lineno"> 2312</span><span class="comment">     * NUM_READ_IOVEC chains. */</span></div>
<div class="line"><span class="lineno"> 2313</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#a0169295592d02008ef6229de9ba8a79b">evbuffer_expand_fast_</a>(buf, howmuch, <a class="code hl_define" href="libevent_2buffer_8c.html#a8d7d34f52e59cad4a53c7afb41b3ce1b">NUM_READ_IOVEC</a>) == -1) {</div>
<div class="line"><span class="lineno"> 2314</span>        result = -1;</div>
<div class="line"><span class="lineno"> 2315</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 2316</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2317</span>        IOV_TYPE vecs[<a class="code hl_define" href="libevent_2buffer_8c.html#a8d7d34f52e59cad4a53c7afb41b3ce1b">NUM_READ_IOVEC</a>];</div>
<div class="line"><span class="lineno"> 2318</span><span class="preprocessor">#ifdef EVBUFFER_IOVEC_IS_NATIVE_</span></div>
<div class="line"><span class="lineno"> 2319</span>        nvecs = <a class="code hl_function" href="libevent_2buffer_8c.html#a2c28b535591bbd5a33a3e5e00ba9b1c7">evbuffer_read_setup_vecs_</a>(buf, howmuch, vecs,</div>
<div class="line"><span class="lineno"> 2320</span>            <a class="code hl_define" href="libevent_2buffer_8c.html#a8d7d34f52e59cad4a53c7afb41b3ce1b">NUM_READ_IOVEC</a>, &amp;chainp, 1);</div>
<div class="line"><span class="lineno"> 2321</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 2322</span>        <span class="comment">/* We aren&#39;t using the native struct iovec.  Therefore,</span></div>
<div class="line"><span class="lineno"> 2323</span><span class="comment">           we are on win32. */</span></div>
<div class="line"><span class="lineno"> 2324</span>        <span class="keyword">struct </span>evbuffer_iovec ev_vecs[<a class="code hl_define" href="libevent_2buffer_8c.html#a8d7d34f52e59cad4a53c7afb41b3ce1b">NUM_READ_IOVEC</a>];</div>
<div class="line"><span class="lineno"> 2325</span>        nvecs = <a class="code hl_function" href="libevent_2buffer_8c.html#a2c28b535591bbd5a33a3e5e00ba9b1c7">evbuffer_read_setup_vecs_</a>(buf, howmuch, ev_vecs, 2,</div>
<div class="line"><span class="lineno"> 2326</span>            &amp;chainp, 1);</div>
<div class="line"><span class="lineno"> 2327</span> </div>
<div class="line"><span class="lineno"> 2328</span>        <span class="keywordflow">for</span> (i=0; i &lt; nvecs; ++i)</div>
<div class="line"><span class="lineno"> 2329</span>            <a class="code hl_define" href="evbuffer-internal_8h.html#a65d8385549fea2f6a752537b4679ba3d">WSABUF_FROM_EVBUFFER_IOV</a>(&amp;vecs[i], &amp;ev_vecs[i]);</div>
<div class="line"><span class="lineno"> 2330</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2331</span> </div>
<div class="line"><span class="lineno"> 2332</span><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="lineno"> 2333</span>        {</div>
<div class="line"><span class="lineno"> 2334</span>            DWORD bytesRead;</div>
<div class="line"><span class="lineno"> 2335</span>            DWORD flags=0;</div>
<div class="line"><span class="lineno"> 2336</span>            <span class="keywordflow">if</span> (WSARecv(fd, vecs, nvecs, &amp;bytesRead, &amp;flags, NULL, NULL)) {</div>
<div class="line"><span class="lineno"> 2337</span>                <span class="comment">/* The read failed. It might be a close,</span></div>
<div class="line"><span class="lineno"> 2338</span><span class="comment">                 * or it might be an error. */</span></div>
<div class="line"><span class="lineno"> 2339</span>                <span class="keywordflow">if</span> (WSAGetLastError() == WSAECONNABORTED)</div>
<div class="line"><span class="lineno"> 2340</span>                    n = 0;</div>
<div class="line"><span class="lineno"> 2341</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2342</span>                    n = -1;</div>
<div class="line"><span class="lineno"> 2343</span>            } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2344</span>                n = bytesRead;</div>
<div class="line"><span class="lineno"> 2345</span>        }</div>
<div class="line"><span class="lineno"> 2346</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 2347</span>        n = readv(fd, vecs, nvecs);</div>
<div class="line"><span class="lineno"> 2348</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2349</span>    }</div>
<div class="line"><span class="lineno"> 2350</span> </div>
<div class="line"><span class="lineno"> 2351</span><span class="preprocessor">#else </span></div>
<div class="line"><span class="lineno"> 2352</span>    <span class="comment">/* If we don&#39;t have FIONREAD, we might waste some space here */</span></div>
<div class="line"><span class="lineno"> 2353</span>    <span class="comment">/* XXX we _will_ waste some space here if there is any space left</span></div>
<div class="line"><span class="lineno"> 2354</span><span class="comment">     * over on buf-&gt;last. */</span></div>
<div class="line"><span class="lineno"> 2355</span>    <span class="keywordflow">if</span> ((chain = <a class="code hl_function" href="libevent_2buffer_8c.html#af29382773b8c1cbe484de86282e6fb87">evbuffer_expand_singlechain</a>(buf, howmuch)) == NULL) {</div>
<div class="line"><span class="lineno"> 2356</span>        result = -1;</div>
<div class="line"><span class="lineno"> 2357</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 2358</span>    }</div>
<div class="line"><span class="lineno"> 2359</span> </div>
<div class="line"><span class="lineno"> 2360</span>    <span class="comment">/* We can append new data at this point */</span></div>
<div class="line"><span class="lineno"> 2361</span>    p = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 2362</span> </div>
<div class="line"><span class="lineno"> 2363</span><span class="preprocessor">#ifndef _WIN32</span></div>
<div class="line"><span class="lineno"> 2364</span>    n = read(fd, p, howmuch);</div>
<div class="line"><span class="lineno"> 2365</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 2366</span>    n = recv(fd, p, howmuch, 0);</div>
<div class="line"><span class="lineno"> 2367</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2368</span><span class="preprocessor">#endif </span><span class="comment">/* USE_IOVEC_IMPL */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno"> 2369</span> </div>
<div class="line"><span class="lineno"> 2370</span>    <span class="keywordflow">if</span> (n == -1) {</div>
<div class="line"><span class="lineno"> 2371</span>        result = -1;</div>
<div class="line"><span class="lineno"> 2372</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 2373</span>    }</div>
<div class="line"><span class="lineno"> 2374</span>    <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line"><span class="lineno"> 2375</span>        result = 0;</div>
<div class="line"><span class="lineno"> 2376</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 2377</span>    }</div>
<div class="line"><span class="lineno"> 2378</span> </div>
<div class="line"><span class="lineno"> 2379</span><span class="preprocessor">#ifdef USE_IOVEC_IMPL</span></div>
<div class="line"><span class="lineno"> 2380</span>    remaining = n;</div>
<div class="line"><span class="lineno"> 2381</span>    <span class="keywordflow">for</span> (i=0; i &lt; nvecs; ++i) {</div>
<div class="line"><span class="lineno"> 2382</span>        <span class="comment">/* can&#39;t overflow, since only mutable chains have</span></div>
<div class="line"><span class="lineno"> 2383</span><span class="comment">         * huge misaligns. */</span></div>
<div class="line"><span class="lineno"> 2384</span>        <span class="keywordtype">size_t</span> space = (size_t) <a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(*chainp);</div>
<div class="line"><span class="lineno"> 2385</span>        <span class="comment">/* XXXX This is a kludge that can waste space in perverse</span></div>
<div class="line"><span class="lineno"> 2386</span><span class="comment">         * situations. */</span></div>
<div class="line"><span class="lineno"> 2387</span>        <span class="keywordflow">if</span> (space &gt; <a class="code hl_define" href="evbuffer-internal_8h.html#a6fc2d164d40c2e7fba6014619f968b16">EVBUFFER_CHAIN_MAX</a>)</div>
<div class="line"><span class="lineno"> 2388</span>            space = <a class="code hl_define" href="evbuffer-internal_8h.html#a6fc2d164d40c2e7fba6014619f968b16">EVBUFFER_CHAIN_MAX</a>;</div>
<div class="line"><span class="lineno"> 2389</span>        <span class="keywordflow">if</span> ((ev_ssize_t)space &lt; remaining) {</div>
<div class="line"><span class="lineno"> 2390</span>            (*chainp)-&gt;off += space;</div>
<div class="line"><span class="lineno"> 2391</span>            remaining -= (int)space;</div>
<div class="line"><span class="lineno"> 2392</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2393</span>            (*chainp)-&gt;off += remaining;</div>
<div class="line"><span class="lineno"> 2394</span>            buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = chainp;</div>
<div class="line"><span class="lineno"> 2395</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2396</span>        }</div>
<div class="line"><span class="lineno"> 2397</span>        chainp = &amp;(*chainp)-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 2398</span>    }</div>
<div class="line"><span class="lineno"> 2399</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 2400</span>    chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> += n;</div>
<div class="line"><span class="lineno"> 2401</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a77d24636f0fc7b5e7de020ad37633aad">advance_last_with_data</a>(buf);</div>
<div class="line"><span class="lineno"> 2402</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2403</span>    buf-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> += n;</div>
<div class="line"><span class="lineno"> 2404</span>    buf-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += n;</div>
<div class="line"><span class="lineno"> 2405</span> </div>
<div class="line"><span class="lineno"> 2406</span>    <span class="comment">/* Tell someone about changes in this buffer */</span></div>
<div class="line"><span class="lineno"> 2407</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a>(buf);</div>
<div class="line"><span class="lineno"> 2408</span>    result = n;</div>
<div class="line"><span class="lineno"> 2409</span>done:</div>
<div class="line"><span class="lineno"> 2410</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 2411</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 2412</span>}</div>
<div class="ttc" id="aevbuffer-internal_8h_html_a65d8385549fea2f6a752537b4679ba3d"><div class="ttname"><a href="evbuffer-internal_8h.html#a65d8385549fea2f6a752537b4679ba3d">WSABUF_FROM_EVBUFFER_IOV</a></div><div class="ttdeci">#define WSABUF_FROM_EVBUFFER_IOV(i, ei)</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00330">evbuffer-internal.h:330</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a2c28b535591bbd5a33a3e5e00ba9b1c7"><div class="ttname"><a href="libevent_2buffer_8c.html#a2c28b535591bbd5a33a3e5e00ba9b1c7">evbuffer_read_setup_vecs_</a></div><div class="ttdeci">int evbuffer_read_setup_vecs_(struct evbuffer *buf, ev_ssize_t howmuch, struct evbuffer_iovec *vecs, int n_vecs_avail, struct evbuffer_chain ***chainp, int exact)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l02225">buffer.c:2225</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a8d7d34f52e59cad4a53c7afb41b3ce1b"><div class="ttname"><a href="libevent_2buffer_8c.html#a8d7d34f52e59cad4a53c7afb41b3ce1b">NUM_READ_IOVEC</a></div><div class="ttdeci">#define NUM_READ_IOVEC</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l02207">buffer.c:2207</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_aa62a364d82e2d2146c09541026650104"><div class="ttname"><a href="libevent_2buffer_8c.html#aa62a364d82e2d2146c09541026650104">get_n_bytes_readable_on_socket</a></div><div class="ttdeci">static int get_n_bytes_readable_on_socket(evutil_socket_t fd)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l02263">buffer.c:2263</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_af22cda87cfe7fa6b9a07c4c645bcb754"><div class="ttname"><a href="libevent_2buffer_8c.html#af22cda87cfe7fa6b9a07c4c645bcb754">EVBUFFER_MAX_READ</a></div><div class="ttdeci">#define EVBUFFER_MAX_READ</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l02209">buffer.c:2209</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00704">advance_last_with_data()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00130">CHAIN_SPACE_LEN</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00166">EVBUFFER_CHAIN_MAX</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02051">evbuffer_expand_fast_()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01939">evbuffer_expand_singlechain()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00514">evbuffer_invoke_callbacks_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02209">EVBUFFER_MAX_READ</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02225">evbuffer_read_setup_vecs_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00123">evbuffer::freeze_end</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02263">get_n_bytes_readable_on_socket()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00106">evbuffer::n_add_for_cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02207">NUM_READ_IOVEC</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00330">WSABUF_FROM_EVBUFFER_IOV</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__sock_8c_source.html#l00149">bufferevent_readcb()</a>.</p>

</div>
</div>
<a id="a2c28b535591bbd5a33a3e5e00ba9b1c7" name="a2c28b535591bbd5a33a3e5e00ba9b1c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c28b535591bbd5a33a3e5e00ba9b1c7">&#9670;&nbsp;</a></span>evbuffer_read_setup_vecs_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_read_setup_vecs_ </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev_ssize_t&#160;</td>
          <td class="paramname"><em>howmuch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct evbuffer_iovec *&#160;</td>
          <td class="paramname"><em>vecs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_vecs_avail</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> ***&#160;</td>
          <td class="paramname"><em>chainp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>exact</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Helper function to figure out which space to use for reading data into an evbuffer. Internal use only.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>The buffer to read into </td></tr>
    <tr><td class="paramname">howmuch</td><td>How much we want to read. </td></tr>
    <tr><td class="paramname">vecs</td><td>An array of two or more iovecs or WSABUFs. </td></tr>
    <tr><td class="paramname">n_vecs_avail</td><td>The length of vecs </td></tr>
    <tr><td class="paramname">chainp</td><td>A pointer to a variable to hold the first chain we're reading into. </td></tr>
    <tr><td class="paramname">exact</td><td>Boolean: if true, we do not provide more than 'howmuch' space in the vectors, even if more space is available. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of buffers we're using. </dd></dl>

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02225">2225</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2228</span>{</div>
<div class="line"><span class="lineno"> 2229</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain;</div>
<div class="line"><span class="lineno"> 2230</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> **firstchainp;</div>
<div class="line"><span class="lineno"> 2231</span>    <span class="keywordtype">size_t</span> so_far;</div>
<div class="line"><span class="lineno"> 2232</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 2233</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(buf);</div>
<div class="line"><span class="lineno"> 2234</span> </div>
<div class="line"><span class="lineno"> 2235</span>    <span class="keywordflow">if</span> (howmuch &lt; 0)</div>
<div class="line"><span class="lineno"> 2236</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2237</span> </div>
<div class="line"><span class="lineno"> 2238</span>    so_far = 0;</div>
<div class="line"><span class="lineno"> 2239</span>    <span class="comment">/* Let firstchain be the first chain with any space on it */</span></div>
<div class="line"><span class="lineno"> 2240</span>    firstchainp = buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>;</div>
<div class="line"><span class="lineno"> 2241</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(*firstchainp);</div>
<div class="line"><span class="lineno"> 2242</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(*firstchainp) == 0) {</div>
<div class="line"><span class="lineno"> 2243</span>        firstchainp = &amp;(*firstchainp)-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 2244</span>    }</div>
<div class="line"><span class="lineno"> 2245</span> </div>
<div class="line"><span class="lineno"> 2246</span>    chain = *firstchainp;</div>
<div class="line"><span class="lineno"> 2247</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(chain);</div>
<div class="line"><span class="lineno"> 2248</span>    <span class="keywordflow">for</span> (i = 0; i &lt; n_vecs_avail &amp;&amp; so_far &lt; (size_t)howmuch; ++i) {</div>
<div class="line"><span class="lineno"> 2249</span>        <span class="keywordtype">size_t</span> avail = (size_t) <a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(chain);</div>
<div class="line"><span class="lineno"> 2250</span>        <span class="keywordflow">if</span> (avail &gt; (howmuch - so_far) &amp;&amp; exact)</div>
<div class="line"><span class="lineno"> 2251</span>            avail = howmuch - so_far;</div>
<div class="line"><span class="lineno"> 2252</span>        vecs[i].iov_base = (<span class="keywordtype">void</span> *)<a class="code hl_define" href="libevent_2buffer_8c.html#a17846db51ec6b10c559ec8af1b30e379">CHAIN_SPACE_PTR</a>(chain);</div>
<div class="line"><span class="lineno"> 2253</span>        vecs[i].iov_len = avail;</div>
<div class="line"><span class="lineno"> 2254</span>        so_far += avail;</div>
<div class="line"><span class="lineno"> 2255</span>        chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 2256</span>    }</div>
<div class="line"><span class="lineno"> 2257</span> </div>
<div class="line"><span class="lineno"> 2258</span>    *chainp = firstchainp;</div>
<div class="line"><span class="lineno"> 2259</span>    <span class="keywordflow">return</span> i;</div>
<div class="line"><span class="lineno"> 2260</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00282">ASSERT_EVBUFFER_LOCKED</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00130">CHAIN_SPACE_LEN</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00129">CHAIN_SPACE_PTR</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>.</p>

<p class="reference">Referenced by <a class="el" href="buffer__iocp_8c_source.html#l00246">evbuffer_launch_read_()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02284">evbuffer_read()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00671">evbuffer_reserve_space()</a>.</p>

</div>
</div>
<a id="ae8608c1eb1f6e86a006f1e9fcfb9f31d" name="ae8608c1eb1f6e86a006f1e9fcfb9f31d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8608c1eb1f6e86a006f1e9fcfb9f31d">&#9670;&nbsp;</a></span>evbuffer_readline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * evbuffer_readline </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01468">1468</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1469</span>{</div>
<div class="line"><span class="lineno"> 1470</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="libevent_2buffer_8c.html#a145454dc7f26b678aa6b724aaf8742e7">evbuffer_readln</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, NULL, EVBUFFER_EOL_ANY);</div>
<div class="line"><span class="lineno"> 1471</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a145454dc7f26b678aa6b724aaf8742e7"><div class="ttname"><a href="libevent_2buffer_8c.html#a145454dc7f26b678aa6b724aaf8742e7">evbuffer_readln</a></div><div class="ttdeci">char * evbuffer_readln(struct evbuffer *buffer, size_t *n_read_out, enum evbuffer_eol_style eol_style)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01687">buffer.c:1687</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l01687">evbuffer_readln()</a>.</p>

</div>
</div>
<a id="a145454dc7f26b678aa6b724aaf8742e7" name="a145454dc7f26b678aa6b724aaf8742e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a145454dc7f26b678aa6b724aaf8742e7">&#9670;&nbsp;</a></span>evbuffer_readln()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * evbuffer_readln </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>n_read_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum evbuffer_eol_style&#160;</td>
          <td class="paramname"><em>eol_style</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01687">1687</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1689</span>{</div>
<div class="line"><span class="lineno"> 1690</span>    <span class="keyword">struct </span>evbuffer_ptr it;</div>
<div class="line"><span class="lineno"> 1691</span>    <span class="keywordtype">char</span> *line;</div>
<div class="line"><span class="lineno"> 1692</span>    <span class="keywordtype">size_t</span> n_to_copy=0, extra_drain=0;</div>
<div class="line"><span class="lineno"> 1693</span>    <span class="keywordtype">char</span> *result = NULL;</div>
<div class="line"><span class="lineno"> 1694</span> </div>
<div class="line"><span class="lineno"> 1695</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 1696</span> </div>
<div class="line"><span class="lineno"> 1697</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;freeze_start) {</div>
<div class="line"><span class="lineno"> 1698</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1699</span>    }</div>
<div class="line"><span class="lineno"> 1700</span> </div>
<div class="line"><span class="lineno"> 1701</span>    it = <a class="code hl_function" href="libevent_2buffer_8c.html#aa54aca588fa272157513191a9628d457">evbuffer_search_eol</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, NULL, &amp;extra_drain, eol_style);</div>
<div class="line"><span class="lineno"> 1702</span>    <span class="keywordflow">if</span> (it.pos &lt; 0)</div>
<div class="line"><span class="lineno"> 1703</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1704</span>    n_to_copy = it.pos;</div>
<div class="line"><span class="lineno"> 1705</span> </div>
<div class="line"><span class="lineno"> 1706</span>    <span class="keywordflow">if</span> ((line = <a class="code hl_define" href="mm-internal_8h.html#a7c27fb60329839e84d16185cda4734d5">mm_malloc</a>(n_to_copy+1)) == NULL) {</div>
<div class="line"><span class="lineno"> 1707</span>        <a class="code hl_function" href="log-internal_8h.html#a266362bd8989fd1dacd0e1fc25b904f3">event_warn</a>(<span class="stringliteral">&quot;%s: out of memory&quot;</span>, <a class="code hl_define" href="util-internal_8h.html#a7d6e1cf1a8d53f38471e9e9db3faf740">__func__</a>);</div>
<div class="line"><span class="lineno"> 1708</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1709</span>    }</div>
<div class="line"><span class="lineno"> 1710</span> </div>
<div class="line"><span class="lineno"> 1711</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#af5a341004cb2b4fb591fe11544b3228d">evbuffer_remove</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, line, n_to_copy);</div>
<div class="line"><span class="lineno"> 1712</span>    line[n_to_copy] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1713</span> </div>
<div class="line"><span class="lineno"> 1714</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a5c24f3bfbc941d693bf59b5d77d2c37f">evbuffer_drain</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, extra_drain);</div>
<div class="line"><span class="lineno"> 1715</span>    result = line;</div>
<div class="line"><span class="lineno"> 1716</span>done:</div>
<div class="line"><span class="lineno"> 1717</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 1718</span> </div>
<div class="line"><span class="lineno"> 1719</span>    <span class="keywordflow">if</span> (n_read_out)</div>
<div class="line"><span class="lineno"> 1720</span>        *n_read_out = result ? n_to_copy : 0;</div>
<div class="line"><span class="lineno"> 1721</span> </div>
<div class="line"><span class="lineno"> 1722</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 1723</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a5c24f3bfbc941d693bf59b5d77d2c37f"><div class="ttname"><a href="libevent_2buffer_8c.html#a5c24f3bfbc941d693bf59b5d77d2c37f">evbuffer_drain</a></div><div class="ttdeci">int evbuffer_drain(struct evbuffer *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01101">buffer.c:1101</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_aa54aca588fa272157513191a9628d457"><div class="ttname"><a href="libevent_2buffer_8c.html#aa54aca588fa272157513191a9628d457">evbuffer_search_eol</a></div><div class="ttdeci">struct evbuffer_ptr evbuffer_search_eol(struct evbuffer *buffer, struct evbuffer_ptr *start, size_t *eol_len_out, enum evbuffer_eol_style eol_style)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01597">buffer.c:1597</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_af5a341004cb2b4fb591fe11544b3228d"><div class="ttname"><a href="libevent_2buffer_8c.html#af5a341004cb2b4fb591fe11544b3228d">evbuffer_remove</a></div><div class="ttdeci">int evbuffer_remove(struct evbuffer *buf, void *data_out, size_t datlen)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01170">buffer.c:1170</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="util-internal_8h_source.html#l00086">__func__</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01101">evbuffer_drain()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01170">evbuffer_remove()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01597">evbuffer_search_eol()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="log-internal_8h.html#a266362bd8989fd1dacd0e1fc25b904f3">event_warn()</a>, and <a class="el" href="mm-internal_8h_source.html#l00075">mm_malloc</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01468">evbuffer_readline()</a>, <a class="el" href="http_8c_source.html#l00906">evhttp_handle_chunked_read()</a>, <a class="el" href="http_8c_source.html#l02025">evhttp_parse_firstline_()</a>, and <a class="el" href="http_8c_source.html#l02096">evhttp_parse_headers_()</a>.</p>

</div>
</div>
<a id="af5a341004cb2b4fb591fe11544b3228d" name="af5a341004cb2b4fb591fe11544b3228d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5a341004cb2b4fb591fe11544b3228d">&#9670;&nbsp;</a></span>evbuffer_remove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_remove </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01170">1170</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1171</span>{</div>
<div class="line"><span class="lineno"> 1172</span>    ev_ssize_t n;</div>
<div class="line"><span class="lineno"> 1173</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 1174</span>    n = <a class="code hl_function" href="libevent_2buffer_8c.html#ac88bba444ce768f5e3e4cf38e48381ab">evbuffer_copyout_from</a>(buf, NULL, data_out, datlen);</div>
<div class="line"><span class="lineno"> 1175</span>    <span class="keywordflow">if</span> (n &gt; 0) {</div>
<div class="line"><span class="lineno"> 1176</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#a5c24f3bfbc941d693bf59b5d77d2c37f">evbuffer_drain</a>(buf, n)&lt;0)</div>
<div class="line"><span class="lineno"> 1177</span>            n = -1;</div>
<div class="line"><span class="lineno"> 1178</span>    }</div>
<div class="line"><span class="lineno"> 1179</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno"> 1180</span>    <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)n;</div>
<div class="line"><span class="lineno"> 1181</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l01190">evbuffer_copyout_from()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01101">evbuffer_drain()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__openssl_8c_source.html#l00133">bio_bufferevent_read()</a>, <a class="el" href="bufferevent_8c_source.html#l00470">bufferevent_read()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01687">evbuffer_readln()</a>, <a class="el" href="http_8c_source.html#l04948">evhttp_uri_join()</a>, <a class="el" href="http_8c_source.html#l03110">evhttp_uriencode()</a>, <a class="el" href="event__tagging_8c_source.html#l00543">evtag_unmarshal_fixed()</a>, and <a class="el" href="event__tagging_8c_source.html#l00562">evtag_unmarshal_string()</a>.</p>

</div>
</div>
<a id="a8baa73c3690e47a1e2b5af4e069c3f68" name="a8baa73c3690e47a1e2b5af4e069c3f68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8baa73c3690e47a1e2b5af4e069c3f68">&#9670;&nbsp;</a></span>evbuffer_remove_all_callbacks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void evbuffer_remove_all_callbacks </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00550">550</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  551</span>{</div>
<div class="line"><span class="lineno">  552</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__cb__entry.html">evbuffer_cb_entry</a> *cbent;</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>    <span class="keywordflow">while</span> ((cbent = LIST_FIRST(&amp;<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;callbacks))) {</div>
<div class="line"><span class="lineno">  555</span>        LIST_REMOVE(cbent, next);</div>
<div class="line"><span class="lineno">  556</span>        <a class="code hl_define" href="mm-internal_8h.html#af7d87798652aaa8398bb9c0504256f16">mm_free</a>(cbent);</div>
<div class="line"><span class="lineno">  557</span>    }</div>
<div class="line"><span class="lineno">  558</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mm-internal_8h_source.html#l00079">mm_free</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00561">evbuffer_decref_and_unlock_()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l03312">evbuffer_setcb()</a>.</p>

</div>
</div>
<a id="a0bdef97f6a142425b271b329a90de869" name="a0bdef97f6a142425b271b329a90de869"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bdef97f6a142425b271b329a90de869">&#9670;&nbsp;</a></span>evbuffer_remove_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_remove_buffer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01260">1260</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1262</span>{</div>
<div class="line"><span class="lineno"> 1263</span>    <span class="comment">/*XXX We should have an option to force this to be zero-copy.*/</span></div>
<div class="line"><span class="lineno"> 1264</span> </div>
<div class="line"><span class="lineno"> 1265</span>    <span class="comment">/*XXX can fail badly on sendfile case. */</span></div>
<div class="line"><span class="lineno"> 1266</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain, *previous;</div>
<div class="line"><span class="lineno"> 1267</span>    <span class="keywordtype">size_t</span> nread = 0;</div>
<div class="line"><span class="lineno"> 1268</span>    <span class="keywordtype">int</span> result;</div>
<div class="line"><span class="lineno"> 1269</span> </div>
<div class="line"><span class="lineno"> 1270</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a9eaca177b89c10b76bf6f8228aace3ba">EVBUFFER_LOCK2</a>(src, dst);</div>
<div class="line"><span class="lineno"> 1271</span> </div>
<div class="line"><span class="lineno"> 1272</span>    chain = previous = src-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno"> 1273</span> </div>
<div class="line"><span class="lineno"> 1274</span>    <span class="keywordflow">if</span> (datlen == 0 || dst == src) {</div>
<div class="line"><span class="lineno"> 1275</span>        result = 0;</div>
<div class="line"><span class="lineno"> 1276</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1277</span>    }</div>
<div class="line"><span class="lineno"> 1278</span> </div>
<div class="line"><span class="lineno"> 1279</span>    <span class="keywordflow">if</span> (dst-&gt;<a class="code hl_variable" href="structevbuffer.html#a6bed33d6f3074d83a5c39a21b3acbaf1">freeze_end</a> || src-&gt;<a class="code hl_variable" href="structevbuffer.html#a082d569d992120cf9ff28ddb0f5da313">freeze_start</a>) {</div>
<div class="line"><span class="lineno"> 1280</span>        result = -1;</div>
<div class="line"><span class="lineno"> 1281</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1282</span>    }</div>
<div class="line"><span class="lineno"> 1283</span> </div>
<div class="line"><span class="lineno"> 1284</span>    <span class="comment">/* short-cut if there is no more data buffered */</span></div>
<div class="line"><span class="lineno"> 1285</span>    <span class="keywordflow">if</span> (datlen &gt;= src-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>) {</div>
<div class="line"><span class="lineno"> 1286</span>        datlen = src-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>;</div>
<div class="line"><span class="lineno"> 1287</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a9d2edd536246d70c50678a3865305414">evbuffer_add_buffer</a>(dst, src);</div>
<div class="line"><span class="lineno"> 1288</span>        result = (int)datlen; <span class="comment">/*XXXX should return ev_ssize_t*/</span></div>
<div class="line"><span class="lineno"> 1289</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1290</span>    }</div>
<div class="line"><span class="lineno"> 1291</span> </div>
<div class="line"><span class="lineno"> 1292</span>    <span class="comment">/* removes chains if possible */</span></div>
<div class="line"><span class="lineno"> 1293</span>    <span class="keywordflow">while</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> &lt;= datlen) {</div>
<div class="line"><span class="lineno"> 1294</span>        <span class="comment">/* We can&#39;t remove the last with data from src unless we</span></div>
<div class="line"><span class="lineno"> 1295</span><span class="comment">         * remove all chains, in which case we would have done the if</span></div>
<div class="line"><span class="lineno"> 1296</span><span class="comment">         * block above */</span></div>
<div class="line"><span class="lineno"> 1297</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(chain != *src-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>);</div>
<div class="line"><span class="lineno"> 1298</span>        nread += chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 1299</span>        datlen -= chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno"> 1300</span>        previous = chain;</div>
<div class="line"><span class="lineno"> 1301</span>        <span class="keywordflow">if</span> (src-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> == &amp;chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>)</div>
<div class="line"><span class="lineno"> 1302</span>            src-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = &amp;src-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno"> 1303</span>        chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 1304</span>    }</div>
<div class="line"><span class="lineno"> 1305</span> </div>
<div class="line"><span class="lineno"> 1306</span>    <span class="keywordflow">if</span> (chain != src-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>) {</div>
<div class="line"><span class="lineno"> 1307</span>        <span class="comment">/* we can remove the chain */</span></div>
<div class="line"><span class="lineno"> 1308</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> **chp;</div>
<div class="line"><span class="lineno"> 1309</span>        chp = <a class="code hl_function" href="libevent_2buffer_8c.html#aa0b9aab1a4a4fb3d9e446b03d1ad2743">evbuffer_free_trailing_empty_chains</a>(dst);</div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span>        <span class="keywordflow">if</span> (dst-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a> == NULL) {</div>
<div class="line"><span class="lineno"> 1312</span>            dst-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a> = src-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno"> 1313</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1314</span>            *chp = src-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno"> 1315</span>        }</div>
<div class="line"><span class="lineno"> 1316</span>        dst-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> = previous;</div>
<div class="line"><span class="lineno"> 1317</span>        previous-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> = NULL;</div>
<div class="line"><span class="lineno"> 1318</span>        src-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a> = chain;</div>
<div class="line"><span class="lineno"> 1319</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a77d24636f0fc7b5e7de020ad37633aad">advance_last_with_data</a>(dst);</div>
<div class="line"><span class="lineno"> 1320</span> </div>
<div class="line"><span class="lineno"> 1321</span>        dst-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> += nread;</div>
<div class="line"><span class="lineno"> 1322</span>        dst-&gt;<a class="code hl_variable" href="structevbuffer.html#ab2953dce6411c80514f7c787b311725c">n_add_for_cb</a> += nread;</div>
<div class="line"><span class="lineno"> 1323</span>    }</div>
<div class="line"><span class="lineno"> 1324</span> </div>
<div class="line"><span class="lineno"> 1325</span>    <span class="comment">/* we know that there is more data in the src buffer than</span></div>
<div class="line"><span class="lineno"> 1326</span><span class="comment">     * we want to read, so we manually drain the chain */</span></div>
<div class="line"><span class="lineno"> 1327</span>    <a class="code hl_function" href="libevent_2buffer_8c.html#a8bcbab1212ab067b8faa767febc347ef">evbuffer_add</a>(dst, chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>, datlen);</div>
<div class="line"><span class="lineno"> 1328</span>    chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> += datlen;</div>
<div class="line"><span class="lineno"> 1329</span>    chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> -= datlen;</div>
<div class="line"><span class="lineno"> 1330</span>    nread += datlen;</div>
<div class="line"><span class="lineno"> 1331</span> </div>
<div class="line"><span class="lineno"> 1332</span>    <span class="comment">/* You might think we would want to increment dst-&gt;n_add_for_cb</span></div>
<div class="line"><span class="lineno"> 1333</span><span class="comment">     * here too.  But evbuffer_add above already took care of that.</span></div>
<div class="line"><span class="lineno"> 1334</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1335</span>    src-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> -= nread;</div>
<div class="line"><span class="lineno"> 1336</span>    src-&gt;<a class="code hl_variable" href="structevbuffer.html#a5f4fd4011a0461e5fbee4e417031a960">n_del_for_cb</a> += nread;</div>
<div class="line"><span class="lineno"> 1337</span> </div>
<div class="line"><span class="lineno"> 1338</span>    <span class="keywordflow">if</span> (nread) {</div>
<div class="line"><span class="lineno"> 1339</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a>(dst);</div>
<div class="line"><span class="lineno"> 1340</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a19e27adc7ac1c3b2c8303586c39e912e">evbuffer_invoke_callbacks_</a>(src);</div>
<div class="line"><span class="lineno"> 1341</span>    }</div>
<div class="line"><span class="lineno"> 1342</span>    result = (int)nread;<span class="comment">/*XXXX should change return type */</span></div>
<div class="line"><span class="lineno"> 1343</span> </div>
<div class="line"><span class="lineno"> 1344</span>done:</div>
<div class="line"><span class="lineno"> 1345</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2c063b555017c0dfceede8560a711aed">EVBUFFER_UNLOCK2</a>(src, dst);</div>
<div class="line"><span class="lineno"> 1346</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 1347</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a9d2edd536246d70c50678a3865305414"><div class="ttname"><a href="libevent_2buffer_8c.html#a9d2edd536246d70c50678a3865305414">evbuffer_add_buffer</a></div><div class="ttdeci">int evbuffer_add_buffer(struct evbuffer *outbuf, struct evbuffer *inbuf)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00966">buffer.c:966</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00704">advance_last_with_data()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01730">evbuffer_add()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00966">evbuffer_add_buffer()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00291">evbuffer_free_trailing_empty_chains()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00514">evbuffer_invoke_callbacks_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00293">EVBUFFER_LOCK2</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00297">EVBUFFER_UNLOCK2</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00123">evbuffer::freeze_end</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00120">evbuffer::freeze_start</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00084">evbuffer::last</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00106">evbuffer::n_add_for_cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00109">evbuffer::n_del_for_cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__filter_8c_source.html#l00159">be_null_filter()</a>, <a class="el" href="bufferevent__pair_8c_source.html#l00153">be_pair_transfer()</a>, <a class="el" href="http_8c_source.html#l00906">evhttp_handle_chunked_read()</a>, and <a class="el" href="http_8c_source.html#l01047">evhttp_read_body()</a>.</p>

</div>
</div>
<a id="a4d7c75045267863306d37043d3f0809a" name="a4d7c75045267863306d37043d3f0809a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d7c75045267863306d37043d3f0809a">&#9670;&nbsp;</a></span>evbuffer_remove_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_remove_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">evbuffer_cb_func&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cbarg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l03360">3360</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3361</span>{</div>
<div class="line"><span class="lineno"> 3362</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__cb__entry.html">evbuffer_cb_entry</a> *cbent;</div>
<div class="line"><span class="lineno"> 3363</span>    <span class="keywordtype">int</span> result = -1;</div>
<div class="line"><span class="lineno"> 3364</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3365</span>    LIST_FOREACH(cbent, &amp;<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;callbacks, next) {</div>
<div class="line"><span class="lineno"> 3366</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="structevbuffer__cb__entry.html#abb6fdf4fa07371ac05bc5114893abc5c">cb</a> == cbent-&gt;<a class="code hl_variable" href="structevbuffer__cb__entry.html#abb6fdf4fa07371ac05bc5114893abc5c">cb</a>.<a class="code hl_variable" href="structevbuffer__cb__entry.html#a7be341470ee9df41c27b9fa68b1311a3">cb_func</a> &amp;&amp; <a class="code hl_variable" href="structevbuffer__cb__entry.html#ab12730928647120b4f8039eb20501c9f">cbarg</a> == cbent-&gt;<a class="code hl_variable" href="structevbuffer__cb__entry.html#ab12730928647120b4f8039eb20501c9f">cbarg</a>) {</div>
<div class="line"><span class="lineno"> 3367</span>            result = <a class="code hl_function" href="libevent_2buffer_8c.html#afd1e51be92170b17178949a639dfa8ab">evbuffer_remove_cb_entry</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, cbent);</div>
<div class="line"><span class="lineno"> 3368</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 3369</span>        }</div>
<div class="line"><span class="lineno"> 3370</span>    }</div>
<div class="line"><span class="lineno"> 3371</span>done:</div>
<div class="line"><span class="lineno"> 3372</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3373</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 3374</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_afd1e51be92170b17178949a639dfa8ab"><div class="ttname"><a href="libevent_2buffer_8c.html#afd1e51be92170b17178949a639dfa8ab">evbuffer_remove_cb_entry</a></div><div class="ttdeci">int evbuffer_remove_cb_entry(struct evbuffer *buffer, struct evbuffer_cb_entry *ent)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l03349">buffer.c:3349</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structevbuffer__cb__entry.html#abb6fdf4fa07371ac05bc5114893abc5c">evbuffer_cb_entry::cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00069">evbuffer_cb_entry::cb_func</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00073">evbuffer_cb_entry::cbarg</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="libevent_2buffer_8c_source.html#l03349">evbuffer_remove_cb_entry()</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>.</p>

</div>
</div>
<a id="afd1e51be92170b17178949a639dfa8ab" name="afd1e51be92170b17178949a639dfa8ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd1e51be92170b17178949a639dfa8ab">&#9670;&nbsp;</a></span>evbuffer_remove_cb_entry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_remove_cb_entry </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__cb__entry.html">evbuffer_cb_entry</a> *&#160;</td>
          <td class="paramname"><em>ent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l03349">3349</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3351</span>{</div>
<div class="line"><span class="lineno"> 3352</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3353</span>    LIST_REMOVE(ent, next);</div>
<div class="line"><span class="lineno"> 3354</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3355</span>    <a class="code hl_define" href="mm-internal_8h.html#af7d87798652aaa8398bb9c0504256f16">mm_free</a>(ent);</div>
<div class="line"><span class="lineno"> 3356</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 3357</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, and <a class="el" href="mm-internal_8h_source.html#l00079">mm_free</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__filter_8c_source.html#l00258">be_filter_destruct()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l03360">evbuffer_remove_cb()</a>.</p>

</div>
</div>
<a id="ae7de48b30ac1112dd7d421fa23ddf529" name="ae7de48b30ac1112dd7d421fa23ddf529"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7de48b30ac1112dd7d421fa23ddf529">&#9670;&nbsp;</a></span>evbuffer_reserve_space()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_reserve_space </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev_ssize_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct evbuffer_iovec *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_vecs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00671">671</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  673</span>{</div>
<div class="line"><span class="lineno">  674</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain, **chainp;</div>
<div class="line"><span class="lineno">  675</span>    <span class="keywordtype">int</span> n = -1;</div>
<div class="line"><span class="lineno">  676</span> </div>
<div class="line"><span class="lineno">  677</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno">  678</span>    <span class="keywordflow">if</span> (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a6bed33d6f3074d83a5c39a21b3acbaf1">freeze_end</a>)</div>
<div class="line"><span class="lineno">  679</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  680</span>    <span class="keywordflow">if</span> (n_vecs &lt; 1)</div>
<div class="line"><span class="lineno">  681</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  682</span>    <span class="keywordflow">if</span> (n_vecs == 1) {</div>
<div class="line"><span class="lineno">  683</span>        <span class="keywordflow">if</span> ((chain = <a class="code hl_function" href="libevent_2buffer_8c.html#af29382773b8c1cbe484de86282e6fb87">evbuffer_expand_singlechain</a>(buf, size)) == NULL)</div>
<div class="line"><span class="lineno">  684</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>        vec[0].iov_base = (<span class="keywordtype">void</span> *)<a class="code hl_define" href="libevent_2buffer_8c.html#a17846db51ec6b10c559ec8af1b30e379">CHAIN_SPACE_PTR</a>(chain);</div>
<div class="line"><span class="lineno">  687</span>        vec[0].iov_len = (size_t)<a class="code hl_define" href="libevent_2buffer_8c.html#a1381150c8f2120296bd2726cf00f3284">CHAIN_SPACE_LEN</a>(chain);</div>
<div class="line"><span class="lineno">  688</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(size&lt;0 || (<span class="keywordtype">size_t</span>)vec[0].iov_len &gt;= (<span class="keywordtype">size_t</span>)size);</div>
<div class="line"><span class="lineno">  689</span>        n = 1;</div>
<div class="line"><span class="lineno">  690</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  691</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#a0169295592d02008ef6229de9ba8a79b">evbuffer_expand_fast_</a>(buf, size, n_vecs)&lt;0)</div>
<div class="line"><span class="lineno">  692</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  693</span>        n = <a class="code hl_function" href="libevent_2buffer_8c.html#a2c28b535591bbd5a33a3e5e00ba9b1c7">evbuffer_read_setup_vecs_</a>(buf, size, vec, n_vecs,</div>
<div class="line"><span class="lineno">  694</span>                &amp;chainp, 0);</div>
<div class="line"><span class="lineno">  695</span>    }</div>
<div class="line"><span class="lineno">  696</span> </div>
<div class="line"><span class="lineno">  697</span>done:</div>
<div class="line"><span class="lineno">  698</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno">  699</span>    <span class="keywordflow">return</span> n;</div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00130">CHAIN_SPACE_LEN</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00129">CHAIN_SPACE_PTR</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02051">evbuffer_expand_fast_()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01939">evbuffer_expand_singlechain()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02225">evbuffer_read_setup_vecs_()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00123">evbuffer::freeze_end</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__openssl_8c_source.html#l00584">do_read()</a>.</p>

</div>
</div>
<a id="a9498833b7740ef5ea694a18ad9bf4c07" name="a9498833b7740ef5ea694a18ad9bf4c07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9498833b7740ef5ea694a18ad9bf4c07">&#9670;&nbsp;</a></span>evbuffer_run_callbacks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void evbuffer_run_callbacks </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>running_deferred</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00456">456</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  457</span>{</div>
<div class="line"><span class="lineno">  458</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__cb__entry.html">evbuffer_cb_entry</a> *cbent, *next;</div>
<div class="line"><span class="lineno">  459</span>    <span class="keyword">struct </span>evbuffer_cb_info info;</div>
<div class="line"><span class="lineno">  460</span>    <span class="keywordtype">size_t</span> new_size;</div>
<div class="line"><span class="lineno">  461</span>    ev_uint32_t mask, masked_val;</div>
<div class="line"><span class="lineno">  462</span>    <span class="keywordtype">int</span> clear = 1;</div>
<div class="line"><span class="lineno">  463</span> </div>
<div class="line"><span class="lineno">  464</span>    <span class="keywordflow">if</span> (running_deferred) {</div>
<div class="line"><span class="lineno">  465</span>        mask = <a class="code hl_define" href="evbuffer-internal_8h.html#a88a728a0e2acbfc11e4430c9fce15eab">EVBUFFER_CB_NODEFER</a>|EVBUFFER_CB_ENABLED;</div>
<div class="line"><span class="lineno">  466</span>        masked_val = EVBUFFER_CB_ENABLED;</div>
<div class="line"><span class="lineno">  467</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;deferred_cbs) {</div>
<div class="line"><span class="lineno">  468</span>        mask = <a class="code hl_define" href="evbuffer-internal_8h.html#a88a728a0e2acbfc11e4430c9fce15eab">EVBUFFER_CB_NODEFER</a>|EVBUFFER_CB_ENABLED;</div>
<div class="line"><span class="lineno">  469</span>        masked_val = <a class="code hl_define" href="evbuffer-internal_8h.html#a88a728a0e2acbfc11e4430c9fce15eab">EVBUFFER_CB_NODEFER</a>|EVBUFFER_CB_ENABLED;</div>
<div class="line"><span class="lineno">  470</span>        <span class="comment">/* Don&#39;t zero-out n_add/n_del, since the deferred callbacks</span></div>
<div class="line"><span class="lineno">  471</span><span class="comment">           will want to see them. */</span></div>
<div class="line"><span class="lineno">  472</span>        clear = 0;</div>
<div class="line"><span class="lineno">  473</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  474</span>        mask = EVBUFFER_CB_ENABLED;</div>
<div class="line"><span class="lineno">  475</span>        masked_val = EVBUFFER_CB_ENABLED;</div>
<div class="line"><span class="lineno">  476</span>    }</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>    <span class="keywordflow">if</span> (LIST_EMPTY(&amp;<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;callbacks)) {</div>
<div class="line"><span class="lineno">  481</span>        <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;n_add_for_cb = <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;n_del_for_cb = 0;</div>
<div class="line"><span class="lineno">  482</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  483</span>    }</div>
<div class="line"><span class="lineno">  484</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;n_add_for_cb == 0 &amp;&amp; <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;n_del_for_cb == 0)</div>
<div class="line"><span class="lineno">  485</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>    new_size = <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;total_len;</div>
<div class="line"><span class="lineno">  488</span>    info.orig_size = new_size + <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;n_del_for_cb - <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;n_add_for_cb;</div>
<div class="line"><span class="lineno">  489</span>    info.n_added = <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;n_add_for_cb;</div>
<div class="line"><span class="lineno">  490</span>    info.n_deleted = <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;n_del_for_cb;</div>
<div class="line"><span class="lineno">  491</span>    <span class="keywordflow">if</span> (clear) {</div>
<div class="line"><span class="lineno">  492</span>        <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;n_add_for_cb = 0;</div>
<div class="line"><span class="lineno">  493</span>        <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;n_del_for_cb = 0;</div>
<div class="line"><span class="lineno">  494</span>    }</div>
<div class="line"><span class="lineno">  495</span>    <span class="keywordflow">for</span> (cbent = LIST_FIRST(&amp;<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;callbacks);</div>
<div class="line"><span class="lineno">  496</span>         cbent != <a class="code hl_define" href="event-internal_8h.html#a0687dc033d5b408a3883b5bf2bd9a935">LIST_END</a>(&amp;<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;callbacks);</div>
<div class="line"><span class="lineno">  497</span>         cbent = next) {</div>
<div class="line"><span class="lineno">  498</span>        <span class="comment">/* Get the &#39;next&#39; pointer now in case this callback decides</span></div>
<div class="line"><span class="lineno">  499</span><span class="comment">         * to remove itself or something. */</span></div>
<div class="line"><span class="lineno">  500</span>        next = LIST_NEXT(cbent, next);</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>        <span class="keywordflow">if</span> ((cbent-&gt;<a class="code hl_variable" href="structevbuffer__cb__entry.html#a616160bb4a571f1fba4a9c0679932d03">flags</a> &amp; mask) != masked_val)</div>
<div class="line"><span class="lineno">  503</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span>        <span class="keywordflow">if</span> ((cbent-&gt;<a class="code hl_variable" href="structevbuffer__cb__entry.html#a616160bb4a571f1fba4a9c0679932d03">flags</a> &amp; <a class="code hl_define" href="libevent_2buffer_8c.html#a01e8c8d803941dfdaae3c2308603437c">EVBUFFER_CB_OBSOLETE</a>))</div>
<div class="line"><span class="lineno">  506</span>            cbent-&gt;<a class="code hl_variable" href="structevbuffer__cb__entry.html#abb6fdf4fa07371ac05bc5114893abc5c">cb</a>.<a class="code hl_variable" href="structevbuffer__cb__entry.html#a47ac874de8d3d21c5751a103cfd8dd58">cb_obsolete</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>,</div>
<div class="line"><span class="lineno">  507</span>                info.orig_size, new_size, cbent-&gt;<a class="code hl_variable" href="structevbuffer__cb__entry.html#ab12730928647120b4f8039eb20501c9f">cbarg</a>);</div>
<div class="line"><span class="lineno">  508</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  509</span>            cbent-&gt;<a class="code hl_variable" href="structevbuffer__cb__entry.html#abb6fdf4fa07371ac05bc5114893abc5c">cb</a>.<a class="code hl_variable" href="structevbuffer__cb__entry.html#a7be341470ee9df41c27b9fa68b1311a3">cb_func</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, &amp;info, cbent-&gt;<a class="code hl_variable" href="structevbuffer__cb__entry.html#ab12730928647120b4f8039eb20501c9f">cbarg</a>);</div>
<div class="line"><span class="lineno">  510</span>    }</div>
<div class="line"><span class="lineno">  511</span>}</div>
<div class="ttc" id="aevbuffer-internal_8h_html_a88a728a0e2acbfc11e4430c9fce15eab"><div class="ttname"><a href="evbuffer-internal_8h.html#a88a728a0e2acbfc11e4430c9fce15eab">EVBUFFER_CB_NODEFER</a></div><div class="ttdeci">#define EVBUFFER_CB_NODEFER</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00044">evbuffer-internal.h:44</a></div></div>
<div class="ttc" id="aevent-internal_8h_html_a0687dc033d5b408a3883b5bf2bd9a935"><div class="ttname"><a href="event-internal_8h.html#a0687dc033d5b408a3883b5bf2bd9a935">LIST_END</a></div><div class="ttdeci">#define LIST_END(head)</div><div class="ttdef"><b>Definition:</b> <a href="event-internal_8h_source.html#l00372">event-internal.h:372</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a01e8c8d803941dfdaae3c2308603437c"><div class="ttname"><a href="libevent_2buffer_8c.html#a01e8c8d803941dfdaae3c2308603437c">EVBUFFER_CB_OBSOLETE</a></div><div class="ttdeci">#define EVBUFFER_CB_OBSOLETE</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l00126">buffer.c:126</a></div></div>
<div class="ttc" id="astructevbuffer__cb__entry_html_a47ac874de8d3d21c5751a103cfd8dd58"><div class="ttname"><a href="structevbuffer__cb__entry.html#a47ac874de8d3d21c5751a103cfd8dd58">evbuffer_cb_entry::cb_obsolete</a></div><div class="ttdeci">evbuffer_cb cb_obsolete</div><div class="ttdef"><b>Definition:</b> <a href="evbuffer-internal_8h_source.html#l00070">evbuffer-internal.h:70</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00282">ASSERT_EVBUFFER_LOCKED</a>, <a class="el" href="structevbuffer__cb__entry.html#abb6fdf4fa07371ac05bc5114893abc5c">evbuffer_cb_entry::cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00069">evbuffer_cb_entry::cb_func</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00070">evbuffer_cb_entry::cb_obsolete</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00073">evbuffer_cb_entry::cbarg</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00044">EVBUFFER_CB_NODEFER</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00126">EVBUFFER_CB_OBSOLETE</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00075">evbuffer_cb_entry::flags</a>, and <a class="el" href="event-internal_8h_source.html#l00372">LIST_END</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00534">evbuffer_deferred_callback()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00514">evbuffer_invoke_callbacks_()</a>.</p>

</div>
</div>
<a id="a61e15e2a355409587464c476d2481105" name="a61e15e2a355409587464c476d2481105"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61e15e2a355409587464c476d2481105">&#9670;&nbsp;</a></span>evbuffer_search()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct evbuffer_ptr evbuffer_search </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>what</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct evbuffer_ptr *&#160;</td>
          <td class="paramname"><em>start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02715">2715</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2716</span>{</div>
<div class="line"><span class="lineno"> 2717</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="libevent_2buffer_8c.html#a532ded8162d838b306e18839e9ab04af">evbuffer_search_range</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, what, len, start, NULL);</div>
<div class="line"><span class="lineno"> 2718</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a532ded8162d838b306e18839e9ab04af"><div class="ttname"><a href="libevent_2buffer_8c.html#a532ded8162d838b306e18839e9ab04af">evbuffer_search_range</a></div><div class="ttdeci">struct evbuffer_ptr evbuffer_search_range(struct evbuffer *buffer, const char *what, size_t len, const struct evbuffer_ptr *start, const struct evbuffer_ptr *end)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l02721">buffer.c:2721</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l02721">evbuffer_search_range()</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l02578">evbuffer_find()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l01597">evbuffer_search_eol()</a>.</p>

</div>
</div>
<a id="aa54aca588fa272157513191a9628d457" name="aa54aca588fa272157513191a9628d457"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa54aca588fa272157513191a9628d457">&#9670;&nbsp;</a></span>evbuffer_search_eol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct evbuffer_ptr evbuffer_search_eol </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct evbuffer_ptr *&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>eol_len_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum evbuffer_eol_style&#160;</td>
          <td class="paramname"><em>eol_style</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01597">1597</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1600</span>{</div>
<div class="line"><span class="lineno"> 1601</span>    <span class="keyword">struct </span>evbuffer_ptr it, it2;</div>
<div class="line"><span class="lineno"> 1602</span>    <span class="keywordtype">size_t</span> extra_drain = 0;</div>
<div class="line"><span class="lineno"> 1603</span>    <span class="keywordtype">int</span> ok = 0;</div>
<div class="line"><span class="lineno"> 1604</span> </div>
<div class="line"><span class="lineno"> 1605</span>    <span class="comment">/* Avoid locking in trivial edge cases */</span></div>
<div class="line"><span class="lineno"> 1606</span>    <span class="keywordflow">if</span> (start &amp;&amp; start-&gt;internal_.chain == NULL) {</div>
<div class="line"><span class="lineno"> 1607</span>        <a class="code hl_define" href="libevent_2buffer_8c.html#a85a672d3751a1c49b2374d439cc7bf55">PTR_NOT_FOUND</a>(&amp;it);</div>
<div class="line"><span class="lineno"> 1608</span>        <span class="keywordflow">if</span> (eol_len_out)</div>
<div class="line"><span class="lineno"> 1609</span>            *eol_len_out = extra_drain;</div>
<div class="line"><span class="lineno"> 1610</span>        <span class="keywordflow">return</span> it;</div>
<div class="line"><span class="lineno"> 1611</span>    }</div>
<div class="line"><span class="lineno"> 1612</span> </div>
<div class="line"><span class="lineno"> 1613</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 1614</span> </div>
<div class="line"><span class="lineno"> 1615</span>    <span class="keywordflow">if</span> (start) {</div>
<div class="line"><span class="lineno"> 1616</span>        memcpy(&amp;it, start, <span class="keyword">sizeof</span>(it));</div>
<div class="line"><span class="lineno"> 1617</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1618</span>        it.pos = 0;</div>
<div class="line"><span class="lineno"> 1619</span>        it.internal_.chain = <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;first;</div>
<div class="line"><span class="lineno"> 1620</span>        it.internal_.pos_in_chain = 0;</div>
<div class="line"><span class="lineno"> 1621</span>    }</div>
<div class="line"><span class="lineno"> 1622</span> </div>
<div class="line"><span class="lineno"> 1623</span>    <span class="comment">/* the eol_style determines our first stop character and how many</span></div>
<div class="line"><span class="lineno"> 1624</span><span class="comment">     * characters we are going to drain afterwards. */</span></div>
<div class="line"><span class="lineno"> 1625</span>    <span class="keywordflow">switch</span> (eol_style) {</div>
<div class="line"><span class="lineno"> 1626</span>    <span class="keywordflow">case</span> EVBUFFER_EOL_ANY:</div>
<div class="line"><span class="lineno"> 1627</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#a6dfe0e3fa9c89d6ef86d46f91bec1407">evbuffer_find_eol_char</a>(&amp;it) &lt; 0)</div>
<div class="line"><span class="lineno"> 1628</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1629</span>        memcpy(&amp;it2, &amp;it, <span class="keyword">sizeof</span>(it));</div>
<div class="line"><span class="lineno"> 1630</span>        extra_drain = <a class="code hl_function" href="libevent_2buffer_8c.html#aec4e48cd2e9b7feaa8d928f1d29b4599">evbuffer_strspn</a>(&amp;it2, <span class="stringliteral">&quot;\r\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1631</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1632</span>    <span class="keywordflow">case</span> EVBUFFER_EOL_CRLF_STRICT: {</div>
<div class="line"><span class="lineno"> 1633</span>        it = <a class="code hl_function" href="libevent_2buffer_8c.html#a61e15e2a355409587464c476d2481105">evbuffer_search</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, <span class="stringliteral">&quot;\r\n&quot;</span>, 2, &amp;it);</div>
<div class="line"><span class="lineno"> 1634</span>        <span class="keywordflow">if</span> (it.pos &lt; 0)</div>
<div class="line"><span class="lineno"> 1635</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1636</span>        extra_drain = 2;</div>
<div class="line"><span class="lineno"> 1637</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1638</span>    }</div>
<div class="line"><span class="lineno"> 1639</span>    <span class="keywordflow">case</span> EVBUFFER_EOL_CRLF: {</div>
<div class="line"><span class="lineno"> 1640</span>        ev_ssize_t start_pos = it.pos;</div>
<div class="line"><span class="lineno"> 1641</span>        <span class="comment">/* Look for a LF ... */</span></div>
<div class="line"><span class="lineno"> 1642</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#a7bbd0d5c6cb68c7e17471acedb254ff3">evbuffer_strchr</a>(&amp;it, <span class="charliteral">&#39;\n&#39;</span>) &lt; 0)</div>
<div class="line"><span class="lineno"> 1643</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1644</span>        extra_drain = 1;</div>
<div class="line"><span class="lineno"> 1645</span>        <span class="comment">/* ... optionally preceeded by a CR. */</span></div>
<div class="line"><span class="lineno"> 1646</span>        <span class="keywordflow">if</span> (it.pos == start_pos)</div>
<div class="line"><span class="lineno"> 1647</span>            <span class="keywordflow">break</span>; <span class="comment">/* If the first character is \n, don&#39;t back up */</span></div>
<div class="line"><span class="lineno"> 1648</span>        <span class="comment">/* This potentially does an extra linear walk over the first</span></div>
<div class="line"><span class="lineno"> 1649</span><span class="comment">         * few chains.  Probably, that&#39;s not too expensive unless you</span></div>
<div class="line"><span class="lineno"> 1650</span><span class="comment">         * have a really pathological setup. */</span></div>
<div class="line"><span class="lineno"> 1651</span>        memcpy(&amp;it2, &amp;it, <span class="keyword">sizeof</span>(it));</div>
<div class="line"><span class="lineno"> 1652</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#a773c9681d248f1a77895f70f4fb34c0e">evbuffer_ptr_subtract</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, &amp;it2, 1)&lt;0)</div>
<div class="line"><span class="lineno"> 1653</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1654</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#a5777ea043f5871f05333dfb95360c306">evbuffer_getchr</a>(&amp;it2) == <span class="charliteral">&#39;\r&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1655</span>            memcpy(&amp;it, &amp;it2, <span class="keyword">sizeof</span>(it));</div>
<div class="line"><span class="lineno"> 1656</span>            extra_drain = 2;</div>
<div class="line"><span class="lineno"> 1657</span>        }</div>
<div class="line"><span class="lineno"> 1658</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1659</span>    }</div>
<div class="line"><span class="lineno"> 1660</span>    <span class="keywordflow">case</span> EVBUFFER_EOL_LF:</div>
<div class="line"><span class="lineno"> 1661</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#a7bbd0d5c6cb68c7e17471acedb254ff3">evbuffer_strchr</a>(&amp;it, <span class="charliteral">&#39;\n&#39;</span>) &lt; 0)</div>
<div class="line"><span class="lineno"> 1662</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1663</span>        extra_drain = 1;</div>
<div class="line"><span class="lineno"> 1664</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1665</span>    <span class="keywordflow">case</span> EVBUFFER_EOL_NUL:</div>
<div class="line"><span class="lineno"> 1666</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="libevent_2buffer_8c.html#a7bbd0d5c6cb68c7e17471acedb254ff3">evbuffer_strchr</a>(&amp;it, <span class="charliteral">&#39;\0&#39;</span>) &lt; 0)</div>
<div class="line"><span class="lineno"> 1667</span>            <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1668</span>        extra_drain = 1;</div>
<div class="line"><span class="lineno"> 1669</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1670</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1671</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 1672</span>    }</div>
<div class="line"><span class="lineno"> 1673</span> </div>
<div class="line"><span class="lineno"> 1674</span>    ok = 1;</div>
<div class="line"><span class="lineno"> 1675</span>done:</div>
<div class="line"><span class="lineno"> 1676</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 1677</span> </div>
<div class="line"><span class="lineno"> 1678</span>    <span class="keywordflow">if</span> (!ok)</div>
<div class="line"><span class="lineno"> 1679</span>        <a class="code hl_define" href="libevent_2buffer_8c.html#a85a672d3751a1c49b2374d439cc7bf55">PTR_NOT_FOUND</a>(&amp;it);</div>
<div class="line"><span class="lineno"> 1680</span>    <span class="keywordflow">if</span> (eol_len_out)</div>
<div class="line"><span class="lineno"> 1681</span>        *eol_len_out = extra_drain;</div>
<div class="line"><span class="lineno"> 1682</span> </div>
<div class="line"><span class="lineno"> 1683</span>    <span class="keywordflow">return</span> it;</div>
<div class="line"><span class="lineno"> 1684</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a5777ea043f5871f05333dfb95360c306"><div class="ttname"><a href="libevent_2buffer_8c.html#a5777ea043f5871f05333dfb95360c306">evbuffer_getchr</a></div><div class="ttdeci">static int evbuffer_getchr(struct evbuffer_ptr *it)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01585">buffer.c:1585</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a6dfe0e3fa9c89d6ef86d46f91bec1407"><div class="ttname"><a href="libevent_2buffer_8c.html#a6dfe0e3fa9c89d6ef86d46f91bec1407">evbuffer_find_eol_char</a></div><div class="ttdeci">static ev_ssize_t evbuffer_find_eol_char(struct evbuffer_ptr *it)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01523">buffer.c:1523</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a773c9681d248f1a77895f70f4fb34c0e"><div class="ttname"><a href="libevent_2buffer_8c.html#a773c9681d248f1a77895f70f4fb34c0e">evbuffer_ptr_subtract</a></div><div class="ttdeci">static int evbuffer_ptr_subtract(struct evbuffer *buf, struct evbuffer_ptr *pos, size_t howfar)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l02603">buffer.c:2603</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_a7bbd0d5c6cb68c7e17471acedb254ff3"><div class="ttname"><a href="libevent_2buffer_8c.html#a7bbd0d5c6cb68c7e17471acedb254ff3">evbuffer_strchr</a></div><div class="ttdeci">static ev_ssize_t evbuffer_strchr(struct evbuffer_ptr *it, const char chr)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01474">buffer.c:1474</a></div></div>
<div class="ttc" id="alibevent_2buffer_8c_html_aec4e48cd2e9b7feaa8d928f1d29b4599"><div class="ttname"><a href="libevent_2buffer_8c.html#aec4e48cd2e9b7feaa8d928f1d29b4599">evbuffer_strspn</a></div><div class="ttdeci">static size_t evbuffer_strspn(struct evbuffer_ptr *ptr, const char *chrset)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l01545">buffer.c:1545</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l01523">evbuffer_find_eol_char()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01585">evbuffer_getchr()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02603">evbuffer_ptr_subtract()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02715">evbuffer_search()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01474">evbuffer_strchr()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01545">evbuffer_strspn()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00137">PTR_NOT_FOUND</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01687">evbuffer_readln()</a>.</p>

</div>
</div>
<a id="a532ded8162d838b306e18839e9ab04af" name="a532ded8162d838b306e18839e9ab04af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a532ded8162d838b306e18839e9ab04af">&#9670;&nbsp;</a></span>evbuffer_search_range()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct evbuffer_ptr evbuffer_search_range </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>what</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct evbuffer_ptr *&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct evbuffer_ptr *&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02721">2721</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2722</span>{</div>
<div class="line"><span class="lineno"> 2723</span>    <span class="keyword">struct </span>evbuffer_ptr pos;</div>
<div class="line"><span class="lineno"> 2724</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain, *last_chain = NULL;</div>
<div class="line"><span class="lineno"> 2725</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p;</div>
<div class="line"><span class="lineno"> 2726</span>    <span class="keywordtype">char</span> first;</div>
<div class="line"><span class="lineno"> 2727</span> </div>
<div class="line"><span class="lineno"> 2728</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 2729</span> </div>
<div class="line"><span class="lineno"> 2730</span>    <span class="keywordflow">if</span> (start) {</div>
<div class="line"><span class="lineno"> 2731</span>        memcpy(&amp;pos, start, <span class="keyword">sizeof</span>(pos));</div>
<div class="line"><span class="lineno"> 2732</span>        chain = pos.internal_.chain;</div>
<div class="line"><span class="lineno"> 2733</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2734</span>        pos.pos = 0;</div>
<div class="line"><span class="lineno"> 2735</span>        chain = pos.internal_.chain = <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;first;</div>
<div class="line"><span class="lineno"> 2736</span>        pos.internal_.pos_in_chain = 0;</div>
<div class="line"><span class="lineno"> 2737</span>    }</div>
<div class="line"><span class="lineno"> 2738</span> </div>
<div class="line"><span class="lineno"> 2739</span>    <span class="keywordflow">if</span> (end)</div>
<div class="line"><span class="lineno"> 2740</span>        last_chain = end-&gt;internal_.chain;</div>
<div class="line"><span class="lineno"> 2741</span> </div>
<div class="line"><span class="lineno"> 2742</span>    <span class="keywordflow">if</span> (!len || len &gt; EV_SSIZE_MAX)</div>
<div class="line"><span class="lineno"> 2743</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 2744</span> </div>
<div class="line"><span class="lineno"> 2745</span>    first = what[0];</div>
<div class="line"><span class="lineno"> 2746</span> </div>
<div class="line"><span class="lineno"> 2747</span>    <span class="keywordflow">while</span> (chain) {</div>
<div class="line"><span class="lineno"> 2748</span>        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *start_at =</div>
<div class="line"><span class="lineno"> 2749</span>            chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> +</div>
<div class="line"><span class="lineno"> 2750</span>            pos.internal_.pos_in_chain;</div>
<div class="line"><span class="lineno"> 2751</span>        p = memchr(start_at, first,</div>
<div class="line"><span class="lineno"> 2752</span>            chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> - pos.internal_.pos_in_chain);</div>
<div class="line"><span class="lineno"> 2753</span>        <span class="keywordflow">if</span> (p) {</div>
<div class="line"><span class="lineno"> 2754</span>            pos.pos += p - start_at;</div>
<div class="line"><span class="lineno"> 2755</span>            pos.internal_.pos_in_chain += p - start_at;</div>
<div class="line"><span class="lineno"> 2756</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="libevent_2buffer_8c.html#a31a6529210bd5b3285d926cc9f8f304b">evbuffer_ptr_memcmp</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, &amp;pos, what, len)) {</div>
<div class="line"><span class="lineno"> 2757</span>                <span class="keywordflow">if</span> (end &amp;&amp; pos.pos + (ev_ssize_t)len &gt; end-&gt;pos)</div>
<div class="line"><span class="lineno"> 2758</span>                    <span class="keywordflow">goto</span> not_found;</div>
<div class="line"><span class="lineno"> 2759</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2760</span>                    <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 2761</span>            }</div>
<div class="line"><span class="lineno"> 2762</span>            ++pos.pos;</div>
<div class="line"><span class="lineno"> 2763</span>            ++pos.internal_.pos_in_chain;</div>
<div class="line"><span class="lineno"> 2764</span>            <span class="keywordflow">if</span> (pos.internal_.pos_in_chain == chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>) {</div>
<div class="line"><span class="lineno"> 2765</span>                chain = pos.internal_.chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 2766</span>                pos.internal_.pos_in_chain = 0;</div>
<div class="line"><span class="lineno"> 2767</span>            }</div>
<div class="line"><span class="lineno"> 2768</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2769</span>            <span class="keywordflow">if</span> (chain == last_chain)</div>
<div class="line"><span class="lineno"> 2770</span>                <span class="keywordflow">goto</span> not_found;</div>
<div class="line"><span class="lineno"> 2771</span>            pos.pos += chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> - pos.internal_.pos_in_chain;</div>
<div class="line"><span class="lineno"> 2772</span>            chain = pos.internal_.chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 2773</span>            pos.internal_.pos_in_chain = 0;</div>
<div class="line"><span class="lineno"> 2774</span>        }</div>
<div class="line"><span class="lineno"> 2775</span>    }</div>
<div class="line"><span class="lineno"> 2776</span> </div>
<div class="line"><span class="lineno"> 2777</span>not_found:</div>
<div class="line"><span class="lineno"> 2778</span>    <a class="code hl_define" href="libevent_2buffer_8c.html#a85a672d3751a1c49b2374d439cc7bf55">PTR_NOT_FOUND</a>(&amp;pos);</div>
<div class="line"><span class="lineno"> 2779</span>done:</div>
<div class="line"><span class="lineno"> 2780</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 2781</span>    <span class="keywordflow">return</span> pos;</div>
<div class="line"><span class="lineno"> 2782</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a31a6529210bd5b3285d926cc9f8f304b"><div class="ttname"><a href="libevent_2buffer_8c.html#a31a6529210bd5b3285d926cc9f8f304b">evbuffer_ptr_memcmp</a></div><div class="ttdeci">static int evbuffer_ptr_memcmp(const struct evbuffer *buf, const struct evbuffer_ptr *pos, const char *mem, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l02679">buffer.c:2679</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02679">evbuffer_ptr_memcmp()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00137">PTR_NOT_FOUND</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l02715">evbuffer_search()</a>.</p>

</div>
</div>
<a id="ae7ca62b72232b4029288e4c3a06f1c6c" name="ae7ca62b72232b4029288e4c3a06f1c6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7ca62b72232b4029288e4c3a06f1c6c">&#9670;&nbsp;</a></span>evbuffer_set_flags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_set_flags </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev_uint64_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00378">378</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  379</span>{</div>
<div class="line"><span class="lineno">  380</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno">  381</span>    buf-&gt;<a class="code hl_variable" href="structevbuffer.html#a48cb697057298efe9c66dd6398415a58">flags</a> |= (ev_uint32_t)flags;</div>
<div class="line"><span class="lineno">  382</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno">  383</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  384</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00135">evbuffer::flags</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__sock_8c_source.html#l00344">bufferevent_socket_new()</a>.</p>

</div>
</div>
<a id="a2dbc008d184dacd1d3d97ed9fabad435" name="a2dbc008d184dacd1d3d97ed9fabad435"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dbc008d184dacd1d3d97ed9fabad435">&#9670;&nbsp;</a></span>evbuffer_set_parent_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evbuffer_set_parent_ </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct bufferevent *&#160;</td>
          <td class="paramname"><em>bev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Set the parent bufferevent object for buf to bev </p>

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00448">448</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  449</span>{</div>
<div class="line"><span class="lineno">  450</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(buf);</div>
<div class="line"><span class="lineno">  451</span>    buf-&gt;<a class="code hl_variable" href="structevbuffer.html#acc2fc2823057650c10b7133a8282d153">parent</a> = bev;</div>
<div class="line"><span class="lineno">  452</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno">  453</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00155">evbuffer::parent</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent_8c_source.html#l00309">bufferevent_init_common_()</a>.</p>

</div>
</div>
<a id="aeadc5a2edfe385d9fa182c659d7d9b37" name="aeadc5a2edfe385d9fa182c659d7d9b37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeadc5a2edfe385d9fa182c659d7d9b37">&#9670;&nbsp;</a></span>evbuffer_setcb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_setcb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">evbuffer_cb&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cbarg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l03312">3312</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3313</span>{</div>
<div class="line"><span class="lineno"> 3314</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3315</span> </div>
<div class="line"><span class="lineno"> 3316</span>    <span class="keywordflow">if</span> (!LIST_EMPTY(&amp;<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;callbacks))</div>
<div class="line"><span class="lineno"> 3317</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a8baa73c3690e47a1e2b5af4e069c3f68">evbuffer_remove_all_callbacks</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3318</span> </div>
<div class="line"><span class="lineno"> 3319</span>    <span class="keywordflow">if</span> (cb) {</div>
<div class="line"><span class="lineno"> 3320</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__cb__entry.html">evbuffer_cb_entry</a> *ent =</div>
<div class="line"><span class="lineno"> 3321</span>            <a class="code hl_function" href="libevent_2buffer_8c.html#a7f74a931a40fed1f64496cce05e4f140">evbuffer_add_cb</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, NULL, <a class="code hl_variable" href="structevbuffer__cb__entry.html#ab12730928647120b4f8039eb20501c9f">cbarg</a>);</div>
<div class="line"><span class="lineno"> 3322</span>        <span class="keywordflow">if</span> (!ent) {</div>
<div class="line"><span class="lineno"> 3323</span>            <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3324</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 3325</span>        }</div>
<div class="line"><span class="lineno"> 3326</span>        ent-&gt;<a class="code hl_variable" href="structevbuffer__cb__entry.html#abb6fdf4fa07371ac05bc5114893abc5c">cb</a>.<a class="code hl_variable" href="structevbuffer__cb__entry.html#a47ac874de8d3d21c5751a103cfd8dd58">cb_obsolete</a> = <a class="code hl_variable" href="structevbuffer__cb__entry.html#abb6fdf4fa07371ac05bc5114893abc5c">cb</a>;</div>
<div class="line"><span class="lineno"> 3327</span>        ent-&gt;<a class="code hl_variable" href="structevbuffer__cb__entry.html#a616160bb4a571f1fba4a9c0679932d03">flags</a> |= <a class="code hl_define" href="libevent_2buffer_8c.html#a01e8c8d803941dfdaae3c2308603437c">EVBUFFER_CB_OBSOLETE</a>;</div>
<div class="line"><span class="lineno"> 3328</span>    }</div>
<div class="line"><span class="lineno"> 3329</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3330</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 3331</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a7f74a931a40fed1f64496cce05e4f140"><div class="ttname"><a href="libevent_2buffer_8c.html#a7f74a931a40fed1f64496cce05e4f140">evbuffer_add_cb</a></div><div class="ttdeci">struct evbuffer_cb_entry * evbuffer_add_cb(struct evbuffer *buffer, evbuffer_cb_func cb, void *cbarg)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l03334">buffer.c:3334</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structevbuffer__cb__entry.html#abb6fdf4fa07371ac05bc5114893abc5c">evbuffer_cb_entry::cb</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00070">evbuffer_cb_entry::cb_obsolete</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00073">evbuffer_cb_entry::cbarg</a>, <a class="el" href="libevent_2buffer_8c_source.html#l03334">evbuffer_add_cb()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00126">EVBUFFER_CB_OBSOLETE</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00550">evbuffer_remove_all_callbacks()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00075">evbuffer_cb_entry::flags</a>.</p>

</div>
</div>
<a id="a7bbd0d5c6cb68c7e17471acedb254ff3" name="a7bbd0d5c6cb68c7e17471acedb254ff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bbd0d5c6cb68c7e17471acedb254ff3">&#9670;&nbsp;</a></span>evbuffer_strchr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static ev_ssize_t evbuffer_strchr </td>
          <td>(</td>
          <td class="paramtype">struct evbuffer_ptr *&#160;</td>
          <td class="paramname"><em>it</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>chr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01474">1474</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1475</span>{</div>
<div class="line"><span class="lineno"> 1476</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain = it-&gt;internal_.chain;</div>
<div class="line"><span class="lineno"> 1477</span>    <span class="keywordtype">size_t</span> i = it-&gt;internal_.pos_in_chain;</div>
<div class="line"><span class="lineno"> 1478</span>    <span class="keywordflow">while</span> (chain != NULL) {</div>
<div class="line"><span class="lineno"> 1479</span>        <span class="keywordtype">char</span> *<a class="code hl_struct" href="structbuffer.html">buffer</a> = (<span class="keywordtype">char</span> *)chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>;</div>
<div class="line"><span class="lineno"> 1480</span>        <span class="keywordtype">char</span> *cp = memchr(<a class="code hl_struct" href="structbuffer.html">buffer</a>+i, chr, chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>-i);</div>
<div class="line"><span class="lineno"> 1481</span>        <span class="keywordflow">if</span> (cp) {</div>
<div class="line"><span class="lineno"> 1482</span>            it-&gt;internal_.chain = chain;</div>
<div class="line"><span class="lineno"> 1483</span>            it-&gt;internal_.pos_in_chain = cp - <a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a>;</div>
<div class="line"><span class="lineno"> 1484</span>            it-&gt;pos += (cp - <a class="code hl_struct" href="structbuffer.html">buffer</a> - i);</div>
<div class="line"><span class="lineno"> 1485</span>            <span class="keywordflow">return</span> it-&gt;pos;</div>
<div class="line"><span class="lineno"> 1486</span>        }</div>
<div class="line"><span class="lineno"> 1487</span>        it-&gt;pos += chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> - i;</div>
<div class="line"><span class="lineno"> 1488</span>        i = 0;</div>
<div class="line"><span class="lineno"> 1489</span>        chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 1490</span>    }</div>
<div class="line"><span class="lineno"> 1491</span> </div>
<div class="line"><span class="lineno"> 1492</span>    <span class="keywordflow">return</span> (-1);</div>
<div class="line"><span class="lineno"> 1493</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01597">evbuffer_search_eol()</a>.</p>

</div>
</div>
<a id="aec4e48cd2e9b7feaa8d928f1d29b4599" name="aec4e48cd2e9b7feaa8d928f1d29b4599"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec4e48cd2e9b7feaa8d928f1d29b4599">&#9670;&nbsp;</a></span>evbuffer_strspn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t evbuffer_strspn </td>
          <td>(</td>
          <td class="paramtype">struct evbuffer_ptr *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>chrset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01545">1545</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1547</span>{</div>
<div class="line"><span class="lineno"> 1548</span>    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="tests_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a> = 0;</div>
<div class="line"><span class="lineno"> 1549</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain = ptr-&gt;internal_.chain;</div>
<div class="line"><span class="lineno"> 1550</span>    <span class="keywordtype">size_t</span> i = ptr-&gt;internal_.pos_in_chain;</div>
<div class="line"><span class="lineno"> 1551</span> </div>
<div class="line"><span class="lineno"> 1552</span>    <span class="keywordflow">if</span> (!chain)</div>
<div class="line"><span class="lineno"> 1553</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1554</span> </div>
<div class="line"><span class="lineno"> 1555</span>    <span class="keywordflow">while</span> (1) {</div>
<div class="line"><span class="lineno"> 1556</span>        <span class="keywordtype">char</span> *<a class="code hl_struct" href="structbuffer.html">buffer</a> = (<span class="keywordtype">char</span> *)chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>;</div>
<div class="line"><span class="lineno"> 1557</span>        for (; i &lt; chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>; ++i) {</div>
<div class="line"><span class="lineno"> 1558</span>            <span class="keyword">const</span> <span class="keywordtype">char</span> *p = chrset;</div>
<div class="line"><span class="lineno"> 1559</span>            <span class="keywordflow">while</span> (*p) {</div>
<div class="line"><span class="lineno"> 1560</span>                <span class="keywordflow">if</span> (<a class="code hl_struct" href="structbuffer.html">buffer</a>[i] == *p++)</div>
<div class="line"><span class="lineno"> 1561</span>                    <span class="keywordflow">goto</span> <a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 1562</span>            }</div>
<div class="line"><span class="lineno"> 1563</span>            ptr-&gt;internal_.chain = chain;</div>
<div class="line"><span class="lineno"> 1564</span>            ptr-&gt;internal_.pos_in_chain = i;</div>
<div class="line"><span class="lineno"> 1565</span>            ptr-&gt;pos += <a class="code hl_variable" href="tests_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>;</div>
<div class="line"><span class="lineno"> 1566</span>            <span class="keywordflow">return</span> <a class="code hl_variable" href="tests_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>;</div>
<div class="line"><span class="lineno"> 1567</span>        <a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>:</div>
<div class="line"><span class="lineno"> 1568</span>            ++<a class="code hl_variable" href="tests_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>;</div>
<div class="line"><span class="lineno"> 1569</span>        }</div>
<div class="line"><span class="lineno"> 1570</span>        i = 0;</div>
<div class="line"><span class="lineno"> 1571</span> </div>
<div class="line"><span class="lineno"> 1572</span>        <span class="keywordflow">if</span> (! chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>) {</div>
<div class="line"><span class="lineno"> 1573</span>            ptr-&gt;internal_.chain = chain;</div>
<div class="line"><span class="lineno"> 1574</span>            ptr-&gt;internal_.pos_in_chain = i;</div>
<div class="line"><span class="lineno"> 1575</span>            ptr-&gt;pos += <a class="code hl_variable" href="tests_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>;</div>
<div class="line"><span class="lineno"> 1576</span>            <span class="keywordflow">return</span> <a class="code hl_variable" href="tests_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>;</div>
<div class="line"><span class="lineno"> 1577</span>        }</div>
<div class="line"><span class="lineno"> 1578</span> </div>
<div class="line"><span class="lineno"> 1579</span>        chain = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno"> 1580</span>    }</div>
<div class="line"><span class="lineno"> 1581</span>}</div>
<div class="ttc" id="atests_8c_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="tests_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a></div><div class="ttdeci">static int count</div><div class="ttdef"><b>Definition:</b> <a href="tests_8c_source.html#l00033">tests.c:33</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="tests_8c_source.html#l00033">count</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01597">evbuffer_search_eol()</a>.</p>

</div>
</div>
<a id="ae1aa94b12221a02fcacc2f5dbf0f28b5" name="ae1aa94b12221a02fcacc2f5dbf0f28b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1aa94b12221a02fcacc2f5dbf0f28b5">&#9670;&nbsp;</a></span>evbuffer_unfreeze()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_unfreeze </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l03413">3413</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3414</span>{</div>
<div class="line"><span class="lineno"> 3415</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3416</span>    <span class="keywordflow">if</span> (start)</div>
<div class="line"><span class="lineno"> 3417</span>        <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;freeze_start = 0;</div>
<div class="line"><span class="lineno"> 3418</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3419</span>        <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;freeze_end = 0;</div>
<div class="line"><span class="lineno"> 3420</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 3421</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 3422</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__pair_8c_source.html#l00153">be_pair_transfer()</a>, <a class="el" href="bufferevent__sock_8c_source.html#l00619">be_socket_setfd()</a>, <a class="el" href="bufferevent__sock_8c_source.html#l00149">bufferevent_readcb()</a>, <a class="el" href="bufferevent__sock_8c_source.html#l00230">bufferevent_writecb()</a>, <a class="el" href="buffer__iocp_8c_source.html#l00098">evbuffer_commit_read_()</a>, <a class="el" href="buffer__iocp_8c_source.html#l00139">evbuffer_commit_write_()</a>, <a class="el" href="buffer__iocp_8c_source.html#l00246">evbuffer_launch_read_()</a>, <a class="el" href="buffer__iocp_8c_source.html#l00172">evbuffer_launch_write_()</a>, and <a class="el" href="http_8c_source.html#l01455">evhttp_connection_read_on_write_error()</a>.</p>

</div>
</div>
<a id="a538b62549df58369e10fd5703cafe92b" name="a538b62549df58369e10fd5703cafe92b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a538b62549df58369e10fd5703cafe92b">&#9670;&nbsp;</a></span>evbuffer_unlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evbuffer_unlock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00601">601</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  602</span>{</div>
<div class="line"><span class="lineno">  603</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(buf);</div>
<div class="line"><span class="lineno">  604</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>.</p>

</div>
</div>
<a id="a1207167bb14d5333326225f41477e910" name="a1207167bb14d5333326225f41477e910"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1207167bb14d5333326225f41477e910">&#9670;&nbsp;</a></span>evbuffer_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_write </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">evutil_socket_t&#160;</td>
          <td class="paramname"><em>fd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02572">2572</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2573</span>{</div>
<div class="line"><span class="lineno"> 2574</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="libevent_2buffer_8c.html#aa0bea512e82177762be7cf0a28a9b03b">evbuffer_write_atmost</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, fd, -1);</div>
<div class="line"><span class="lineno"> 2575</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_aa0bea512e82177762be7cf0a28a9b03b"><div class="ttname"><a href="libevent_2buffer_8c.html#aa0bea512e82177762be7cf0a28a9b03b">evbuffer_write_atmost</a></div><div class="ttdeci">int evbuffer_write_atmost(struct evbuffer *buffer, evutil_socket_t fd, ev_ssize_t howmuch)</div><div class="ttdef"><b>Definition:</b> <a href="libevent_2buffer_8c_source.html#l02524">buffer.c:2524</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l02524">evbuffer_write_atmost()</a>.</p>

</div>
</div>
<a id="aa0bea512e82177762be7cf0a28a9b03b" name="aa0bea512e82177762be7cf0a28a9b03b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0bea512e82177762be7cf0a28a9b03b">&#9670;&nbsp;</a></span>evbuffer_write_atmost()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evbuffer_write_atmost </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">evutil_socket_t&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev_ssize_t&#160;</td>
          <td class="paramname"><em>howmuch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02524">2524</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2526</span>{</div>
<div class="line"><span class="lineno"> 2527</span>    <span class="keywordtype">int</span> n = -1;</div>
<div class="line"><span class="lineno"> 2528</span> </div>
<div class="line"><span class="lineno"> 2529</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a2db7168a100510b09c26d9d9896991e0">EVBUFFER_LOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 2530</span> </div>
<div class="line"><span class="lineno"> 2531</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;freeze_start) {</div>
<div class="line"><span class="lineno"> 2532</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno"> 2533</span>    }</div>
<div class="line"><span class="lineno"> 2534</span> </div>
<div class="line"><span class="lineno"> 2535</span>    <span class="keywordflow">if</span> (howmuch &lt; 0 || (<span class="keywordtype">size_t</span>)howmuch &gt; <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;total_len)</div>
<div class="line"><span class="lineno"> 2536</span>        howmuch = <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;total_len;</div>
<div class="line"><span class="lineno"> 2537</span> </div>
<div class="line"><span class="lineno"> 2538</span>    <span class="keywordflow">if</span> (howmuch &gt; 0) {</div>
<div class="line"><span class="lineno"> 2539</span><span class="preprocessor">#ifdef USE_SENDFILE</span></div>
<div class="line"><span class="lineno"> 2540</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain = <a class="code hl_struct" href="structbuffer.html">buffer</a>-&gt;first;</div>
<div class="line"><span class="lineno"> 2541</span>        <span class="keywordflow">if</span> (chain != NULL &amp;&amp; (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a5f5fd17d81d5c58ccb4113857115130f">flags</a> &amp; <a class="code hl_define" href="evbuffer-internal_8h.html#af16ec197b2b0ede3e2e6de9e9ccb430b">EVBUFFER_SENDFILE</a>))</div>
<div class="line"><span class="lineno"> 2542</span>            n = evbuffer_write_sendfile(<a class="code hl_struct" href="structbuffer.html">buffer</a>, fd, howmuch);</div>
<div class="line"><span class="lineno"> 2543</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2544</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2545</span><span class="preprocessor">#ifdef USE_IOVEC_IMPL</span></div>
<div class="line"><span class="lineno"> 2546</span>        n = evbuffer_write_iovec(<a class="code hl_struct" href="structbuffer.html">buffer</a>, fd, howmuch);</div>
<div class="line"><span class="lineno"> 2547</span><span class="preprocessor">#elif defined(_WIN32)</span></div>
<div class="line"><span class="lineno"> 2548</span>        <span class="comment">/* XXX(nickm) Don&#39;t disable this code until we know if</span></div>
<div class="line"><span class="lineno"> 2549</span><span class="comment">         * the WSARecv code above works. */</span></div>
<div class="line"><span class="lineno"> 2550</span>        <span class="keywordtype">void</span> *p = <a class="code hl_function" href="libevent_2buffer_8c.html#a832cd3d902a61b8ed503c1b1ae804058">evbuffer_pullup</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, howmuch);</div>
<div class="line"><span class="lineno"> 2551</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(p || !howmuch);</div>
<div class="line"><span class="lineno"> 2552</span>        n = send(fd, p, howmuch, 0);</div>
<div class="line"><span class="lineno"> 2553</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 2554</span>        <span class="keywordtype">void</span> *p = <a class="code hl_function" href="libevent_2buffer_8c.html#a832cd3d902a61b8ed503c1b1ae804058">evbuffer_pullup</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, howmuch);</div>
<div class="line"><span class="lineno"> 2555</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(p || !howmuch);</div>
<div class="line"><span class="lineno"> 2556</span>        n = write(fd, p, howmuch);</div>
<div class="line"><span class="lineno"> 2557</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2558</span><span class="preprocessor">#ifdef USE_SENDFILE</span></div>
<div class="line"><span class="lineno"> 2559</span>        }</div>
<div class="line"><span class="lineno"> 2560</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2561</span>    }</div>
<div class="line"><span class="lineno"> 2562</span> </div>
<div class="line"><span class="lineno"> 2563</span>    <span class="keywordflow">if</span> (n &gt; 0)</div>
<div class="line"><span class="lineno"> 2564</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a5c24f3bfbc941d693bf59b5d77d2c37f">evbuffer_drain</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>, n);</div>
<div class="line"><span class="lineno"> 2565</span> </div>
<div class="line"><span class="lineno"> 2566</span>done:</div>
<div class="line"><span class="lineno"> 2567</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#a7d4b06a7e3d8b4e945cd3234328e39d7">EVBUFFER_UNLOCK</a>(<a class="code hl_struct" href="structbuffer.html">buffer</a>);</div>
<div class="line"><span class="lineno"> 2568</span>    <span class="keywordflow">return</span> (n);</div>
<div class="line"><span class="lineno"> 2569</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l01101">evbuffer_drain()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00285">EVBUFFER_LOCK</a>, <a class="el" href="libevent_2buffer_8c_source.html#l01350">evbuffer_pullup()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00190">EVBUFFER_SENDFILE</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00289">EVBUFFER_UNLOCK</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00188">evbuffer_chain::flags</a>.</p>

<p class="reference">Referenced by <a class="el" href="bufferevent__sock_8c_source.html#l00230">bufferevent_writecb()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l02572">evbuffer_write()</a>.</p>

</div>
</div>
<a id="a73da90a05a87e6f5e0df8a2a3f253e71" name="a73da90a05a87e6f5e0df8a2a3f253e71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73da90a05a87e6f5e0df8a2a3f253e71">&#9670;&nbsp;</a></span>find_eol_char()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char * find_eol_char </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l01496">1496</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1497</span>{</div>
<div class="line"><span class="lineno"> 1498</span><span class="preprocessor">#define CHUNK_SZ 128</span></div>
<div class="line"><span class="lineno"> 1499</span>    <span class="comment">/* Lots of benchmarking found this approach to be faster in practice</span></div>
<div class="line"><span class="lineno"> 1500</span><span class="comment">     * than doing two memchrs over the whole buffer, doin a memchr on each</span></div>
<div class="line"><span class="lineno"> 1501</span><span class="comment">     * char of the buffer, or trying to emulate memchr by hand. */</span></div>
<div class="line"><span class="lineno"> 1502</span>    <span class="keywordtype">char</span> *s_end, *cr, *lf;</div>
<div class="line"><span class="lineno"> 1503</span>    s_end = s+len;</div>
<div class="line"><span class="lineno"> 1504</span>    <span class="keywordflow">while</span> (s &lt; s_end) {</div>
<div class="line"><span class="lineno"> 1505</span>        <span class="keywordtype">size_t</span> chunk = (s + <a class="code hl_define" href="libevent_2buffer_8c.html#a29a60cb0a04a05e4e0b3e88ddd312c79">CHUNK_SZ</a> &lt; s_end) ? <a class="code hl_define" href="libevent_2buffer_8c.html#a29a60cb0a04a05e4e0b3e88ddd312c79">CHUNK_SZ</a> : (s_end - s);</div>
<div class="line"><span class="lineno"> 1506</span>        cr = memchr(s, <span class="charliteral">&#39;\r&#39;</span>, chunk);</div>
<div class="line"><span class="lineno"> 1507</span>        lf = memchr(s, <span class="charliteral">&#39;\n&#39;</span>, chunk);</div>
<div class="line"><span class="lineno"> 1508</span>        <span class="keywordflow">if</span> (cr) {</div>
<div class="line"><span class="lineno"> 1509</span>            <span class="keywordflow">if</span> (lf &amp;&amp; lf &lt; cr)</div>
<div class="line"><span class="lineno"> 1510</span>                <span class="keywordflow">return</span> lf;</div>
<div class="line"><span class="lineno"> 1511</span>            <span class="keywordflow">return</span> cr;</div>
<div class="line"><span class="lineno"> 1512</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lf) {</div>
<div class="line"><span class="lineno"> 1513</span>            <span class="keywordflow">return</span> lf;</div>
<div class="line"><span class="lineno"> 1514</span>        }</div>
<div class="line"><span class="lineno"> 1515</span>        s += <a class="code hl_define" href="libevent_2buffer_8c.html#a29a60cb0a04a05e4e0b3e88ddd312c79">CHUNK_SZ</a>;</div>
<div class="line"><span class="lineno"> 1516</span>    }</div>
<div class="line"><span class="lineno"> 1517</span> </div>
<div class="line"><span class="lineno"> 1518</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1519</span><span class="preprocessor">#undef CHUNK_SZ</span></div>
<div class="line"><span class="lineno"> 1520</span>}</div>
<div class="ttc" id="alibevent_2buffer_8c_html_a29a60cb0a04a05e4e0b3e88ddd312c79"><div class="ttname"><a href="libevent_2buffer_8c.html#a29a60cb0a04a05e4e0b3e88ddd312c79">CHUNK_SZ</a></div><div class="ttdeci">#define CHUNK_SZ</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c.html#a29a60cb0a04a05e4e0b3e88ddd312c79">CHUNK_SZ</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01523">evbuffer_find_eol_char()</a>.</p>

</div>
</div>
<a id="aa62a364d82e2d2146c09541026650104" name="aa62a364d82e2d2146c09541026650104"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa62a364d82e2d2146c09541026650104">&#9670;&nbsp;</a></span>get_n_bytes_readable_on_socket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int get_n_bytes_readable_on_socket </td>
          <td>(</td>
          <td class="paramtype">evutil_socket_t&#160;</td>
          <td class="paramname"><em>fd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l02263">2263</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2264</span>{</div>
<div class="line"><span class="lineno"> 2265</span><span class="preprocessor">#if defined(FIONREAD) &amp;&amp; defined(_WIN32)</span></div>
<div class="line"><span class="lineno"> 2266</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lng = <a class="code hl_define" href="libevent_2buffer_8c.html#af22cda87cfe7fa6b9a07c4c645bcb754">EVBUFFER_MAX_READ</a>;</div>
<div class="line"><span class="lineno"> 2267</span>    <span class="keywordflow">if</span> (ioctlsocket(fd, FIONREAD, &amp;lng) &lt; 0)</div>
<div class="line"><span class="lineno"> 2268</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2269</span>    <span class="comment">/* Can overflow, but mostly harmlessly. XXXX */</span></div>
<div class="line"><span class="lineno"> 2270</span>    <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)lng;</div>
<div class="line"><span class="lineno"> 2271</span><span class="preprocessor">#elif defined(FIONREAD)</span></div>
<div class="line"><span class="lineno"> 2272</span>    <span class="keywordtype">int</span> n = <a class="code hl_define" href="libevent_2buffer_8c.html#af22cda87cfe7fa6b9a07c4c645bcb754">EVBUFFER_MAX_READ</a>;</div>
<div class="line"><span class="lineno"> 2273</span>    <span class="keywordflow">if</span> (ioctl(fd, FIONREAD, &amp;n) &lt; 0)</div>
<div class="line"><span class="lineno"> 2274</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2275</span>    <span class="keywordflow">return</span> n;</div>
<div class="line"><span class="lineno"> 2276</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 2277</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="libevent_2buffer_8c.html#af22cda87cfe7fa6b9a07c4c645bcb754">EVBUFFER_MAX_READ</a>;</div>
<div class="line"><span class="lineno"> 2278</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2279</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l02209">EVBUFFER_MAX_READ</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l02284">evbuffer_read()</a>.</p>

</div>
</div>
<a id="a1791544d9552594ef60983b83b13f3a8" name="a1791544d9552594ef60983b83b13f3a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1791544d9552594ef60983b83b13f3a8">&#9670;&nbsp;</a></span>HAS_PINNED_R()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int HAS_PINNED_R </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00794">794</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  795</span>{</div>
<div class="line"><span class="lineno">  796</span>    <span class="keywordflow">return</span> (buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> &amp;&amp; <a class="code hl_define" href="libevent_2buffer_8c.html#ae415a92292709e1ae7eac7ebcebce494">CHAIN_PINNED_R</a>(buf-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a>));</div>
<div class="line"><span class="lineno">  797</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="libevent_2buffer_8c_source.html#l00134">CHAIN_PINNED_R</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00084">evbuffer::last</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01101">evbuffer_drain()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00814">PRESERVE_PINNED()</a>.</p>

</div>
</div>
<a id="a130b2fd82cc34ea9a10afb27cf160f6a" name="a130b2fd82cc34ea9a10afb27cf160f6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a130b2fd82cc34ea9a10afb27cf160f6a">&#9670;&nbsp;</a></span>PREPEND_CHAIN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void PREPEND_CHAIN </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00948">948</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  949</span>{</div>
<div class="line"><span class="lineno">  950</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(dst);</div>
<div class="line"><span class="lineno">  951</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(src);</div>
<div class="line"><span class="lineno">  952</span>    src-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a>-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a> = dst-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno">  953</span>    dst-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a> = src-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno">  954</span>    dst-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> += src-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a>;</div>
<div class="line"><span class="lineno">  955</span>    <span class="keywordflow">if</span> (*dst-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> == NULL) {</div>
<div class="line"><span class="lineno">  956</span>        <span class="keywordflow">if</span> (src-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> == &amp;(src)-&gt;first)</div>
<div class="line"><span class="lineno">  957</span>            dst-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = &amp;dst-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno">  958</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  959</span>            dst-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = src-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>;</div>
<div class="line"><span class="lineno">  960</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dst-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> == &amp;dst-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>) {</div>
<div class="line"><span class="lineno">  961</span>        dst-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = &amp;src-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a>-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno">  962</span>    }</div>
<div class="line"><span class="lineno">  963</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00282">ASSERT_EVBUFFER_LOCKED</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00084">evbuffer::last</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01055">evbuffer_prepend_buffer()</a>.</p>

</div>
</div>
<a id="ac60199252b9aeb1951f7928fb8fcf489" name="ac60199252b9aeb1951f7928fb8fcf489"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac60199252b9aeb1951f7928fb8fcf489">&#9670;&nbsp;</a></span>PRESERVE_PINNED()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int PRESERVE_PINNED </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> **&#160;</td>
          <td class="paramname"><em>first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> **&#160;</td>
          <td class="paramname"><em>last</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00814">814</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  816</span>{</div>
<div class="line"><span class="lineno">  817</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *chain, **pinned;</div>
<div class="line"><span class="lineno">  818</span> </div>
<div class="line"><span class="lineno">  819</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(src);</div>
<div class="line"><span class="lineno">  820</span> </div>
<div class="line"><span class="lineno">  821</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="libevent_2buffer_8c.html#a1791544d9552594ef60983b83b13f3a8">HAS_PINNED_R</a>(src)) {</div>
<div class="line"><span class="lineno">  822</span>        *first = *last = NULL;</div>
<div class="line"><span class="lineno">  823</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  824</span>    }</div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span>    pinned = src-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>;</div>
<div class="line"><span class="lineno">  827</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="libevent_2buffer_8c.html#ae415a92292709e1ae7eac7ebcebce494">CHAIN_PINNED_R</a>(*pinned))</div>
<div class="line"><span class="lineno">  828</span>        pinned = &amp;(*pinned)-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a302eea17a6aacc55c33f119ad788ddb5">next</a>;</div>
<div class="line"><span class="lineno">  829</span>    <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(<a class="code hl_define" href="libevent_2buffer_8c.html#ae415a92292709e1ae7eac7ebcebce494">CHAIN_PINNED_R</a>(*pinned));</div>
<div class="line"><span class="lineno">  830</span>    chain = *first = *pinned;</div>
<div class="line"><span class="lineno">  831</span>    *last = src-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a>;</div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>    <span class="comment">/* If there&#39;s data in the first pinned chain, we need to allocate</span></div>
<div class="line"><span class="lineno">  834</span><span class="comment">     * a new chain and copy the data over. */</span></div>
<div class="line"><span class="lineno">  835</span>    <span class="keywordflow">if</span> (chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>) {</div>
<div class="line"><span class="lineno">  836</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structevbuffer__chain.html">evbuffer_chain</a> *tmp;</div>
<div class="line"><span class="lineno">  837</span> </div>
<div class="line"><span class="lineno">  838</span>        <a class="code hl_define" href="util-internal_8h.html#a7365930d8b30f4c1ab3cef31a8622731">EVUTIL_ASSERT</a>(pinned == src-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>);</div>
<div class="line"><span class="lineno">  839</span>        tmp = <a class="code hl_function" href="libevent_2buffer_8c.html#ab8a73fb51f7ddbe1641be56eaa45a00f">evbuffer_chain_new</a>(chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>);</div>
<div class="line"><span class="lineno">  840</span>        <span class="keywordflow">if</span> (!tmp)</div>
<div class="line"><span class="lineno">  841</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  842</span>        memcpy(tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a>, chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a9374df4f7d07f1e4580c617da0b38ec7">buffer</a> + chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a>,</div>
<div class="line"><span class="lineno">  843</span>            chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>);</div>
<div class="line"><span class="lineno">  844</span>        tmp-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno">  845</span>        *src-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = tmp;</div>
<div class="line"><span class="lineno">  846</span>        src-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> = tmp;</div>
<div class="line"><span class="lineno">  847</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a4a11d168256c989272d4d2ecea5b16f3">misalign</a> += chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a>;</div>
<div class="line"><span class="lineno">  848</span>        chain-&gt;<a class="code hl_variable" href="structevbuffer__chain.html#a974dfb5dd49914c64eb413ddac81fc26">off</a> = 0;</div>
<div class="line"><span class="lineno">  849</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  850</span>        src-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> = *src-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a>;</div>
<div class="line"><span class="lineno">  851</span>        *pinned = NULL;</div>
<div class="line"><span class="lineno">  852</span>    }</div>
<div class="line"><span class="lineno">  853</span> </div>
<div class="line"><span class="lineno">  854</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  855</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00282">ASSERT_EVBUFFER_LOCKED</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00213">evbuffer_chain::buffer</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00134">CHAIN_PINNED_R</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00157">evbuffer_chain_new()</a>, <a class="el" href="util-internal_8h_source.html#l00363">EVUTIL_ASSERT</a>, <a class="el" href="libevent_2buffer_8c_source.html#l00794">HAS_PINNED_R()</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00084">evbuffer::last</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00180">evbuffer_chain::misalign</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00173">evbuffer_chain::next</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00185">evbuffer_chain::off</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00966">evbuffer_add_buffer()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l01055">evbuffer_prepend_buffer()</a>.</p>

</div>
</div>
<a id="a1e2fe7a3afa03f1b336cc62ef0317bbc" name="a1e2fe7a3afa03f1b336cc62ef0317bbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e2fe7a3afa03f1b336cc62ef0317bbc">&#9670;&nbsp;</a></span>RESTORE_PINNED()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void RESTORE_PINNED </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *&#160;</td>
          <td class="paramname"><em>pinned</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structevbuffer__chain.html">evbuffer_chain</a> *&#160;</td>
          <td class="paramname"><em>last</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00858">858</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  860</span>{</div>
<div class="line"><span class="lineno">  861</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(src);</div>
<div class="line"><span class="lineno">  862</span> </div>
<div class="line"><span class="lineno">  863</span>    <span class="keywordflow">if</span> (!pinned) {</div>
<div class="line"><span class="lineno">  864</span>        <a class="code hl_function" href="libevent_2buffer_8c.html#a11161d984ed671f309bb410de5acff51">ZERO_CHAIN</a>(src);</div>
<div class="line"><span class="lineno">  865</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  866</span>    }</div>
<div class="line"><span class="lineno">  867</span> </div>
<div class="line"><span class="lineno">  868</span>    src-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a> = pinned;</div>
<div class="line"><span class="lineno">  869</span>    src-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> = last;</div>
<div class="line"><span class="lineno">  870</span>    src-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = &amp;src-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a>;</div>
<div class="line"><span class="lineno">  871</span>    src-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> = 0;</div>
<div class="line"><span class="lineno">  872</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00282">ASSERT_EVBUFFER_LOCKED</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00084">evbuffer::last</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00800">ZERO_CHAIN()</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l00966">evbuffer_add_buffer()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l01055">evbuffer_prepend_buffer()</a>.</p>

</div>
</div>
<a id="a11161d984ed671f309bb410de5acff51" name="a11161d984ed671f309bb410de5acff51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11161d984ed671f309bb410de5acff51">&#9670;&nbsp;</a></span>ZERO_CHAIN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ZERO_CHAIN </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structevbuffer.html">evbuffer</a> *&#160;</td>
          <td class="paramname"><em>dst</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="libevent_2buffer_8c_source.html#l00800">800</a> of file <a class="el" href="libevent_2buffer_8c_source.html">buffer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  801</span>{</div>
<div class="line"><span class="lineno">  802</span>    <a class="code hl_define" href="evbuffer-internal_8h.html#abfee4993b153dd7fe271db7669e6d647">ASSERT_EVBUFFER_LOCKED</a>(dst);</div>
<div class="line"><span class="lineno">  803</span>    dst-&gt;<a class="code hl_variable" href="structevbuffer.html#a590cd5dc76dfecc57b45262d65fa1106">first</a> = NULL;</div>
<div class="line"><span class="lineno">  804</span>    dst-&gt;<a class="code hl_variable" href="structevbuffer.html#aada4ae960b5f60ac937cd8488dafc849">last</a> = NULL;</div>
<div class="line"><span class="lineno">  805</span>    dst-&gt;<a class="code hl_variable" href="structevbuffer.html#aa89b72c7086750d7b6c91902e2f1bf21">last_with_datap</a> = &amp;(dst)-&gt;first;</div>
<div class="line"><span class="lineno">  806</span>    dst-&gt;<a class="code hl_variable" href="structevbuffer.html#af432b67ab2e1b3dd8b96e314a0785116">total_len</a> = 0;</div>
<div class="line"><span class="lineno">  807</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="evbuffer-internal_8h_source.html#l00282">ASSERT_EVBUFFER_LOCKED</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00082">evbuffer::first</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00084">evbuffer::last</a>, <a class="el" href="evbuffer-internal_8h_source.html#l00099">evbuffer::last_with_datap</a>, and <a class="el" href="evbuffer-internal_8h_source.html#l00102">evbuffer::total_len</a>.</p>

<p class="reference">Referenced by <a class="el" href="libevent_2buffer_8c_source.html#l01101">evbuffer_drain()</a>, <a class="el" href="libevent_2buffer_8c_source.html#l02051">evbuffer_expand_fast_()</a>, and <a class="el" href="libevent_2buffer_8c_source.html#l00858">RESTORE_PINNED()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
